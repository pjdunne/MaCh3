<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MaCh3: How to Contribute Code to MaCh3</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="MaCh3.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="mach3logo_small.png"/></td>
  <td id="projectalign">
   <div id="projectname">MaCh3<span id="projectnumber">&#160;1.1.1</span>
   </div>
   <div id="projectbrief">Reference Guide</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

</div><!-- top -->
<div><div class="header">
  <div class="headertitle"><div class="title">How to Contribute Code to MaCh3</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="autotoc_md2"></a>The gitflow development policy should be followed, with the master and develop branches only being committed to via pull request.</p>
<p>New features should be developed on branches in this repository with the branch naming: <code>feature_FEATURENAME</code></p>
<p>Please see <a href="https://www.atlassian.com/git/tutorials/comparing-workflows/gitflow-workflow">here</a> for more details</p>
<h1><a class="anchor" id="autotoc_md3"></a>
Doxygen</h1>
<p>When making comments try following Doxygen type of comments</p>
<div class="fragment"><div class="line">// I like comments</div>
<div class="line">void Foo(){}</div>
</div><!-- fragment --><p> try </p><div class="fragment"><div class="line">/// @brief I like comments</div>
<div class="line">void Foo(){}</div>
</div><!-- fragment --><p> After making release or tag please </p><div class="fragment"><div class="line">cd Doc</div>
<div class="line">doxygen Doxyfile</div>
</div><!-- fragment --><p> to produce both html and latex file. To produce book like pdf file: </p><div class="fragment"><div class="line">cd latex</div>
<div class="line">pdflatex refman.tex</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md4"></a>
Logger</h1>
<p>MaCh3 is using spdlog logger see <a href="https://github.com/gabime/spdlog/tree/master">here</a>. And wraps it around MaCh3 names <a href="https://github.com/mach3-software/MaCh3/blob/develop/manager/MaCh3Logger.h">here</a> It is advised to use it. For example rather than </p><div class="fragment"><div class="line">std::cout&lt;&lt; &quot; Error: Something is wrong&quot; &lt;&lt;std::endl;</div>
</div><!-- fragment --><p> it is advised to used logger </p><div class="fragment"><div class="line">MACH3LOG_ERROR(&quot;Something is wrong&quot;);</div>
</div><!-- fragment --><p> To pass argument to logger use following syntax: </p><div class="fragment"><div class="line">MACH3LOG_INFO(&quot;I like {}, do you like {}&quot;, FirsString, SecondString);</div>
</div><!-- fragment --><p> Logger by default will print whole float. Normally to show only several significant figures you would use <code>std::precision(2)</code>. To obtain same thing with logger please use <code>{:.2f}</code> like this: </p><div class="fragment"><div class="line">MACH3LOG_INFO(&quot;Here is full LLH but I only show 2 significant figures {:.2f}&quot;, LLH);</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md5"></a>
Config Syntax</h1>
<p>MaCh3 currently uses yaml as config handler. To help unify syntax over the code there are several YamlHelper function available <a href="https://github.com/mach3-software/MaCh3/blob/develop/manager/YamlHelper.h">here</a>. Most important is <code>GetFromManager</code>. For code below which checks if config entry exist and if doesn't set some default value</p>
<div class="fragment"><div class="line">bool AsimovFit = false;</div>
<div class="line"> </div>
<div class="line">if(config[AsimovFit])</div>
<div class="line">{</div>
<div class="line">  AsimovFit = config[AsimovFit].as&lt;bool&gt;;</div>
<div class="line">}</div>
</div><!-- fragment --><p> This can be replaced with: </p><div class="fragment"><div class="line">bool AsimovFit = GetFromManager&lt;bool&gt;(config[AsimovFit], false);</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md6"></a>
double vs float?</h1>
<p>Some fits require lot's of RAM. Easiest and fastest solution to reduce RAM is use floats instead of doubles. MaCh3 has custom type like _float_ defined <a href="https://github.com/mach3-software/MaCh3/blob/761cdc168663a6cfe659e4e3bab0d939bf715273/samplePDF/Structs.h#L9">here</a>. _float_ is usually double unless _LOW_MEMORY_STRUCTS_ is defined at compilation level. Then _float_ will be actual float. By using _float_ one can flexibly change from one type to another. When developing it is advised to used these data types unless some data types are necessary due to desired precision code safety etc.</p>
<h1><a class="anchor" id="autotoc_md7"></a>
Error handling</h1>
<p>MaCh3 uses custom error handling implemented <a href="https://github.com/mach3-software/MaCh3/blob/develop/manager/MaCh3Exception.h">here</a> Instead of throw </p><div class="fragment"><div class="line">throw;</div>
</div><!-- fragment --><p> it is advised to use:</p>
<div class="fragment"><div class="line">throw MaCh3Exception(__FILE__ , __LINE__ , &quot;Some message&quot;);</div>
</div><!-- fragment --><p> or </p><div class="fragment"><div class="line">throw MaCh3Exception(__FILE__ , __LINE__ );</div>
</div><!-- fragment --><p> This way we can ensure error messages are unified and user always get hints where in the code problem occurred. If current <a class="el" href="classMaCh3Exception.html" title="Custom exception class for MaCh3 errors.">MaCh3Exception</a> is not sufficient consider implementing new or expanding current exceptions in <a class="el" href="MaCh3Exception_8h.html">MaCh3Exception.h</a>.</p>
<h1><a class="anchor" id="autotoc_md8"></a>
Formatting</h1>
<p>To ensure a unified style in MaCh3 software you can use a clang-format file which has instructions about formatting code. </p><div class="fragment"><div class="line">clang-format --assume-filename=/path/to/your/.clang-format=${MaCh3_ROOT}/../.clang-format blarb.cpp</div>
</div><!-- fragment --><p> Please see <a href="https://clang.llvm.org/docs/ClangFormat.html">here</a> and <a href="https://root.cern/contribute/coding_conventions/">here</a> for more details. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
