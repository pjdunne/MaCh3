<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.6"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MaCh3: MCMCProcessor Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="MaCh3.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="mach3logo_small.png"/></td>
  <td id="projectalign">
   <div id="projectname">MaCh3<span id="projectnumber">&#160;1.2.1</span>
   </div>
   <div id="projectbrief">Reference Guide</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.6 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="classMCMCProcessor-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">MCMCProcessor Class Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Class responsible for processing MCMC chains, performing diagnostics, generating plots, and managing Bayesian analysis.  
 <a href="classMCMCProcessor.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="MCMCProcessor_8h_source.html">mcmc/MCMCProcessor.h</a>&gt;</code></p>
<div class="dynheader">
Collaboration diagram for MCMCProcessor:</div>
<div class="dyncontent">
<div class="center"><img src="classMCMCProcessor__coll__graph.png" border="0" usemap="#aMCMCProcessor_coll__map" alt="Collaboration graph"/></div>
<map name="aMCMCProcessor_coll__map" id="aMCMCProcessor_coll__map">
<area shape="rect" title="Class responsible for processing MCMC chains, performing diagnostics, generating plots,..." alt="" coords="872,489,999,514"/>
<area shape="rect" title=" " alt="" coords="233,130,320,155"/>
<area shape="rect" title=" " alt="" coords="493,174,679,199"/>
<area shape="rect" title=" " alt="" coords="5,123,144,163"/>
<area shape="rect" title=" " alt="" coords="499,224,673,264"/>
<area shape="rect" title=" " alt="" coords="511,288,661,328"/>
<area shape="rect" title=" " alt="" coords="193,402,360,427"/>
<area shape="rect" title=" " alt="" coords="499,444,673,484"/>
<area shape="rect" title=" " alt="" coords="202,542,351,567"/>
<area shape="rect" title=" " alt="" coords="499,585,673,625"/>
<area shape="rect" title=" " alt="" coords="499,649,673,689"/>
<area shape="rect" title=" " alt="" coords="194,657,359,682"/>
<area shape="rect" title=" " alt="" coords="517,714,655,739"/>
<area shape="rect" title=" " alt="" coords="473,763,699,789"/>
<area shape="rect" title=" " alt="" coords="502,813,670,838"/>
</map>
<center><span class="legend">[<a href="graph_legend.html">legend</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:afb50150dcb6d1d75f3c08b5ee8d3d77c"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#afb50150dcb6d1d75f3c08b5ee8d3d77c">MCMCProcessor</a> (const std::string &amp;InputFile)</td></tr>
<tr class="memdesc:afb50150dcb6d1d75f3c08b5ee8d3d77c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructs an <a class="el" href="classMCMCProcessor.html" title="Class responsible for processing MCMC chains, performing diagnostics, generating plots,...">MCMCProcessor</a> object with the specified input file and options.  <br /></td></tr>
<tr class="separator:afb50150dcb6d1d75f3c08b5ee8d3d77c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a50810cd50c5a4545bd5c1e486aae7b1c"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#a50810cd50c5a4545bd5c1e486aae7b1c">~MCMCProcessor</a> ()</td></tr>
<tr class="memdesc:a50810cd50c5a4545bd5c1e486aae7b1c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Destroys the <a class="el" href="classMCMCProcessor.html" title="Class responsible for processing MCMC chains, performing diagnostics, generating plots,...">MCMCProcessor</a> object.  <br /></td></tr>
<tr class="separator:a50810cd50c5a4545bd5c1e486aae7b1c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a224995a0b47bd9cbd04e099cc3ca634c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#a224995a0b47bd9cbd04e099cc3ca634c">Initialise</a> ()</td></tr>
<tr class="memdesc:a224995a0b47bd9cbd04e099cc3ca634c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Scan chain, what parameters we have and load information from covariance matrices.  <br /></td></tr>
<tr class="separator:a224995a0b47bd9cbd04e099cc3ca634c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8667510132aa01395520f028287f511b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#a8667510132aa01395520f028287f511b">MakePostfit</a> ()</td></tr>
<tr class="memdesc:a8667510132aa01395520f028287f511b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Make 1D projection for each parameter and prepare structure.  <br /></td></tr>
<tr class="separator:a8667510132aa01395520f028287f511b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afc94f21ffd599b1e2dd7e62f24f6c4de"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#afc94f21ffd599b1e2dd7e62f24f6c4de">MakeCovariance</a> ()</td></tr>
<tr class="memdesc:afc94f21ffd599b1e2dd7e62f24f6c4de"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate covariance by making 2D projection of each combination of parameters.  <br /></td></tr>
<tr class="separator:afc94f21ffd599b1e2dd7e62f24f6c4de"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ace48a54fb08e2a3943d4e2ed1f8c4a4b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#ace48a54fb08e2a3943d4e2ed1f8c4a4b">CacheSteps</a> ()</td></tr>
<tr class="memdesc:ace48a54fb08e2a3943d4e2ed1f8c4a4b"><td class="mdescLeft">&#160;</td><td class="mdescRight">KS:By caching each step we use multithreading.  <br /></td></tr>
<tr class="separator:ace48a54fb08e2a3943d4e2ed1f8c4a4b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab367cb5f56606338bb1fce780f2414e8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#ab367cb5f56606338bb1fce780f2414e8">MakeCovariance_MP</a> (const bool Mute=false)</td></tr>
<tr class="memdesc:ab367cb5f56606338bb1fce780f2414e8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate covariance by making 2D projection of each combination of parameters using multithreading.  <br /></td></tr>
<tr class="separator:ab367cb5f56606338bb1fce780f2414e8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afac304b884238cc3624f5471b43f1a7e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#afac304b884238cc3624f5471b43f1a7e">MakeSubOptimality</a> (const int NIntervals=10)</td></tr>
<tr class="memdesc:afac304b884238cc3624f5471b43f1a7e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Make and Draw SubOptimality <a class="el" href="citelist.html#CITEREF_roberts2009adaptive">[15]</a>.  <br /></td></tr>
<tr class="separator:afac304b884238cc3624f5471b43f1a7e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a36441ec3d5b0e24e48040282ffcda3eb"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#a36441ec3d5b0e24e48040282ffcda3eb">ResetHistograms</a> ()</td></tr>
<tr class="memdesc:a36441ec3d5b0e24e48040282ffcda3eb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reset 2D posteriors, in case we would like to calculate in again with different BurnInCut.  <br /></td></tr>
<tr class="separator:a36441ec3d5b0e24e48040282ffcda3eb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab420de77e598da4b02ba74cdc20f2ea9"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#ab420de77e598da4b02ba74cdc20f2ea9">DrawPostfit</a> ()</td></tr>
<tr class="memdesc:ab420de77e598da4b02ba74cdc20f2ea9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Draw the post-fit comparisons.  <br /></td></tr>
<tr class="separator:ab420de77e598da4b02ba74cdc20f2ea9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a04976c69f0ef0b3f39edcf5f25f90981"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#a04976c69f0ef0b3f39edcf5f25f90981">MakeViolin</a> ()</td></tr>
<tr class="memdesc:a04976c69f0ef0b3f39edcf5f25f90981"><td class="mdescLeft">&#160;</td><td class="mdescRight">Make and Draw Violin.  <br /></td></tr>
<tr class="separator:a04976c69f0ef0b3f39edcf5f25f90981"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a17c0f09bfce82d1701a83645f748988a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#a17c0f09bfce82d1701a83645f748988a">MakeCredibleIntervals</a> (const std::vector&lt; double &gt; &amp;CredibleIntervals={0.99, 0.90, 0.68 }, const std::vector&lt; Color_t &gt; &amp;CredibleIntervalsColours={kCyan+4, kCyan-2, kCyan-10}, const bool CredibleInSigmas=false)</td></tr>
<tr class="memdesc:a17c0f09bfce82d1701a83645f748988a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Make and Draw Credible intervals.  <br /></td></tr>
<tr class="separator:a17c0f09bfce82d1701a83645f748988a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8d9b9c1c780a51b130fe528583dc5019"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#a8d9b9c1c780a51b130fe528583dc5019">DrawCovariance</a> ()</td></tr>
<tr class="memdesc:a8d9b9c1c780a51b130fe528583dc5019"><td class="mdescLeft">&#160;</td><td class="mdescRight">Draw the post-fit covariances.  <br /></td></tr>
<tr class="separator:a8d9b9c1c780a51b130fe528583dc5019"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a304adbe4407166ec42d76329c4bd17ff"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#a304adbe4407166ec42d76329c4bd17ff">MakeCredibleRegions</a> (const std::vector&lt; double &gt; &amp;CredibleRegions={0.99, 0.90, 0.68}, const std::vector&lt; Style_t &gt; &amp;CredibleRegionStyle={kDashed, kSolid, kDotted}, const std::vector&lt; Color_t &gt; &amp;CredibleRegionColor={kGreen-3, kGreen-10, kGreen}, const bool CredibleInSigmas=false)</td></tr>
<tr class="memdesc:a304adbe4407166ec42d76329c4bd17ff"><td class="mdescLeft">&#160;</td><td class="mdescRight">Make and Draw Credible Regions.  <br /></td></tr>
<tr class="separator:a304adbe4407166ec42d76329c4bd17ff"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3ae80722efa0c94eec066ee91f3cf997"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#a3ae80722efa0c94eec066ee91f3cf997">MakeTrianglePlot</a> (const std::vector&lt; std::string &gt; &amp;ParNames, const std::vector&lt; double &gt; &amp;CredibleIntervals={0.99, 0.90, 0.68 }, const std::vector&lt; Color_t &gt; &amp;CredibleIntervalsColours={kCyan+4, kCyan-2, kCyan-10}, const std::vector&lt; double &gt; &amp;CredibleRegions={0.99, 0.90, 0.68}, const std::vector&lt; Style_t &gt; &amp;CredibleRegionStyle={kDashed, kSolid, kDotted}, const std::vector&lt; Color_t &gt; &amp;CredibleRegionColor={kGreen-3, kGreen-10, kGreen}, const bool CredibleInSigmas=false)</td></tr>
<tr class="memdesc:a3ae80722efa0c94eec066ee91f3cf997"><td class="mdescLeft">&#160;</td><td class="mdescRight">Make fancy triangle plot for selected parameters.  <br /></td></tr>
<tr class="separator:a3ae80722efa0c94eec066ee91f3cf997"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac358c3ffe7c060e8872c762259973c6b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#ac358c3ffe7c060e8872c762259973c6b">GetPolarPlot</a> (const std::vector&lt; std::string &gt; &amp;ParNames)</td></tr>
<tr class="memdesc:ac358c3ffe7c060e8872c762259973c6b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Make funny polar plot.  <br /></td></tr>
<tr class="separator:ac358c3ffe7c060e8872c762259973c6b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1fc5adc3c109227e6ead71eb0746ec4d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#a1fc5adc3c109227e6ead71eb0746ec4d">GetBayesFactor</a> (const std::vector&lt; std::string &gt; &amp;ParName, const std::vector&lt; std::vector&lt; double &gt; &gt; &amp;Model1Bounds, const std::vector&lt; std::vector&lt; double &gt; &gt; &amp;Model2Bounds, const std::vector&lt; std::vector&lt; std::string &gt; &gt; &amp;ModelNames)</td></tr>
<tr class="memdesc:a1fc5adc3c109227e6ead71eb0746ec4d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate Bayes factor for vector of params, and model boundaries.  <br /></td></tr>
<tr class="separator:a1fc5adc3c109227e6ead71eb0746ec4d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad09b1ad60fa52fdd87450ab8834e9cd9"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#ad09b1ad60fa52fdd87450ab8834e9cd9">GetSavageDickey</a> (const std::vector&lt; std::string &gt; &amp;ParName, const std::vector&lt; double &gt; &amp;EvaluationPoint, const std::vector&lt; std::vector&lt; double &gt; &gt; &amp;Bounds)</td></tr>
<tr class="memdesc:ad09b1ad60fa52fdd87450ab8834e9cd9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate Bayes factor for point like hypothesis using SavageDickey.  <br /></td></tr>
<tr class="separator:ad09b1ad60fa52fdd87450ab8834e9cd9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad3b1cfab21c7063bc29d1cf5dcca888c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#ad3b1cfab21c7063bc29d1cf5dcca888c">ReweightPrior</a> (const std::vector&lt; std::string &gt; &amp;Names, const std::vector&lt; double &gt; &amp;NewCentral, const std::vector&lt; double &gt; &amp;NewError)</td></tr>
<tr class="memdesc:ad3b1cfab21c7063bc29d1cf5dcca888c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reweight Prior by giving new central value and new error.  <br /></td></tr>
<tr class="separator:ad3b1cfab21c7063bc29d1cf5dcca888c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac9a5fc93b5ac3f6ef7850d21f47fd5dd"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#ac9a5fc93b5ac3f6ef7850d21f47fd5dd">ParameterEvolution</a> (const std::vector&lt; std::string &gt; &amp;Names, const std::vector&lt; int &gt; &amp;NIntervals)</td></tr>
<tr class="memdesc:ac9a5fc93b5ac3f6ef7850d21f47fd5dd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Make .gif of parameter evolution.  <br /></td></tr>
<tr class="separator:ac9a5fc93b5ac3f6ef7850d21f47fd5dd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a623957be60ec7c48145e80d0014ef971"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#a623957be60ec7c48145e80d0014ef971">ThinMCMC</a> (const int ThinningCut)</td></tr>
<tr class="memdesc:a623957be60ec7c48145e80d0014ef971"><td class="mdescLeft">&#160;</td><td class="mdescRight">Thin MCMC Chain, to save space and maintain low autocorrelations.  <br /></td></tr>
<tr class="separator:a623957be60ec7c48145e80d0014ef971"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7f8faecae63616ba100cf24ae42ecc08"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#a7f8faecae63616ba100cf24ae42ecc08">DiagMCMC</a> ()</td></tr>
<tr class="memdesc:a7f8faecae63616ba100cf24ae42ecc08"><td class="mdescLeft">&#160;</td><td class="mdescRight">KS: Perform MCMC diagnostic including Autocorrelation, Trace etc.  <br /></td></tr>
<tr class="separator:a7f8faecae63616ba100cf24ae42ecc08"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adbde2f115d983b233d0a9ea896187586"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#adbde2f115d983b233d0a9ea896187586">GetNParams</a> ()</td></tr>
<tr class="memdesc:adbde2f115d983b233d0a9ea896187586"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get total number of used parameters.  <br /></td></tr>
<tr class="separator:adbde2f115d983b233d0a9ea896187586"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a82e67c2a28b286aae353636782c93a23"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#a82e67c2a28b286aae353636782c93a23">GetNFlux</a> ()</td></tr>
<tr class="separator:a82e67c2a28b286aae353636782c93a23"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae5ba9ac70fefcd01afd5066281438883"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#ae5ba9ac70fefcd01afd5066281438883">GetNXSec</a> ()</td></tr>
<tr class="separator:ae5ba9ac70fefcd01afd5066281438883"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af92fab1bce506912ae00d1aa5d9b7233"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#af92fab1bce506912ae00d1aa5d9b7233">GetNND</a> ()</td></tr>
<tr class="separator:af92fab1bce506912ae00d1aa5d9b7233"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad376c15dcf60a4284dfa23368e097450"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#ad376c15dcf60a4284dfa23368e097450">GetNFD</a> ()</td></tr>
<tr class="separator:ad376c15dcf60a4284dfa23368e097450"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6aaa70eeca8d40c94f9836b3108cf579"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#a6aaa70eeca8d40c94f9836b3108cf579">GetOSC</a> ()</td></tr>
<tr class="separator:a6aaa70eeca8d40c94f9836b3108cf579"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a70f5590946414af43c3b6c3a5cd315de"><td class="memItemLeft" align="right" valign="top">TH1D *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#a70f5590946414af43c3b6c3a5cd315de">GetHpost</a> (const int i)</td></tr>
<tr class="memdesc:a70f5590946414af43c3b6c3a5cd315de"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get 1D posterior for a given parameter.  <br /></td></tr>
<tr class="separator:a70f5590946414af43c3b6c3a5cd315de"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7882d6c6a54bb345df394ef13b2962d1"><td class="memItemLeft" align="right" valign="top">TH2D *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#a7882d6c6a54bb345df394ef13b2962d1">GetHpost2D</a> (const int i, const int j)</td></tr>
<tr class="memdesc:a7882d6c6a54bb345df394ef13b2962d1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get 2D posterior for a given parameter combination.  <br /></td></tr>
<tr class="separator:a7882d6c6a54bb345df394ef13b2962d1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4ecd30520854d1379946bd8b1f2992f2"><td class="memItemLeft" align="right" valign="top">TH2D *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#a4ecd30520854d1379946bd8b1f2992f2">GetViolin</a> ()</td></tr>
<tr class="memdesc:a4ecd30520854d1379946bd8b1f2992f2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get Violin plot for all parameters with posterior values.  <br /></td></tr>
<tr class="separator:a4ecd30520854d1379946bd8b1f2992f2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0489e9f57b847389bc0c9f8af5a0abdb"><td class="memItemLeft" align="right" valign="top">TH2D *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#a0489e9f57b847389bc0c9f8af5a0abdb">GetViolinPrior</a> ()</td></tr>
<tr class="memdesc:a0489e9f57b847389bc0c9f8af5a0abdb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get Violin plot for all parameters with prior values.  <br /></td></tr>
<tr class="separator:a0489e9f57b847389bc0c9f8af5a0abdb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad4fa1cfa19aad913c370143b4dc2fa6b"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::string &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#ad4fa1cfa19aad913c370143b4dc2fa6b">GetXSecCov</a> () const</td></tr>
<tr class="separator:ad4fa1cfa19aad913c370143b4dc2fa6b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad26a853f53f50f5625b1c8043534dbe0"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#ad26a853f53f50f5625b1c8043534dbe0">GetNDCov</a> () const</td></tr>
<tr class="separator:ad26a853f53f50f5625b1c8043534dbe0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab831ff0257b1f3137e1711df115a8b8d"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#ab831ff0257b1f3137e1711df115a8b8d">GetFDCov</a> () const</td></tr>
<tr class="separator:ab831ff0257b1f3137e1711df115a8b8d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae1d255f2216d4f4e9bc64c300d396d1e"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::string &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#ae1d255f2216d4f4e9bc64c300d396d1e">GetOscCov</a> () const</td></tr>
<tr class="separator:ae1d255f2216d4f4e9bc64c300d396d1e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5fc015740496b821648f0e5ca8cffe80"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#a5fc015740496b821648f0e5ca8cffe80">GetPostfit</a> (TVectorD *&amp;Central, TVectorD *&amp;<a class="el" href="classMCMCProcessor.html#a5174aaa900edf16ddc6e841ea4adae83">Errors</a>, TVectorD *&amp;Central_Gauss, TVectorD *&amp;<a class="el" href="classMCMCProcessor.html#aa78b7ed1bb9966f84f4eaf8cedf5e688">Errors_Gauss</a>, TVectorD *&amp;Peaks)</td></tr>
<tr class="memdesc:a5fc015740496b821648f0e5ca8cffe80"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the post-fit results (arithmetic and Gaussian)  <br /></td></tr>
<tr class="separator:a5fc015740496b821648f0e5ca8cffe80"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac9e4fdea5d2de92a1abad5b79b7daf88"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#ac9e4fdea5d2de92a1abad5b79b7daf88">GetCovariance</a> (TMatrixDSym *&amp;Cov, TMatrixDSym *&amp;Corr)</td></tr>
<tr class="memdesc:ac9e4fdea5d2de92a1abad5b79b7daf88"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the post-fit covariances and correlations.  <br /></td></tr>
<tr class="separator:ac9e4fdea5d2de92a1abad5b79b7daf88"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a59fa9550b7c69c616929217ae89c2f42"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#a59fa9550b7c69c616929217ae89c2f42">GetPostfit_Ind</a> (TVectorD *&amp;Central, TVectorD *&amp;<a class="el" href="classMCMCProcessor.html#a5174aaa900edf16ddc6e841ea4adae83">Errors</a>, TVectorD *&amp;Peaks, <a class="el" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20b">ParameterEnum</a> kParam)</td></tr>
<tr class="memdesc:a59fa9550b7c69c616929217ae89c2f42"><td class="mdescLeft">&#160;</td><td class="mdescRight">Or the individual post-fits.  <br /></td></tr>
<tr class="separator:a59fa9550b7c69c616929217ae89c2f42"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3905a8c1e333cb52a192c0cfaf1a0949"><td class="memItemLeft" align="right" valign="top">const std::vector&lt; TString &gt; &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#a3905a8c1e333cb52a192c0cfaf1a0949">GetBranchNames</a> () const</td></tr>
<tr class="memdesc:a3905a8c1e333cb52a192c0cfaf1a0949"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the vector of branch names from root file.  <br /></td></tr>
<tr class="separator:a3905a8c1e333cb52a192c0cfaf1a0949"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a28dfe42f1bf6fd3a145287be1e63fb0b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#a28dfe42f1bf6fd3a145287be1e63fb0b">GetNthParameter</a> (const int param, double &amp;Prior, double &amp;PriorError, TString &amp;Title)</td></tr>
<tr class="memdesc:a28dfe42f1bf6fd3a145287be1e63fb0b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get properties of parameter by passing it number.  <br /></td></tr>
<tr class="separator:a28dfe42f1bf6fd3a145287be1e63fb0b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5ab91183fbbf23fff759fefc9954a1a5"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#a5ab91183fbbf23fff759fefc9954a1a5">GetParamIndexFromName</a> (const std::string &amp;Name)</td></tr>
<tr class="memdesc:a5ab91183fbbf23fff759fefc9954a1a5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get parameter number based on name.  <br /></td></tr>
<tr class="separator:a5ab91183fbbf23fff759fefc9954a1a5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7f00ad66e9eb7a910ef6e9e081c4154d"><td class="memItemLeft" align="right" valign="top">Long64_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#a7f00ad66e9eb7a910ef6e9e081c4154d">GetnEntries</a> ()</td></tr>
<tr class="memdesc:a7f00ad66e9eb7a910ef6e9e081c4154d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get Number of entries that Chain has, for merged chains will not be the same Nsteps.  <br /></td></tr>
<tr class="separator:a7f00ad66e9eb7a910ef6e9e081c4154d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa2ebe9262f7f28778d92148164a54d4b"><td class="memItemLeft" align="right" valign="top">Long64_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#aa2ebe9262f7f28778d92148164a54d4b">GetnSteps</a> ()</td></tr>
<tr class="memdesc:aa2ebe9262f7f28778d92148164a54d4b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get Number of Steps that Chain has, for merged chains will not be the same nEntries.  <br /></td></tr>
<tr class="separator:aa2ebe9262f7f28778d92148164a54d4b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad610d8e835031872b428e759ef4045f1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#ad610d8e835031872b428e759ef4045f1">SetStepCut</a> (const std::string &amp;Cuts)</td></tr>
<tr class="memdesc:ad610d8e835031872b428e759ef4045f1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the step cutting by string.  <br /></td></tr>
<tr class="separator:ad610d8e835031872b428e759ef4045f1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a16f653dcb6358f2a8e393e3946a7e6d2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#a16f653dcb6358f2a8e393e3946a7e6d2">SetStepCut</a> (const int Cuts)</td></tr>
<tr class="memdesc:a16f653dcb6358f2a8e393e3946a7e6d2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the step cutting by int.  <br /></td></tr>
<tr class="separator:a16f653dcb6358f2a8e393e3946a7e6d2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6ea549289949ac19d2fc768d82c8f1c9"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#a6ea549289949ac19d2fc768d82c8f1c9">SetPlotRelativeToPrior</a> (const bool PlotOrNot)</td></tr>
<tr class="memdesc:a6ea549289949ac19d2fc768d82c8f1c9"><td class="mdescLeft">&#160;</td><td class="mdescRight">You can set relative to prior or relative to generated. It is advised to use relate to prior.  <br /></td></tr>
<tr class="separator:a6ea549289949ac19d2fc768d82c8f1c9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9db87211d9f066011daed18af7f4631e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#a9db87211d9f066011daed18af7f4631e">SetPrintToPDF</a> (const bool PlotOrNot)</td></tr>
<tr class="separator:a9db87211d9f066011daed18af7f4631e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adbe0ec06ce30447cb1c03a961364b929"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#adbe0ec06ce30447cb1c03a961364b929">SetPlotErrorForFlatPrior</a> (const bool PlotOrNot)</td></tr>
<tr class="memdesc:adbe0ec06ce30447cb1c03a961364b929"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set whether you want to plot error for parameters which have flat prior.  <br /></td></tr>
<tr class="separator:adbe0ec06ce30447cb1c03a961364b929"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aed120fafdfe97615f4c2a30aedde03dd"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#aed120fafdfe97615f4c2a30aedde03dd">SetPlotBinValue</a> (const bool PlotOrNot)</td></tr>
<tr class="separator:aed120fafdfe97615f4c2a30aedde03dd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7f61cf0a51670f24f16dd7d77b7f5ae4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#a7f61cf0a51670f24f16dd7d77b7f5ae4">SetFancyNames</a> (const bool PlotOrNot)</td></tr>
<tr class="separator:a7f61cf0a51670f24f16dd7d77b7f5ae4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4bec41cdc9af977a51b269e2a07fe961"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#a4bec41cdc9af977a51b269e2a07fe961">SetSmoothing</a> (const bool PlotOrNot)</td></tr>
<tr class="memdesc:a4bec41cdc9af977a51b269e2a07fe961"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set whether want to use smoothing for histograms using ROOT algorithm.  <br /></td></tr>
<tr class="separator:a4bec41cdc9af977a51b269e2a07fe961"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab605f4d7bf4e2b24b4c0b1c5853b479f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#ab605f4d7bf4e2b24b4c0b1c5853b479f">SetPost2DPlotThreshold</a> (const double Threshold)</td></tr>
<tr class="memdesc:ab605f4d7bf4e2b24b4c0b1c5853b479f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Code will only plot 2D posteriors if Correlation are larger than defined threshold.  <br /></td></tr>
<tr class="separator:ab605f4d7bf4e2b24b4c0b1c5853b479f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab90c5ec77c57103dfaa72648c330a390"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#ab90c5ec77c57103dfaa72648c330a390">SetUseFFTAutoCorrelation</a> (const bool useFFT)</td></tr>
<tr class="memdesc:ab90c5ec77c57103dfaa72648c330a390"><td class="mdescLeft">&#160;</td><td class="mdescRight">Toggle using the FFT-based autocorrelation calculator.  <br /></td></tr>
<tr class="separator:ab90c5ec77c57103dfaa72648c330a390"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4364a8ab084906c8925c9db9dc110485"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#a4364a8ab084906c8925c9db9dc110485">SetExcludedTypes</a> (std::vector&lt; std::string &gt; Name)</td></tr>
<tr class="memdesc:a4364a8ab084906c8925c9db9dc110485"><td class="mdescLeft">&#160;</td><td class="mdescRight">Setter related what parameters we want to exclude from analysis, for example if cross-section parameters look like xsec_, then passing "xsec_" will.  <br /></td></tr>
<tr class="separator:a4364a8ab084906c8925c9db9dc110485"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a09a6fa6cefcb20c00bee22c1dc5718c5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#a09a6fa6cefcb20c00bee22c1dc5718c5">SetExcludedNames</a> (std::vector&lt; std::string &gt; Name)</td></tr>
<tr class="separator:a09a6fa6cefcb20c00bee22c1dc5718c5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5b13f1879f84d13b7d139432a9b993c6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#a5b13f1879f84d13b7d139432a9b993c6">SetnBatches</a> (const int Batches)</td></tr>
<tr class="memdesc:a5b13f1879f84d13b7d139432a9b993c6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set value of Nbatches used for batched mean, this need to be done earlier as batches are made when reading tree.  <br /></td></tr>
<tr class="separator:a5b13f1879f84d13b7d139432a9b993c6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a173d37d528ff201e66db8f92c156e3bb"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#a173d37d528ff201e66db8f92c156e3bb">SetnLags</a> (const int nLags)</td></tr>
<tr class="separator:a173d37d528ff201e66db8f92c156e3bb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2f4bf14c95b830c457a73be5399403ad"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#a2f4bf14c95b830c457a73be5399403ad">SetOutputSuffix</a> (const std::string Suffix)</td></tr>
<tr class="memdesc:a2f4bf14c95b830c457a73be5399403ad"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sett output suffix, this way jobs using the same file will have different names.  <br /></td></tr>
<tr class="separator:a2f4bf14c95b830c457a73be5399403ad"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a641da7f5e018d48d480638fbad6406a4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#a641da7f5e018d48d480638fbad6406a4">SetPosterior1DCut</a> (const std::string Cut)</td></tr>
<tr class="memdesc:a641da7f5e018d48d480638fbad6406a4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Allow to set addtional cuts based on ROOT TBrowser cut, for to only affect one mass ordering.  <br /></td></tr>
<tr class="separator:a641da7f5e018d48d480638fbad6406a4"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pri-methods" name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr class="memitem:a03267ff95cb0f4dab0882db852893768"><td class="memItemLeft" align="right" valign="top">TH1D *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#a03267ff95cb0f4dab0882db852893768">MakePrefit</a> ()</td></tr>
<tr class="memdesc:a03267ff95cb0f4dab0882db852893768"><td class="mdescLeft">&#160;</td><td class="mdescRight">Prepare prefit histogram for parameter overlay plot.  <br /></td></tr>
<tr class="separator:a03267ff95cb0f4dab0882db852893768"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa5a7761e97cf2e24c7d877a5374b7333"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#aa5a7761e97cf2e24c7d877a5374b7333">MakeOutputFile</a> ()</td></tr>
<tr class="memdesc:aa5a7761e97cf2e24c7d877a5374b7333"><td class="mdescLeft">&#160;</td><td class="mdescRight">prepare output root file and canvas to which we will save EVERYTHING  <br /></td></tr>
<tr class="separator:aa5a7761e97cf2e24c7d877a5374b7333"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5b0961bcb0eea7a347e6a29ef7738d80"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#a5b0961bcb0eea7a347e6a29ef7738d80">DrawCorrelations1D</a> ()</td></tr>
<tr class="memdesc:a5b0961bcb0eea7a347e6a29ef7738d80"><td class="mdescLeft">&#160;</td><td class="mdescRight">Draw 1D correlations which might be more helpful than looking at huge 2D Corr matrix.  <br /></td></tr>
<tr class="separator:a5b0961bcb0eea7a347e6a29ef7738d80"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afef48d4fccf7551dc1845f8f6c08864f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#afef48d4fccf7551dc1845f8f6c08864f">ReadInputCov</a> ()</td></tr>
<tr class="memdesc:afef48d4fccf7551dc1845f8f6c08864f"><td class="mdescLeft">&#160;</td><td class="mdescRight">CW: Read the input Covariance matrix entries. Get stuff like parameter input errors, names, and so on.  <br /></td></tr>
<tr class="separator:afef48d4fccf7551dc1845f8f6c08864f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aea15e730ff77556bb93bc4cff675744c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#aea15e730ff77556bb93bc4cff675744c">FindInputFiles</a> ()</td></tr>
<tr class="memdesc:aea15e730ff77556bb93bc4cff675744c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Read the output MCMC file and find what inputs were used.  <br /></td></tr>
<tr class="separator:aea15e730ff77556bb93bc4cff675744c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2b0b4afbf45adb93357abe96d108170b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#a2b0b4afbf45adb93357abe96d108170b">ReadXSecFile</a> ()</td></tr>
<tr class="memdesc:a2b0b4afbf45adb93357abe96d108170b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Read the xsec file and get the input central values and errors.  <br /></td></tr>
<tr class="separator:a2b0b4afbf45adb93357abe96d108170b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a66dd0f1f88dbeb2b6a1976d42f77e136"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#a66dd0f1f88dbeb2b6a1976d42f77e136">ReadNDFile</a> ()</td></tr>
<tr class="memdesc:a66dd0f1f88dbeb2b6a1976d42f77e136"><td class="mdescLeft">&#160;</td><td class="mdescRight">Read the ND cov file and get the input central values and errors.  <br /></td></tr>
<tr class="separator:a66dd0f1f88dbeb2b6a1976d42f77e136"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae5ea421c8dd77ceac2e748008633b573"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#ae5ea421c8dd77ceac2e748008633b573">ReadFDFile</a> ()</td></tr>
<tr class="memdesc:ae5ea421c8dd77ceac2e748008633b573"><td class="mdescLeft">&#160;</td><td class="mdescRight">Read the FD cov file and get the input central values and errors.  <br /></td></tr>
<tr class="separator:ae5ea421c8dd77ceac2e748008633b573"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3733b3b753c73f79e6846bc92c4da11b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#a3733b3b753c73f79e6846bc92c4da11b">ReadOSCFile</a> ()</td></tr>
<tr class="memdesc:a3733b3b753c73f79e6846bc92c4da11b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Read the Osc cov file and get the input central values and errors.  <br /></td></tr>
<tr class="separator:a3733b3b753c73f79e6846bc92c4da11b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9a29c1cb64589ac136f7f927cafa18aa"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#a9a29c1cb64589ac136f7f927cafa18aa">RemoveParameters</a> ()</td></tr>
<tr class="memdesc:a9a29c1cb64589ac136f7f927cafa18aa"><td class="mdescLeft">&#160;</td><td class="mdescRight">Remove parameter specified in config.  <br /></td></tr>
<tr class="separator:a9a29c1cb64589ac136f7f927cafa18aa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeff2174617268c1e55333529459bffb6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#aeff2174617268c1e55333529459bffb6">ScanInput</a> ()</td></tr>
<tr class="memdesc:aeff2174617268c1e55333529459bffb6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Scan Input etc.  <br /></td></tr>
<tr class="separator:aeff2174617268c1e55333529459bffb6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a015cf0d6925d026e5bd9d82aa31083b6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#a015cf0d6925d026e5bd9d82aa31083b6">ScanParameterOrder</a> ()</td></tr>
<tr class="memdesc:a015cf0d6925d026e5bd9d82aa31083b6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Scan order of params from a different groups.  <br /></td></tr>
<tr class="separator:a015cf0d6925d026e5bd9d82aa31083b6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa4761be1345f1be3defe162b278a9d8e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#aa4761be1345f1be3defe162b278a9d8e">SetupOutput</a> ()</td></tr>
<tr class="memdesc:aa4761be1345f1be3defe162b278a9d8e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Prepare all objects used for output.  <br /></td></tr>
<tr class="separator:aa4761be1345f1be3defe162b278a9d8e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a930cadafa41b31b58066dea68628de9f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#a930cadafa41b31b58066dea68628de9f">PrepareDiagMCMC</a> ()</td></tr>
<tr class="memdesc:a930cadafa41b31b58066dea68628de9f"><td class="mdescLeft">&#160;</td><td class="mdescRight">CW: Prepare branches etc. for DiagMCMC.  <br /></td></tr>
<tr class="separator:a930cadafa41b31b58066dea68628de9f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a929d6efec80bb4de05eea7011257439a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#a929d6efec80bb4de05eea7011257439a">ParamTraces</a> ()</td></tr>
<tr class="memdesc:a929d6efec80bb4de05eea7011257439a"><td class="mdescLeft">&#160;</td><td class="mdescRight">CW: Draw trace plots of the parameters i.e. parameter vs step.  <br /></td></tr>
<tr class="separator:a929d6efec80bb4de05eea7011257439a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a322bee0c362ba83df8c45769d299ce9f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#a322bee0c362ba83df8c45769d299ce9f">AutoCorrelation</a> ()</td></tr>
<tr class="memdesc:a322bee0c362ba83df8c45769d299ce9f"><td class="mdescLeft">&#160;</td><td class="mdescRight">KS: Calculate autocorrelations supports both OpenMP and CUDA :)  <br /></td></tr>
<tr class="separator:a322bee0c362ba83df8c45769d299ce9f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abeb5e115fa9f58ea7872af5cf13c6b79"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#abeb5e115fa9f58ea7872af5cf13c6b79">AutoCorrelation_FFT</a> ()</td></tr>
<tr class="memdesc:abeb5e115fa9f58ea7872af5cf13c6b79"><td class="mdescLeft">&#160;</td><td class="mdescRight">MJR: Autocorrelation function using FFT algorithm for extra speed.  <br /></td></tr>
<tr class="separator:abeb5e115fa9f58ea7872af5cf13c6b79"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1eb6f27c2fb967326dc14dc3dcdc3957"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#a1eb6f27c2fb967326dc14dc3dcdc3957">CalculateESS</a> (const int nLags, const std::vector&lt; std::vector&lt; double &gt; &gt; &amp;LagL)</td></tr>
<tr class="memdesc:a1eb6f27c2fb967326dc14dc3dcdc3957"><td class="mdescLeft">&#160;</td><td class="mdescRight">KS: calc Effective Sample Size.  <br /></td></tr>
<tr class="separator:a1eb6f27c2fb967326dc14dc3dcdc3957"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a29d492906e0c027d089331a0509cd2c3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#a29d492906e0c027d089331a0509cd2c3">BatchedAnalysis</a> ()</td></tr>
<tr class="memdesc:a29d492906e0c027d089331a0509cd2c3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the batched means variance estimation and variable indicating if number of batches is sensible <a class="el" href="citelist.html#CITEREF_chakraborty2019estimating">[2]</a> <a class="el" href="citelist.html#CITEREF_rossetti2024batch">[16]</a>.  <br /></td></tr>
<tr class="separator:a29d492906e0c027d089331a0509cd2c3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af3658b8adee50f6ef5557ebbd1c87b8e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#af3658b8adee50f6ef5557ebbd1c87b8e">BatchedMeans</a> ()</td></tr>
<tr class="memdesc:af3658b8adee50f6ef5557ebbd1c87b8e"><td class="mdescLeft">&#160;</td><td class="mdescRight">CW: Batched means, literally read from an array and chuck into TH1D.  <br /></td></tr>
<tr class="separator:af3658b8adee50f6ef5557ebbd1c87b8e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a03b7c4bb9cd9a90aa7d284b0f1a6156b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#a03b7c4bb9cd9a90aa7d284b0f1a6156b">GewekeDiagnostic</a> ()</td></tr>
<tr class="memdesc:a03b7c4bb9cd9a90aa7d284b0f1a6156b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Geweke Diagnostic based on the methods described by Fang (2014) and Karlsbakk (2011). <a class="el" href="citelist.html#CITEREF_Fang2014GewekeDiagnostics">[6]</a> <a class="el" href="citelist.html#CITEREF_karlsbakk2011">[12]</a>.  <br /></td></tr>
<tr class="separator:a03b7c4bb9cd9a90aa7d284b0f1a6156b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a278b82fa945d847e57ae6ed6357d8f61"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#a278b82fa945d847e57ae6ed6357d8f61">AcceptanceProbabilities</a> ()</td></tr>
<tr class="memdesc:a278b82fa945d847e57ae6ed6357d8f61"><td class="mdescLeft">&#160;</td><td class="mdescRight">Acceptance Probability.  <br /></td></tr>
<tr class="separator:a278b82fa945d847e57ae6ed6357d8f61"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aef760d8c4bb70690a5c4114f4b2409b3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#aef760d8c4bb70690a5c4114f4b2409b3">PowerSpectrumAnalysis</a> ()</td></tr>
<tr class="memdesc:aef760d8c4bb70690a5c4114f4b2409b3"><td class="mdescLeft">&#160;</td><td class="mdescRight">RC: Perform spectral analysis of MCMC <a class="el" href="citelist.html#CITEREF_Dunkley:2004sv">[5]</a>.  <br /></td></tr>
<tr class="separator:aef760d8c4bb70690a5c4114f4b2409b3"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pri-attribs" name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:a6d212d77a818304a8674a7b9b18d43b8"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#a6d212d77a818304a8674a7b9b18d43b8">MCMCFile</a></td></tr>
<tr class="memdesc:a6d212d77a818304a8674a7b9b18d43b8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Name of MCMC file.  <br /></td></tr>
<tr class="separator:a6d212d77a818304a8674a7b9b18d43b8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa34b50ce33fb2cb7d9e9ef2d9f2f67c1"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#aa34b50ce33fb2cb7d9e9ef2d9f2f67c1">OutputSuffix</a></td></tr>
<tr class="memdesc:aa34b50ce33fb2cb7d9e9ef2d9f2f67c1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Output file suffix useful when running over same file with different settings.  <br /></td></tr>
<tr class="separator:aa34b50ce33fb2cb7d9e9ef2d9f2f67c1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7c6afb0ed75207fd02c28e408f0592d4"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::vector&lt; std::string &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#a7c6afb0ed75207fd02c28e408f0592d4">CovPos</a></td></tr>
<tr class="memdesc:a7c6afb0ed75207fd02c28e408f0592d4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Covariance matrix name position.  <br /></td></tr>
<tr class="separator:a7c6afb0ed75207fd02c28e408f0592d4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4c1330a025c0b91e382bdc29c960424a"><td class="memItemLeft" align="right" valign="top">std::vector&lt; YAML::Node &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#a4c1330a025c0b91e382bdc29c960424a">CovConfig</a></td></tr>
<tr class="memdesc:a4c1330a025c0b91e382bdc29c960424a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Covariance matrix config.  <br /></td></tr>
<tr class="separator:a4c1330a025c0b91e382bdc29c960424a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6be3bbebd4a79fe9814a3da09b3bb820"><td class="memItemLeft" align="right" valign="top">TChain *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#a6be3bbebd4a79fe9814a3da09b3bb820">Chain</a></td></tr>
<tr class="memdesc:a6be3bbebd4a79fe9814a3da09b3bb820"><td class="mdescLeft">&#160;</td><td class="mdescRight">Main chain storing all steps etc.  <br /></td></tr>
<tr class="separator:a6be3bbebd4a79fe9814a3da09b3bb820"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a576f0eb874afaf7e31ff5c86b9e5b8f9"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#a576f0eb874afaf7e31ff5c86b9e5b8f9">StepCut</a></td></tr>
<tr class="memdesc:a576f0eb874afaf7e31ff5c86b9e5b8f9"><td class="mdescLeft">&#160;</td><td class="mdescRight">BurnIn Cuts.  <br /></td></tr>
<tr class="separator:a576f0eb874afaf7e31ff5c86b9e5b8f9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a85917e25c4f5b5b966c50cccd9ddd6a0"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#a85917e25c4f5b5b966c50cccd9ddd6a0">Posterior1DCut</a></td></tr>
<tr class="memdesc:a85917e25c4f5b5b966c50cccd9ddd6a0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Cut used when making 1D Posterior distribution.  <br /></td></tr>
<tr class="separator:a85917e25c4f5b5b966c50cccd9ddd6a0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a840c686f15f419c0156df01c4ed62931"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#a840c686f15f419c0156df01c4ed62931">UpperCut</a></td></tr>
<tr class="memdesc:a840c686f15f419c0156df01c4ed62931"><td class="mdescLeft">&#160;</td><td class="mdescRight">KS: Used only for SubOptimality.  <br /></td></tr>
<tr class="separator:a840c686f15f419c0156df01c4ed62931"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a22f82dadceccbe87dd8c5b7daa8432e8"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#a22f82dadceccbe87dd8c5b7daa8432e8">BurnInCut</a></td></tr>
<tr class="memdesc:a22f82dadceccbe87dd8c5b7daa8432e8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Value of burn in cut.  <br /></td></tr>
<tr class="separator:a22f82dadceccbe87dd8c5b7daa8432e8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af6ba5d9aec5350fafebbf81309e813cb"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#af6ba5d9aec5350fafebbf81309e813cb">nBranches</a></td></tr>
<tr class="memdesc:af6ba5d9aec5350fafebbf81309e813cb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Number of branches in a TTree.  <br /></td></tr>
<tr class="separator:af6ba5d9aec5350fafebbf81309e813cb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af3a19b885e9c34e1674aea8cfbe14e1c"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#af3a19b885e9c34e1674aea8cfbe14e1c">nEntries</a></td></tr>
<tr class="memdesc:af3a19b885e9c34e1674aea8cfbe14e1c"><td class="mdescLeft">&#160;</td><td class="mdescRight">KS: For merged chains number of entries will be different from nSteps.  <br /></td></tr>
<tr class="separator:af3a19b885e9c34e1674aea8cfbe14e1c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aae0016a4e1d105d5d65243438c622a97"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#aae0016a4e1d105d5d65243438c622a97">nSteps</a></td></tr>
<tr class="memdesc:aae0016a4e1d105d5d65243438c622a97"><td class="mdescLeft">&#160;</td><td class="mdescRight">KS: For merged chains number of entries will be different from nSteps.  <br /></td></tr>
<tr class="separator:aae0016a4e1d105d5d65243438c622a97"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a419d3669dbb54a55a635e35691134cc1"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#a419d3669dbb54a55a635e35691134cc1">nSamples</a></td></tr>
<tr class="memdesc:a419d3669dbb54a55a635e35691134cc1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Number of sample PDF objects.  <br /></td></tr>
<tr class="separator:a419d3669dbb54a55a635e35691134cc1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adf518be96278f1d3901404cfbe767b67"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#adf518be96278f1d3901404cfbe767b67">nSysts</a></td></tr>
<tr class="memdesc:adf518be96278f1d3901404cfbe767b67"><td class="mdescLeft">&#160;</td><td class="mdescRight">Number of covariance objects.  <br /></td></tr>
<tr class="separator:adf518be96278f1d3901404cfbe767b67"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa30545fedb0af2ad9619d6accf42a10d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a></td></tr>
<tr class="memdesc:aa30545fedb0af2ad9619d6accf42a10d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Number of all parameters used in the analysis.  <br /></td></tr>
<tr class="separator:aa30545fedb0af2ad9619d6accf42a10d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad043b6b2c885f47ab9967831bc8d0f5a"><td class="memItemLeft" align="right" valign="top">std::vector&lt; TString &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#ad043b6b2c885f47ab9967831bc8d0f5a">BranchNames</a></td></tr>
<tr class="separator:ad043b6b2c885f47ab9967831bc8d0f5a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aada4aadea10661586b46c1013a9d018f"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::string &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#aada4aadea10661586b46c1013a9d018f">ExcludedTypes</a></td></tr>
<tr class="separator:aada4aadea10661586b46c1013a9d018f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7425f7802e50bcb5ff4b38e20157c423"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::string &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#a7425f7802e50bcb5ff4b38e20157c423">ExcludedNames</a></td></tr>
<tr class="separator:a7425f7802e50bcb5ff4b38e20157c423"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a95fa49737432818bc830a44898d0d850"><td class="memItemLeft" align="right" valign="top">std::vector&lt; bool &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#a95fa49737432818bc830a44898d0d850">IamVaried</a></td></tr>
<tr class="memdesc:a95fa49737432818bc830a44898d0d850"><td class="mdescLeft">&#160;</td><td class="mdescRight">Is the ith parameter varied.  <br /></td></tr>
<tr class="separator:a95fa49737432818bc830a44898d0d850"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adecc55689f7d37b9412f8886fe3480dc"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::vector&lt; TString &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#adecc55689f7d37b9412f8886fe3480dc">ParamNames</a></td></tr>
<tr class="memdesc:adecc55689f7d37b9412f8886fe3480dc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Name of parameters which we are going to analyse.  <br /></td></tr>
<tr class="separator:adecc55689f7d37b9412f8886fe3480dc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3a6614826ae320e462211e38e96d9d02"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::vector&lt; double &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#a3a6614826ae320e462211e38e96d9d02">ParamCentral</a></td></tr>
<tr class="memdesc:a3a6614826ae320e462211e38e96d9d02"><td class="mdescLeft">&#160;</td><td class="mdescRight">Parameters central values which we are going to analyse.  <br /></td></tr>
<tr class="separator:a3a6614826ae320e462211e38e96d9d02"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4c4c6aa4827a2fe54ce37defbb3d0475"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::vector&lt; double &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#a4c4c6aa4827a2fe54ce37defbb3d0475">ParamNom</a></td></tr>
<tr class="separator:a4c4c6aa4827a2fe54ce37defbb3d0475"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3a97e3cb4be3ceb9eb721eac51d82d60"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::vector&lt; double &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#a3a97e3cb4be3ceb9eb721eac51d82d60">ParamErrors</a></td></tr>
<tr class="separator:a3a97e3cb4be3ceb9eb721eac51d82d60"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4be1eedb743e4ea410009a4fa45720f7"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::vector&lt; bool &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#a4be1eedb743e4ea410009a4fa45720f7">ParamFlat</a></td></tr>
<tr class="separator:a4be1eedb743e4ea410009a4fa45720f7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4200e7cbe1c8f811d3640ebfd648ca85"><td class="memItemLeft" align="right" valign="top">std::vector&lt; int &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#a4200e7cbe1c8f811d3640ebfd648ca85">nParam</a></td></tr>
<tr class="memdesc:a4200e7cbe1c8f811d3640ebfd648ca85"><td class="mdescLeft">&#160;</td><td class="mdescRight">Number of parameters per type.  <br /></td></tr>
<tr class="separator:a4200e7cbe1c8f811d3640ebfd648ca85"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaa903949bde8f1a69800c71fe1eb538e"><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20b">ParameterEnum</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#aaa903949bde8f1a69800c71fe1eb538e">ParamType</a></td></tr>
<tr class="memdesc:aaa903949bde8f1a69800c71fe1eb538e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Make an enum for which class this parameter belongs to so we don't have to keep string comparing.  <br /></td></tr>
<tr class="separator:aaa903949bde8f1a69800c71fe1eb538e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeab63979ff36256072c046a15d981875"><td class="memItemLeft" align="right" valign="top">std::vector&lt; int &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#aeab63979ff36256072c046a15d981875">ParamTypeStartPos</a></td></tr>
<tr class="separator:aeab63979ff36256072c046a15d981875"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2c06d64020e9246e720cc131a9f4986d"><td class="memItemLeft" align="right" valign="top">std::vector&lt; bool &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#a2c06d64020e9246e720cc131a9f4986d">IsXsec</a></td></tr>
<tr class="separator:a2c06d64020e9246e720cc131a9f4986d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acfc681553c5fbba89e133dfda605db3c"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#acfc681553c5fbba89e133dfda605db3c">nFlux</a></td></tr>
<tr class="separator:acfc681553c5fbba89e133dfda605db3c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3660e404a6631cfa913a815481730a9b"><td class="memItemLeft" align="right" valign="top">std::vector&lt; TString &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#a3660e404a6631cfa913a815481730a9b">SampleName_v</a></td></tr>
<tr class="memdesc:a3660e404a6631cfa913a815481730a9b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Vector of each systematic.  <br /></td></tr>
<tr class="separator:a3660e404a6631cfa913a815481730a9b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acb1871575fdd3ae156aed4bf7c7a0a73"><td class="memItemLeft" align="right" valign="top">std::vector&lt; TString &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#acb1871575fdd3ae156aed4bf7c7a0a73">SystName_v</a></td></tr>
<tr class="memdesc:acb1871575fdd3ae156aed4bf7c7a0a73"><td class="mdescLeft">&#160;</td><td class="mdescRight">Vector of each sample PDF object.  <br /></td></tr>
<tr class="separator:acb1871575fdd3ae156aed4bf7c7a0a73"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3d17c1720b91d6d0361da0b5dabfbbff"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#a3d17c1720b91d6d0361da0b5dabfbbff">OutputName</a></td></tr>
<tr class="memdesc:a3d17c1720b91d6d0361da0b5dabfbbff"><td class="mdescLeft">&#160;</td><td class="mdescRight">Name of output files.  <br /></td></tr>
<tr class="separator:a3d17c1720b91d6d0361da0b5dabfbbff"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab5aec3dc293919701d31e6ae705601dd"><td class="memItemLeft" align="right" valign="top">TString&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#ab5aec3dc293919701d31e6ae705601dd">CanvasName</a></td></tr>
<tr class="memdesc:ab5aec3dc293919701d31e6ae705601dd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Name of canvas which help to save to the sample pdf.  <br /></td></tr>
<tr class="separator:ab5aec3dc293919701d31e6ae705601dd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad24411a2556504c440ff0af045e8e7aa"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#ad24411a2556504c440ff0af045e8e7aa">PlotFlatPrior</a></td></tr>
<tr class="memdesc:ad24411a2556504c440ff0af045e8e7aa"><td class="mdescLeft">&#160;</td><td class="mdescRight">Whether we plot flat prior or not, we usually provide error even for flat prior params.  <br /></td></tr>
<tr class="separator:ad24411a2556504c440ff0af045e8e7aa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af1392c6cff68e9f0a27e2c9a4e52cf4c"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#af1392c6cff68e9f0a27e2c9a4e52cf4c">PlotJarlskog</a></td></tr>
<tr class="memdesc:af1392c6cff68e9f0a27e2c9a4e52cf4c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Will plot Jarlskog Invariant using information in the chain.  <br /></td></tr>
<tr class="separator:af1392c6cff68e9f0a27e2c9a4e52cf4c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afbac2a114c15ca7db4abe71dd549504c"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#afbac2a114c15ca7db4abe71dd549504c">plotRelativeToPrior</a></td></tr>
<tr class="memdesc:afbac2a114c15ca7db4abe71dd549504c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Whether we plot relative to prior or nominal, in most cases is prior.  <br /></td></tr>
<tr class="separator:afbac2a114c15ca7db4abe71dd549504c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aecc35d4ea7d2c7e020e50388ba0ffb64"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#aecc35d4ea7d2c7e020e50388ba0ffb64">MadePostfit</a></td></tr>
<tr class="memdesc:aecc35d4ea7d2c7e020e50388ba0ffb64"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sanity check if Postfit is already done to not make several times.  <br /></td></tr>
<tr class="separator:aecc35d4ea7d2c7e020e50388ba0ffb64"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad73755714ae3d6dc951158d5513c6eee"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#ad73755714ae3d6dc951158d5513c6eee">printToPDF</a></td></tr>
<tr class="memdesc:ad73755714ae3d6dc951158d5513c6eee"><td class="mdescLeft">&#160;</td><td class="mdescRight">Will plot all plot to PDF not only to root file.  <br /></td></tr>
<tr class="separator:ad73755714ae3d6dc951158d5513c6eee"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad25fe818c94163b0c4a8fcdfd387c148"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#ad25fe818c94163b0c4a8fcdfd387c148">FancyPlotNames</a></td></tr>
<tr class="memdesc:ad25fe818c94163b0c4a8fcdfd387c148"><td class="mdescLeft">&#160;</td><td class="mdescRight">Whether we want fancy plot names or not.  <br /></td></tr>
<tr class="separator:ad25fe818c94163b0c4a8fcdfd387c148"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa7611f55ac3c0ea70607761d037fbd91"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#aa7611f55ac3c0ea70607761d037fbd91">plotBinValue</a></td></tr>
<tr class="memdesc:aa7611f55ac3c0ea70607761d037fbd91"><td class="mdescLeft">&#160;</td><td class="mdescRight">If true it will print value on each bin of covariance matrix.  <br /></td></tr>
<tr class="separator:aa7611f55ac3c0ea70607761d037fbd91"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a682c1c47626542f5820d633ba2bc010c"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#a682c1c47626542f5820d633ba2bc010c">ApplySmoothing</a></td></tr>
<tr class="memdesc:a682c1c47626542f5820d633ba2bc010c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Apply smoothing for 2D histos using root algorithm.  <br /></td></tr>
<tr class="separator:a682c1c47626542f5820d633ba2bc010c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a25e4685b6299181021b02ac0e0b74681"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#a25e4685b6299181021b02ac0e0b74681">Post2DPlotThreshold</a></td></tr>
<tr class="memdesc:a25e4685b6299181021b02ac0e0b74681"><td class="mdescLeft">&#160;</td><td class="mdescRight">KS: Set Threshold when to plot 2D posterior as by default we get a LOT of plots.  <br /></td></tr>
<tr class="separator:a25e4685b6299181021b02ac0e0b74681"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a562261269f0f4ec4a209b2fca64ff443"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#a562261269f0f4ec4a209b2fca64ff443">useFFTAutoCorrelation</a></td></tr>
<tr class="memdesc:a562261269f0f4ec4a209b2fca64ff443"><td class="mdescLeft">&#160;</td><td class="mdescRight">MJR: Use FFT-based autocorrelation algorithm (save time &amp; resources)?  <br /></td></tr>
<tr class="separator:a562261269f0f4ec4a209b2fca64ff443"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae76b02ce85737d30c778698ba127933b"><td class="memItemLeft" align="right" valign="top">std::vector&lt; int &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#ae76b02ce85737d30c778698ba127933b">NDSamplesBins</a></td></tr>
<tr class="separator:ae76b02ce85737d30c778698ba127933b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a27c8a25155baab660fc9658861c433ab"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::string &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#a27c8a25155baab660fc9658861c433ab">NDSamplesNames</a></td></tr>
<tr class="separator:a27c8a25155baab660fc9658861c433ab"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a92c1d9b0ebdf90951221cdaf2ac4cc2c"><td class="memItemLeft" align="right" valign="top">TF1 *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#a92c1d9b0ebdf90951221cdaf2ac4cc2c">Gauss</a></td></tr>
<tr class="memdesc:a92c1d9b0ebdf90951221cdaf2ac4cc2c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gaussian fitter.  <br /></td></tr>
<tr class="separator:a92c1d9b0ebdf90951221cdaf2ac4cc2c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a62035b99df4617ab334cd1abd6ed0346"><td class="memItemLeft" align="right" valign="top">TFile *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#a62035b99df4617ab334cd1abd6ed0346">OutputFile</a></td></tr>
<tr class="memdesc:a62035b99df4617ab334cd1abd6ed0346"><td class="mdescLeft">&#160;</td><td class="mdescRight">The output file.  <br /></td></tr>
<tr class="separator:a62035b99df4617ab334cd1abd6ed0346"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a82e6cfef1ba6fcfc8ac8f61acb5bf931"><td class="memItemLeft" align="right" valign="top">TCanvas *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#a82e6cfef1ba6fcfc8ac8f61acb5bf931">Posterior</a></td></tr>
<tr class="memdesc:a82e6cfef1ba6fcfc8ac8f61acb5bf931"><td class="mdescLeft">&#160;</td><td class="mdescRight">Fancy canvas used for our beautiful plots.  <br /></td></tr>
<tr class="separator:a82e6cfef1ba6fcfc8ac8f61acb5bf931"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aad661c6d53f9f891e18ff8ccdbd08479"><td class="memItemLeft" align="right" valign="top">TVectorD *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#aad661c6d53f9f891e18ff8ccdbd08479">Central_Value</a></td></tr>
<tr class="memdesc:aad661c6d53f9f891e18ff8ccdbd08479"><td class="mdescLeft">&#160;</td><td class="mdescRight">Vector with central value for each parameter.  <br /></td></tr>
<tr class="separator:aad661c6d53f9f891e18ff8ccdbd08479"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acaf7f239136dfa3506d095b612323d0a"><td class="memItemLeft" align="right" valign="top">TVectorD *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#acaf7f239136dfa3506d095b612323d0a">Means</a></td></tr>
<tr class="memdesc:acaf7f239136dfa3506d095b612323d0a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Vector with mean values using Arithmetic Mean.  <br /></td></tr>
<tr class="separator:acaf7f239136dfa3506d095b612323d0a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5174aaa900edf16ddc6e841ea4adae83"><td class="memItemLeft" align="right" valign="top">TVectorD *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#a5174aaa900edf16ddc6e841ea4adae83">Errors</a></td></tr>
<tr class="memdesc:a5174aaa900edf16ddc6e841ea4adae83"><td class="mdescLeft">&#160;</td><td class="mdescRight">Vector with errors values using RMS.  <br /></td></tr>
<tr class="separator:a5174aaa900edf16ddc6e841ea4adae83"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a600fc8c39af2750df91fb7a0ff85ac74"><td class="memItemLeft" align="right" valign="top">TVectorD *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#a600fc8c39af2750df91fb7a0ff85ac74">Means_Gauss</a></td></tr>
<tr class="memdesc:a600fc8c39af2750df91fb7a0ff85ac74"><td class="mdescLeft">&#160;</td><td class="mdescRight">Vector with mean values using Gaussian fit.  <br /></td></tr>
<tr class="separator:a600fc8c39af2750df91fb7a0ff85ac74"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa78b7ed1bb9966f84f4eaf8cedf5e688"><td class="memItemLeft" align="right" valign="top">TVectorD *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#aa78b7ed1bb9966f84f4eaf8cedf5e688">Errors_Gauss</a></td></tr>
<tr class="memdesc:aa78b7ed1bb9966f84f4eaf8cedf5e688"><td class="mdescLeft">&#160;</td><td class="mdescRight">Vector with error values using Gaussian fit.  <br /></td></tr>
<tr class="separator:aa78b7ed1bb9966f84f4eaf8cedf5e688"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a32657dc39a7fc0d04804f6195a3d8c3e"><td class="memItemLeft" align="right" valign="top">TVectorD *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#a32657dc39a7fc0d04804f6195a3d8c3e">Means_HPD</a></td></tr>
<tr class="memdesc:a32657dc39a7fc0d04804f6195a3d8c3e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Vector with mean values using Highest Posterior Density.  <br /></td></tr>
<tr class="separator:a32657dc39a7fc0d04804f6195a3d8c3e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abb5c6ad85c89227bbb9bc5de2eb71272"><td class="memItemLeft" align="right" valign="top">TVectorD *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#abb5c6ad85c89227bbb9bc5de2eb71272">Errors_HPD</a></td></tr>
<tr class="memdesc:abb5c6ad85c89227bbb9bc5de2eb71272"><td class="mdescLeft">&#160;</td><td class="mdescRight">Vector with error values using Highest Posterior Density.  <br /></td></tr>
<tr class="separator:abb5c6ad85c89227bbb9bc5de2eb71272"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af96664fa8cc51c49ad1385da07a343b8"><td class="memItemLeft" align="right" valign="top">TVectorD *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#af96664fa8cc51c49ad1385da07a343b8">Errors_HPD_Positive</a></td></tr>
<tr class="memdesc:af96664fa8cc51c49ad1385da07a343b8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Vector with positive error (right hand side) values using Highest Posterior Density.  <br /></td></tr>
<tr class="separator:af96664fa8cc51c49ad1385da07a343b8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7b85df39f22390dac24f4d66a89518e5"><td class="memItemLeft" align="right" valign="top">TVectorD *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#a7b85df39f22390dac24f4d66a89518e5">Errors_HPD_Negative</a></td></tr>
<tr class="memdesc:a7b85df39f22390dac24f4d66a89518e5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Vector with negative error (left hand side) values using Highest Posterior Density.  <br /></td></tr>
<tr class="separator:a7b85df39f22390dac24f4d66a89518e5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af9a40632e2d7f1266d69a74d5b5f2244"><td class="memItemLeft" align="right" valign="top">TMatrixDSym *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#af9a40632e2d7f1266d69a74d5b5f2244">Covariance</a></td></tr>
<tr class="memdesc:af9a40632e2d7f1266d69a74d5b5f2244"><td class="mdescLeft">&#160;</td><td class="mdescRight">Posterior Covariance Matrix.  <br /></td></tr>
<tr class="separator:af9a40632e2d7f1266d69a74d5b5f2244"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a03f28431158777cdd81d058b6632a92f"><td class="memItemLeft" align="right" valign="top">TMatrixDSym *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#a03f28431158777cdd81d058b6632a92f">Correlation</a></td></tr>
<tr class="memdesc:a03f28431158777cdd81d058b6632a92f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Posterior Correlation Matrix.  <br /></td></tr>
<tr class="separator:a03f28431158777cdd81d058b6632a92f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a795f661ed1ba8b8ae54c41fde5fb9496"><td class="memItemLeft" align="right" valign="top">std::vector&lt; TH1D * &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#a795f661ed1ba8b8ae54c41fde5fb9496">hpost</a></td></tr>
<tr class="memdesc:a795f661ed1ba8b8ae54c41fde5fb9496"><td class="mdescLeft">&#160;</td><td class="mdescRight">Holds 1D Posterior Distributions.  <br /></td></tr>
<tr class="separator:a795f661ed1ba8b8ae54c41fde5fb9496"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0ddcfa4ba1e4dcdea366d88decc64391"><td class="memItemLeft" align="right" valign="top">TH2D ***&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#a0ddcfa4ba1e4dcdea366d88decc64391">hpost2D</a></td></tr>
<tr class="memdesc:a0ddcfa4ba1e4dcdea366d88decc64391"><td class="mdescLeft">&#160;</td><td class="mdescRight">Holds 2D Posterior Distributions.  <br /></td></tr>
<tr class="separator:a0ddcfa4ba1e4dcdea366d88decc64391"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a556988f03b24e3af33e9a29b23d2b1e2"><td class="memItemLeft" align="right" valign="top">TH2D *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#a556988f03b24e3af33e9a29b23d2b1e2">hviolin</a></td></tr>
<tr class="memdesc:a556988f03b24e3af33e9a29b23d2b1e2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Holds violin plot for all dials.  <br /></td></tr>
<tr class="separator:a556988f03b24e3af33e9a29b23d2b1e2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a25d79f451d5d584c3e7ef0e1423e5e8e"><td class="memItemLeft" align="right" valign="top">TH2D *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#a25d79f451d5d584c3e7ef0e1423e5e8e">hviolin_prior</a></td></tr>
<tr class="memdesc:a25d79f451d5d584c3e7ef0e1423e5e8e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Holds prior violin plot for all dials,.  <br /></td></tr>
<tr class="separator:a25d79f451d5d584c3e7ef0e1423e5e8e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a087dca88a306acdc28afea7213e3623c"><td class="memItemLeft" align="right" valign="top">double **&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#a087dca88a306acdc28afea7213e3623c">ParStep</a></td></tr>
<tr class="memdesc:a087dca88a306acdc28afea7213e3623c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Array holding values for all parameters.  <br /></td></tr>
<tr class="separator:a087dca88a306acdc28afea7213e3623c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a07549f3b67ca5409218d80c679f6e69e"><td class="memItemLeft" align="right" valign="top">int *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#a07549f3b67ca5409218d80c679f6e69e">StepNumber</a></td></tr>
<tr class="memdesc:a07549f3b67ca5409218d80c679f6e69e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Step number for step, important if chains were merged.  <br /></td></tr>
<tr class="separator:a07549f3b67ca5409218d80c679f6e69e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6b74f8195bcbca0979f9e9fe43468bae"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#a6b74f8195bcbca0979f9e9fe43468bae">nBins</a></td></tr>
<tr class="memdesc:a6b74f8195bcbca0979f9e9fe43468bae"><td class="mdescLeft">&#160;</td><td class="mdescRight">Number of bins.  <br /></td></tr>
<tr class="separator:a6b74f8195bcbca0979f9e9fe43468bae"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4abe633b264acd9b0459c7b8ccd8b9df"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#a4abe633b264acd9b0459c7b8ccd8b9df">DrawRange</a></td></tr>
<tr class="memdesc:a4abe633b264acd9b0459c7b8ccd8b9df"><td class="mdescLeft">&#160;</td><td class="mdescRight">Drawrange for SetMaximum.  <br /></td></tr>
<tr class="separator:a4abe633b264acd9b0459c7b8ccd8b9df"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aea84f0315695aa05ec41fcf965b1b031"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#aea84f0315695aa05ec41fcf965b1b031">CacheMCMC</a></td></tr>
<tr class="memdesc:aea84f0315695aa05ec41fcf965b1b031"><td class="mdescLeft">&#160;</td><td class="mdescRight">MCMC Chain has been cached.  <br /></td></tr>
<tr class="separator:aea84f0315695aa05ec41fcf965b1b031"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adf449e50cf358f737fe4a2b65d9668e9"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#adf449e50cf358f737fe4a2b65d9668e9">doDiagMCMC</a></td></tr>
<tr class="memdesc:adf449e50cf358f737fe4a2b65d9668e9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Doing MCMC Diagnostic.  <br /></td></tr>
<tr class="separator:adf449e50cf358f737fe4a2b65d9668e9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a02c5a3f849cf217705816c650c678d19"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#a02c5a3f849cf217705816c650c678d19">nBatches</a></td></tr>
<tr class="memdesc:a02c5a3f849cf217705816c650c678d19"><td class="mdescLeft">&#160;</td><td class="mdescRight">Number of batches for Batched Mean.  <br /></td></tr>
<tr class="separator:a02c5a3f849cf217705816c650c678d19"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6156bba72e1f076e66f0356e48506a36"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#a6156bba72e1f076e66f0356e48506a36">AutoCorrLag</a></td></tr>
<tr class="memdesc:a6156bba72e1f076e66f0356e48506a36"><td class="mdescLeft">&#160;</td><td class="mdescRight">LagL used in AutoCorrelation.  <br /></td></tr>
<tr class="separator:a6156bba72e1f076e66f0356e48506a36"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7db98c7cf390b050f1acb927b4f55cab"><td class="memItemLeft" align="right" valign="top">double *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#a7db98c7cf390b050f1acb927b4f55cab">ParamSums</a></td></tr>
<tr class="memdesc:a7db98c7cf390b050f1acb927b4f55cab"><td class="mdescLeft">&#160;</td><td class="mdescRight">Total parameter sum for each param.  <br /></td></tr>
<tr class="separator:a7db98c7cf390b050f1acb927b4f55cab"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab3f590b501162fc2ee5b78ce75689771"><td class="memItemLeft" align="right" valign="top">double **&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#ab3f590b501162fc2ee5b78ce75689771">BatchedAverages</a></td></tr>
<tr class="memdesc:ab3f590b501162fc2ee5b78ce75689771"><td class="mdescLeft">&#160;</td><td class="mdescRight">Values of batched average for every param and batch.  <br /></td></tr>
<tr class="separator:ab3f590b501162fc2ee5b78ce75689771"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a28e89498420221149ec97c353c430bf8"><td class="memItemLeft" align="right" valign="top">double **&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#a28e89498420221149ec97c353c430bf8">SampleValues</a></td></tr>
<tr class="memdesc:a28e89498420221149ec97c353c430bf8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Holds the sample values.  <br /></td></tr>
<tr class="separator:a28e89498420221149ec97c353c430bf8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4eb2748c81b0aef9bd7e14785559e301"><td class="memItemLeft" align="right" valign="top">double **&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#a4eb2748c81b0aef9bd7e14785559e301">SystValues</a></td></tr>
<tr class="memdesc:a4eb2748c81b0aef9bd7e14785559e301"><td class="mdescLeft">&#160;</td><td class="mdescRight">Holds the systs values.  <br /></td></tr>
<tr class="separator:a4eb2748c81b0aef9bd7e14785559e301"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a88cab29770fd6098a674a0ab3628a251"><td class="memItemLeft" align="right" valign="top">double *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#a88cab29770fd6098a674a0ab3628a251">AccProbValues</a></td></tr>
<tr class="memdesc:a88cab29770fd6098a674a0ab3628a251"><td class="mdescLeft">&#160;</td><td class="mdescRight">Holds all accProb.  <br /></td></tr>
<tr class="separator:a88cab29770fd6098a674a0ab3628a251"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a523a223a4754c133121796f4591c7be3"><td class="memItemLeft" align="right" valign="top">double *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMCMCProcessor.html#a523a223a4754c133121796f4591c7be3">AccProbBatchedAverages</a></td></tr>
<tr class="memdesc:a523a223a4754c133121796f4591c7be3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Holds all accProb in batches.  <br /></td></tr>
<tr class="separator:a523a223a4754c133121796f4591c7be3"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Class responsible for processing MCMC chains, performing diagnostics, generating plots, and managing Bayesian analysis. </p>
<p>This class provides utilities to handle MCMC output generated by <a class="el" href="classmcmc.html#a8a9cc0e0aa65c8573fca703a42b2ee31" title="Actual implementation of MCMC fitting algorithm.">mcmc::runMCMC</a>. It is particularly useful for extracting values from previous MCMC runs and initiating new MCMC runs with those values. Inspired by nd280_utils/DrawComp.cpp. </p><dl class="section see"><dt>See also</dt><dd>For more details and examples, visit the <a href="https://github.com/mach3-software/MaCh3/wiki/09.-Bayesian-Analysis,-Plotting-and-MCMC-Processor">Wiki</a>. </dd></dl>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00063">63</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="afb50150dcb6d1d75f3c08b5ee8d3d77c" name="afb50150dcb6d1d75f3c08b5ee8d3d77c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afb50150dcb6d1d75f3c08b5ee8d3d77c">&#9670;&#160;</a></span>MCMCProcessor()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">MCMCProcessor::MCMCProcessor </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>InputFile</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Constructs an <a class="el" href="classMCMCProcessor.html" title="Class responsible for processing MCMC chains, performing diagnostics, generating plots,...">MCMCProcessor</a> object with the specified input file and options. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">InputFile</td><td>The path to the input file containing MCMC data. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8cpp_source.html#l00015">15</a> of file <a class="el" href="MCMCProcessor_8cpp_source.html">MCMCProcessor.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   15</span>                                                       :</div>
<div class="line"><span class="lineno">   16</span>  <a class="code hl_variable" href="classMCMCProcessor.html#a6be3bbebd4a79fe9814a3da09b3bb820">Chain</a>(<span class="keyword">nullptr</span>), <a class="code hl_variable" href="classMCMCProcessor.html#a576f0eb874afaf7e31ff5c86b9e5b8f9">StepCut</a>(<span class="stringliteral">&quot;&quot;</span>), <a class="code hl_variable" href="classMCMCProcessor.html#aecc35d4ea7d2c7e020e50388ba0ffb64">MadePostfit</a>(<span class="keyword">false</span>) {</div>
<div class="line"><span class="lineno">   17</span><span class="comment">// ****************************</span></div>
<div class="line"><span class="lineno">   18</span>  <a class="code hl_variable" href="classMCMCProcessor.html#a6d212d77a818304a8674a7b9b18d43b8">MCMCFile</a> = InputFile;</div>
<div class="line"><span class="lineno">   19</span> </div>
<div class="line"><span class="lineno">   20</span>  <a class="code hl_function" href="MaCh3Logger_8h.html#aa603c55ea73cd86d1994901227883e1e">SetMaCh3LoggerFormat</a>();</div>
<div class="line"><span class="lineno">   21</span>  <a class="code hl_function" href="namespaceMaCh3Utils.html#ac6f4a3b6a7749967ff9a011469352f6c">MaCh3Utils::MaCh3Welcome</a>();</div>
<div class="line"><span class="lineno">   22</span>  <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Making post-fit processor for: {}&quot;</span>, <a class="code hl_variable" href="classMCMCProcessor.html#a6d212d77a818304a8674a7b9b18d43b8">MCMCFile</a>);</div>
<div class="line"><span class="lineno">   23</span> </div>
<div class="line"><span class="lineno">   24</span>  <a class="code hl_variable" href="classMCMCProcessor.html#a087dca88a306acdc28afea7213e3623c">ParStep</a> = <span class="keyword">nullptr</span>;</div>
<div class="line"><span class="lineno">   25</span>  <a class="code hl_variable" href="classMCMCProcessor.html#a07549f3b67ca5409218d80c679f6e69e">StepNumber</a> = <span class="keyword">nullptr</span>;</div>
<div class="line"><span class="lineno">   26</span>    </div>
<div class="line"><span class="lineno">   27</span>  <a class="code hl_variable" href="classMCMCProcessor.html#a82e6cfef1ba6fcfc8ac8f61acb5bf931">Posterior</a> = <span class="keyword">nullptr</span>;</div>
<div class="line"><span class="lineno">   28</span>  <a class="code hl_variable" href="classMCMCProcessor.html#a0ddcfa4ba1e4dcdea366d88decc64391">hpost2D</a> = <span class="keyword">nullptr</span>;</div>
<div class="line"><span class="lineno">   29</span>  <a class="code hl_variable" href="classMCMCProcessor.html#a556988f03b24e3af33e9a29b23d2b1e2">hviolin</a> = <span class="keyword">nullptr</span>;</div>
<div class="line"><span class="lineno">   30</span>  <a class="code hl_variable" href="classMCMCProcessor.html#a25d79f451d5d584c3e7ef0e1423e5e8e">hviolin_prior</a> = <span class="keyword">nullptr</span>;</div>
<div class="line"><span class="lineno">   31</span> </div>
<div class="line"><span class="lineno">   32</span>  <a class="code hl_variable" href="classMCMCProcessor.html#a62035b99df4617ab334cd1abd6ed0346">OutputFile</a> = <span class="keyword">nullptr</span>;</div>
<div class="line"><span class="lineno">   33</span>  </div>
<div class="line"><span class="lineno">   34</span>  <a class="code hl_variable" href="classMCMCProcessor.html#a7db98c7cf390b050f1acb927b4f55cab">ParamSums</a> = <span class="keyword">nullptr</span>;</div>
<div class="line"><span class="lineno">   35</span>  <a class="code hl_variable" href="classMCMCProcessor.html#ab3f590b501162fc2ee5b78ce75689771">BatchedAverages</a> = <span class="keyword">nullptr</span>;</div>
<div class="line"><span class="lineno">   36</span>  <a class="code hl_variable" href="classMCMCProcessor.html#a28e89498420221149ec97c353c430bf8">SampleValues</a> = <span class="keyword">nullptr</span>;</div>
<div class="line"><span class="lineno">   37</span>  <a class="code hl_variable" href="classMCMCProcessor.html#a4eb2748c81b0aef9bd7e14785559e301">SystValues</a> = <span class="keyword">nullptr</span>;</div>
<div class="line"><span class="lineno">   38</span>  <a class="code hl_variable" href="classMCMCProcessor.html#a88cab29770fd6098a674a0ab3628a251">AccProbValues</a> = <span class="keyword">nullptr</span>;</div>
<div class="line"><span class="lineno">   39</span>  <a class="code hl_variable" href="classMCMCProcessor.html#a523a223a4754c133121796f4591c7be3">AccProbBatchedAverages</a> = <span class="keyword">nullptr</span>;</div>
<div class="line"><span class="lineno">   40</span>    </div>
<div class="line"><span class="lineno">   41</span>  <span class="comment">//KS: WARNING this only work when you project from Chain, will nor work when you try SetBranchAddress etc. Turn it on only if you know how to use it</span></div>
<div class="line"><span class="lineno">   42</span>  <a class="code hl_variable" href="classMCMCProcessor.html#af1392c6cff68e9f0a27e2c9a4e52cf4c">PlotJarlskog</a> = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">   43</span>  </div>
<div class="line"><span class="lineno">   44</span>  <span class="comment">//KS:Hardcoded should be a way to get it via config or something</span></div>
<div class="line"><span class="lineno">   45</span>  <a class="code hl_variable" href="classMCMCProcessor.html#afbac2a114c15ca7db4abe71dd549504c">plotRelativeToPrior</a> = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">   46</span>  <a class="code hl_variable" href="classMCMCProcessor.html#ad73755714ae3d6dc951158d5513c6eee">printToPDF</a> = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">   47</span>  <a class="code hl_variable" href="classMCMCProcessor.html#aa7611f55ac3c0ea70607761d037fbd91">plotBinValue</a> = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">   48</span>  <a class="code hl_variable" href="classMCMCProcessor.html#ad24411a2556504c440ff0af045e8e7aa">PlotFlatPrior</a> = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">   49</span>  <a class="code hl_variable" href="classMCMCProcessor.html#aea84f0315695aa05ec41fcf965b1b031">CacheMCMC</a> = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">   50</span>  <a class="code hl_variable" href="classMCMCProcessor.html#a682c1c47626542f5820d633ba2bc010c">ApplySmoothing</a> = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">   51</span>  <a class="code hl_variable" href="classMCMCProcessor.html#ad25fe818c94163b0c4a8fcdfd387c148">FancyPlotNames</a> = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">   52</span>  <a class="code hl_variable" href="classMCMCProcessor.html#adf449e50cf358f737fe4a2b65d9668e9">doDiagMCMC</a> = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">   53</span>  <a class="code hl_variable" href="classMCMCProcessor.html#a562261269f0f4ec4a209b2fca64ff443">useFFTAutoCorrelation</a> = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">   54</span>  <a class="code hl_variable" href="classMCMCProcessor.html#aa34b50ce33fb2cb7d9e9ef2d9f2f67c1">OutputSuffix</a> = <span class="stringliteral">&quot;_Process&quot;</span>;</div>
<div class="line"><span class="lineno">   55</span>  <a class="code hl_variable" href="classMCMCProcessor.html#a25e4685b6299181021b02ac0e0b74681">Post2DPlotThreshold</a> = 1.e-5;</div>
<div class="line"><span class="lineno">   56</span> </div>
<div class="line"><span class="lineno">   57</span>  <a class="code hl_variable" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a> = 0;</div>
<div class="line"><span class="lineno">   58</span>  <a class="code hl_variable" href="classMCMCProcessor.html#acfc681553c5fbba89e133dfda605db3c">nFlux</a> = 0;</div>
<div class="line"><span class="lineno">   59</span>  <a class="code hl_variable" href="classMCMCProcessor.html#af3a19b885e9c34e1674aea8cfbe14e1c">nEntries</a> = 0;</div>
<div class="line"><span class="lineno">   60</span>  <a class="code hl_variable" href="classMCMCProcessor.html#a840c686f15f419c0156df01c4ed62931">UpperCut</a> = <a class="code hl_define" href="MCMCProcessor_8h.html#a82a6d79039474bc403b627437a7b97ec">_UNDEF_</a>;</div>
<div class="line"><span class="lineno">   61</span>  <a class="code hl_variable" href="classMCMCProcessor.html#aae0016a4e1d105d5d65243438c622a97">nSteps</a> = 0;</div>
<div class="line"><span class="lineno">   62</span>  <a class="code hl_variable" href="classMCMCProcessor.html#a02c5a3f849cf217705816c650c678d19">nBatches</a> = 0;</div>
<div class="line"><span class="lineno">   63</span>  <a class="code hl_variable" href="classMCMCProcessor.html#a6156bba72e1f076e66f0356e48506a36">AutoCorrLag</a> = 0;</div>
<div class="line"><span class="lineno">   64</span>  <a class="code hl_variable" href="classMCMCProcessor.html#adf518be96278f1d3901404cfbe767b67">nSysts</a> = 0;</div>
<div class="line"><span class="lineno">   65</span>  <a class="code hl_variable" href="classMCMCProcessor.html#a419d3669dbb54a55a635e35691134cc1">nSamples</a> = 0;</div>
<div class="line"><span class="lineno">   66</span>  </div>
<div class="line"><span class="lineno">   67</span>  <a class="code hl_variable" href="classMCMCProcessor.html#a6b74f8195bcbca0979f9e9fe43468bae">nBins</a> = 70;</div>
<div class="line"><span class="lineno">   68</span>  <a class="code hl_variable" href="classMCMCProcessor.html#a4abe633b264acd9b0459c7b8ccd8b9df">DrawRange</a> = 1.5;</div>
<div class="line"><span class="lineno">   69</span>  </div>
<div class="line"><span class="lineno">   70</span>  <a class="code hl_variable" href="classMCMCProcessor.html#a85917e25c4f5b5b966c50cccd9ddd6a0">Posterior1DCut</a> = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><span class="lineno">   71</span>  <span class="comment">//KS:Those keep basic information for ParameterEnum</span></div>
<div class="line"><span class="lineno">   72</span>  <a class="code hl_variable" href="classMCMCProcessor.html#adecc55689f7d37b9412f8886fe3480dc">ParamNames</a>.resize(<a class="code hl_enumvalue" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20babd8035289bbe1770c6cb4d4d3e9d1b5a">kNParameterEnum</a>);</div>
<div class="line"><span class="lineno">   73</span>  <a class="code hl_variable" href="classMCMCProcessor.html#a3a6614826ae320e462211e38e96d9d02">ParamCentral</a>.resize(<a class="code hl_enumvalue" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20babd8035289bbe1770c6cb4d4d3e9d1b5a">kNParameterEnum</a>);</div>
<div class="line"><span class="lineno">   74</span>  <a class="code hl_variable" href="classMCMCProcessor.html#a4c4c6aa4827a2fe54ce37defbb3d0475">ParamNom</a>.resize(<a class="code hl_enumvalue" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20babd8035289bbe1770c6cb4d4d3e9d1b5a">kNParameterEnum</a>);</div>
<div class="line"><span class="lineno">   75</span>  <a class="code hl_variable" href="classMCMCProcessor.html#a3a97e3cb4be3ceb9eb721eac51d82d60">ParamErrors</a>.resize(<a class="code hl_enumvalue" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20babd8035289bbe1770c6cb4d4d3e9d1b5a">kNParameterEnum</a>);</div>
<div class="line"><span class="lineno">   76</span>  <a class="code hl_variable" href="classMCMCProcessor.html#a4be1eedb743e4ea410009a4fa45720f7">ParamFlat</a>.resize(<a class="code hl_enumvalue" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20babd8035289bbe1770c6cb4d4d3e9d1b5a">kNParameterEnum</a>);</div>
<div class="line"><span class="lineno">   77</span>  <a class="code hl_variable" href="classMCMCProcessor.html#aeab63979ff36256072c046a15d981875">ParamTypeStartPos</a>.resize(<a class="code hl_enumvalue" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20babd8035289bbe1770c6cb4d4d3e9d1b5a">kNParameterEnum</a>);</div>
<div class="line"><span class="lineno">   78</span>  <a class="code hl_variable" href="classMCMCProcessor.html#a4200e7cbe1c8f811d3640ebfd648ca85">nParam</a>.resize(<a class="code hl_enumvalue" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20babd8035289bbe1770c6cb4d4d3e9d1b5a">kNParameterEnum</a>);</div>
<div class="line"><span class="lineno">   79</span>  <a class="code hl_variable" href="classMCMCProcessor.html#a7c6afb0ed75207fd02c28e408f0592d4">CovPos</a>.resize(<a class="code hl_enumvalue" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20babd8035289bbe1770c6cb4d4d3e9d1b5a">kNParameterEnum</a>);</div>
<div class="line"><span class="lineno">   80</span>  <a class="code hl_variable" href="classMCMCProcessor.html#a4c1330a025c0b91e382bdc29c960424a">CovConfig</a>.resize(<a class="code hl_enumvalue" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20babd8035289bbe1770c6cb4d4d3e9d1b5a">kNParameterEnum</a>);</div>
<div class="line"><span class="lineno">   81</span> </div>
<div class="line"><span class="lineno">   82</span>  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_enumvalue" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20babd8035289bbe1770c6cb4d4d3e9d1b5a">kNParameterEnum</a>; i++)</div>
<div class="line"><span class="lineno">   83</span>  {</div>
<div class="line"><span class="lineno">   84</span>    <a class="code hl_variable" href="classMCMCProcessor.html#aeab63979ff36256072c046a15d981875">ParamTypeStartPos</a>[i] = 0;</div>
<div class="line"><span class="lineno">   85</span>    <a class="code hl_variable" href="classMCMCProcessor.html#a4200e7cbe1c8f811d3640ebfd648ca85">nParam</a>[i] = 0;</div>
<div class="line"><span class="lineno">   86</span>  }</div>
<div class="line"><span class="lineno">   87</span>  <span class="comment">//Only if GPU is enabled</span></div>
<div class="line"><span class="lineno">   88</span><span class="preprocessor">  #ifdef CUDA</span></div>
<div class="line"><span class="lineno">   89</span>   ParStep_cpu = <span class="keyword">nullptr</span>;</div>
<div class="line"><span class="lineno">   90</span>   NumeratorSum_cpu = <span class="keyword">nullptr</span>;</div>
<div class="line"><span class="lineno">   91</span>   ParamSums_cpu = <span class="keyword">nullptr</span>;</div>
<div class="line"><span class="lineno">   92</span>   DenomSum_cpu = <span class="keyword">nullptr</span>;</div>
<div class="line"><span class="lineno">   93</span> </div>
<div class="line"><span class="lineno">   94</span>   ParStep_gpu = <span class="keyword">nullptr</span>;</div>
<div class="line"><span class="lineno">   95</span>   NumeratorSum_gpu = <span class="keyword">nullptr</span>;</div>
<div class="line"><span class="lineno">   96</span>   ParamSums_gpu = <span class="keyword">nullptr</span>;</div>
<div class="line"><span class="lineno">   97</span>   DenomSum_gpu = <span class="keyword">nullptr</span>;</div>
<div class="line"><span class="lineno">   98</span><span class="preprocessor">  #endif</span></div>
<div class="line"><span class="lineno">   99</span>}</div>
<div class="ttc" id="aMCMCProcessor_8h_html_a82a6d79039474bc403b627437a7b97ec"><div class="ttname"><a href="MCMCProcessor_8h.html#a82a6d79039474bc403b627437a7b97ec">_UNDEF_</a></div><div class="ttdeci">#define _UNDEF_</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8h_source.html#l00004">MCMCProcessor.h:4</a></div></div>
<div class="ttc" id="aMCMCProcessor_8h_html_acd2848273413543fe14936252942c20babd8035289bbe1770c6cb4d4d3e9d1b5a"><div class="ttname"><a href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20babd8035289bbe1770c6cb4d4d3e9d1b5a">kNParameterEnum</a></div><div class="ttdeci">@ kNParameterEnum</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8h_source.html#l00058">MCMCProcessor.h:57</a></div></div>
<div class="ttc" id="aMaCh3Logger_8h_html_a95fa4dffc648e4c5536c9292c2bdcac3"><div class="ttname"><a href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a></div><div class="ttdeci">#define MACH3LOG_INFO</div><div class="ttdef"><b>Definition:</b> <a href="MaCh3Logger_8h_source.html#l00016">MaCh3Logger.h:16</a></div></div>
<div class="ttc" id="aMaCh3Logger_8h_html_aa603c55ea73cd86d1994901227883e1e"><div class="ttname"><a href="MaCh3Logger_8h.html#aa603c55ea73cd86d1994901227883e1e">SetMaCh3LoggerFormat</a></div><div class="ttdeci">void SetMaCh3LoggerFormat()</div><div class="ttdoc">Set messaging format of the logger.</div><div class="ttdef"><b>Definition:</b> <a href="MaCh3Logger_8h_source.html#l00023">MaCh3Logger.h:23</a></div></div>
<div class="ttc" id="aclassMCMCProcessor_html_a02c5a3f849cf217705816c650c678d19"><div class="ttname"><a href="classMCMCProcessor.html#a02c5a3f849cf217705816c650c678d19">MCMCProcessor::nBatches</a></div><div class="ttdeci">int nBatches</div><div class="ttdoc">Number of batches for Batched Mean.</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8h_source.html#l00479">MCMCProcessor.h:479</a></div></div>
<div class="ttc" id="aclassMCMCProcessor_html_a07549f3b67ca5409218d80c679f6e69e"><div class="ttname"><a href="classMCMCProcessor.html#a07549f3b67ca5409218d80c679f6e69e">MCMCProcessor::StepNumber</a></div><div class="ttdeci">int * StepNumber</div><div class="ttdoc">Step number for step, important if chains were merged.</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8h_source.html#l00465">MCMCProcessor.h:465</a></div></div>
<div class="ttc" id="aclassMCMCProcessor_html_a087dca88a306acdc28afea7213e3623c"><div class="ttname"><a href="classMCMCProcessor.html#a087dca88a306acdc28afea7213e3623c">MCMCProcessor::ParStep</a></div><div class="ttdeci">double ** ParStep</div><div class="ttdoc">Array holding values for all parameters.</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8h_source.html#l00463">MCMCProcessor.h:463</a></div></div>
<div class="ttc" id="aclassMCMCProcessor_html_a0ddcfa4ba1e4dcdea366d88decc64391"><div class="ttname"><a href="classMCMCProcessor.html#a0ddcfa4ba1e4dcdea366d88decc64391">MCMCProcessor::hpost2D</a></div><div class="ttdeci">TH2D *** hpost2D</div><div class="ttdoc">Holds 2D Posterior Distributions.</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8h_source.html#l00456">MCMCProcessor.h:456</a></div></div>
<div class="ttc" id="aclassMCMCProcessor_html_a25d79f451d5d584c3e7ef0e1423e5e8e"><div class="ttname"><a href="classMCMCProcessor.html#a25d79f451d5d584c3e7ef0e1423e5e8e">MCMCProcessor::hviolin_prior</a></div><div class="ttdeci">TH2D * hviolin_prior</div><div class="ttdoc">Holds prior violin plot for all dials,.</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8h_source.html#l00460">MCMCProcessor.h:460</a></div></div>
<div class="ttc" id="aclassMCMCProcessor_html_a25e4685b6299181021b02ac0e0b74681"><div class="ttname"><a href="classMCMCProcessor.html#a25e4685b6299181021b02ac0e0b74681">MCMCProcessor::Post2DPlotThreshold</a></div><div class="ttdeci">double Post2DPlotThreshold</div><div class="ttdoc">KS: Set Threshold when to plot 2D posterior as by default we get a LOT of plots.</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8h_source.html#l00412">MCMCProcessor.h:412</a></div></div>
<div class="ttc" id="aclassMCMCProcessor_html_a28e89498420221149ec97c353c430bf8"><div class="ttname"><a href="classMCMCProcessor.html#a28e89498420221149ec97c353c430bf8">MCMCProcessor::SampleValues</a></div><div class="ttdeci">double ** SampleValues</div><div class="ttdoc">Holds the sample values.</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8h_source.html#l00489">MCMCProcessor.h:489</a></div></div>
<div class="ttc" id="aclassMCMCProcessor_html_a3a6614826ae320e462211e38e96d9d02"><div class="ttname"><a href="classMCMCProcessor.html#a3a6614826ae320e462211e38e96d9d02">MCMCProcessor::ParamCentral</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; double &gt; &gt; ParamCentral</div><div class="ttdoc">Parameters central values which we are going to analyse.</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8h_source.html#l00364">MCMCProcessor.h:364</a></div></div>
<div class="ttc" id="aclassMCMCProcessor_html_a3a97e3cb4be3ceb9eb721eac51d82d60"><div class="ttname"><a href="classMCMCProcessor.html#a3a97e3cb4be3ceb9eb721eac51d82d60">MCMCProcessor::ParamErrors</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; double &gt; &gt; ParamErrors</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8h_source.html#l00366">MCMCProcessor.h:366</a></div></div>
<div class="ttc" id="aclassMCMCProcessor_html_a419d3669dbb54a55a635e35691134cc1"><div class="ttname"><a href="classMCMCProcessor.html#a419d3669dbb54a55a635e35691134cc1">MCMCProcessor::nSamples</a></div><div class="ttdeci">int nSamples</div><div class="ttdoc">Number of sample PDF objects.</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8h_source.html#l00348">MCMCProcessor.h:348</a></div></div>
<div class="ttc" id="aclassMCMCProcessor_html_a4200e7cbe1c8f811d3640ebfd648ca85"><div class="ttname"><a href="classMCMCProcessor.html#a4200e7cbe1c8f811d3640ebfd648ca85">MCMCProcessor::nParam</a></div><div class="ttdeci">std::vector&lt; int &gt; nParam</div><div class="ttdoc">Number of parameters per type.</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8h_source.html#l00369">MCMCProcessor.h:369</a></div></div>
<div class="ttc" id="aclassMCMCProcessor_html_a4abe633b264acd9b0459c7b8ccd8b9df"><div class="ttname"><a href="classMCMCProcessor.html#a4abe633b264acd9b0459c7b8ccd8b9df">MCMCProcessor::DrawRange</a></div><div class="ttdeci">double DrawRange</div><div class="ttdoc">Drawrange for SetMaximum.</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8h_source.html#l00470">MCMCProcessor.h:470</a></div></div>
<div class="ttc" id="aclassMCMCProcessor_html_a4be1eedb743e4ea410009a4fa45720f7"><div class="ttname"><a href="classMCMCProcessor.html#a4be1eedb743e4ea410009a4fa45720f7">MCMCProcessor::ParamFlat</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; bool &gt; &gt; ParamFlat</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8h_source.html#l00367">MCMCProcessor.h:367</a></div></div>
<div class="ttc" id="aclassMCMCProcessor_html_a4c1330a025c0b91e382bdc29c960424a"><div class="ttname"><a href="classMCMCProcessor.html#a4c1330a025c0b91e382bdc29c960424a">MCMCProcessor::CovConfig</a></div><div class="ttdeci">std::vector&lt; YAML::Node &gt; CovConfig</div><div class="ttdoc">Covariance matrix config.</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8h_source.html#l00329">MCMCProcessor.h:329</a></div></div>
<div class="ttc" id="aclassMCMCProcessor_html_a4c4c6aa4827a2fe54ce37defbb3d0475"><div class="ttname"><a href="classMCMCProcessor.html#a4c4c6aa4827a2fe54ce37defbb3d0475">MCMCProcessor::ParamNom</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; double &gt; &gt; ParamNom</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8h_source.html#l00365">MCMCProcessor.h:365</a></div></div>
<div class="ttc" id="aclassMCMCProcessor_html_a4eb2748c81b0aef9bd7e14785559e301"><div class="ttname"><a href="classMCMCProcessor.html#a4eb2748c81b0aef9bd7e14785559e301">MCMCProcessor::SystValues</a></div><div class="ttdeci">double ** SystValues</div><div class="ttdoc">Holds the systs values.</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8h_source.html#l00491">MCMCProcessor.h:491</a></div></div>
<div class="ttc" id="aclassMCMCProcessor_html_a523a223a4754c133121796f4591c7be3"><div class="ttname"><a href="classMCMCProcessor.html#a523a223a4754c133121796f4591c7be3">MCMCProcessor::AccProbBatchedAverages</a></div><div class="ttdeci">double * AccProbBatchedAverages</div><div class="ttdoc">Holds all accProb in batches.</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8h_source.html#l00496">MCMCProcessor.h:496</a></div></div>
<div class="ttc" id="aclassMCMCProcessor_html_a556988f03b24e3af33e9a29b23d2b1e2"><div class="ttname"><a href="classMCMCProcessor.html#a556988f03b24e3af33e9a29b23d2b1e2">MCMCProcessor::hviolin</a></div><div class="ttdeci">TH2D * hviolin</div><div class="ttdoc">Holds violin plot for all dials.</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8h_source.html#l00458">MCMCProcessor.h:458</a></div></div>
<div class="ttc" id="aclassMCMCProcessor_html_a562261269f0f4ec4a209b2fca64ff443"><div class="ttname"><a href="classMCMCProcessor.html#a562261269f0f4ec4a209b2fca64ff443">MCMCProcessor::useFFTAutoCorrelation</a></div><div class="ttdeci">bool useFFTAutoCorrelation</div><div class="ttdoc">MJR: Use FFT-based autocorrelation algorithm (save time &amp; resources)?</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8h_source.html#l00414">MCMCProcessor.h:414</a></div></div>
<div class="ttc" id="aclassMCMCProcessor_html_a576f0eb874afaf7e31ff5c86b9e5b8f9"><div class="ttname"><a href="classMCMCProcessor.html#a576f0eb874afaf7e31ff5c86b9e5b8f9">MCMCProcessor::StepCut</a></div><div class="ttdeci">std::string StepCut</div><div class="ttdoc">BurnIn Cuts.</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8h_source.html#l00334">MCMCProcessor.h:334</a></div></div>
<div class="ttc" id="aclassMCMCProcessor_html_a6156bba72e1f076e66f0356e48506a36"><div class="ttname"><a href="classMCMCProcessor.html#a6156bba72e1f076e66f0356e48506a36">MCMCProcessor::AutoCorrLag</a></div><div class="ttdeci">int AutoCorrLag</div><div class="ttdoc">LagL used in AutoCorrelation.</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8h_source.html#l00481">MCMCProcessor.h:481</a></div></div>
<div class="ttc" id="aclassMCMCProcessor_html_a62035b99df4617ab334cd1abd6ed0346"><div class="ttname"><a href="classMCMCProcessor.html#a62035b99df4617ab334cd1abd6ed0346">MCMCProcessor::OutputFile</a></div><div class="ttdeci">TFile * OutputFile</div><div class="ttdoc">The output file.</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8h_source.html#l00423">MCMCProcessor.h:423</a></div></div>
<div class="ttc" id="aclassMCMCProcessor_html_a682c1c47626542f5820d633ba2bc010c"><div class="ttname"><a href="classMCMCProcessor.html#a682c1c47626542f5820d633ba2bc010c">MCMCProcessor::ApplySmoothing</a></div><div class="ttdeci">bool ApplySmoothing</div><div class="ttdoc">Apply smoothing for 2D histos using root algorithm.</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8h_source.html#l00410">MCMCProcessor.h:410</a></div></div>
<div class="ttc" id="aclassMCMCProcessor_html_a6b74f8195bcbca0979f9e9fe43468bae"><div class="ttname"><a href="classMCMCProcessor.html#a6b74f8195bcbca0979f9e9fe43468bae">MCMCProcessor::nBins</a></div><div class="ttdeci">int nBins</div><div class="ttdoc">Number of bins.</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8h_source.html#l00468">MCMCProcessor.h:468</a></div></div>
<div class="ttc" id="aclassMCMCProcessor_html_a6be3bbebd4a79fe9814a3da09b3bb820"><div class="ttname"><a href="classMCMCProcessor.html#a6be3bbebd4a79fe9814a3da09b3bb820">MCMCProcessor::Chain</a></div><div class="ttdeci">TChain * Chain</div><div class="ttdoc">Main chain storing all steps etc.</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8h_source.html#l00332">MCMCProcessor.h:332</a></div></div>
<div class="ttc" id="aclassMCMCProcessor_html_a6d212d77a818304a8674a7b9b18d43b8"><div class="ttname"><a href="classMCMCProcessor.html#a6d212d77a818304a8674a7b9b18d43b8">MCMCProcessor::MCMCFile</a></div><div class="ttdeci">std::string MCMCFile</div><div class="ttdoc">Name of MCMC file.</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8h_source.html#l00323">MCMCProcessor.h:323</a></div></div>
<div class="ttc" id="aclassMCMCProcessor_html_a7c6afb0ed75207fd02c28e408f0592d4"><div class="ttname"><a href="classMCMCProcessor.html#a7c6afb0ed75207fd02c28e408f0592d4">MCMCProcessor::CovPos</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; std::string &gt; &gt; CovPos</div><div class="ttdoc">Covariance matrix name position.</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8h_source.html#l00327">MCMCProcessor.h:327</a></div></div>
<div class="ttc" id="aclassMCMCProcessor_html_a7db98c7cf390b050f1acb927b4f55cab"><div class="ttname"><a href="classMCMCProcessor.html#a7db98c7cf390b050f1acb927b4f55cab">MCMCProcessor::ParamSums</a></div><div class="ttdeci">double * ParamSums</div><div class="ttdoc">Total parameter sum for each param.</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8h_source.html#l00484">MCMCProcessor.h:484</a></div></div>
<div class="ttc" id="aclassMCMCProcessor_html_a82e6cfef1ba6fcfc8ac8f61acb5bf931"><div class="ttname"><a href="classMCMCProcessor.html#a82e6cfef1ba6fcfc8ac8f61acb5bf931">MCMCProcessor::Posterior</a></div><div class="ttdeci">TCanvas * Posterior</div><div class="ttdoc">Fancy canvas used for our beautiful plots.</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8h_source.html#l00426">MCMCProcessor.h:426</a></div></div>
<div class="ttc" id="aclassMCMCProcessor_html_a840c686f15f419c0156df01c4ed62931"><div class="ttname"><a href="classMCMCProcessor.html#a840c686f15f419c0156df01c4ed62931">MCMCProcessor::UpperCut</a></div><div class="ttdeci">int UpperCut</div><div class="ttdoc">KS: Used only for SubOptimality.</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8h_source.html#l00338">MCMCProcessor.h:338</a></div></div>
<div class="ttc" id="aclassMCMCProcessor_html_a85917e25c4f5b5b966c50cccd9ddd6a0"><div class="ttname"><a href="classMCMCProcessor.html#a85917e25c4f5b5b966c50cccd9ddd6a0">MCMCProcessor::Posterior1DCut</a></div><div class="ttdeci">std::string Posterior1DCut</div><div class="ttdoc">Cut used when making 1D Posterior distribution.</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8h_source.html#l00336">MCMCProcessor.h:336</a></div></div>
<div class="ttc" id="aclassMCMCProcessor_html_a88cab29770fd6098a674a0ab3628a251"><div class="ttname"><a href="classMCMCProcessor.html#a88cab29770fd6098a674a0ab3628a251">MCMCProcessor::AccProbValues</a></div><div class="ttdeci">double * AccProbValues</div><div class="ttdoc">Holds all accProb.</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8h_source.html#l00494">MCMCProcessor.h:494</a></div></div>
<div class="ttc" id="aclassMCMCProcessor_html_aa30545fedb0af2ad9619d6accf42a10d"><div class="ttname"><a href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">MCMCProcessor::nDraw</a></div><div class="ttdeci">int nDraw</div><div class="ttdoc">Number of all parameters used in the analysis.</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8h_source.html#l00352">MCMCProcessor.h:352</a></div></div>
<div class="ttc" id="aclassMCMCProcessor_html_aa34b50ce33fb2cb7d9e9ef2d9f2f67c1"><div class="ttname"><a href="classMCMCProcessor.html#aa34b50ce33fb2cb7d9e9ef2d9f2f67c1">MCMCProcessor::OutputSuffix</a></div><div class="ttdeci">std::string OutputSuffix</div><div class="ttdoc">Output file suffix useful when running over same file with different settings.</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8h_source.html#l00325">MCMCProcessor.h:325</a></div></div>
<div class="ttc" id="aclassMCMCProcessor_html_aa7611f55ac3c0ea70607761d037fbd91"><div class="ttname"><a href="classMCMCProcessor.html#aa7611f55ac3c0ea70607761d037fbd91">MCMCProcessor::plotBinValue</a></div><div class="ttdeci">bool plotBinValue</div><div class="ttdoc">If true it will print value on each bin of covariance matrix.</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8h_source.html#l00408">MCMCProcessor.h:408</a></div></div>
<div class="ttc" id="aclassMCMCProcessor_html_aae0016a4e1d105d5d65243438c622a97"><div class="ttname"><a href="classMCMCProcessor.html#aae0016a4e1d105d5d65243438c622a97">MCMCProcessor::nSteps</a></div><div class="ttdeci">int nSteps</div><div class="ttdoc">KS: For merged chains number of entries will be different from nSteps.</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8h_source.html#l00346">MCMCProcessor.h:346</a></div></div>
<div class="ttc" id="aclassMCMCProcessor_html_ab3f590b501162fc2ee5b78ce75689771"><div class="ttname"><a href="classMCMCProcessor.html#ab3f590b501162fc2ee5b78ce75689771">MCMCProcessor::BatchedAverages</a></div><div class="ttdeci">double ** BatchedAverages</div><div class="ttdoc">Values of batched average for every param and batch.</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8h_source.html#l00486">MCMCProcessor.h:486</a></div></div>
<div class="ttc" id="aclassMCMCProcessor_html_acfc681553c5fbba89e133dfda605db3c"><div class="ttname"><a href="classMCMCProcessor.html#acfc681553c5fbba89e133dfda605db3c">MCMCProcessor::nFlux</a></div><div class="ttdeci">int nFlux</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8h_source.html#l00381">MCMCProcessor.h:381</a></div></div>
<div class="ttc" id="aclassMCMCProcessor_html_ad24411a2556504c440ff0af045e8e7aa"><div class="ttname"><a href="classMCMCProcessor.html#ad24411a2556504c440ff0af045e8e7aa">MCMCProcessor::PlotFlatPrior</a></div><div class="ttdeci">bool PlotFlatPrior</div><div class="ttdoc">Whether we plot flat prior or not, we usually provide error even for flat prior params.</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8h_source.html#l00394">MCMCProcessor.h:394</a></div></div>
<div class="ttc" id="aclassMCMCProcessor_html_ad25fe818c94163b0c4a8fcdfd387c148"><div class="ttname"><a href="classMCMCProcessor.html#ad25fe818c94163b0c4a8fcdfd387c148">MCMCProcessor::FancyPlotNames</a></div><div class="ttdeci">bool FancyPlotNames</div><div class="ttdoc">Whether we want fancy plot names or not.</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8h_source.html#l00406">MCMCProcessor.h:406</a></div></div>
<div class="ttc" id="aclassMCMCProcessor_html_ad73755714ae3d6dc951158d5513c6eee"><div class="ttname"><a href="classMCMCProcessor.html#ad73755714ae3d6dc951158d5513c6eee">MCMCProcessor::printToPDF</a></div><div class="ttdeci">bool printToPDF</div><div class="ttdoc">Will plot all plot to PDF not only to root file.</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8h_source.html#l00404">MCMCProcessor.h:404</a></div></div>
<div class="ttc" id="aclassMCMCProcessor_html_adecc55689f7d37b9412f8886fe3480dc"><div class="ttname"><a href="classMCMCProcessor.html#adecc55689f7d37b9412f8886fe3480dc">MCMCProcessor::ParamNames</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; TString &gt; &gt; ParamNames</div><div class="ttdoc">Name of parameters which we are going to analyse.</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8h_source.html#l00362">MCMCProcessor.h:362</a></div></div>
<div class="ttc" id="aclassMCMCProcessor_html_adf449e50cf358f737fe4a2b65d9668e9"><div class="ttname"><a href="classMCMCProcessor.html#adf449e50cf358f737fe4a2b65d9668e9">MCMCProcessor::doDiagMCMC</a></div><div class="ttdeci">bool doDiagMCMC</div><div class="ttdoc">Doing MCMC Diagnostic.</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8h_source.html#l00475">MCMCProcessor.h:475</a></div></div>
<div class="ttc" id="aclassMCMCProcessor_html_adf518be96278f1d3901404cfbe767b67"><div class="ttname"><a href="classMCMCProcessor.html#adf518be96278f1d3901404cfbe767b67">MCMCProcessor::nSysts</a></div><div class="ttdeci">int nSysts</div><div class="ttdoc">Number of covariance objects.</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8h_source.html#l00350">MCMCProcessor.h:350</a></div></div>
<div class="ttc" id="aclassMCMCProcessor_html_aea84f0315695aa05ec41fcf965b1b031"><div class="ttname"><a href="classMCMCProcessor.html#aea84f0315695aa05ec41fcf965b1b031">MCMCProcessor::CacheMCMC</a></div><div class="ttdeci">bool CacheMCMC</div><div class="ttdoc">MCMC Chain has been cached.</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8h_source.html#l00473">MCMCProcessor.h:473</a></div></div>
<div class="ttc" id="aclassMCMCProcessor_html_aeab63979ff36256072c046a15d981875"><div class="ttname"><a href="classMCMCProcessor.html#aeab63979ff36256072c046a15d981875">MCMCProcessor::ParamTypeStartPos</a></div><div class="ttdeci">std::vector&lt; int &gt; ParamTypeStartPos</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8h_source.html#l00374">MCMCProcessor.h:374</a></div></div>
<div class="ttc" id="aclassMCMCProcessor_html_aecc35d4ea7d2c7e020e50388ba0ffb64"><div class="ttname"><a href="classMCMCProcessor.html#aecc35d4ea7d2c7e020e50388ba0ffb64">MCMCProcessor::MadePostfit</a></div><div class="ttdeci">bool MadePostfit</div><div class="ttdoc">Sanity check if Postfit is already done to not make several times.</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8h_source.html#l00402">MCMCProcessor.h:402</a></div></div>
<div class="ttc" id="aclassMCMCProcessor_html_af1392c6cff68e9f0a27e2c9a4e52cf4c"><div class="ttname"><a href="classMCMCProcessor.html#af1392c6cff68e9f0a27e2c9a4e52cf4c">MCMCProcessor::PlotJarlskog</a></div><div class="ttdeci">bool PlotJarlskog</div><div class="ttdoc">Will plot Jarlskog Invariant using information in the chain.</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8h_source.html#l00396">MCMCProcessor.h:396</a></div></div>
<div class="ttc" id="aclassMCMCProcessor_html_af3a19b885e9c34e1674aea8cfbe14e1c"><div class="ttname"><a href="classMCMCProcessor.html#af3a19b885e9c34e1674aea8cfbe14e1c">MCMCProcessor::nEntries</a></div><div class="ttdeci">int nEntries</div><div class="ttdoc">KS: For merged chains number of entries will be different from nSteps.</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8h_source.html#l00344">MCMCProcessor.h:344</a></div></div>
<div class="ttc" id="aclassMCMCProcessor_html_afbac2a114c15ca7db4abe71dd549504c"><div class="ttname"><a href="classMCMCProcessor.html#afbac2a114c15ca7db4abe71dd549504c">MCMCProcessor::plotRelativeToPrior</a></div><div class="ttdeci">bool plotRelativeToPrior</div><div class="ttdoc">Whether we plot relative to prior or nominal, in most cases is prior.</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8h_source.html#l00400">MCMCProcessor.h:400</a></div></div>
<div class="ttc" id="anamespaceMaCh3Utils_html_ac6f4a3b6a7749967ff9a011469352f6c"><div class="ttname"><a href="namespaceMaCh3Utils.html#ac6f4a3b6a7749967ff9a011469352f6c">MaCh3Utils::MaCh3Welcome</a></div><div class="ttdeci">void MaCh3Welcome()</div><div class="ttdoc">KS: Prints welcome message with MaCh3 logo.</div><div class="ttdef"><b>Definition:</b> <a href="Monitor_8cpp_source.html#l00011">Monitor.cpp:11</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a50810cd50c5a4545bd5c1e486aae7b1c" name="a50810cd50c5a4545bd5c1e486aae7b1c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a50810cd50c5a4545bd5c1e486aae7b1c">&#9670;&#160;</a></span>~MCMCProcessor()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">MCMCProcessor::~MCMCProcessor </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Destroys the <a class="el" href="classMCMCProcessor.html" title="Class responsible for processing MCMC chains, performing diagnostics, generating plots,...">MCMCProcessor</a> object. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8cpp_source.html#l00103">103</a> of file <a class="el" href="MCMCProcessor_8cpp_source.html">MCMCProcessor.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  103</span>                              {</div>
<div class="line"><span class="lineno">  104</span><span class="comment">// ****************************</span></div>
<div class="line"><span class="lineno">  105</span>  <span class="comment">// Close the pdf file</span></div>
<div class="line"><span class="lineno">  106</span>  <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Closing pdf in MCMCProcessor: {}&quot;</span>, <a class="code hl_variable" href="classMCMCProcessor.html#ab5aec3dc293919701d31e6ae705601dd">CanvasName</a>.Data());</div>
<div class="line"><span class="lineno">  107</span>  <a class="code hl_variable" href="classMCMCProcessor.html#ab5aec3dc293919701d31e6ae705601dd">CanvasName</a> += <span class="stringliteral">&quot;]&quot;</span>;</div>
<div class="line"><span class="lineno">  108</span>  <span class="keywordflow">if</span>(<a class="code hl_variable" href="classMCMCProcessor.html#ad73755714ae3d6dc951158d5513c6eee">printToPDF</a>) <a class="code hl_variable" href="classMCMCProcessor.html#a82e6cfef1ba6fcfc8ac8f61acb5bf931">Posterior</a>-&gt;Print(<a class="code hl_variable" href="classMCMCProcessor.html#ab5aec3dc293919701d31e6ae705601dd">CanvasName</a>);</div>
<div class="line"><span class="lineno">  109</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="classMCMCProcessor.html#a82e6cfef1ba6fcfc8ac8f61acb5bf931">Posterior</a> != <span class="keyword">nullptr</span>) <span class="keyword">delete</span> <a class="code hl_variable" href="classMCMCProcessor.html#a82e6cfef1ba6fcfc8ac8f61acb5bf931">Posterior</a>;</div>
<div class="line"><span class="lineno">  110</span> </div>
<div class="line"><span class="lineno">  111</span>  <span class="keyword">delete</span> <a class="code hl_variable" href="classMCMCProcessor.html#a92c1d9b0ebdf90951221cdaf2ac4cc2c">Gauss</a>;</div>
<div class="line"><span class="lineno">  112</span>  <span class="keyword">delete</span> <a class="code hl_variable" href="classMCMCProcessor.html#af9a40632e2d7f1266d69a74d5b5f2244">Covariance</a>;</div>
<div class="line"><span class="lineno">  113</span>  <span class="keyword">delete</span> <a class="code hl_variable" href="classMCMCProcessor.html#a03f28431158777cdd81d058b6632a92f">Correlation</a>;</div>
<div class="line"><span class="lineno">  114</span>  <span class="keyword">delete</span> <a class="code hl_variable" href="classMCMCProcessor.html#aad661c6d53f9f891e18ff8ccdbd08479">Central_Value</a>;</div>
<div class="line"><span class="lineno">  115</span>  <span class="keyword">delete</span> <a class="code hl_variable" href="classMCMCProcessor.html#acaf7f239136dfa3506d095b612323d0a">Means</a>;</div>
<div class="line"><span class="lineno">  116</span>  <span class="keyword">delete</span> <a class="code hl_variable" href="classMCMCProcessor.html#a5174aaa900edf16ddc6e841ea4adae83">Errors</a>;</div>
<div class="line"><span class="lineno">  117</span>  <span class="keyword">delete</span> <a class="code hl_variable" href="classMCMCProcessor.html#a600fc8c39af2750df91fb7a0ff85ac74">Means_Gauss</a>;</div>
<div class="line"><span class="lineno">  118</span>  <span class="keyword">delete</span> <a class="code hl_variable" href="classMCMCProcessor.html#aa78b7ed1bb9966f84f4eaf8cedf5e688">Errors_Gauss</a>;</div>
<div class="line"><span class="lineno">  119</span>  <span class="keyword">delete</span> <a class="code hl_variable" href="classMCMCProcessor.html#a32657dc39a7fc0d04804f6195a3d8c3e">Means_HPD</a>;</div>
<div class="line"><span class="lineno">  120</span>  <span class="keyword">delete</span> <a class="code hl_variable" href="classMCMCProcessor.html#abb5c6ad85c89227bbb9bc5de2eb71272">Errors_HPD</a>;</div>
<div class="line"><span class="lineno">  121</span>  <span class="keyword">delete</span> <a class="code hl_variable" href="classMCMCProcessor.html#af96664fa8cc51c49ad1385da07a343b8">Errors_HPD_Positive</a>;</div>
<div class="line"><span class="lineno">  122</span>  <span class="keyword">delete</span> <a class="code hl_variable" href="classMCMCProcessor.html#a7b85df39f22390dac24f4d66a89518e5">Errors_HPD_Negative</a>;</div>
<div class="line"><span class="lineno">  123</span> </div>
<div class="line"><span class="lineno">  124</span> </div>
<div class="line"><span class="lineno">  125</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_variable" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>; ++i)</div>
<div class="line"><span class="lineno">  126</span>  {</div>
<div class="line"><span class="lineno">  127</span>    <span class="keywordflow">if</span>(<a class="code hl_variable" href="classMCMCProcessor.html#a795f661ed1ba8b8ae54c41fde5fb9496">hpost</a>[i] != <span class="keyword">nullptr</span>) <span class="keyword">delete</span> <a class="code hl_variable" href="classMCMCProcessor.html#a795f661ed1ba8b8ae54c41fde5fb9496">hpost</a>[i];</div>
<div class="line"><span class="lineno">  128</span>  }</div>
<div class="line"><span class="lineno">  129</span>  <span class="keywordflow">if</span>(<a class="code hl_variable" href="classMCMCProcessor.html#aea84f0315695aa05ec41fcf965b1b031">CacheMCMC</a>)</div>
<div class="line"><span class="lineno">  130</span>  {</div>
<div class="line"><span class="lineno">  131</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_variable" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>; ++i) </div>
<div class="line"><span class="lineno">  132</span>    {</div>
<div class="line"><span class="lineno">  133</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a class="code hl_variable" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>; ++j) </div>
<div class="line"><span class="lineno">  134</span>      {</div>
<div class="line"><span class="lineno">  135</span>        <span class="keyword">delete</span> <a class="code hl_variable" href="classMCMCProcessor.html#a0ddcfa4ba1e4dcdea366d88decc64391">hpost2D</a>[i][j];</div>
<div class="line"><span class="lineno">  136</span>      }</div>
<div class="line"><span class="lineno">  137</span>      <span class="keyword">delete</span>[] <a class="code hl_variable" href="classMCMCProcessor.html#a087dca88a306acdc28afea7213e3623c">ParStep</a>[i];</div>
<div class="line"><span class="lineno">  138</span>      <span class="keyword">delete</span>[] <a class="code hl_variable" href="classMCMCProcessor.html#a0ddcfa4ba1e4dcdea366d88decc64391">hpost2D</a>[i];</div>
<div class="line"><span class="lineno">  139</span>    }</div>
<div class="line"><span class="lineno">  140</span>    <span class="keyword">delete</span>[] <a class="code hl_variable" href="classMCMCProcessor.html#a087dca88a306acdc28afea7213e3623c">ParStep</a>;</div>
<div class="line"><span class="lineno">  141</span>    <span class="keyword">delete</span>[] <a class="code hl_variable" href="classMCMCProcessor.html#a0ddcfa4ba1e4dcdea366d88decc64391">hpost2D</a>;</div>
<div class="line"><span class="lineno">  142</span>  }</div>
<div class="line"><span class="lineno">  143</span>  <span class="keywordflow">if</span>(<a class="code hl_variable" href="classMCMCProcessor.html#a07549f3b67ca5409218d80c679f6e69e">StepNumber</a> != <span class="keyword">nullptr</span>) <span class="keyword">delete</span>[] <a class="code hl_variable" href="classMCMCProcessor.html#a07549f3b67ca5409218d80c679f6e69e">StepNumber</a>;</div>
<div class="line"><span class="lineno">  144</span> </div>
<div class="line"><span class="lineno">  145</span>  <span class="keywordflow">if</span>(<a class="code hl_variable" href="classMCMCProcessor.html#a556988f03b24e3af33e9a29b23d2b1e2">hviolin</a> != <span class="keyword">nullptr</span>) <span class="keyword">delete</span> <a class="code hl_variable" href="classMCMCProcessor.html#a556988f03b24e3af33e9a29b23d2b1e2">hviolin</a>;</div>
<div class="line"><span class="lineno">  146</span>  <span class="keywordflow">if</span>(<a class="code hl_variable" href="classMCMCProcessor.html#a25d79f451d5d584c3e7ef0e1423e5e8e">hviolin_prior</a> != <span class="keyword">nullptr</span>) <span class="keyword">delete</span> <a class="code hl_variable" href="classMCMCProcessor.html#a25d79f451d5d584c3e7ef0e1423e5e8e">hviolin_prior</a>;</div>
<div class="line"><span class="lineno">  147</span>  <span class="keywordflow">if</span>(<a class="code hl_variable" href="classMCMCProcessor.html#a62035b99df4617ab334cd1abd6ed0346">OutputFile</a> != <span class="keyword">nullptr</span>) <a class="code hl_variable" href="classMCMCProcessor.html#a62035b99df4617ab334cd1abd6ed0346">OutputFile</a>-&gt;Close();</div>
<div class="line"><span class="lineno">  148</span>  <span class="keywordflow">if</span>(<a class="code hl_variable" href="classMCMCProcessor.html#a62035b99df4617ab334cd1abd6ed0346">OutputFile</a> != <span class="keyword">nullptr</span>) <span class="keyword">delete</span> <a class="code hl_variable" href="classMCMCProcessor.html#a62035b99df4617ab334cd1abd6ed0346">OutputFile</a>;</div>
<div class="line"><span class="lineno">  149</span>  <span class="keyword">delete</span> <a class="code hl_variable" href="classMCMCProcessor.html#a6be3bbebd4a79fe9814a3da09b3bb820">Chain</a>;</div>
<div class="line"><span class="lineno">  150</span>}</div>
<div class="ttc" id="aclassMCMCProcessor_html_a03f28431158777cdd81d058b6632a92f"><div class="ttname"><a href="classMCMCProcessor.html#a03f28431158777cdd81d058b6632a92f">MCMCProcessor::Correlation</a></div><div class="ttdeci">TMatrixDSym * Correlation</div><div class="ttdoc">Posterior Correlation Matrix.</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8h_source.html#l00451">MCMCProcessor.h:451</a></div></div>
<div class="ttc" id="aclassMCMCProcessor_html_a32657dc39a7fc0d04804f6195a3d8c3e"><div class="ttname"><a href="classMCMCProcessor.html#a32657dc39a7fc0d04804f6195a3d8c3e">MCMCProcessor::Means_HPD</a></div><div class="ttdeci">TVectorD * Means_HPD</div><div class="ttdoc">Vector with mean values using Highest Posterior Density.</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8h_source.html#l00440">MCMCProcessor.h:440</a></div></div>
<div class="ttc" id="aclassMCMCProcessor_html_a5174aaa900edf16ddc6e841ea4adae83"><div class="ttname"><a href="classMCMCProcessor.html#a5174aaa900edf16ddc6e841ea4adae83">MCMCProcessor::Errors</a></div><div class="ttdeci">TVectorD * Errors</div><div class="ttdoc">Vector with errors values using RMS.</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8h_source.html#l00434">MCMCProcessor.h:434</a></div></div>
<div class="ttc" id="aclassMCMCProcessor_html_a600fc8c39af2750df91fb7a0ff85ac74"><div class="ttname"><a href="classMCMCProcessor.html#a600fc8c39af2750df91fb7a0ff85ac74">MCMCProcessor::Means_Gauss</a></div><div class="ttdeci">TVectorD * Means_Gauss</div><div class="ttdoc">Vector with mean values using Gaussian fit.</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8h_source.html#l00436">MCMCProcessor.h:436</a></div></div>
<div class="ttc" id="aclassMCMCProcessor_html_a795f661ed1ba8b8ae54c41fde5fb9496"><div class="ttname"><a href="classMCMCProcessor.html#a795f661ed1ba8b8ae54c41fde5fb9496">MCMCProcessor::hpost</a></div><div class="ttdeci">std::vector&lt; TH1D * &gt; hpost</div><div class="ttdoc">Holds 1D Posterior Distributions.</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8h_source.html#l00454">MCMCProcessor.h:454</a></div></div>
<div class="ttc" id="aclassMCMCProcessor_html_a7b85df39f22390dac24f4d66a89518e5"><div class="ttname"><a href="classMCMCProcessor.html#a7b85df39f22390dac24f4d66a89518e5">MCMCProcessor::Errors_HPD_Negative</a></div><div class="ttdeci">TVectorD * Errors_HPD_Negative</div><div class="ttdoc">Vector with negative error (left hand side) values using Highest Posterior Density.</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8h_source.html#l00446">MCMCProcessor.h:446</a></div></div>
<div class="ttc" id="aclassMCMCProcessor_html_a92c1d9b0ebdf90951221cdaf2ac4cc2c"><div class="ttname"><a href="classMCMCProcessor.html#a92c1d9b0ebdf90951221cdaf2ac4cc2c">MCMCProcessor::Gauss</a></div><div class="ttdeci">TF1 * Gauss</div><div class="ttdoc">Gaussian fitter.</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8h_source.html#l00420">MCMCProcessor.h:420</a></div></div>
<div class="ttc" id="aclassMCMCProcessor_html_aa78b7ed1bb9966f84f4eaf8cedf5e688"><div class="ttname"><a href="classMCMCProcessor.html#aa78b7ed1bb9966f84f4eaf8cedf5e688">MCMCProcessor::Errors_Gauss</a></div><div class="ttdeci">TVectorD * Errors_Gauss</div><div class="ttdoc">Vector with error values using Gaussian fit.</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8h_source.html#l00438">MCMCProcessor.h:438</a></div></div>
<div class="ttc" id="aclassMCMCProcessor_html_aad661c6d53f9f891e18ff8ccdbd08479"><div class="ttname"><a href="classMCMCProcessor.html#aad661c6d53f9f891e18ff8ccdbd08479">MCMCProcessor::Central_Value</a></div><div class="ttdeci">TVectorD * Central_Value</div><div class="ttdoc">Vector with central value for each parameter.</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8h_source.html#l00430">MCMCProcessor.h:430</a></div></div>
<div class="ttc" id="aclassMCMCProcessor_html_ab5aec3dc293919701d31e6ae705601dd"><div class="ttname"><a href="classMCMCProcessor.html#ab5aec3dc293919701d31e6ae705601dd">MCMCProcessor::CanvasName</a></div><div class="ttdeci">TString CanvasName</div><div class="ttdoc">Name of canvas which help to save to the sample pdf.</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8h_source.html#l00391">MCMCProcessor.h:391</a></div></div>
<div class="ttc" id="aclassMCMCProcessor_html_abb5c6ad85c89227bbb9bc5de2eb71272"><div class="ttname"><a href="classMCMCProcessor.html#abb5c6ad85c89227bbb9bc5de2eb71272">MCMCProcessor::Errors_HPD</a></div><div class="ttdeci">TVectorD * Errors_HPD</div><div class="ttdoc">Vector with error values using Highest Posterior Density.</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8h_source.html#l00442">MCMCProcessor.h:442</a></div></div>
<div class="ttc" id="aclassMCMCProcessor_html_acaf7f239136dfa3506d095b612323d0a"><div class="ttname"><a href="classMCMCProcessor.html#acaf7f239136dfa3506d095b612323d0a">MCMCProcessor::Means</a></div><div class="ttdeci">TVectorD * Means</div><div class="ttdoc">Vector with mean values using Arithmetic Mean.</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8h_source.html#l00432">MCMCProcessor.h:432</a></div></div>
<div class="ttc" id="aclassMCMCProcessor_html_af96664fa8cc51c49ad1385da07a343b8"><div class="ttname"><a href="classMCMCProcessor.html#af96664fa8cc51c49ad1385da07a343b8">MCMCProcessor::Errors_HPD_Positive</a></div><div class="ttdeci">TVectorD * Errors_HPD_Positive</div><div class="ttdoc">Vector with positive error (right hand side) values using Highest Posterior Density.</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8h_source.html#l00444">MCMCProcessor.h:444</a></div></div>
<div class="ttc" id="aclassMCMCProcessor_html_af9a40632e2d7f1266d69a74d5b5f2244"><div class="ttname"><a href="classMCMCProcessor.html#af9a40632e2d7f1266d69a74d5b5f2244">MCMCProcessor::Covariance</a></div><div class="ttdeci">TMatrixDSym * Covariance</div><div class="ttdoc">Posterior Covariance Matrix.</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8h_source.html#l00449">MCMCProcessor.h:449</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a278b82fa945d847e57ae6ed6357d8f61" name="a278b82fa945d847e57ae6ed6357d8f61"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a278b82fa945d847e57ae6ed6357d8f61">&#9670;&#160;</a></span>AcceptanceProbabilities()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void MCMCProcessor::AcceptanceProbabilities </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Acceptance Probability. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8cpp_source.html#l04358">4358</a> of file <a class="el" href="MCMCProcessor_8cpp_source.html">MCMCProcessor.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 4358</span>                                            {</div>
<div class="line"><span class="lineno"> 4359</span><span class="comment">// **************************</span></div>
<div class="line"><span class="lineno"> 4360</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="classMCMCProcessor.html#a523a223a4754c133121796f4591c7be3">AccProbBatchedAverages</a> == <span class="keyword">nullptr</span>) <a class="code hl_function" href="classMCMCProcessor.html#a930cadafa41b31b58066dea68628de9f">PrepareDiagMCMC</a>();</div>
<div class="line"><span class="lineno"> 4361</span> </div>
<div class="line"><span class="lineno"> 4362</span>  <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Making AccProb plots...&quot;</span>);</div>
<div class="line"><span class="lineno"> 4363</span> </div>
<div class="line"><span class="lineno"> 4364</span>  <span class="comment">// Set the titles and limits for TH1Ds</span></div>
<div class="line"><span class="lineno"> 4365</span>  <span class="keyword">auto</span> AcceptanceProbPlot = std::make_unique&lt;TH1D&gt;(<span class="stringliteral">&quot;AcceptanceProbability&quot;</span>, <span class="stringliteral">&quot;Acceptance Probability&quot;</span>, <a class="code hl_variable" href="classMCMCProcessor.html#af3a19b885e9c34e1674aea8cfbe14e1c">nEntries</a>, 0, <a class="code hl_variable" href="classMCMCProcessor.html#af3a19b885e9c34e1674aea8cfbe14e1c">nEntries</a>);</div>
<div class="line"><span class="lineno"> 4366</span>  AcceptanceProbPlot-&gt;GetXaxis()-&gt;SetTitle(<span class="stringliteral">&quot;Step&quot;</span>);</div>
<div class="line"><span class="lineno"> 4367</span>  AcceptanceProbPlot-&gt;GetYaxis()-&gt;SetTitle(<span class="stringliteral">&quot;Acceptance Probability&quot;</span>);</div>
<div class="line"><span class="lineno"> 4368</span> </div>
<div class="line"><span class="lineno"> 4369</span>  <span class="keyword">auto</span> BatchedAcceptanceProblot = std::make_unique&lt;TH1D&gt;(<span class="stringliteral">&quot;AcceptanceProbability_Batch&quot;</span>, <span class="stringliteral">&quot;AcceptanceProbability_Batch&quot;</span>, <a class="code hl_variable" href="classMCMCProcessor.html#a02c5a3f849cf217705816c650c678d19">nBatches</a>, 0, <a class="code hl_variable" href="classMCMCProcessor.html#a02c5a3f849cf217705816c650c678d19">nBatches</a>);</div>
<div class="line"><span class="lineno"> 4370</span>  BatchedAcceptanceProblot-&gt;GetYaxis()-&gt;SetTitle(<span class="stringliteral">&quot;Acceptance Probability&quot;</span>);</div>
<div class="line"><span class="lineno"> 4371</span>  </div>
<div class="line"><span class="lineno"> 4372</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_variable" href="classMCMCProcessor.html#a02c5a3f849cf217705816c650c678d19">nBatches</a>; ++i) {</div>
<div class="line"><span class="lineno"> 4373</span>    BatchedAcceptanceProblot-&gt;SetBinContent(i+1, <a class="code hl_variable" href="classMCMCProcessor.html#a523a223a4754c133121796f4591c7be3">AccProbBatchedAverages</a>[i]);</div>
<div class="line"><span class="lineno"> 4374</span>    <span class="keyword">const</span> <span class="keywordtype">int</span> BatchRangeLow = double(i)*double(<a class="code hl_variable" href="classMCMCProcessor.html#af3a19b885e9c34e1674aea8cfbe14e1c">nEntries</a>)/double(<a class="code hl_variable" href="classMCMCProcessor.html#a02c5a3f849cf217705816c650c678d19">nBatches</a>);</div>
<div class="line"><span class="lineno"> 4375</span>    <span class="keyword">const</span> <span class="keywordtype">int</span> BatchRangeHigh = double(i+1)*double(<a class="code hl_variable" href="classMCMCProcessor.html#af3a19b885e9c34e1674aea8cfbe14e1c">nEntries</a>)/double(<a class="code hl_variable" href="classMCMCProcessor.html#a02c5a3f849cf217705816c650c678d19">nBatches</a>);</div>
<div class="line"><span class="lineno"> 4376</span>    std::stringstream ss;</div>
<div class="line"><span class="lineno"> 4377</span>    ss &lt;&lt; BatchRangeLow &lt;&lt; <span class="stringliteral">&quot; - &quot;</span> &lt;&lt; BatchRangeHigh;</div>
<div class="line"><span class="lineno"> 4378</span>    BatchedAcceptanceProblot-&gt;GetXaxis()-&gt;SetBinLabel(i+1, ss.str().c_str());</div>
<div class="line"><span class="lineno"> 4379</span>  }</div>
<div class="line"><span class="lineno"> 4380</span>  </div>
<div class="line"><span class="lineno"> 4381</span><span class="preprocessor">  #ifdef MULTITHREAD</span></div>
<div class="line"><span class="lineno"> 4382</span><span class="preprocessor">  #pragma omp parallel for</span></div>
<div class="line"><span class="lineno"> 4383</span><span class="preprocessor">  #endif</span></div>
<div class="line"><span class="lineno"> 4384</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_variable" href="classMCMCProcessor.html#af3a19b885e9c34e1674aea8cfbe14e1c">nEntries</a>; ++i) {</div>
<div class="line"><span class="lineno"> 4385</span>    <span class="comment">// Set bin content for the i-th bin to the parameter values</span></div>
<div class="line"><span class="lineno"> 4386</span>    AcceptanceProbPlot-&gt;SetBinContent(i, <a class="code hl_variable" href="classMCMCProcessor.html#a88cab29770fd6098a674a0ab3628a251">AccProbValues</a>[i]);</div>
<div class="line"><span class="lineno"> 4387</span>  }</div>
<div class="line"><span class="lineno"> 4388</span>    </div>
<div class="line"><span class="lineno"> 4389</span>  TDirectory *probDir = <a class="code hl_variable" href="classMCMCProcessor.html#a62035b99df4617ab334cd1abd6ed0346">OutputFile</a>-&gt;mkdir(<span class="stringliteral">&quot;AccProb&quot;</span>);</div>
<div class="line"><span class="lineno"> 4390</span>  probDir-&gt;cd();</div>
<div class="line"><span class="lineno"> 4391</span>  </div>
<div class="line"><span class="lineno"> 4392</span>  AcceptanceProbPlot-&gt;Write();</div>
<div class="line"><span class="lineno"> 4393</span>  BatchedAcceptanceProblot-&gt;Write();</div>
<div class="line"><span class="lineno"> 4394</span>  <span class="keyword">delete</span>[] <a class="code hl_variable" href="classMCMCProcessor.html#a88cab29770fd6098a674a0ab3628a251">AccProbValues</a>;</div>
<div class="line"><span class="lineno"> 4395</span>  <span class="keyword">delete</span>[] <a class="code hl_variable" href="classMCMCProcessor.html#a523a223a4754c133121796f4591c7be3">AccProbBatchedAverages</a>;</div>
<div class="line"><span class="lineno"> 4396</span> </div>
<div class="line"><span class="lineno"> 4397</span>  probDir-&gt;Close();</div>
<div class="line"><span class="lineno"> 4398</span>  <span class="keyword">delete</span> probDir;</div>
<div class="line"><span class="lineno"> 4399</span> </div>
<div class="line"><span class="lineno"> 4400</span>  <a class="code hl_variable" href="classMCMCProcessor.html#a62035b99df4617ab334cd1abd6ed0346">OutputFile</a>-&gt;cd();</div>
<div class="line"><span class="lineno"> 4401</span>}</div>
<div class="ttc" id="aclassMCMCProcessor_html_a930cadafa41b31b58066dea68628de9f"><div class="ttname"><a href="classMCMCProcessor.html#a930cadafa41b31b58066dea68628de9f">MCMCProcessor::PrepareDiagMCMC</a></div><div class="ttdeci">void PrepareDiagMCMC()</div><div class="ttdoc">CW: Prepare branches etc. for DiagMCMC.</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8cpp_source.html#l03233">MCMCProcessor.cpp:3233</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a322bee0c362ba83df8c45769d299ce9f" name="a322bee0c362ba83df8c45769d299ce9f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a322bee0c362ba83df8c45769d299ce9f">&#9670;&#160;</a></span>AutoCorrelation()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void MCMCProcessor::AutoCorrelation </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>KS: Calculate autocorrelations supports both OpenMP and CUDA :) </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8cpp_source.html#l03600">3600</a> of file <a class="el" href="MCMCProcessor_8cpp_source.html">MCMCProcessor.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3600</span>                                    {</div>
<div class="line"><span class="lineno"> 3601</span><span class="comment">// *********************************</span></div>
<div class="line"><span class="lineno"> 3602</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="classMCMCProcessor.html#a087dca88a306acdc28afea7213e3623c">ParStep</a> == <span class="keyword">nullptr</span>) <a class="code hl_function" href="classMCMCProcessor.html#a930cadafa41b31b58066dea68628de9f">PrepareDiagMCMC</a>();</div>
<div class="line"><span class="lineno"> 3603</span> </div>
<div class="line"><span class="lineno"> 3604</span>  TStopwatch clock;</div>
<div class="line"><span class="lineno"> 3605</span>  clock.Start();</div>
<div class="line"><span class="lineno"> 3606</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> nLags = <a class="code hl_variable" href="classMCMCProcessor.html#a6156bba72e1f076e66f0356e48506a36">AutoCorrLag</a>;</div>
<div class="line"><span class="lineno"> 3607</span>  <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Making auto-correlations for nLags = {}&quot;</span>, nLags);</div>
<div class="line"><span class="lineno"> 3608</span> </div>
<div class="line"><span class="lineno"> 3609</span>  <span class="comment">// The sum of (Y-Ymean)^2 over all steps for each parameter</span></div>
<div class="line"><span class="lineno"> 3610</span>  std::vector&lt;std::vector&lt;double&gt;&gt; DenomSum(<a class="code hl_variable" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>);</div>
<div class="line"><span class="lineno"> 3611</span>  std::vector&lt;std::vector&lt;double&gt;&gt; NumeratorSum(<a class="code hl_variable" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>);</div>
<div class="line"><span class="lineno"> 3612</span>  std::vector&lt;std::vector&lt;double&gt;&gt; LagL(<a class="code hl_variable" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>);</div>
<div class="line"><span class="lineno"> 3613</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a class="code hl_variable" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>; ++j) {</div>
<div class="line"><span class="lineno"> 3614</span>    DenomSum[j].resize(nLags);</div>
<div class="line"><span class="lineno"> 3615</span>    NumeratorSum[j].resize(nLags);</div>
<div class="line"><span class="lineno"> 3616</span>    LagL[j].resize(nLags);</div>
<div class="line"><span class="lineno"> 3617</span>  }</div>
<div class="line"><span class="lineno"> 3618</span>  std::vector&lt;TH1D*&gt; LagKPlots(<a class="code hl_variable" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>);</div>
<div class="line"><span class="lineno"> 3619</span>  <span class="comment">// Loop over the parameters of interest</span></div>
<div class="line"><span class="lineno"> 3620</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a class="code hl_variable" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>; ++j)</div>
<div class="line"><span class="lineno"> 3621</span>  {</div>
<div class="line"><span class="lineno"> 3622</span>    <span class="comment">// Loop over each lag</span></div>
<div class="line"><span class="lineno"> 3623</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; nLags; ++k) {</div>
<div class="line"><span class="lineno"> 3624</span>      NumeratorSum[j][k] = 0.0;</div>
<div class="line"><span class="lineno"> 3625</span>      DenomSum[j][k] = 0.0;</div>
<div class="line"><span class="lineno"> 3626</span>      LagL[j][k] = 0.0;</div>
<div class="line"><span class="lineno"> 3627</span>    }</div>
<div class="line"><span class="lineno"> 3628</span> </div>
<div class="line"><span class="lineno"> 3629</span>    <span class="comment">// Make TH1Ds for each parameter which hold the lag</span></div>
<div class="line"><span class="lineno"> 3630</span>    TString Title = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><span class="lineno"> 3631</span>    <span class="keywordtype">double</span> Prior = 1.0;</div>
<div class="line"><span class="lineno"> 3632</span>    <span class="keywordtype">double</span> PriorError = 1.0;</div>
<div class="line"><span class="lineno"> 3633</span>    </div>
<div class="line"><span class="lineno"> 3634</span>    <a class="code hl_function" href="classMCMCProcessor.html#a28dfe42f1bf6fd3a145287be1e63fb0b">GetNthParameter</a>(j, Prior, PriorError, Title);</div>
<div class="line"><span class="lineno"> 3635</span>    std::string HistName = Form(<span class="stringliteral">&quot;%s_%s_Lag&quot;</span>, Title.Data(), <a class="code hl_variable" href="classMCMCProcessor.html#ad043b6b2c885f47ab9967831bc8d0f5a">BranchNames</a>[j].Data());</div>
<div class="line"><span class="lineno"> 3636</span>    LagKPlots[j] = <span class="keyword">new</span> TH1D(HistName.c_str(), HistName.c_str(), nLags, 0.0, nLags);</div>
<div class="line"><span class="lineno"> 3637</span>    LagKPlots[j]-&gt;GetXaxis()-&gt;SetTitle(<span class="stringliteral">&quot;Lag&quot;</span>);</div>
<div class="line"><span class="lineno"> 3638</span>    LagKPlots[j]-&gt;GetYaxis()-&gt;SetTitle(<span class="stringliteral">&quot;Auto-correlation function&quot;</span>);</div>
<div class="line"><span class="lineno"> 3639</span>  }</div>
<div class="line"><span class="lineno"> 3640</span><span class="comment">//KS: If CUDA is not enabled do calculations on CPU</span></div>
<div class="line"><span class="lineno"> 3641</span><span class="preprocessor">#ifndef CUDA</span></div>
<div class="line"><span class="lineno"> 3642</span>  <span class="comment">// Loop over the lags</span></div>
<div class="line"><span class="lineno"> 3643</span>  <span class="comment">//CW: Each lag is independent so might as well multi-thread them!</span></div>
<div class="line"><span class="lineno"> 3644</span><span class="preprocessor">  #ifdef MULTITHREAD</span></div>
<div class="line"><span class="lineno"> 3645</span>  <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Using multi-threading...&quot;</span>);</div>
<div class="line"><span class="lineno"> 3646</span><span class="preprocessor">  #pragma omp parallel for collapse(2)</span></div>
<div class="line"><span class="lineno"> 3647</span><span class="preprocessor">  #endif      </span><span class="comment">// Loop over the number of parameters</span></div>
<div class="line"><span class="lineno"> 3648</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a class="code hl_variable" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>; ++j) {</div>
<div class="line"><span class="lineno"> 3649</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; nLags; ++k) {</div>
<div class="line"><span class="lineno"> 3650</span>      <span class="comment">// Loop over the number of entries</span></div>
<div class="line"><span class="lineno"> 3651</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_variable" href="classMCMCProcessor.html#af3a19b885e9c34e1674aea8cfbe14e1c">nEntries</a>; ++i) {</div>
<div class="line"><span class="lineno"> 3652</span>        <span class="keyword">const</span> <span class="keywordtype">double</span> Diff = <a class="code hl_variable" href="classMCMCProcessor.html#a087dca88a306acdc28afea7213e3623c">ParStep</a>[j][i]-<a class="code hl_variable" href="classMCMCProcessor.html#a7db98c7cf390b050f1acb927b4f55cab">ParamSums</a>[j];</div>
<div class="line"><span class="lineno"> 3653</span> </div>
<div class="line"><span class="lineno"> 3654</span>        <span class="comment">// Only sum the numerator up to i = N-k</span></div>
<div class="line"><span class="lineno"> 3655</span>        <span class="keywordflow">if</span> (i &lt; <a class="code hl_variable" href="classMCMCProcessor.html#af3a19b885e9c34e1674aea8cfbe14e1c">nEntries</a>-k) {</div>
<div class="line"><span class="lineno"> 3656</span>          <span class="keyword">const</span> <span class="keywordtype">double</span> LagTerm = <a class="code hl_variable" href="classMCMCProcessor.html#a087dca88a306acdc28afea7213e3623c">ParStep</a>[j][i+k]-<a class="code hl_variable" href="classMCMCProcessor.html#a7db98c7cf390b050f1acb927b4f55cab">ParamSums</a>[j];</div>
<div class="line"><span class="lineno"> 3657</span>          <span class="keyword">const</span> <span class="keywordtype">double</span> Product = Diff*LagTerm;</div>
<div class="line"><span class="lineno"> 3658</span>          NumeratorSum[j][k] += Product;</div>
<div class="line"><span class="lineno"> 3659</span>        }</div>
<div class="line"><span class="lineno"> 3660</span>        <span class="comment">// Square the difference to form the denominator</span></div>
<div class="line"><span class="lineno"> 3661</span>        <span class="keyword">const</span> <span class="keywordtype">double</span> Denom = Diff*Diff;</div>
<div class="line"><span class="lineno"> 3662</span>        DenomSum[j][k] += Denom;</div>
<div class="line"><span class="lineno"> 3663</span>      }</div>
<div class="line"><span class="lineno"> 3664</span>    }</div>
<div class="line"><span class="lineno"> 3665</span>  }</div>
<div class="line"><span class="lineno"> 3666</span><span class="preprocessor">#else </span><span class="comment">//NOW GPU specific code</span></div>
<div class="line"><span class="lineno"> 3667</span>  <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Using GPU&quot;</span>);</div>
<div class="line"><span class="lineno"> 3668</span>  <span class="comment">//KS: This allocates memory and copy data from CPU to GPU</span></div>
<div class="line"><span class="lineno"> 3669</span>  PrepareGPU_AutoCorr(nLags);</div>
<div class="line"><span class="lineno"> 3670</span> </div>
<div class="line"><span class="lineno"> 3671</span>  <span class="comment">//KS: This runs the main kernel and copy results back to CPU</span></div>
<div class="line"><span class="lineno"> 3672</span>  <a class="code hl_function" href="gpuMCMCProcessorUtils_8cu.html#a809672193d24a096e6d4865109357070">RunGPU_AutoCorr</a>(</div>
<div class="line"><span class="lineno"> 3673</span>    ParStep_gpu,</div>
<div class="line"><span class="lineno"> 3674</span>    ParamSums_gpu,</div>
<div class="line"><span class="lineno"> 3675</span>    NumeratorSum_gpu,</div>
<div class="line"><span class="lineno"> 3676</span>    DenomSum_gpu,</div>
<div class="line"><span class="lineno"> 3677</span>    NumeratorSum_cpu,</div>
<div class="line"><span class="lineno"> 3678</span>    DenomSum_cpu);</div>
<div class="line"><span class="lineno"> 3679</span> </div>
<div class="line"><span class="lineno"> 3680</span><span class="preprocessor">  #ifdef MULTITHREAD</span></div>
<div class="line"><span class="lineno"> 3681</span><span class="preprocessor">  #pragma omp parallel for collapse(2)</span></div>
<div class="line"><span class="lineno"> 3682</span><span class="preprocessor">  #endif</span></div>
<div class="line"><span class="lineno"> 3683</span>  <span class="comment">//KS: Now that that we received data from GPU convert it to CPU-like format</span></div>
<div class="line"><span class="lineno"> 3684</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a class="code hl_variable" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>; ++j)</div>
<div class="line"><span class="lineno"> 3685</span>  {</div>
<div class="line"><span class="lineno"> 3686</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; nLags; ++k)</div>
<div class="line"><span class="lineno"> 3687</span>    {</div>
<div class="line"><span class="lineno"> 3688</span>      <span class="keyword">const</span> <span class="keywordtype">int</span> temp_index = j*nLags+k;</div>
<div class="line"><span class="lineno"> 3689</span>      NumeratorSum[j][k] = NumeratorSum_cpu[temp_index];</div>
<div class="line"><span class="lineno"> 3690</span>      DenomSum[j][k] = DenomSum_cpu[temp_index];</div>
<div class="line"><span class="lineno"> 3691</span>    }</div>
<div class="line"><span class="lineno"> 3692</span>  }</div>
<div class="line"><span class="lineno"> 3693</span>  <span class="comment">//delete auxiliary variables</span></div>
<div class="line"><span class="lineno"> 3694</span>  <span class="keyword">delete</span>[] NumeratorSum_cpu;</div>
<div class="line"><span class="lineno"> 3695</span>  <span class="keyword">delete</span>[] DenomSum_cpu;</div>
<div class="line"><span class="lineno"> 3696</span>  <span class="keyword">delete</span>[] ParStep_cpu;</div>
<div class="line"><span class="lineno"> 3697</span>  <span class="keyword">delete</span>[] ParamSums_cpu;</div>
<div class="line"><span class="lineno"> 3698</span> </div>
<div class="line"><span class="lineno"> 3699</span>  <span class="comment">//KS: Delete stuff at GPU as well</span></div>
<div class="line"><span class="lineno"> 3700</span>  <a class="code hl_function" href="gpuMCMCProcessorUtils_8cu.html#abb46837d774b5be81a6c601c762ab05a">CleanupGPU_AutoCorr</a>(</div>
<div class="line"><span class="lineno"> 3701</span>      ParStep_gpu,</div>
<div class="line"><span class="lineno"> 3702</span>      NumeratorSum_gpu,</div>
<div class="line"><span class="lineno"> 3703</span>      ParamSums_gpu,</div>
<div class="line"><span class="lineno"> 3704</span>      DenomSum_gpu);</div>
<div class="line"><span class="lineno"> 3705</span> </div>
<div class="line"><span class="lineno"> 3706</span><span class="comment">//KS: End of GPU specific code</span></div>
<div class="line"><span class="lineno"> 3707</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 3708</span> </div>
<div class="line"><span class="lineno"> 3709</span>  <a class="code hl_variable" href="classMCMCProcessor.html#a62035b99df4617ab334cd1abd6ed0346">OutputFile</a>-&gt;cd();</div>
<div class="line"><span class="lineno"> 3710</span>  TDirectory *AutoCorrDir = <a class="code hl_variable" href="classMCMCProcessor.html#a62035b99df4617ab334cd1abd6ed0346">OutputFile</a>-&gt;mkdir(<span class="stringliteral">&quot;Auto_corr&quot;</span>);</div>
<div class="line"><span class="lineno"> 3711</span>  <span class="comment">// Now fill the LagK auto-correlation plots</span></div>
<div class="line"><span class="lineno"> 3712</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a class="code hl_variable" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>; ++j) {</div>
<div class="line"><span class="lineno"> 3713</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; nLags; ++k) {</div>
<div class="line"><span class="lineno"> 3714</span>      LagL[j][k] = NumeratorSum[j][k]/DenomSum[j][k];</div>
<div class="line"><span class="lineno"> 3715</span>      LagKPlots[j]-&gt;SetBinContent(k, NumeratorSum[j][k]/DenomSum[j][k]);</div>
<div class="line"><span class="lineno"> 3716</span>    }</div>
<div class="line"><span class="lineno"> 3717</span>    AutoCorrDir-&gt;cd();</div>
<div class="line"><span class="lineno"> 3718</span>    LagKPlots[j]-&gt;Write();</div>
<div class="line"><span class="lineno"> 3719</span>    <span class="keyword">delete</span> LagKPlots[j];</div>
<div class="line"><span class="lineno"> 3720</span>  }</div>
<div class="line"><span class="lineno"> 3721</span> </div>
<div class="line"><span class="lineno"> 3722</span>  <span class="comment">//KS: This is different diagnostic however it relies on calculated Lag, thus we call it before we delete LagKPlots</span></div>
<div class="line"><span class="lineno"> 3723</span>  <a class="code hl_function" href="classMCMCProcessor.html#a1eb6f27c2fb967326dc14dc3dcdc3957">CalculateESS</a>(nLags, LagL);</div>
<div class="line"><span class="lineno"> 3724</span> </div>
<div class="line"><span class="lineno"> 3725</span>  <span class="keyword">delete</span>[] <a class="code hl_variable" href="classMCMCProcessor.html#a7db98c7cf390b050f1acb927b4f55cab">ParamSums</a>;</div>
<div class="line"><span class="lineno"> 3726</span> </div>
<div class="line"><span class="lineno"> 3727</span>  AutoCorrDir-&gt;Close();</div>
<div class="line"><span class="lineno"> 3728</span>  <span class="keyword">delete</span> AutoCorrDir;</div>
<div class="line"><span class="lineno"> 3729</span> </div>
<div class="line"><span class="lineno"> 3730</span>  <a class="code hl_variable" href="classMCMCProcessor.html#a62035b99df4617ab334cd1abd6ed0346">OutputFile</a>-&gt;cd();</div>
<div class="line"><span class="lineno"> 3731</span> </div>
<div class="line"><span class="lineno"> 3732</span>  clock.Stop();</div>
<div class="line"><span class="lineno"> 3733</span>  <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Making auto-correlations took {:.2f}s&quot;</span>, clock.RealTime());</div>
<div class="line"><span class="lineno"> 3734</span>}</div>
<div class="ttc" id="aclassMCMCProcessor_html_a1eb6f27c2fb967326dc14dc3dcdc3957"><div class="ttname"><a href="classMCMCProcessor.html#a1eb6f27c2fb967326dc14dc3dcdc3957">MCMCProcessor::CalculateESS</a></div><div class="ttdeci">void CalculateESS(const int nLags, const std::vector&lt; std::vector&lt; double &gt; &gt; &amp;LagL)</div><div class="ttdoc">KS: calc Effective Sample Size.</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8cpp_source.html#l03821">MCMCProcessor.cpp:3821</a></div></div>
<div class="ttc" id="aclassMCMCProcessor_html_a28dfe42f1bf6fd3a145287be1e63fb0b"><div class="ttname"><a href="classMCMCProcessor.html#a28dfe42f1bf6fd3a145287be1e63fb0b">MCMCProcessor::GetNthParameter</a></div><div class="ttdeci">void GetNthParameter(const int param, double &amp;Prior, double &amp;PriorError, TString &amp;Title)</div><div class="ttdoc">Get properties of parameter by passing it number.</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8cpp_source.html#l02695">MCMCProcessor.cpp:2695</a></div></div>
<div class="ttc" id="aclassMCMCProcessor_html_ad043b6b2c885f47ab9967831bc8d0f5a"><div class="ttname"><a href="classMCMCProcessor.html#ad043b6b2c885f47ab9967831bc8d0f5a">MCMCProcessor::BranchNames</a></div><div class="ttdeci">std::vector&lt; TString &gt; BranchNames</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8h_source.html#l00355">MCMCProcessor.h:355</a></div></div>
<div class="ttc" id="agpuMCMCProcessorUtils_8cu_html_a809672193d24a096e6d4865109357070"><div class="ttname"><a href="gpuMCMCProcessorUtils_8cu.html#a809672193d24a096e6d4865109357070">RunGPU_AutoCorr</a></div><div class="ttdeci">__host__ void RunGPU_AutoCorr(float *ParStep_gpu, float *ParamSums_gpu, float *NumeratorSum_gpu, float *DenomSum_gpu, float *NumeratorSum_cpu, float *DenomSum_cpu)</div><div class="ttdoc">KS: This call the main kernel responsible for calculating LagL and later copy results back to CPU.</div><div class="ttdef"><b>Definition:</b> <a href="gpuMCMCProcessorUtils_8cu_source.html#l00163">gpuMCMCProcessorUtils.cu:163</a></div></div>
<div class="ttc" id="agpuMCMCProcessorUtils_8cu_html_abb46837d774b5be81a6c601c762ab05a"><div class="ttname"><a href="gpuMCMCProcessorUtils_8cu.html#abb46837d774b5be81a6c601c762ab05a">CleanupGPU_AutoCorr</a></div><div class="ttdeci">__host__ void CleanupGPU_AutoCorr(float *ParStep_gpu, float *NumeratorSum_gpu, float *ParamSums_gpu, float *DenomSum_gpu)</div><div class="ttdoc">KS: free memory on gpu.</div><div class="ttdef"><b>Definition:</b> <a href="gpuMCMCProcessorUtils_8cu_source.html#l00201">gpuMCMCProcessorUtils.cu:201</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="abeb5e115fa9f58ea7872af5cf13c6b79" name="abeb5e115fa9f58ea7872af5cf13c6b79"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abeb5e115fa9f58ea7872af5cf13c6b79">&#9670;&#160;</a></span>AutoCorrelation_FFT()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void MCMCProcessor::AutoCorrelation_FFT </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>MJR: Autocorrelation function using FFT algorithm for extra speed. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8cpp_source.html#l03496">3496</a> of file <a class="el" href="MCMCProcessor_8cpp_source.html">MCMCProcessor.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3496</span>                                        {</div>
<div class="line"><span class="lineno"> 3497</span><span class="comment">// *********************************</span></div>
<div class="line"><span class="lineno"> 3498</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="classMCMCProcessor.html#a087dca88a306acdc28afea7213e3623c">ParStep</a> == <span class="keyword">nullptr</span>) <a class="code hl_function" href="classMCMCProcessor.html#a930cadafa41b31b58066dea68628de9f">PrepareDiagMCMC</a>();</div>
<div class="line"><span class="lineno"> 3499</span> </div>
<div class="line"><span class="lineno"> 3500</span>  TStopwatch clock;</div>
<div class="line"><span class="lineno"> 3501</span>  clock.Start();</div>
<div class="line"><span class="lineno"> 3502</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> nLags = <a class="code hl_variable" href="classMCMCProcessor.html#a6156bba72e1f076e66f0356e48506a36">AutoCorrLag</a>;</div>
<div class="line"><span class="lineno"> 3503</span>  <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Making auto-correlations for nLags = {}&quot;</span>, nLags);</div>
<div class="line"><span class="lineno"> 3504</span> </div>
<div class="line"><span class="lineno"> 3505</span>  <span class="comment">// Prep outputs</span></div>
<div class="line"><span class="lineno"> 3506</span>  <a class="code hl_variable" href="classMCMCProcessor.html#a62035b99df4617ab334cd1abd6ed0346">OutputFile</a>-&gt;cd();</div>
<div class="line"><span class="lineno"> 3507</span>  TDirectory* AutoCorrDir = <a class="code hl_variable" href="classMCMCProcessor.html#a62035b99df4617ab334cd1abd6ed0346">OutputFile</a>-&gt;mkdir(<span class="stringliteral">&quot;Auto_corr&quot;</span>);</div>
<div class="line"><span class="lineno"> 3508</span>  std::vector&lt;TH1D*&gt; LagKPlots(<a class="code hl_variable" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>);</div>
<div class="line"><span class="lineno"> 3509</span>  std::vector&lt;std::vector&lt;double&gt;&gt; LagL(<a class="code hl_variable" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>);</div>
<div class="line"><span class="lineno"> 3510</span> </div>
<div class="line"><span class="lineno"> 3511</span>  <span class="comment">// Arrays needed to perform FFT using ROOT</span></div>
<div class="line"><span class="lineno"> 3512</span>  <span class="keywordtype">double</span>* ACFFT = <span class="keyword">new</span> <span class="keywordtype">double</span>[<a class="code hl_variable" href="classMCMCProcessor.html#af3a19b885e9c34e1674aea8cfbe14e1c">nEntries</a>](); <span class="comment">// Main autocorrelation array</span></div>
<div class="line"><span class="lineno"> 3513</span>  <span class="keywordtype">double</span>* ParVals = <span class="keyword">new</span> <span class="keywordtype">double</span>[<a class="code hl_variable" href="classMCMCProcessor.html#af3a19b885e9c34e1674aea8cfbe14e1c">nEntries</a>](); <span class="comment">// Param values for full chain</span></div>
<div class="line"><span class="lineno"> 3514</span>  <span class="keywordtype">double</span>* ParValsFFTR = <span class="keyword">new</span> <span class="keywordtype">double</span>[<a class="code hl_variable" href="classMCMCProcessor.html#af3a19b885e9c34e1674aea8cfbe14e1c">nEntries</a>](); <span class="comment">// FFT Real part</span></div>
<div class="line"><span class="lineno"> 3515</span>  <span class="keywordtype">double</span>* ParValsFFTI = <span class="keyword">new</span> <span class="keywordtype">double</span>[<a class="code hl_variable" href="classMCMCProcessor.html#af3a19b885e9c34e1674aea8cfbe14e1c">nEntries</a>](); <span class="comment">// FFT Imaginary part</span></div>
<div class="line"><span class="lineno"> 3516</span>  <span class="keywordtype">double</span>* ParValsFFTSquare = <span class="keyword">new</span> <span class="keywordtype">double</span>[<a class="code hl_variable" href="classMCMCProcessor.html#af3a19b885e9c34e1674aea8cfbe14e1c">nEntries</a>](); <span class="comment">// FFT Absolute square</span></div>
<div class="line"><span class="lineno"> 3517</span>  <span class="keywordtype">double</span>* ParValsComplex = <span class="keyword">new</span> <span class="keywordtype">double</span>[<a class="code hl_variable" href="classMCMCProcessor.html#af3a19b885e9c34e1674aea8cfbe14e1c">nEntries</a>](); <span class="comment">// Input Imaginary values (0)</span></div>
<div class="line"><span class="lineno"> 3518</span> </div>
<div class="line"><span class="lineno"> 3519</span>  <span class="comment">// Create forward and reverse FFT objects. I don&#39;t love using ROOT here,</span></div>
<div class="line"><span class="lineno"> 3520</span>  <span class="comment">// but it works so I can&#39;t complain</span></div>
<div class="line"><span class="lineno"> 3521</span>  TVirtualFFT* fftf = TVirtualFFT::FFT(1, &amp;<a class="code hl_variable" href="classMCMCProcessor.html#af3a19b885e9c34e1674aea8cfbe14e1c">nEntries</a>, <span class="stringliteral">&quot;C2CFORWARD&quot;</span>);</div>
<div class="line"><span class="lineno"> 3522</span>  TVirtualFFT* fftb = TVirtualFFT::FFT(1, &amp;<a class="code hl_variable" href="classMCMCProcessor.html#af3a19b885e9c34e1674aea8cfbe14e1c">nEntries</a>, <span class="stringliteral">&quot;C2CBACKWARD&quot;</span>);</div>
<div class="line"><span class="lineno"> 3523</span> </div>
<div class="line"><span class="lineno"> 3524</span>  <span class="comment">// Loop over all pars and calculate the full autocorrelation function using FFT</span></div>
<div class="line"><span class="lineno"> 3525</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a class="code hl_variable" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>; ++j) {</div>
<div class="line"><span class="lineno"> 3526</span>    <span class="comment">// Initialize</span></div>
<div class="line"><span class="lineno"> 3527</span>    LagL[j].resize(nLags);</div>
<div class="line"><span class="lineno"> 3528</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_variable" href="classMCMCProcessor.html#af3a19b885e9c34e1674aea8cfbe14e1c">nEntries</a>; ++i) {</div>
<div class="line"><span class="lineno"> 3529</span>      ParVals[i] = <a class="code hl_variable" href="classMCMCProcessor.html#a087dca88a306acdc28afea7213e3623c">ParStep</a>[j][i]-<a class="code hl_variable" href="classMCMCProcessor.html#a7db98c7cf390b050f1acb927b4f55cab">ParamSums</a>[j]; <span class="comment">// Subtract the mean to make it numerically tractable</span></div>
<div class="line"><span class="lineno"> 3530</span>      ParValsComplex[i] = 0.; <span class="comment">// Reset dummy array</span></div>
<div class="line"><span class="lineno"> 3531</span>    }</div>
<div class="line"><span class="lineno"> 3532</span> </div>
<div class="line"><span class="lineno"> 3533</span>    <span class="comment">// Transform</span></div>
<div class="line"><span class="lineno"> 3534</span>    fftf-&gt;SetPointsComplex(ParVals, ParValsComplex);</div>
<div class="line"><span class="lineno"> 3535</span>    fftf-&gt;Transform();</div>
<div class="line"><span class="lineno"> 3536</span>    fftf-&gt;GetPointsComplex(ParValsFFTR, ParValsFFTI);</div>
<div class="line"><span class="lineno"> 3537</span> </div>
<div class="line"><span class="lineno"> 3538</span>    <span class="comment">// Square the results to get the power spectrum</span></div>
<div class="line"><span class="lineno"> 3539</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_variable" href="classMCMCProcessor.html#af3a19b885e9c34e1674aea8cfbe14e1c">nEntries</a>; ++i) {</div>
<div class="line"><span class="lineno"> 3540</span>      ParValsFFTSquare[i] = ParValsFFTR[i]*ParValsFFTR[i] + ParValsFFTI[i]*ParValsFFTI[i];</div>
<div class="line"><span class="lineno"> 3541</span>    }</div>
<div class="line"><span class="lineno"> 3542</span> </div>
<div class="line"><span class="lineno"> 3543</span>    <span class="comment">// Transforming back gives the autocovariance</span></div>
<div class="line"><span class="lineno"> 3544</span>    fftb-&gt;SetPointsComplex(ParValsFFTSquare, ParValsComplex);</div>
<div class="line"><span class="lineno"> 3545</span>    fftb-&gt;Transform();</div>
<div class="line"><span class="lineno"> 3546</span>    fftb-&gt;GetPointsComplex(ACFFT, ParValsComplex);</div>
<div class="line"><span class="lineno"> 3547</span> </div>
<div class="line"><span class="lineno"> 3548</span>    <span class="comment">// Divide by norm to get autocorrelation</span></div>
<div class="line"><span class="lineno"> 3549</span>    <span class="keywordtype">double</span> normAC = ACFFT[0];</div>
<div class="line"><span class="lineno"> 3550</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_variable" href="classMCMCProcessor.html#af3a19b885e9c34e1674aea8cfbe14e1c">nEntries</a>; ++i) {</div>
<div class="line"><span class="lineno"> 3551</span>      ACFFT[i] /= normAC;</div>
<div class="line"><span class="lineno"> 3552</span>    }</div>
<div class="line"><span class="lineno"> 3553</span> </div>
<div class="line"><span class="lineno"> 3554</span>    <span class="comment">// Get plotting info</span></div>
<div class="line"><span class="lineno"> 3555</span>    TString Title = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><span class="lineno"> 3556</span>    <span class="keywordtype">double</span> Prior = 1.0;</div>
<div class="line"><span class="lineno"> 3557</span>    <span class="keywordtype">double</span> PriorError = 1.0;</div>
<div class="line"><span class="lineno"> 3558</span>    <a class="code hl_function" href="classMCMCProcessor.html#a28dfe42f1bf6fd3a145287be1e63fb0b">GetNthParameter</a>(j, Prior, PriorError, Title);</div>
<div class="line"><span class="lineno"> 3559</span>    std::string HistName = Form(<span class="stringliteral">&quot;%s_%s_Lag&quot;</span>, Title.Data(), <a class="code hl_variable" href="classMCMCProcessor.html#ad043b6b2c885f47ab9967831bc8d0f5a">BranchNames</a>[j].Data());</div>
<div class="line"><span class="lineno"> 3560</span> </div>
<div class="line"><span class="lineno"> 3561</span>    <span class="comment">// Initialize Lag plot</span></div>
<div class="line"><span class="lineno"> 3562</span>    LagKPlots[j] = <span class="keyword">new</span> TH1D(HistName.c_str(), HistName.c_str(), nLags, 0.0, nLags);</div>
<div class="line"><span class="lineno"> 3563</span>    LagKPlots[j]-&gt;GetXaxis()-&gt;SetTitle(<span class="stringliteral">&quot;Lag&quot;</span>);</div>
<div class="line"><span class="lineno"> 3564</span>    LagKPlots[j]-&gt;GetYaxis()-&gt;SetTitle(<span class="stringliteral">&quot;Auto-correlation function&quot;</span>);</div>
<div class="line"><span class="lineno"> 3565</span> </div>
<div class="line"><span class="lineno"> 3566</span>    <span class="comment">// Fill plot</span></div>
<div class="line"><span class="lineno"> 3567</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; nLags; ++k) {</div>
<div class="line"><span class="lineno"> 3568</span>      LagL[j][k] = ACFFT[k];</div>
<div class="line"><span class="lineno"> 3569</span>      LagKPlots[j]-&gt;SetBinContent(k, ACFFT[k]);</div>
<div class="line"><span class="lineno"> 3570</span>    }</div>
<div class="line"><span class="lineno"> 3571</span> </div>
<div class="line"><span class="lineno"> 3572</span>    <span class="comment">// Write and clean up</span></div>
<div class="line"><span class="lineno"> 3573</span>    AutoCorrDir-&gt;cd();</div>
<div class="line"><span class="lineno"> 3574</span>    LagKPlots[j]-&gt;Write();</div>
<div class="line"><span class="lineno"> 3575</span>    <span class="keyword">delete</span> LagKPlots[j];</div>
<div class="line"><span class="lineno"> 3576</span>  }</div>
<div class="line"><span class="lineno"> 3577</span> </div>
<div class="line"><span class="lineno"> 3578</span>  <span class="comment">//KS: This is different diagnostic however it relies on calculated Lag, thus we call it before we delete LagKPlots</span></div>
<div class="line"><span class="lineno"> 3579</span>  <a class="code hl_function" href="classMCMCProcessor.html#a1eb6f27c2fb967326dc14dc3dcdc3957">CalculateESS</a>(nLags, LagL);</div>
<div class="line"><span class="lineno"> 3580</span> </div>
<div class="line"><span class="lineno"> 3581</span>  <span class="comment">// Clean up</span></div>
<div class="line"><span class="lineno"> 3582</span>  <span class="keyword">delete</span>[] ACFFT;</div>
<div class="line"><span class="lineno"> 3583</span>  <span class="keyword">delete</span>[] ParVals;</div>
<div class="line"><span class="lineno"> 3584</span>  <span class="keyword">delete</span>[] ParValsFFTR;</div>
<div class="line"><span class="lineno"> 3585</span>  <span class="keyword">delete</span>[] ParValsFFTI;</div>
<div class="line"><span class="lineno"> 3586</span>  <span class="keyword">delete</span>[] ParValsFFTSquare;</div>
<div class="line"><span class="lineno"> 3587</span>  <span class="keyword">delete</span>[] ParValsComplex;</div>
<div class="line"><span class="lineno"> 3588</span> </div>
<div class="line"><span class="lineno"> 3589</span>  AutoCorrDir-&gt;Close();</div>
<div class="line"><span class="lineno"> 3590</span>  <span class="keyword">delete</span> AutoCorrDir;</div>
<div class="line"><span class="lineno"> 3591</span> </div>
<div class="line"><span class="lineno"> 3592</span>  <a class="code hl_variable" href="classMCMCProcessor.html#a62035b99df4617ab334cd1abd6ed0346">OutputFile</a>-&gt;cd();</div>
<div class="line"><span class="lineno"> 3593</span> </div>
<div class="line"><span class="lineno"> 3594</span>  clock.Stop();</div>
<div class="line"><span class="lineno"> 3595</span>  <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Making auto-correlations took {:.2f}s&quot;</span>, clock.RealTime());</div>
<div class="line"><span class="lineno"> 3596</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a29d492906e0c027d089331a0509cd2c3" name="a29d492906e0c027d089331a0509cd2c3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a29d492906e0c027d089331a0509cd2c3">&#9670;&#160;</a></span>BatchedAnalysis()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void MCMCProcessor::BatchedAnalysis </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get the batched means variance estimation and variable indicating if number of batches is sensible <a class="el" href="citelist.html#CITEREF_chakraborty2019estimating">[2]</a> <a class="el" href="citelist.html#CITEREF_rossetti2024batch">[16]</a>. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8cpp_source.html#l03983">3983</a> of file <a class="el" href="MCMCProcessor_8cpp_source.html">MCMCProcessor.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3983</span>                                    {</div>
<div class="line"><span class="lineno"> 3984</span><span class="comment">// **************************</span></div>
<div class="line"><span class="lineno"> 3985</span>  <span class="keywordflow">if</span>(<a class="code hl_variable" href="classMCMCProcessor.html#ab3f590b501162fc2ee5b78ce75689771">BatchedAverages</a> == <span class="keyword">nullptr</span>)</div>
<div class="line"><span class="lineno"> 3986</span>  {</div>
<div class="line"><span class="lineno"> 3987</span>    <a class="code hl_define" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;BatchedAverages haven&#39;t been initialises or have been deleted something is wrong&quot;</span>);</div>
<div class="line"><span class="lineno"> 3988</span>    <a class="code hl_define" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;I need it and refuse to go further&quot;</span>);</div>
<div class="line"><span class="lineno"> 3989</span>    <span class="keywordflow">throw</span> <a class="code hl_class" href="classMaCh3Exception.html">MaCh3Exception</a>(__FILE__ , __LINE__ );</div>
<div class="line"><span class="lineno"> 3990</span>  }</div>
<div class="line"><span class="lineno"> 3991</span> </div>
<div class="line"><span class="lineno"> 3992</span>  <span class="comment">// Calculate variance estimator using batched means following @cite chakraborty2019estimating see Eq. 1.2</span></div>
<div class="line"><span class="lineno"> 3993</span>  TVectorD* BatchedVariance = <span class="keyword">new</span> TVectorD(<a class="code hl_variable" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>);</div>
<div class="line"><span class="lineno"> 3994</span>  <span class="comment">//KS: The hypothesis is rejected if C &gt; z  for a given confidence level . If the batch means do not pass the test, Correlated is reported for the half-width on the statistical reports following @cite rossetti2024batch alternatively for more old-school see Alexopoulos and Seila 1998 section 3.4.3</span></div>
<div class="line"><span class="lineno"> 3995</span>  TVectorD* C_Test_Statistics = <span class="keyword">new</span> TVectorD(<a class="code hl_variable" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>);</div>
<div class="line"><span class="lineno"> 3996</span> </div>
<div class="line"><span class="lineno"> 3997</span>  std::vector&lt;double&gt; OverallBatchMean(<a class="code hl_variable" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>);</div>
<div class="line"><span class="lineno"> 3998</span>  std::vector&lt;double&gt; C_Rho_Nominator(<a class="code hl_variable" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>);</div>
<div class="line"><span class="lineno"> 3999</span>  std::vector&lt;double&gt; C_Rho_Denominator(<a class="code hl_variable" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>);</div>
<div class="line"><span class="lineno"> 4000</span>  std::vector&lt;double&gt; C_Nominator(<a class="code hl_variable" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>);</div>
<div class="line"><span class="lineno"> 4001</span>  std::vector&lt;double&gt; C_Denominator(<a class="code hl_variable" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>);</div>
<div class="line"><span class="lineno"> 4002</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> BatchLength = <a class="code hl_variable" href="classMCMCProcessor.html#af3a19b885e9c34e1674aea8cfbe14e1c">nEntries</a>/<a class="code hl_variable" href="classMCMCProcessor.html#a02c5a3f849cf217705816c650c678d19">nBatches</a>+1;</div>
<div class="line"><span class="lineno"> 4003</span><span class="comment">//KS: Start parallel region</span></div>
<div class="line"><span class="lineno"> 4004</span><span class="preprocessor">#ifdef MULTITHREAD</span></div>
<div class="line"><span class="lineno"> 4005</span><span class="preprocessor">#pragma omp parallel</span></div>
<div class="line"><span class="lineno"> 4006</span>{</div>
<div class="line"><span class="lineno"> 4007</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 4008</span><span class="preprocessor">  #ifdef MULTITHREAD</span></div>
<div class="line"><span class="lineno"> 4009</span><span class="preprocessor">  #pragma omp for</span></div>
<div class="line"><span class="lineno"> 4010</span><span class="preprocessor">  #endif</span></div>
<div class="line"><span class="lineno"> 4011</span>  <span class="comment">//KS: First calculate mean of batched means for each param and Initialise everything to 0</span></div>
<div class="line"><span class="lineno"> 4012</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a class="code hl_variable" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>; ++j)</div>
<div class="line"><span class="lineno"> 4013</span>  {</div>
<div class="line"><span class="lineno"> 4014</span>    OverallBatchMean[j] = 0.0;</div>
<div class="line"><span class="lineno"> 4015</span>    C_Rho_Nominator[j] = 0.0;</div>
<div class="line"><span class="lineno"> 4016</span>    C_Rho_Denominator[j] = 0.0;</div>
<div class="line"><span class="lineno"> 4017</span>    C_Nominator[j] = 0.0;</div>
<div class="line"><span class="lineno"> 4018</span>    C_Denominator[j] = 0.0;</div>
<div class="line"><span class="lineno"> 4019</span> </div>
<div class="line"><span class="lineno"> 4020</span>    (*BatchedVariance)(j) = 0.0;</div>
<div class="line"><span class="lineno"> 4021</span>    (*C_Test_Statistics)(j) = 0.0;</div>
<div class="line"><span class="lineno"> 4022</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_variable" href="classMCMCProcessor.html#a02c5a3f849cf217705816c650c678d19">nBatches</a>; ++i)</div>
<div class="line"><span class="lineno"> 4023</span>    {</div>
<div class="line"><span class="lineno"> 4024</span>      OverallBatchMean[j] += <a class="code hl_variable" href="classMCMCProcessor.html#ab3f590b501162fc2ee5b78ce75689771">BatchedAverages</a>[i][j];</div>
<div class="line"><span class="lineno"> 4025</span>    }</div>
<div class="line"><span class="lineno"> 4026</span>    OverallBatchMean[j] /= <a class="code hl_variable" href="classMCMCProcessor.html#a02c5a3f849cf217705816c650c678d19">nBatches</a>;</div>
<div class="line"><span class="lineno"> 4027</span>  }</div>
<div class="line"><span class="lineno"> 4028</span> </div>
<div class="line"><span class="lineno"> 4029</span><span class="preprocessor">  #ifdef MULTITHREAD</span></div>
<div class="line"><span class="lineno"> 4030</span><span class="preprocessor">  #pragma omp for nowait</span></div>
<div class="line"><span class="lineno"> 4031</span><span class="preprocessor">  #endif</span></div>
<div class="line"><span class="lineno"> 4032</span>  <span class="comment">//KS: next loop is completely independent thus nowait clause</span></div>
<div class="line"><span class="lineno"> 4033</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a class="code hl_variable" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>; ++j)</div>
<div class="line"><span class="lineno"> 4034</span>  {</div>
<div class="line"><span class="lineno"> 4035</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_variable" href="classMCMCProcessor.html#a02c5a3f849cf217705816c650c678d19">nBatches</a>; ++i)</div>
<div class="line"><span class="lineno"> 4036</span>    {</div>
<div class="line"><span class="lineno"> 4037</span>      (*BatchedVariance)(j) += (OverallBatchMean[j] - <a class="code hl_variable" href="classMCMCProcessor.html#ab3f590b501162fc2ee5b78ce75689771">BatchedAverages</a>[i][j])*(OverallBatchMean[j] - <a class="code hl_variable" href="classMCMCProcessor.html#ab3f590b501162fc2ee5b78ce75689771">BatchedAverages</a>[i][j]);</div>
<div class="line"><span class="lineno"> 4038</span>    }</div>
<div class="line"><span class="lineno"> 4039</span>    (*BatchedVariance)(j) = (BatchLength/(<a class="code hl_variable" href="classMCMCProcessor.html#a02c5a3f849cf217705816c650c678d19">nBatches</a>-1))* (*BatchedVariance)(j);</div>
<div class="line"><span class="lineno"> 4040</span>  }</div>
<div class="line"><span class="lineno"> 4041</span>  </div>
<div class="line"><span class="lineno"> 4042</span>  <span class="comment">//KS: Now we focus on C test statistic, again use nowait as next is calculation is independent</span></div>
<div class="line"><span class="lineno"> 4043</span><span class="preprocessor">  #ifdef MULTITHREAD</span></div>
<div class="line"><span class="lineno"> 4044</span><span class="preprocessor">  #pragma omp for nowait</span></div>
<div class="line"><span class="lineno"> 4045</span><span class="preprocessor">  #endif</span></div>
<div class="line"><span class="lineno"> 4046</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a class="code hl_variable" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>; ++j)</div>
<div class="line"><span class="lineno"> 4047</span>  {</div>
<div class="line"><span class="lineno"> 4048</span>    C_Nominator[j] = (OverallBatchMean[j] - <a class="code hl_variable" href="classMCMCProcessor.html#ab3f590b501162fc2ee5b78ce75689771">BatchedAverages</a>[0][j])*(OverallBatchMean[j] - <a class="code hl_variable" href="classMCMCProcessor.html#ab3f590b501162fc2ee5b78ce75689771">BatchedAverages</a>[0][j]) + </div>
<div class="line"><span class="lineno"> 4049</span>                      (OverallBatchMean[j] - <a class="code hl_variable" href="classMCMCProcessor.html#ab3f590b501162fc2ee5b78ce75689771">BatchedAverages</a>[<a class="code hl_variable" href="classMCMCProcessor.html#a02c5a3f849cf217705816c650c678d19">nBatches</a>-1][j])*(OverallBatchMean[j] - <a class="code hl_variable" href="classMCMCProcessor.html#ab3f590b501162fc2ee5b78ce75689771">BatchedAverages</a>[<a class="code hl_variable" href="classMCMCProcessor.html#a02c5a3f849cf217705816c650c678d19">nBatches</a>-1][j]);</div>
<div class="line"><span class="lineno"> 4050</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_variable" href="classMCMCProcessor.html#a02c5a3f849cf217705816c650c678d19">nBatches</a>; ++i)</div>
<div class="line"><span class="lineno"> 4051</span>    {</div>
<div class="line"><span class="lineno"> 4052</span>      C_Denominator[j] += (OverallBatchMean[j] - <a class="code hl_variable" href="classMCMCProcessor.html#ab3f590b501162fc2ee5b78ce75689771">BatchedAverages</a>[i][j])*(OverallBatchMean[j] - <a class="code hl_variable" href="classMCMCProcessor.html#ab3f590b501162fc2ee5b78ce75689771">BatchedAverages</a>[i][j]);</div>
<div class="line"><span class="lineno"> 4053</span>    }</div>
<div class="line"><span class="lineno"> 4054</span>    C_Denominator[j] = 2*C_Denominator[j];</div>
<div class="line"><span class="lineno"> 4055</span>  }</div>
<div class="line"><span class="lineno"> 4056</span>  </div>
<div class="line"><span class="lineno"> 4057</span>  <span class="comment">//KS: We still calculate C and for this we need rho wee need autocorrelations between batches</span></div>
<div class="line"><span class="lineno"> 4058</span><span class="preprocessor">  #ifdef MULTITHREAD</span></div>
<div class="line"><span class="lineno"> 4059</span><span class="preprocessor">  #pragma omp for</span></div>
<div class="line"><span class="lineno"> 4060</span><span class="preprocessor">  #endif</span></div>
<div class="line"><span class="lineno"> 4061</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a class="code hl_variable" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>; ++j)</div>
<div class="line"><span class="lineno"> 4062</span>  {</div>
<div class="line"><span class="lineno"> 4063</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_variable" href="classMCMCProcessor.html#a02c5a3f849cf217705816c650c678d19">nBatches</a>-1; ++i)</div>
<div class="line"><span class="lineno"> 4064</span>    {</div>
<div class="line"><span class="lineno"> 4065</span>      C_Rho_Nominator[j] += (OverallBatchMean[j] - <a class="code hl_variable" href="classMCMCProcessor.html#ab3f590b501162fc2ee5b78ce75689771">BatchedAverages</a>[i][j])*(OverallBatchMean[j] - <a class="code hl_variable" href="classMCMCProcessor.html#ab3f590b501162fc2ee5b78ce75689771">BatchedAverages</a>[i+1][j]);</div>
<div class="line"><span class="lineno"> 4066</span>    }</div>
<div class="line"><span class="lineno"> 4067</span>    </div>
<div class="line"><span class="lineno"> 4068</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_variable" href="classMCMCProcessor.html#a02c5a3f849cf217705816c650c678d19">nBatches</a>; ++i)</div>
<div class="line"><span class="lineno"> 4069</span>    {</div>
<div class="line"><span class="lineno"> 4070</span>      C_Rho_Denominator[j] += (OverallBatchMean[j] - <a class="code hl_variable" href="classMCMCProcessor.html#ab3f590b501162fc2ee5b78ce75689771">BatchedAverages</a>[i][j])*(OverallBatchMean[j] - <a class="code hl_variable" href="classMCMCProcessor.html#ab3f590b501162fc2ee5b78ce75689771">BatchedAverages</a>[i][j]);</div>
<div class="line"><span class="lineno"> 4071</span>    }</div>
<div class="line"><span class="lineno"> 4072</span>  }</div>
<div class="line"><span class="lineno"> 4073</span>  </div>
<div class="line"><span class="lineno"> 4074</span>  <span class="comment">//KS: Final calculations of C</span></div>
<div class="line"><span class="lineno"> 4075</span><span class="preprocessor">  #ifdef MULTITHREAD</span></div>
<div class="line"><span class="lineno"> 4076</span><span class="preprocessor">  #pragma omp for</span></div>
<div class="line"><span class="lineno"> 4077</span><span class="preprocessor">  #endif</span></div>
<div class="line"><span class="lineno"> 4078</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a class="code hl_variable" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>; ++j)</div>
<div class="line"><span class="lineno"> 4079</span>  {</div>
<div class="line"><span class="lineno"> 4080</span>    (*C_Test_Statistics)(j) = std::sqrt((<a class="code hl_variable" href="classMCMCProcessor.html#a02c5a3f849cf217705816c650c678d19">nBatches</a>*<a class="code hl_variable" href="classMCMCProcessor.html#a02c5a3f849cf217705816c650c678d19">nBatches</a> - 1)/(<a class="code hl_variable" href="classMCMCProcessor.html#a02c5a3f849cf217705816c650c678d19">nBatches</a>-2)) * ( C_Rho_Nominator[j]/C_Rho_Denominator[j] + C_Nominator[j]/ C_Denominator[j]);</div>
<div class="line"><span class="lineno"> 4081</span>  }</div>
<div class="line"><span class="lineno"> 4082</span><span class="preprocessor">#ifdef MULTITHREAD</span></div>
<div class="line"><span class="lineno"> 4083</span>} <span class="comment">//End parallel region</span></div>
<div class="line"><span class="lineno"> 4084</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 4085</span> </div>
<div class="line"><span class="lineno"> 4086</span>  <span class="comment">//Save to file</span></div>
<div class="line"><span class="lineno"> 4087</span>  <a class="code hl_variable" href="classMCMCProcessor.html#a62035b99df4617ab334cd1abd6ed0346">OutputFile</a>-&gt;cd();</div>
<div class="line"><span class="lineno"> 4088</span>  BatchedVariance-&gt;Write(<span class="stringliteral">&quot;BatchedMeansVariance&quot;</span>);</div>
<div class="line"><span class="lineno"> 4089</span>  C_Test_Statistics-&gt;Write(<span class="stringliteral">&quot;C_Test_Statistics&quot;</span>);</div>
<div class="line"><span class="lineno"> 4090</span> </div>
<div class="line"><span class="lineno"> 4091</span>  <span class="comment">//Delete all variables</span></div>
<div class="line"><span class="lineno"> 4092</span>  <span class="keyword">delete</span> BatchedVariance;</div>
<div class="line"><span class="lineno"> 4093</span>  <span class="keyword">delete</span> C_Test_Statistics;</div>
<div class="line"><span class="lineno"> 4094</span>}</div>
<div class="ttc" id="aMaCh3Logger_8h_html_a61052119a625282d0ec6d4a97adf3ee2"><div class="ttname"><a href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a></div><div class="ttdeci">#define MACH3LOG_ERROR</div><div class="ttdef"><b>Definition:</b> <a href="MaCh3Logger_8h_source.html#l00018">MaCh3Logger.h:18</a></div></div>
<div class="ttc" id="aclassMaCh3Exception_html"><div class="ttname"><a href="classMaCh3Exception.html">MaCh3Exception</a></div><div class="ttdoc">Custom exception class for MaCh3 errors.</div><div class="ttdef"><b>Definition:</b> <a href="MaCh3Exception_8h_source.html#l00012">MaCh3Exception.h:12</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="af3658b8adee50f6ef5557ebbd1c87b8e" name="af3658b8adee50f6ef5557ebbd1c87b8e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af3658b8adee50f6ef5557ebbd1c87b8e">&#9670;&#160;</a></span>BatchedMeans()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void MCMCProcessor::BatchedMeans </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>CW: Batched means, literally read from an array and chuck into TH1D. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8cpp_source.html#l03924">3924</a> of file <a class="el" href="MCMCProcessor_8cpp_source.html">MCMCProcessor.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3924</span>                                 {</div>
<div class="line"><span class="lineno"> 3925</span><span class="comment">// **************************</span></div>
<div class="line"><span class="lineno"> 3926</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="classMCMCProcessor.html#ab3f590b501162fc2ee5b78ce75689771">BatchedAverages</a> == <span class="keyword">nullptr</span>) <a class="code hl_function" href="classMCMCProcessor.html#a930cadafa41b31b58066dea68628de9f">PrepareDiagMCMC</a>();</div>
<div class="line"><span class="lineno"> 3927</span>  <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Making BatchedMeans plots...&quot;</span>);</div>
<div class="line"><span class="lineno"> 3928</span>  </div>
<div class="line"><span class="lineno"> 3929</span>  std::vector&lt;TH1D*&gt; BatchedParamPlots(<a class="code hl_variable" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>);</div>
<div class="line"><span class="lineno"> 3930</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a class="code hl_variable" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>; ++j) {</div>
<div class="line"><span class="lineno"> 3931</span>    TString Title = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><span class="lineno"> 3932</span>    <span class="keywordtype">double</span> Prior = 1.0;</div>
<div class="line"><span class="lineno"> 3933</span>    <span class="keywordtype">double</span> PriorError = 1.0;</div>
<div class="line"><span class="lineno"> 3934</span>    </div>
<div class="line"><span class="lineno"> 3935</span>    <a class="code hl_function" href="classMCMCProcessor.html#a28dfe42f1bf6fd3a145287be1e63fb0b">GetNthParameter</a>(j, Prior, PriorError, Title);</div>
<div class="line"><span class="lineno"> 3936</span>    </div>
<div class="line"><span class="lineno"> 3937</span>    std::string HistName = Form(<span class="stringliteral">&quot;%s_%s_batch&quot;</span>, Title.Data(), <a class="code hl_variable" href="classMCMCProcessor.html#ad043b6b2c885f47ab9967831bc8d0f5a">BranchNames</a>[j].Data());</div>
<div class="line"><span class="lineno"> 3938</span>    BatchedParamPlots[j] = <span class="keyword">new</span> TH1D(HistName.c_str(), HistName.c_str(), <a class="code hl_variable" href="classMCMCProcessor.html#a02c5a3f849cf217705816c650c678d19">nBatches</a>, 0, <a class="code hl_variable" href="classMCMCProcessor.html#a02c5a3f849cf217705816c650c678d19">nBatches</a>);</div>
<div class="line"><span class="lineno"> 3939</span>  }</div>
<div class="line"><span class="lineno"> 3940</span> </div>
<div class="line"><span class="lineno"> 3941</span><span class="preprocessor">  #ifdef MULTITHREAD</span></div>
<div class="line"><span class="lineno"> 3942</span><span class="preprocessor">  #pragma omp parallel for</span></div>
<div class="line"><span class="lineno"> 3943</span><span class="preprocessor">  #endif</span></div>
<div class="line"><span class="lineno"> 3944</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a class="code hl_variable" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>; ++j) {</div>
<div class="line"><span class="lineno"> 3945</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_variable" href="classMCMCProcessor.html#a02c5a3f849cf217705816c650c678d19">nBatches</a>; ++i) {</div>
<div class="line"><span class="lineno"> 3946</span>      BatchedParamPlots[j]-&gt;SetBinContent(i+1, <a class="code hl_variable" href="classMCMCProcessor.html#ab3f590b501162fc2ee5b78ce75689771">BatchedAverages</a>[i][j]);</div>
<div class="line"><span class="lineno"> 3947</span>      <span class="keyword">const</span> <span class="keywordtype">int</span> BatchRangeLow = double(i)*double(<a class="code hl_variable" href="classMCMCProcessor.html#af3a19b885e9c34e1674aea8cfbe14e1c">nEntries</a>)/double(<a class="code hl_variable" href="classMCMCProcessor.html#a02c5a3f849cf217705816c650c678d19">nBatches</a>);</div>
<div class="line"><span class="lineno"> 3948</span>      <span class="keyword">const</span> <span class="keywordtype">int</span> BatchRangeHigh = double(i+1)*double(<a class="code hl_variable" href="classMCMCProcessor.html#af3a19b885e9c34e1674aea8cfbe14e1c">nEntries</a>)/double(<a class="code hl_variable" href="classMCMCProcessor.html#a02c5a3f849cf217705816c650c678d19">nBatches</a>);</div>
<div class="line"><span class="lineno"> 3949</span>      std::stringstream ss;</div>
<div class="line"><span class="lineno"> 3950</span>      ss &lt;&lt; BatchRangeLow &lt;&lt; <span class="stringliteral">&quot; - &quot;</span> &lt;&lt; BatchRangeHigh;</div>
<div class="line"><span class="lineno"> 3951</span>      BatchedParamPlots[j]-&gt;GetXaxis()-&gt;SetBinLabel(i+1, ss.str().c_str());</div>
<div class="line"><span class="lineno"> 3952</span>    }</div>
<div class="line"><span class="lineno"> 3953</span>  }</div>
<div class="line"><span class="lineno"> 3954</span> </div>
<div class="line"><span class="lineno"> 3955</span>  TDirectory *BatchDir = <a class="code hl_variable" href="classMCMCProcessor.html#a62035b99df4617ab334cd1abd6ed0346">OutputFile</a>-&gt;mkdir(<span class="stringliteral">&quot;Batched_means&quot;</span>);</div>
<div class="line"><span class="lineno"> 3956</span>  BatchDir-&gt;cd();</div>
<div class="line"><span class="lineno"> 3957</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a class="code hl_variable" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>; ++j) {</div>
<div class="line"><span class="lineno"> 3958</span>    TF1 *Fitter = <span class="keyword">new</span> TF1(<span class="stringliteral">&quot;Fitter&quot;</span>,<span class="stringliteral">&quot;[0]&quot;</span>, 0, <a class="code hl_variable" href="classMCMCProcessor.html#a02c5a3f849cf217705816c650c678d19">nBatches</a>);</div>
<div class="line"><span class="lineno"> 3959</span>    Fitter-&gt;SetLineColor(kRed);</div>
<div class="line"><span class="lineno"> 3960</span>    BatchedParamPlots[j]-&gt;Fit(<span class="stringliteral">&quot;Fitter&quot;</span>,<span class="stringliteral">&quot;Rq&quot;</span>);</div>
<div class="line"><span class="lineno"> 3961</span>    BatchedParamPlots[j]-&gt;Write();</div>
<div class="line"><span class="lineno"> 3962</span>    <span class="keyword">delete</span> Fitter;</div>
<div class="line"><span class="lineno"> 3963</span>    <span class="keyword">delete</span> BatchedParamPlots[j];</div>
<div class="line"><span class="lineno"> 3964</span>  }</div>
<div class="line"><span class="lineno"> 3965</span> </div>
<div class="line"><span class="lineno"> 3966</span>  <span class="comment">//KS: Get the batched means variance estimation and variable indicating if number of batches is sensible</span></div>
<div class="line"><span class="lineno"> 3967</span>  <span class="comment">// We do this before deleting BatchedAverages</span></div>
<div class="line"><span class="lineno"> 3968</span>  <a class="code hl_function" href="classMCMCProcessor.html#a29d492906e0c027d089331a0509cd2c3">BatchedAnalysis</a>();</div>
<div class="line"><span class="lineno"> 3969</span> </div>
<div class="line"><span class="lineno"> 3970</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_variable" href="classMCMCProcessor.html#a02c5a3f849cf217705816c650c678d19">nBatches</a>; ++i) {</div>
<div class="line"><span class="lineno"> 3971</span>    <span class="keyword">delete</span> <a class="code hl_variable" href="classMCMCProcessor.html#ab3f590b501162fc2ee5b78ce75689771">BatchedAverages</a>[i];</div>
<div class="line"><span class="lineno"> 3972</span>  }</div>
<div class="line"><span class="lineno"> 3973</span>  <span class="keyword">delete</span>[] <a class="code hl_variable" href="classMCMCProcessor.html#ab3f590b501162fc2ee5b78ce75689771">BatchedAverages</a>;</div>
<div class="line"><span class="lineno"> 3974</span> </div>
<div class="line"><span class="lineno"> 3975</span>  BatchDir-&gt;Close();</div>
<div class="line"><span class="lineno"> 3976</span>  <span class="keyword">delete</span> BatchDir;</div>
<div class="line"><span class="lineno"> 3977</span> </div>
<div class="line"><span class="lineno"> 3978</span>  <a class="code hl_variable" href="classMCMCProcessor.html#a62035b99df4617ab334cd1abd6ed0346">OutputFile</a>-&gt;cd();</div>
<div class="line"><span class="lineno"> 3979</span>}</div>
<div class="ttc" id="aclassMCMCProcessor_html_a29d492906e0c027d089331a0509cd2c3"><div class="ttname"><a href="classMCMCProcessor.html#a29d492906e0c027d089331a0509cd2c3">MCMCProcessor::BatchedAnalysis</a></div><div class="ttdeci">void BatchedAnalysis()</div><div class="ttdoc">Get the batched means variance estimation and variable indicating if number of batches is sensible  .</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8cpp_source.html#l03983">MCMCProcessor.cpp:3983</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ace48a54fb08e2a3943d4e2ed1f8c4a4b" name="ace48a54fb08e2a3943d4e2ed1f8c4a4b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ace48a54fb08e2a3943d4e2ed1f8c4a4b">&#9670;&#160;</a></span>CacheSteps()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void MCMCProcessor::CacheSteps </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>KS:By caching each step we use multithreading. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8cpp_source.html#l01095">1095</a> of file <a class="el" href="MCMCProcessor_8cpp_source.html">MCMCProcessor.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1095</span>                               {</div>
<div class="line"><span class="lineno"> 1096</span><span class="comment">// ***************</span></div>
<div class="line"><span class="lineno"> 1097</span>  <span class="keywordflow">if</span>(<a class="code hl_variable" href="classMCMCProcessor.html#aea84f0315695aa05ec41fcf965b1b031">CacheMCMC</a> == <span class="keyword">true</span>) <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno"> 1098</span>  </div>
<div class="line"><span class="lineno"> 1099</span>  <a class="code hl_variable" href="classMCMCProcessor.html#aea84f0315695aa05ec41fcf965b1b031">CacheMCMC</a> = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1100</span>  </div>
<div class="line"><span class="lineno"> 1101</span>  <span class="keywordflow">if</span>(<a class="code hl_variable" href="classMCMCProcessor.html#a087dca88a306acdc28afea7213e3623c">ParStep</a> != <span class="keyword">nullptr</span>)</div>
<div class="line"><span class="lineno"> 1102</span>  {</div>
<div class="line"><span class="lineno"> 1103</span>    <a class="code hl_define" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;It look like ParStep was already filled &quot;</span>);</div>
<div class="line"><span class="lineno"> 1104</span>    <a class="code hl_define" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Even though it is used for MakeCovariance_MP and for DiagMCMC &quot;</span>);</div>
<div class="line"><span class="lineno"> 1105</span>    <a class="code hl_define" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;it has different structure in both for cache hits, sorry &quot;</span>);</div>
<div class="line"><span class="lineno"> 1106</span>    <span class="keywordflow">throw</span> <a class="code hl_class" href="classMaCh3Exception.html">MaCh3Exception</a>(__FILE__ , __LINE__ );</div>
<div class="line"><span class="lineno"> 1107</span>  }</div>
<div class="line"><span class="lineno"> 1108</span> </div>
<div class="line"><span class="lineno"> 1109</span>  <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Caching input tree...&quot;</span>);</div>
<div class="line"><span class="lineno"> 1110</span>  <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Allocating {:.2f} MB&quot;</span>, <span class="keywordtype">double</span>(<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>)*<a class="code hl_variable" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>*<a class="code hl_variable" href="classMCMCProcessor.html#af3a19b885e9c34e1674aea8cfbe14e1c">nEntries</a>)/1.E6);</div>
<div class="line"><span class="lineno"> 1111</span>  TStopwatch clock;</div>
<div class="line"><span class="lineno"> 1112</span>  clock.Start();</div>
<div class="line"><span class="lineno"> 1113</span>  </div>
<div class="line"><span class="lineno"> 1114</span>  <a class="code hl_variable" href="classMCMCProcessor.html#a087dca88a306acdc28afea7213e3623c">ParStep</a> = <span class="keyword">new</span> <span class="keywordtype">double</span>*[<a class="code hl_variable" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>];</div>
<div class="line"><span class="lineno"> 1115</span>  <a class="code hl_variable" href="classMCMCProcessor.html#a07549f3b67ca5409218d80c679f6e69e">StepNumber</a> = <span class="keyword">new</span> <span class="keywordtype">int</span>[<a class="code hl_variable" href="classMCMCProcessor.html#af3a19b885e9c34e1674aea8cfbe14e1c">nEntries</a>];</div>
<div class="line"><span class="lineno"> 1116</span>  </div>
<div class="line"><span class="lineno"> 1117</span>  <a class="code hl_variable" href="classMCMCProcessor.html#a0ddcfa4ba1e4dcdea366d88decc64391">hpost2D</a> = <span class="keyword">new</span> TH2D**[<a class="code hl_variable" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>]();</div>
<div class="line"><span class="lineno"> 1118</span> </div>
<div class="line"><span class="lineno"> 1119</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_variable" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>; ++i) </div>
<div class="line"><span class="lineno"> 1120</span>  {</div>
<div class="line"><span class="lineno"> 1121</span>    <a class="code hl_variable" href="classMCMCProcessor.html#a087dca88a306acdc28afea7213e3623c">ParStep</a>[i] = <span class="keyword">new</span> <span class="keywordtype">double</span>[<a class="code hl_variable" href="classMCMCProcessor.html#af3a19b885e9c34e1674aea8cfbe14e1c">nEntries</a>];</div>
<div class="line"><span class="lineno"> 1122</span>    <a class="code hl_variable" href="classMCMCProcessor.html#a0ddcfa4ba1e4dcdea366d88decc64391">hpost2D</a>[i] = <span class="keyword">new</span> TH2D*[<a class="code hl_variable" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>]();</div>
<div class="line"><span class="lineno"> 1123</span> </div>
<div class="line"><span class="lineno"> 1124</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a class="code hl_variable" href="classMCMCProcessor.html#af3a19b885e9c34e1674aea8cfbe14e1c">nEntries</a>; ++j)</div>
<div class="line"><span class="lineno"> 1125</span>    {</div>
<div class="line"><span class="lineno"> 1126</span>      <a class="code hl_variable" href="classMCMCProcessor.html#a087dca88a306acdc28afea7213e3623c">ParStep</a>[i][j] = -999.99;</div>
<div class="line"><span class="lineno"> 1127</span>      <span class="comment">//KS: Set this only once</span></div>
<div class="line"><span class="lineno"> 1128</span>      <span class="keywordflow">if</span>(i == 0) <a class="code hl_variable" href="classMCMCProcessor.html#a07549f3b67ca5409218d80c679f6e69e">StepNumber</a>[j] = -999.99;</div>
<div class="line"><span class="lineno"> 1129</span>    }</div>
<div class="line"><span class="lineno"> 1130</span>  }</div>
<div class="line"><span class="lineno"> 1131</span> </div>
<div class="line"><span class="lineno"> 1132</span>  <span class="comment">// Set all the branches to off</span></div>
<div class="line"><span class="lineno"> 1133</span>  <a class="code hl_variable" href="classMCMCProcessor.html#a6be3bbebd4a79fe9814a3da09b3bb820">Chain</a>-&gt;SetBranchStatus(<span class="stringliteral">&quot;*&quot;</span>, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno"> 1134</span>  </div>
<div class="line"><span class="lineno"> 1135</span>  <span class="comment">// Turn on the branches which we want for parameters</span></div>
<div class="line"><span class="lineno"> 1136</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_variable" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>; ++i) </div>
<div class="line"><span class="lineno"> 1137</span>  {</div>
<div class="line"><span class="lineno"> 1138</span>    <a class="code hl_variable" href="classMCMCProcessor.html#a6be3bbebd4a79fe9814a3da09b3bb820">Chain</a>-&gt;SetBranchStatus(<a class="code hl_variable" href="classMCMCProcessor.html#ad043b6b2c885f47ab9967831bc8d0f5a">BranchNames</a>[i].Data(), <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno"> 1139</span>  }</div>
<div class="line"><span class="lineno"> 1140</span>  <a class="code hl_variable" href="classMCMCProcessor.html#a6be3bbebd4a79fe9814a3da09b3bb820">Chain</a>-&gt;SetBranchStatus(<span class="stringliteral">&quot;step&quot;</span>, <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno"> 1141</span> </div>
<div class="line"><span class="lineno"> 1142</span>  <span class="keyword">const</span> Long64_t countwidth = <a class="code hl_variable" href="classMCMCProcessor.html#af3a19b885e9c34e1674aea8cfbe14e1c">nEntries</a>/10;</div>
<div class="line"><span class="lineno"> 1143</span>  <span class="comment">// Loop over the entries</span></div>
<div class="line"><span class="lineno"> 1144</span>  <span class="comment">//KS: This is really a bottleneck right now, thus revisit with ROOT6 https://pep-root6.github.io/docs/analysis/parallell/root.html</span></div>
<div class="line"><span class="lineno"> 1145</span>  <span class="keywordflow">for</span> (Long64_t j = 0; j &lt; <a class="code hl_variable" href="classMCMCProcessor.html#af3a19b885e9c34e1674aea8cfbe14e1c">nEntries</a>; ++j) </div>
<div class="line"><span class="lineno"> 1146</span>  {</div>
<div class="line"><span class="lineno"> 1147</span>    <span class="keywordflow">if</span> (j % countwidth == 0)</div>
<div class="line"><span class="lineno"> 1148</span>        <a class="code hl_function" href="namespaceMaCh3Utils.html#a4c8bdeb1d34606aed192e9f1311a72f5">MaCh3Utils::PrintProgressBar</a>(j, <a class="code hl_variable" href="classMCMCProcessor.html#af3a19b885e9c34e1674aea8cfbe14e1c">nEntries</a>);</div>
<div class="line"><span class="lineno"> 1149</span> </div>
<div class="line"><span class="lineno"> 1150</span>    <a class="code hl_variable" href="classMCMCProcessor.html#a6be3bbebd4a79fe9814a3da09b3bb820">Chain</a>-&gt;SetBranchAddress(<span class="stringliteral">&quot;step&quot;</span>, &amp;<a class="code hl_variable" href="classMCMCProcessor.html#a07549f3b67ca5409218d80c679f6e69e">StepNumber</a>[j]);</div>
<div class="line"><span class="lineno"> 1151</span>    <span class="comment">// Set the branch addresses for params</span></div>
<div class="line"><span class="lineno"> 1152</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_variable" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>; ++i) </div>
<div class="line"><span class="lineno"> 1153</span>    {</div>
<div class="line"><span class="lineno"> 1154</span>      <a class="code hl_variable" href="classMCMCProcessor.html#a6be3bbebd4a79fe9814a3da09b3bb820">Chain</a>-&gt;SetBranchAddress(<a class="code hl_variable" href="classMCMCProcessor.html#ad043b6b2c885f47ab9967831bc8d0f5a">BranchNames</a>[i].Data(), &amp;<a class="code hl_variable" href="classMCMCProcessor.html#a087dca88a306acdc28afea7213e3623c">ParStep</a>[i][j]);</div>
<div class="line"><span class="lineno"> 1155</span>    }</div>
<div class="line"><span class="lineno"> 1156</span>    </div>
<div class="line"><span class="lineno"> 1157</span>    <span class="keywordflow">if</span> (j % countwidth == 0) {</div>
<div class="line"><span class="lineno"> 1158</span>      <a class="code hl_function" href="namespaceMaCh3Utils.html#afb0be593dc0d5e481b78afa4625c858c">MaCh3Utils::EstimateDataTransferRate</a>(<a class="code hl_variable" href="classMCMCProcessor.html#a6be3bbebd4a79fe9814a3da09b3bb820">Chain</a>, j);</div>
<div class="line"><span class="lineno"> 1159</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1160</span>      <span class="comment">// Fill up the ParStep array</span></div>
<div class="line"><span class="lineno"> 1161</span>      <a class="code hl_variable" href="classMCMCProcessor.html#a6be3bbebd4a79fe9814a3da09b3bb820">Chain</a>-&gt;GetEntry(j);</div>
<div class="line"><span class="lineno"> 1162</span>    }</div>
<div class="line"><span class="lineno"> 1163</span> </div>
<div class="line"><span class="lineno"> 1164</span>  }</div>
<div class="line"><span class="lineno"> 1165</span>  </div>
<div class="line"><span class="lineno"> 1166</span>  <span class="comment">// Set all the branches to on</span></div>
<div class="line"><span class="lineno"> 1167</span>  <a class="code hl_variable" href="classMCMCProcessor.html#a6be3bbebd4a79fe9814a3da09b3bb820">Chain</a>-&gt;SetBranchStatus(<span class="stringliteral">&quot;*&quot;</span>, <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno"> 1168</span>  </div>
<div class="line"><span class="lineno"> 1169</span>  <span class="comment">// Cache max and min in chain for covariance matrix</span></div>
<div class="line"><span class="lineno"> 1170</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_variable" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>; ++i) </div>
<div class="line"><span class="lineno"> 1171</span>  {</div>
<div class="line"><span class="lineno"> 1172</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> Min_Chain_i = <a class="code hl_variable" href="classMCMCProcessor.html#a6be3bbebd4a79fe9814a3da09b3bb820">Chain</a>-&gt;GetMinimum(<a class="code hl_variable" href="classMCMCProcessor.html#ad043b6b2c885f47ab9967831bc8d0f5a">BranchNames</a>[i]);</div>
<div class="line"><span class="lineno"> 1173</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> Max_Chain_i = <a class="code hl_variable" href="classMCMCProcessor.html#a6be3bbebd4a79fe9814a3da09b3bb820">Chain</a>-&gt;GetMaximum(<a class="code hl_variable" href="classMCMCProcessor.html#ad043b6b2c885f47ab9967831bc8d0f5a">BranchNames</a>[i]);</div>
<div class="line"><span class="lineno"> 1174</span>    </div>
<div class="line"><span class="lineno"> 1175</span>    TString Title_i = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><span class="lineno"> 1176</span>    <span class="keywordtype">double</span> Prior_i, PriorError_i;</div>
<div class="line"><span class="lineno"> 1177</span>    <a class="code hl_function" href="classMCMCProcessor.html#a28dfe42f1bf6fd3a145287be1e63fb0b">GetNthParameter</a>(i, Prior_i, PriorError_i, Title_i);</div>
<div class="line"><span class="lineno"> 1178</span>    </div>
<div class="line"><span class="lineno"> 1179</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt;= i; ++j)</div>
<div class="line"><span class="lineno"> 1180</span>    {</div>
<div class="line"><span class="lineno"> 1181</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> Min_Chain_j = <a class="code hl_variable" href="classMCMCProcessor.html#a6be3bbebd4a79fe9814a3da09b3bb820">Chain</a>-&gt;GetMinimum(<a class="code hl_variable" href="classMCMCProcessor.html#ad043b6b2c885f47ab9967831bc8d0f5a">BranchNames</a>[j]);</div>
<div class="line"><span class="lineno"> 1182</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> Max_Chain_j = <a class="code hl_variable" href="classMCMCProcessor.html#a6be3bbebd4a79fe9814a3da09b3bb820">Chain</a>-&gt;GetMaximum(<a class="code hl_variable" href="classMCMCProcessor.html#ad043b6b2c885f47ab9967831bc8d0f5a">BranchNames</a>[j]);</div>
<div class="line"><span class="lineno"> 1183</span>  </div>
<div class="line"><span class="lineno"> 1184</span>      <span class="comment">// TH2D to hold the Correlation </span></div>
<div class="line"><span class="lineno"> 1185</span>      <a class="code hl_variable" href="classMCMCProcessor.html#a0ddcfa4ba1e4dcdea366d88decc64391">hpost2D</a>[i][j] = <span class="keyword">new</span> TH2D(Form(<span class="stringliteral">&quot;hpost2D_%i_%i&quot;</span>,i,j), Form(<span class="stringliteral">&quot;hpost2D_%i_%i&quot;</span>,i,j), <a class="code hl_variable" href="classMCMCProcessor.html#a6b74f8195bcbca0979f9e9fe43468bae">nBins</a>, Min_Chain_i, Max_Chain_i, <a class="code hl_variable" href="classMCMCProcessor.html#a6b74f8195bcbca0979f9e9fe43468bae">nBins</a>, Min_Chain_j, Max_Chain_j);</div>
<div class="line"><span class="lineno"> 1186</span>      </div>
<div class="line"><span class="lineno"> 1187</span>      TString Title_j = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><span class="lineno"> 1188</span>      <span class="keywordtype">double</span> Prior_j, PriorError_j;</div>
<div class="line"><span class="lineno"> 1189</span>      <a class="code hl_function" href="classMCMCProcessor.html#a28dfe42f1bf6fd3a145287be1e63fb0b">GetNthParameter</a>(j, Prior_j, PriorError_j, Title_j);</div>
<div class="line"><span class="lineno"> 1190</span>  </div>
<div class="line"><span class="lineno"> 1191</span>      <a class="code hl_variable" href="classMCMCProcessor.html#a0ddcfa4ba1e4dcdea366d88decc64391">hpost2D</a>[i][j]-&gt;SetMinimum(0);</div>
<div class="line"><span class="lineno"> 1192</span>      <a class="code hl_variable" href="classMCMCProcessor.html#a0ddcfa4ba1e4dcdea366d88decc64391">hpost2D</a>[i][j]-&gt;GetXaxis()-&gt;SetTitle(Title_i);</div>
<div class="line"><span class="lineno"> 1193</span>      <a class="code hl_variable" href="classMCMCProcessor.html#a0ddcfa4ba1e4dcdea366d88decc64391">hpost2D</a>[i][j]-&gt;GetYaxis()-&gt;SetTitle(Title_j);</div>
<div class="line"><span class="lineno"> 1194</span>      <a class="code hl_variable" href="classMCMCProcessor.html#a0ddcfa4ba1e4dcdea366d88decc64391">hpost2D</a>[i][j]-&gt;GetZaxis()-&gt;SetTitle(<span class="stringliteral">&quot;Steps&quot;</span>);</div>
<div class="line"><span class="lineno"> 1195</span>    }</div>
<div class="line"><span class="lineno"> 1196</span>  }</div>
<div class="line"><span class="lineno"> 1197</span>      </div>
<div class="line"><span class="lineno"> 1198</span>  clock.Stop();</div>
<div class="line"><span class="lineno"> 1199</span>  <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Caching steps took {:.2f}s to finish for {} steps&quot;</span>, clock.RealTime(), <a class="code hl_variable" href="classMCMCProcessor.html#af3a19b885e9c34e1674aea8cfbe14e1c">nEntries</a> );</div>
<div class="line"><span class="lineno"> 1200</span>}</div>
<div class="ttc" id="anamespaceMaCh3Utils_html_a4c8bdeb1d34606aed192e9f1311a72f5"><div class="ttname"><a href="namespaceMaCh3Utils.html#a4c8bdeb1d34606aed192e9f1311a72f5">MaCh3Utils::PrintProgressBar</a></div><div class="ttdeci">void PrintProgressBar(const Long64_t Done, const Long64_t All)</div><div class="ttdoc">KS: Simply print progress bar.</div><div class="ttdef"><b>Definition:</b> <a href="Monitor_8cpp_source.html#l00189">Monitor.cpp:189</a></div></div>
<div class="ttc" id="anamespaceMaCh3Utils_html_afb0be593dc0d5e481b78afa4625c858c"><div class="ttname"><a href="namespaceMaCh3Utils.html#afb0be593dc0d5e481b78afa4625c858c">MaCh3Utils::EstimateDataTransferRate</a></div><div class="ttdeci">void EstimateDataTransferRate(TChain *chain, const Long64_t entry)</div><div class="ttdoc">KS: Check what CPU you are using.</div><div class="ttdef"><b>Definition:</b> <a href="Monitor_8cpp_source.html#l00171">Monitor.cpp:171</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a1eb6f27c2fb967326dc14dc3dcdc3957" name="a1eb6f27c2fb967326dc14dc3dcdc3957"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1eb6f27c2fb967326dc14dc3dcdc3957">&#9670;&#160;</a></span>CalculateESS()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void MCMCProcessor::CalculateESS </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>nLags</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; std::vector&lt; double &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>LagL</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>KS: calc Effective Sample Size. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">nLags</td><td>Should be the same nLags as used in <a class="el" href="classMCMCProcessor.html#a322bee0c362ba83df8c45769d299ce9f" title="KS: Calculate autocorrelations supports both OpenMP and CUDA :)">AutoCorrelation()</a> </td></tr>
    <tr><td class="paramname">LagL</td><td>Value of LagL for each dial and each Lag</td></tr>
  </table>
  </dd>
</dl>
<p>This function computes the Effective Sample Size (ESS) using the autocorrelations calculated by <a class="el" href="classMCMCProcessor.html#a322bee0c362ba83df8c45769d299ce9f" title="KS: Calculate autocorrelations supports both OpenMP and CUDA :)">AutoCorrelation()</a>. Ensure that the parameter nLags here matches the number of lags used in <a class="el" href="classMCMCProcessor.html#a322bee0c362ba83df8c45769d299ce9f" title="KS: Calculate autocorrelations supports both OpenMP and CUDA :)">AutoCorrelation()</a> to obtain accurate results. <a class="el" href="citelist.html#CITEREF_StanManual">[17]</a> <a class="el" href="citelist.html#CITEREF_hanson2008mcmc">[9]</a> <a class="el" href="citelist.html#CITEREF_gabry2024visual">[7]</a> </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8cpp_source.html#l03821">3821</a> of file <a class="el" href="MCMCProcessor_8cpp_source.html">MCMCProcessor.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3821</span>                                                                                          {</div>
<div class="line"><span class="lineno"> 3822</span><span class="comment">// **************************</span></div>
<div class="line"><span class="lineno"> 3823</span>  <span class="keywordflow">if</span>(LagL.size() == 0)</div>
<div class="line"><span class="lineno"> 3824</span>  {</div>
<div class="line"><span class="lineno"> 3825</span>    <a class="code hl_define" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Size of LagL is 0&quot;</span>);</div>
<div class="line"><span class="lineno"> 3826</span>    <span class="keywordflow">throw</span> <a class="code hl_class" href="classMaCh3Exception.html">MaCh3Exception</a>(__FILE__ , __LINE__ );</div>
<div class="line"><span class="lineno"> 3827</span>  }</div>
<div class="line"><span class="lineno"> 3828</span>  <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Making ESS plots...&quot;</span>);</div>
<div class="line"><span class="lineno"> 3829</span>  TVectorD* <a class="code hl_variable" href="RHat_8cpp.html#ae673254e98992bd483de55c6c1d1dcaf">EffectiveSampleSize</a> = <span class="keyword">new</span> TVectorD(<a class="code hl_variable" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>);</div>
<div class="line"><span class="lineno"> 3830</span>  TVectorD* SamplingEfficiency = <span class="keyword">new</span> TVectorD(<a class="code hl_variable" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>);</div>
<div class="line"><span class="lineno"> 3831</span>  std::vector&lt;double&gt; TempDenominator(<a class="code hl_variable" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>);</div>
<div class="line"><span class="lineno"> 3832</span> </div>
<div class="line"><span class="lineno"> 3833</span>  <span class="keyword">constexpr</span> <span class="keywordtype">int</span> Nhists = 5;</div>
<div class="line"><span class="lineno"> 3834</span>  <span class="keyword">constexpr</span> <span class="keywordtype">double</span> Thresholds[Nhists + 1] = {1, 0.02, 0.005, 0.001, 0.0001, 0.0};</div>
<div class="line"><span class="lineno"> 3835</span>  <span class="keyword">constexpr</span> Color_t ESSColours[Nhists] = {kGreen, kGreen + 2, kYellow, kOrange, kRed};</div>
<div class="line"><span class="lineno"> 3836</span> </div>
<div class="line"><span class="lineno"> 3837</span>  <span class="comment">//KS: This histogram is inspired by the following: @cite gabry2024visual</span></div>
<div class="line"><span class="lineno"> 3838</span>  std::vector&lt;std::unique_ptr&lt;TH1D&gt;&gt; EffectiveSampleSizeHist(Nhists);</div>
<div class="line"><span class="lineno"> 3839</span>  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; Nhists; ++i)</div>
<div class="line"><span class="lineno"> 3840</span>  {</div>
<div class="line"><span class="lineno"> 3841</span>    EffectiveSampleSizeHist[i] =</div>
<div class="line"><span class="lineno"> 3842</span>      std::make_unique&lt;TH1D&gt;(Form(<span class="stringliteral">&quot;EffectiveSampleSizeHist_%i&quot;</span>, i), Form(<span class="stringliteral">&quot;EffectiveSampleSizeHist_%i&quot;</span>, i), <a class="code hl_variable" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>, 0, <a class="code hl_variable" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>);</div>
<div class="line"><span class="lineno"> 3843</span>    EffectiveSampleSizeHist[i]-&gt;GetYaxis()-&gt;SetTitle(<span class="stringliteral">&quot;N_{eff}/N&quot;</span>);</div>
<div class="line"><span class="lineno"> 3844</span>    EffectiveSampleSizeHist[i]-&gt;SetFillColor(ESSColours[i]);</div>
<div class="line"><span class="lineno"> 3845</span>    EffectiveSampleSizeHist[i]-&gt;SetLineColor(ESSColours[i]);</div>
<div class="line"><span class="lineno"> 3846</span>    EffectiveSampleSizeHist[i]-&gt;Sumw2();</div>
<div class="line"><span class="lineno"> 3847</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a class="code hl_variable" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>; ++j)</div>
<div class="line"><span class="lineno"> 3848</span>    {</div>
<div class="line"><span class="lineno"> 3849</span>      TString Title = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><span class="lineno"> 3850</span>      <span class="keywordtype">double</span> Prior = 1.0;</div>
<div class="line"><span class="lineno"> 3851</span>      <span class="keywordtype">double</span> PriorError = 1.0;</div>
<div class="line"><span class="lineno"> 3852</span>      <a class="code hl_function" href="classMCMCProcessor.html#a28dfe42f1bf6fd3a145287be1e63fb0b">GetNthParameter</a>(j, Prior, PriorError, Title);</div>
<div class="line"><span class="lineno"> 3853</span>      EffectiveSampleSizeHist[i]-&gt;GetXaxis()-&gt;SetBinLabel(j+1, Title.Data());</div>
<div class="line"><span class="lineno"> 3854</span>    }</div>
<div class="line"><span class="lineno"> 3855</span>  }</div>
<div class="line"><span class="lineno"> 3856</span> </div>
<div class="line"><span class="lineno"> 3857</span><span class="preprocessor">  #ifdef MULTITHREAD</span></div>
<div class="line"><span class="lineno"> 3858</span><span class="preprocessor">  #pragma omp parallel for</span></div>
<div class="line"><span class="lineno"> 3859</span><span class="preprocessor">  #endif</span></div>
<div class="line"><span class="lineno"> 3860</span>  <span class="comment">//KS: Calculate ESS and MCMC efficiency for each parameter</span></div>
<div class="line"><span class="lineno"> 3861</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a class="code hl_variable" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>; ++j)</div>
<div class="line"><span class="lineno"> 3862</span>  {</div>
<div class="line"><span class="lineno"> 3863</span>    (*EffectiveSampleSize)(j) = <a class="code hl_define" href="MCMCProcessor_8h.html#a82a6d79039474bc403b627437a7b97ec">_UNDEF_</a>;</div>
<div class="line"><span class="lineno"> 3864</span>    (*SamplingEfficiency)(j) = <a class="code hl_define" href="MCMCProcessor_8h.html#a82a6d79039474bc403b627437a7b97ec">_UNDEF_</a>;</div>
<div class="line"><span class="lineno"> 3865</span>    TempDenominator[j] = 0.;</div>
<div class="line"><span class="lineno"> 3866</span>    <span class="comment">//KS: Firs sum over all Calculated autocorrelations</span></div>
<div class="line"><span class="lineno"> 3867</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; nLags; ++k)</div>
<div class="line"><span class="lineno"> 3868</span>    {</div>
<div class="line"><span class="lineno"> 3869</span>      TempDenominator[j] += LagL[j][k];</div>
<div class="line"><span class="lineno"> 3870</span>    }</div>
<div class="line"><span class="lineno"> 3871</span>    TempDenominator[j] = 1+2*TempDenominator[j];</div>
<div class="line"><span class="lineno"> 3872</span>    (*EffectiveSampleSize)(j) = <span class="keywordtype">double</span>(<a class="code hl_variable" href="classMCMCProcessor.html#af3a19b885e9c34e1674aea8cfbe14e1c">nEntries</a>)/TempDenominator[j];</div>
<div class="line"><span class="lineno"> 3873</span>    <span class="comment">// 100 because we convert to percentage</span></div>
<div class="line"><span class="lineno"> 3874</span>    (*SamplingEfficiency)(j) = 100 * 1/TempDenominator[j];</div>
<div class="line"><span class="lineno"> 3875</span> </div>
<div class="line"><span class="lineno"> 3876</span>    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; Nhists; ++i)</div>
<div class="line"><span class="lineno"> 3877</span>    {</div>
<div class="line"><span class="lineno"> 3878</span>      EffectiveSampleSizeHist[i]-&gt;SetBinContent(j+1, 0);</div>
<div class="line"><span class="lineno"> 3879</span>      EffectiveSampleSizeHist[i]-&gt;SetBinError(j+1, 0);</div>
<div class="line"><span class="lineno"> 3880</span> </div>
<div class="line"><span class="lineno"> 3881</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> TempEntry = std::fabs((*<a class="code hl_variable" href="RHat_8cpp.html#ae673254e98992bd483de55c6c1d1dcaf">EffectiveSampleSize</a>)(j)) / double(<a class="code hl_variable" href="classMCMCProcessor.html#af3a19b885e9c34e1674aea8cfbe14e1c">nEntries</a>);</div>
<div class="line"><span class="lineno"> 3882</span>      <span class="keywordflow">if</span>(Thresholds[i] &gt;= TempEntry &amp;&amp; TempEntry &gt; Thresholds[i+1])</div>
<div class="line"><span class="lineno"> 3883</span>      {</div>
<div class="line"><span class="lineno"> 3884</span>        <span class="keywordflow">if</span>( std::isnan((*<a class="code hl_variable" href="RHat_8cpp.html#ae673254e98992bd483de55c6c1d1dcaf">EffectiveSampleSize</a>)(j)) ) <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 3885</span>        EffectiveSampleSizeHist[i]-&gt;SetBinContent(j+1, TempEntry);</div>
<div class="line"><span class="lineno"> 3886</span>      }</div>
<div class="line"><span class="lineno"> 3887</span>    }</div>
<div class="line"><span class="lineno"> 3888</span>  }</div>
<div class="line"><span class="lineno"> 3889</span> </div>
<div class="line"><span class="lineno"> 3890</span>  <span class="comment">//KS Write to the output tree</span></div>
<div class="line"><span class="lineno"> 3891</span>  <span class="comment">//Save to file</span></div>
<div class="line"><span class="lineno"> 3892</span>  <a class="code hl_variable" href="classMCMCProcessor.html#a62035b99df4617ab334cd1abd6ed0346">OutputFile</a>-&gt;cd();</div>
<div class="line"><span class="lineno"> 3893</span>  <a class="code hl_variable" href="RHat_8cpp.html#ae673254e98992bd483de55c6c1d1dcaf">EffectiveSampleSize</a>-&gt;Write(<span class="stringliteral">&quot;EffectiveSampleSize&quot;</span>);</div>
<div class="line"><span class="lineno"> 3894</span>  SamplingEfficiency-&gt;Write(<span class="stringliteral">&quot;SamplingEfficiency&quot;</span>);</div>
<div class="line"><span class="lineno"> 3895</span> </div>
<div class="line"><span class="lineno"> 3896</span>  EffectiveSampleSizeHist[0]-&gt;SetTitle(<span class="stringliteral">&quot;Effective Sample Size&quot;</span>);</div>
<div class="line"><span class="lineno"> 3897</span>  EffectiveSampleSizeHist[0]-&gt;Draw();</div>
<div class="line"><span class="lineno"> 3898</span>  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 1; i &lt; Nhists; ++i)</div>
<div class="line"><span class="lineno"> 3899</span>  {</div>
<div class="line"><span class="lineno"> 3900</span>    EffectiveSampleSizeHist[i]-&gt;Draw(<span class="stringliteral">&quot;SAME&quot;</span>);</div>
<div class="line"><span class="lineno"> 3901</span>  }</div>
<div class="line"><span class="lineno"> 3902</span> </div>
<div class="line"><span class="lineno"> 3903</span>  <span class="keyword">auto</span> leg = std::make_unique&lt;TLegend&gt;(0.2, 0.7, 0.6, 0.95);</div>
<div class="line"><span class="lineno"> 3904</span>  leg-&gt;SetTextSize(0.03);</div>
<div class="line"><span class="lineno"> 3905</span>  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; Nhists; ++i)</div>
<div class="line"><span class="lineno"> 3906</span>  {</div>
<div class="line"><span class="lineno"> 3907</span>    leg-&gt;AddEntry(EffectiveSampleSizeHist[i].get(), Form(<span class="stringliteral">&quot;%.4f &gt;= N_{eff}/N &gt; %.4f&quot;</span>, Thresholds[i], Thresholds[i+1]), <span class="stringliteral">&quot;f&quot;</span>);</div>
<div class="line"><span class="lineno"> 3908</span>  }</div>
<div class="line"><span class="lineno"> 3909</span>  leg-&gt;SetLineColor(0);</div>
<div class="line"><span class="lineno"> 3910</span>  leg-&gt;SetLineStyle(0);</div>
<div class="line"><span class="lineno"> 3911</span>  leg-&gt;SetFillColor(0);</div>
<div class="line"><span class="lineno"> 3912</span>  leg-&gt;SetFillStyle(0);</div>
<div class="line"><span class="lineno"> 3913</span>  leg-&gt;Draw(<span class="stringliteral">&quot;SAME&quot;</span>);</div>
<div class="line"><span class="lineno"> 3914</span> </div>
<div class="line"><span class="lineno"> 3915</span>  <a class="code hl_variable" href="classMCMCProcessor.html#a82e6cfef1ba6fcfc8ac8f61acb5bf931">Posterior</a>-&gt;Write(<span class="stringliteral">&quot;EffectiveSampleSizeCanvas&quot;</span>);</div>
<div class="line"><span class="lineno"> 3916</span> </div>
<div class="line"><span class="lineno"> 3917</span>  <span class="comment">//Delete all variables</span></div>
<div class="line"><span class="lineno"> 3918</span>  <span class="keyword">delete</span> <a class="code hl_variable" href="RHat_8cpp.html#ae673254e98992bd483de55c6c1d1dcaf">EffectiveSampleSize</a>;</div>
<div class="line"><span class="lineno"> 3919</span>  <span class="keyword">delete</span> SamplingEfficiency;</div>
<div class="line"><span class="lineno"> 3920</span>}</div>
<div class="ttc" id="aRHat_8cpp_html_ae673254e98992bd483de55c6c1d1dcaf"><div class="ttname"><a href="RHat_8cpp.html#ae673254e98992bd483de55c6c1d1dcaf">EffectiveSampleSize</a></div><div class="ttdeci">double * EffectiveSampleSize</div><div class="ttdef"><b>Definition:</b> <a href="RHat_8cpp_source.html#l00068">RHat.cpp:68</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a7f8faecae63616ba100cf24ae42ecc08" name="a7f8faecae63616ba100cf24ae42ecc08"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7f8faecae63616ba100cf24ae42ecc08">&#9670;&#160;</a></span>DiagMCMC()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void MCMCProcessor::DiagMCMC </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>KS: Perform MCMC diagnostic including Autocorrelation, Trace etc. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8cpp_source.html#l03202">3202</a> of file <a class="el" href="MCMCProcessor_8cpp_source.html">MCMCProcessor.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3202</span>                             {</div>
<div class="line"><span class="lineno"> 3203</span><span class="comment">// **************************</span></div>
<div class="line"><span class="lineno"> 3204</span> </div>
<div class="line"><span class="lineno"> 3205</span>  <span class="comment">// Prepare branches etc for DiagMCMC</span></div>
<div class="line"><span class="lineno"> 3206</span>  <a class="code hl_function" href="classMCMCProcessor.html#a930cadafa41b31b58066dea68628de9f">PrepareDiagMCMC</a>();</div>
<div class="line"><span class="lineno"> 3207</span> </div>
<div class="line"><span class="lineno"> 3208</span>  <span class="comment">// Draw the simple trace matrices</span></div>
<div class="line"><span class="lineno"> 3209</span>  <a class="code hl_function" href="classMCMCProcessor.html#a929d6efec80bb4de05eea7011257439a">ParamTraces</a>();</div>
<div class="line"><span class="lineno"> 3210</span> </div>
<div class="line"><span class="lineno"> 3211</span>  <span class="comment">// Get the batched means</span></div>
<div class="line"><span class="lineno"> 3212</span>  <a class="code hl_function" href="classMCMCProcessor.html#af3658b8adee50f6ef5557ebbd1c87b8e">BatchedMeans</a>();</div>
<div class="line"><span class="lineno"> 3213</span> </div>
<div class="line"><span class="lineno"> 3214</span>  <span class="comment">// Draw the auto-correlations</span></div>
<div class="line"><span class="lineno"> 3215</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="classMCMCProcessor.html#a562261269f0f4ec4a209b2fca64ff443">useFFTAutoCorrelation</a>) {</div>
<div class="line"><span class="lineno"> 3216</span>    <a class="code hl_function" href="classMCMCProcessor.html#abeb5e115fa9f58ea7872af5cf13c6b79">AutoCorrelation_FFT</a>();</div>
<div class="line"><span class="lineno"> 3217</span>  } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 3218</span>    <a class="code hl_function" href="classMCMCProcessor.html#a322bee0c362ba83df8c45769d299ce9f">AutoCorrelation</a>();</div>
<div class="line"><span class="lineno"> 3219</span>  }</div>
<div class="line"><span class="lineno"> 3220</span> </div>
<div class="line"><span class="lineno"> 3221</span>  <span class="comment">// Calculate Power Spectrum for each param</span></div>
<div class="line"><span class="lineno"> 3222</span>  <a class="code hl_function" href="classMCMCProcessor.html#aef760d8c4bb70690a5c4114f4b2409b3">PowerSpectrumAnalysis</a>();</div>
<div class="line"><span class="lineno"> 3223</span> </div>
<div class="line"><span class="lineno"> 3224</span>  <span class="comment">// Get Geweke Z score helping select burn-in</span></div>
<div class="line"><span class="lineno"> 3225</span>  <a class="code hl_function" href="classMCMCProcessor.html#a03b7c4bb9cd9a90aa7d284b0f1a6156b">GewekeDiagnostic</a>();</div>
<div class="line"><span class="lineno"> 3226</span> </div>
<div class="line"><span class="lineno"> 3227</span>  <span class="comment">// Draw acceptance Probability</span></div>
<div class="line"><span class="lineno"> 3228</span>  <a class="code hl_function" href="classMCMCProcessor.html#a278b82fa945d847e57ae6ed6357d8f61">AcceptanceProbabilities</a>();</div>
<div class="line"><span class="lineno"> 3229</span>}</div>
<div class="ttc" id="aclassMCMCProcessor_html_a03b7c4bb9cd9a90aa7d284b0f1a6156b"><div class="ttname"><a href="classMCMCProcessor.html#a03b7c4bb9cd9a90aa7d284b0f1a6156b">MCMCProcessor::GewekeDiagnostic</a></div><div class="ttdeci">void GewekeDiagnostic()</div><div class="ttdoc">Geweke Diagnostic based on the methods described by Fang (2014) and Karlsbakk (2011)....</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8cpp_source.html#l04223">MCMCProcessor.cpp:4223</a></div></div>
<div class="ttc" id="aclassMCMCProcessor_html_a278b82fa945d847e57ae6ed6357d8f61"><div class="ttname"><a href="classMCMCProcessor.html#a278b82fa945d847e57ae6ed6357d8f61">MCMCProcessor::AcceptanceProbabilities</a></div><div class="ttdeci">void AcceptanceProbabilities()</div><div class="ttdoc">Acceptance Probability.</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8cpp_source.html#l04358">MCMCProcessor.cpp:4358</a></div></div>
<div class="ttc" id="aclassMCMCProcessor_html_a322bee0c362ba83df8c45769d299ce9f"><div class="ttname"><a href="classMCMCProcessor.html#a322bee0c362ba83df8c45769d299ce9f">MCMCProcessor::AutoCorrelation</a></div><div class="ttdeci">void AutoCorrelation()</div><div class="ttdoc">KS: Calculate autocorrelations supports both OpenMP and CUDA :)</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8cpp_source.html#l03600">MCMCProcessor.cpp:3600</a></div></div>
<div class="ttc" id="aclassMCMCProcessor_html_a929d6efec80bb4de05eea7011257439a"><div class="ttname"><a href="classMCMCProcessor.html#a929d6efec80bb4de05eea7011257439a">MCMCProcessor::ParamTraces</a></div><div class="ttdeci">void ParamTraces()</div><div class="ttdoc">CW: Draw trace plots of the parameters i.e. parameter vs step.</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8cpp_source.html#l03401">MCMCProcessor.cpp:3401</a></div></div>
<div class="ttc" id="aclassMCMCProcessor_html_abeb5e115fa9f58ea7872af5cf13c6b79"><div class="ttname"><a href="classMCMCProcessor.html#abeb5e115fa9f58ea7872af5cf13c6b79">MCMCProcessor::AutoCorrelation_FFT</a></div><div class="ttdeci">void AutoCorrelation_FFT()</div><div class="ttdoc">MJR: Autocorrelation function using FFT algorithm for extra speed.</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8cpp_source.html#l03496">MCMCProcessor.cpp:3496</a></div></div>
<div class="ttc" id="aclassMCMCProcessor_html_aef760d8c4bb70690a5c4114f4b2409b3"><div class="ttname"><a href="classMCMCProcessor.html#aef760d8c4bb70690a5c4114f4b2409b3">MCMCProcessor::PowerSpectrumAnalysis</a></div><div class="ttdeci">void PowerSpectrumAnalysis()</div><div class="ttdoc">RC: Perform spectral analysis of MCMC .</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8cpp_source.html#l04098">MCMCProcessor.cpp:4098</a></div></div>
<div class="ttc" id="aclassMCMCProcessor_html_af3658b8adee50f6ef5557ebbd1c87b8e"><div class="ttname"><a href="classMCMCProcessor.html#af3658b8adee50f6ef5557ebbd1c87b8e">MCMCProcessor::BatchedMeans</a></div><div class="ttdeci">void BatchedMeans()</div><div class="ttdoc">CW: Batched means, literally read from an array and chuck into TH1D.</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8cpp_source.html#l03924">MCMCProcessor.cpp:3924</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a5b0961bcb0eea7a347e6a29ef7738d80" name="a5b0961bcb0eea7a347e6a29ef7738d80"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5b0961bcb0eea7a347e6a29ef7738d80">&#9670;&#160;</a></span>DrawCorrelations1D()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void MCMCProcessor::DrawCorrelations1D </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Draw 1D correlations which might be more helpful than looking at huge 2D Corr matrix. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8cpp_source.html#l01474">1474</a> of file <a class="el" href="MCMCProcessor_8cpp_source.html">MCMCProcessor.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1474</span>                                       {</div>
<div class="line"><span class="lineno"> 1475</span><span class="comment">// *********************</span></div>
<div class="line"><span class="lineno"> 1476</span>  <span class="comment">//KS: Store it as we go back to them at the end</span></div>
<div class="line"><span class="lineno"> 1477</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> TopMargin  = <a class="code hl_variable" href="classMCMCProcessor.html#a82e6cfef1ba6fcfc8ac8f61acb5bf931">Posterior</a>-&gt;GetTopMargin();</div>
<div class="line"><span class="lineno"> 1478</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> BottomMargin  = <a class="code hl_variable" href="classMCMCProcessor.html#a82e6cfef1ba6fcfc8ac8f61acb5bf931">Posterior</a>-&gt;GetBottomMargin();</div>
<div class="line"><span class="lineno"> 1479</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> OptTitle = gStyle-&gt;GetOptTitle();</div>
<div class="line"><span class="lineno"> 1480</span> </div>
<div class="line"><span class="lineno"> 1481</span>  <a class="code hl_variable" href="classMCMCProcessor.html#a82e6cfef1ba6fcfc8ac8f61acb5bf931">Posterior</a>-&gt;SetTopMargin(0.1);</div>
<div class="line"><span class="lineno"> 1482</span>  <a class="code hl_variable" href="classMCMCProcessor.html#a82e6cfef1ba6fcfc8ac8f61acb5bf931">Posterior</a>-&gt;SetBottomMargin(0.2);</div>
<div class="line"><span class="lineno"> 1483</span>  gStyle-&gt;SetOptTitle(1);</div>
<div class="line"><span class="lineno"> 1484</span> </div>
<div class="line"><span class="lineno"> 1485</span>  <span class="keyword">constexpr</span> <span class="keywordtype">int</span> Nhists = 3;</div>
<div class="line"><span class="lineno"> 1486</span>  <span class="comment">//KS: Highest value is just meant bo be sliglhy higher than 1 to catch &gt;,</span></div>
<div class="line"><span class="lineno"> 1487</span>  <span class="keyword">constexpr</span> <span class="keywordtype">double</span> Thresholds[Nhists+1] = {0, 0.25, 0.5, 1.0001};</div>
<div class="line"><span class="lineno"> 1488</span>  <span class="keyword">constexpr</span> Color_t CorrColours[Nhists] = {kRed-10, kRed-6,  kRed};</div>
<div class="line"><span class="lineno"> 1489</span> </div>
<div class="line"><span class="lineno"> 1490</span>  <span class="comment">//KS: This strore neccesary entires for stripped covariance which strore only &quot;menaingfull correlations</span></div>
<div class="line"><span class="lineno"> 1491</span>  std::vector&lt;std::vector&lt;double&gt;&gt; CorrOfInterest;</div>
<div class="line"><span class="lineno"> 1492</span>  CorrOfInterest.resize(<a class="code hl_variable" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>);</div>
<div class="line"><span class="lineno"> 1493</span>  std::vector&lt;std::vector&lt;std::string&gt;&gt; NameCorrOfInterest;</div>
<div class="line"><span class="lineno"> 1494</span>  NameCorrOfInterest.resize(<a class="code hl_variable" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>);</div>
<div class="line"><span class="lineno"> 1495</span> </div>
<div class="line"><span class="lineno"> 1496</span>  std::vector&lt;std::vector&lt;std::unique_ptr&lt;TH1D&gt;&gt;&gt; Corr1DHist(<a class="code hl_variable" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>);</div>
<div class="line"><span class="lineno"> 1497</span>  <span class="comment">//KS: Initialising ROOT objects is never safe in MP loop</span></div>
<div class="line"><span class="lineno"> 1498</span>  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_variable" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>; ++i)</div>
<div class="line"><span class="lineno"> 1499</span>  {</div>
<div class="line"><span class="lineno"> 1500</span>    TString Title = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><span class="lineno"> 1501</span>    <span class="keywordtype">double</span> Prior = 1.0;</div>
<div class="line"><span class="lineno"> 1502</span>    <span class="keywordtype">double</span> PriorError = 1.0;</div>
<div class="line"><span class="lineno"> 1503</span>    <a class="code hl_function" href="classMCMCProcessor.html#a28dfe42f1bf6fd3a145287be1e63fb0b">GetNthParameter</a>(i, Prior, PriorError, Title);</div>
<div class="line"><span class="lineno"> 1504</span> </div>
<div class="line"><span class="lineno"> 1505</span>    Corr1DHist[i].resize(Nhists);</div>
<div class="line"><span class="lineno"> 1506</span>    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j = 0; j &lt; Nhists; ++j)</div>
<div class="line"><span class="lineno"> 1507</span>    {</div>
<div class="line"><span class="lineno"> 1508</span>      Corr1DHist[i][j] = std::make_unique&lt;TH1D&gt;(Form(<span class="stringliteral">&quot;Corr1DHist_%i_%i&quot;</span>, i, j), Form(<span class="stringliteral">&quot;Corr1DHist_%i_%i&quot;</span>, i, j), <a class="code hl_variable" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>, 0, <a class="code hl_variable" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>);</div>
<div class="line"><span class="lineno"> 1509</span>      Corr1DHist[i][j]-&gt;SetTitle(Form(<span class="stringliteral">&quot;%s&quot;</span>,Title.Data()));</div>
<div class="line"><span class="lineno"> 1510</span>      Corr1DHist[i][j]-&gt;GetYaxis()-&gt;SetTitle(<span class="stringliteral">&quot;Correlation&quot;</span>);</div>
<div class="line"><span class="lineno"> 1511</span>      Corr1DHist[i][j]-&gt;SetFillColor(CorrColours[j]);</div>
<div class="line"><span class="lineno"> 1512</span>      Corr1DHist[i][j]-&gt;SetLineColor(kBlack);</div>
<div class="line"><span class="lineno"> 1513</span> </div>
<div class="line"><span class="lineno"> 1514</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; <a class="code hl_variable" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>; ++k)</div>
<div class="line"><span class="lineno"> 1515</span>      {</div>
<div class="line"><span class="lineno"> 1516</span>        TString Title_y = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><span class="lineno"> 1517</span>        <span class="keywordtype">double</span> Prior_y = 1.0;</div>
<div class="line"><span class="lineno"> 1518</span>        <span class="keywordtype">double</span> PriorError_y = 1.0;</div>
<div class="line"><span class="lineno"> 1519</span>        <a class="code hl_function" href="classMCMCProcessor.html#a28dfe42f1bf6fd3a145287be1e63fb0b">GetNthParameter</a>(k, Prior_y, PriorError_y, Title_y);</div>
<div class="line"><span class="lineno"> 1520</span>        Corr1DHist[i][j]-&gt;GetXaxis()-&gt;SetBinLabel(k+1, Title_y.Data());</div>
<div class="line"><span class="lineno"> 1521</span>      }</div>
<div class="line"><span class="lineno"> 1522</span>    }</div>
<div class="line"><span class="lineno"> 1523</span>  }</div>
<div class="line"><span class="lineno"> 1524</span> </div>
<div class="line"><span class="lineno"> 1525</span><span class="preprocessor">  #ifdef MULTITHREAD</span></div>
<div class="line"><span class="lineno"> 1526</span><span class="preprocessor">  #pragma omp parallel for</span></div>
<div class="line"><span class="lineno"> 1527</span><span class="preprocessor">  #endif</span></div>
<div class="line"><span class="lineno"> 1528</span>  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_variable" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>; ++i)</div>
<div class="line"><span class="lineno"> 1529</span>  {</div>
<div class="line"><span class="lineno"> 1530</span>    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j = 0; j &lt; <a class="code hl_variable" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>; ++j)</div>
<div class="line"><span class="lineno"> 1531</span>    {</div>
<div class="line"><span class="lineno"> 1532</span>      <span class="keywordflow">for</span>(<span class="keywordtype">int</span> k = 0; k &lt; Nhists; ++k)</div>
<div class="line"><span class="lineno"> 1533</span>      {</div>
<div class="line"><span class="lineno"> 1534</span>        <span class="keyword">const</span> <span class="keywordtype">double</span> TempEntry = std::fabs((*<a class="code hl_variable" href="classMCMCProcessor.html#a03f28431158777cdd81d058b6632a92f">Correlation</a>)(i,j));</div>
<div class="line"><span class="lineno"> 1535</span>        <span class="keywordflow">if</span>(Thresholds[k+1] &gt; TempEntry &amp;&amp; TempEntry &gt;= Thresholds[k])</div>
<div class="line"><span class="lineno"> 1536</span>        {</div>
<div class="line"><span class="lineno"> 1537</span>          Corr1DHist[i][k]-&gt;SetBinContent(j+1, (*<a class="code hl_variable" href="classMCMCProcessor.html#a03f28431158777cdd81d058b6632a92f">Correlation</a>)(i,j));</div>
<div class="line"><span class="lineno"> 1538</span>        }</div>
<div class="line"><span class="lineno"> 1539</span>      }</div>
<div class="line"><span class="lineno"> 1540</span>      <span class="keywordflow">if</span>(std::fabs((*<a class="code hl_variable" href="classMCMCProcessor.html#a03f28431158777cdd81d058b6632a92f">Correlation</a>)(i,j)) &gt; <a class="code hl_variable" href="classMCMCProcessor.html#a25e4685b6299181021b02ac0e0b74681">Post2DPlotThreshold</a> &amp;&amp; i != j)</div>
<div class="line"><span class="lineno"> 1541</span>      {</div>
<div class="line"><span class="lineno"> 1542</span>        CorrOfInterest[i].push_back((*<a class="code hl_variable" href="classMCMCProcessor.html#a03f28431158777cdd81d058b6632a92f">Correlation</a>)(i,j));</div>
<div class="line"><span class="lineno"> 1543</span>        NameCorrOfInterest[i].push_back(Corr1DHist[i][0]-&gt;GetXaxis()-&gt;GetBinLabel(j+1));</div>
<div class="line"><span class="lineno"> 1544</span>      }</div>
<div class="line"><span class="lineno"> 1545</span>    }</div>
<div class="line"><span class="lineno"> 1546</span>  }</div>
<div class="line"><span class="lineno"> 1547</span> </div>
<div class="line"><span class="lineno"> 1548</span>  TDirectory *CorrDir = <a class="code hl_variable" href="classMCMCProcessor.html#a62035b99df4617ab334cd1abd6ed0346">OutputFile</a>-&gt;mkdir(<span class="stringliteral">&quot;Corr1D&quot;</span>);</div>
<div class="line"><span class="lineno"> 1549</span>  CorrDir-&gt;cd();</div>
<div class="line"><span class="lineno"> 1550</span> </div>
<div class="line"><span class="lineno"> 1551</span>  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_variable" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>; i++)</div>
<div class="line"><span class="lineno"> 1552</span>  {</div>
<div class="line"><span class="lineno"> 1553</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classMCMCProcessor.html#a95fa49737432818bc830a44898d0d850">IamVaried</a>[i] == <span class="keyword">false</span>) <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 1554</span> </div>
<div class="line"><span class="lineno"> 1555</span>    Corr1DHist[i][0]-&gt;SetMaximum(+1.);</div>
<div class="line"><span class="lineno"> 1556</span>    Corr1DHist[i][0]-&gt;SetMinimum(-1.);</div>
<div class="line"><span class="lineno"> 1557</span>    Corr1DHist[i][0]-&gt;Draw();</div>
<div class="line"><span class="lineno"> 1558</span>    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> k = 1; k &lt; Nhists; k++)</div>
<div class="line"><span class="lineno"> 1559</span>    {</div>
<div class="line"><span class="lineno"> 1560</span>      Corr1DHist[i][k]-&gt;Draw(<span class="stringliteral">&quot;SAME&quot;</span>);</div>
<div class="line"><span class="lineno"> 1561</span>    }</div>
<div class="line"><span class="lineno"> 1562</span> </div>
<div class="line"><span class="lineno"> 1563</span>    <span class="keyword">auto</span> leg = std::make_unique&lt;TLegend&gt;(0.3, 0.75, 0.6, 0.90);</div>
<div class="line"><span class="lineno"> 1564</span>    leg-&gt;SetTextSize(0.02);</div>
<div class="line"><span class="lineno"> 1565</span>    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> k = 0; k &lt; Nhists; k++)</div>
<div class="line"><span class="lineno"> 1566</span>    {</div>
<div class="line"><span class="lineno"> 1567</span>      leg-&gt;AddEntry(Corr1DHist[i][k].get(), Form(<span class="stringliteral">&quot;%.2f &gt; |Corr| &gt;= %.2f&quot;</span>, Thresholds[k+1], Thresholds[k]), <span class="stringliteral">&quot;f&quot;</span>);</div>
<div class="line"><span class="lineno"> 1568</span>    }</div>
<div class="line"><span class="lineno"> 1569</span>    leg-&gt;SetLineColor(0);</div>
<div class="line"><span class="lineno"> 1570</span>    leg-&gt;SetLineStyle(0);</div>
<div class="line"><span class="lineno"> 1571</span>    leg-&gt;SetFillColor(0);</div>
<div class="line"><span class="lineno"> 1572</span>    leg-&gt;SetFillStyle(0);</div>
<div class="line"><span class="lineno"> 1573</span>    leg-&gt;Draw(<span class="stringliteral">&quot;SAME&quot;</span>);</div>
<div class="line"><span class="lineno"> 1574</span> </div>
<div class="line"><span class="lineno"> 1575</span>    <a class="code hl_variable" href="classMCMCProcessor.html#a82e6cfef1ba6fcfc8ac8f61acb5bf931">Posterior</a>-&gt;Write(Corr1DHist[i][0]-&gt;GetTitle());</div>
<div class="line"><span class="lineno"> 1576</span>    <span class="keywordflow">if</span>(<a class="code hl_variable" href="classMCMCProcessor.html#ad73755714ae3d6dc951158d5513c6eee">printToPDF</a>) <a class="code hl_variable" href="classMCMCProcessor.html#a82e6cfef1ba6fcfc8ac8f61acb5bf931">Posterior</a>-&gt;Print(<a class="code hl_variable" href="classMCMCProcessor.html#ab5aec3dc293919701d31e6ae705601dd">CanvasName</a>);</div>
<div class="line"><span class="lineno"> 1577</span>  }</div>
<div class="line"><span class="lineno"> 1578</span> </div>
<div class="line"><span class="lineno"> 1579</span>  <span class="comment">//KS: Plot only meaningful correlations</span></div>
<div class="line"><span class="lineno"> 1580</span>  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_variable" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>; i++)</div>
<div class="line"><span class="lineno"> 1581</span>  {</div>
<div class="line"><span class="lineno"> 1582</span>    <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code hl_variable" href="GetPenaltyTerm_8cpp.html#a439227feff9d7f55384e8780cfc2eb82">size</a> = int(CorrOfInterest[i].<a class="code hl_variable" href="GetPenaltyTerm_8cpp.html#a439227feff9d7f55384e8780cfc2eb82">size</a>());</div>
<div class="line"><span class="lineno"> 1583</span> </div>
<div class="line"><span class="lineno"> 1584</span>    <span class="keywordflow">if</span>(<a class="code hl_variable" href="GetPenaltyTerm_8cpp.html#a439227feff9d7f55384e8780cfc2eb82">size</a> == 0) <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 1585</span>    TH1D* Corr1DHist_Reduced = <span class="keyword">new</span> TH1D(<span class="stringliteral">&quot;Corr1DHist_Reduced&quot;</span>, <span class="stringliteral">&quot;Corr1DHist_Reduced&quot;</span>, <a class="code hl_variable" href="GetPenaltyTerm_8cpp.html#a439227feff9d7f55384e8780cfc2eb82">size</a>, 0, <a class="code hl_variable" href="GetPenaltyTerm_8cpp.html#a439227feff9d7f55384e8780cfc2eb82">size</a>);</div>
<div class="line"><span class="lineno"> 1586</span> </div>
<div class="line"><span class="lineno"> 1587</span>    Corr1DHist_Reduced-&gt;SetTitle(Corr1DHist[i][0]-&gt;GetTitle());</div>
<div class="line"><span class="lineno"> 1588</span>    Corr1DHist_Reduced-&gt;GetYaxis()-&gt;SetTitle(<span class="stringliteral">&quot;Correlation&quot;</span>);</div>
<div class="line"><span class="lineno"> 1589</span>    Corr1DHist_Reduced-&gt;SetFillColor(kBlue);</div>
<div class="line"><span class="lineno"> 1590</span>    Corr1DHist_Reduced-&gt;SetLineColor(kBlue);</div>
<div class="line"><span class="lineno"> 1591</span> </div>
<div class="line"><span class="lineno"> 1592</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a class="code hl_variable" href="GetPenaltyTerm_8cpp.html#a439227feff9d7f55384e8780cfc2eb82">size</a>; ++j)</div>
<div class="line"><span class="lineno"> 1593</span>    {</div>
<div class="line"><span class="lineno"> 1594</span>      Corr1DHist_Reduced-&gt;GetXaxis()-&gt;SetBinLabel(j+1, NameCorrOfInterest[i][j].c_str());</div>
<div class="line"><span class="lineno"> 1595</span>      Corr1DHist_Reduced-&gt;SetBinContent(j+1, CorrOfInterest[i][j]);</div>
<div class="line"><span class="lineno"> 1596</span>    }</div>
<div class="line"><span class="lineno"> 1597</span>    Corr1DHist_Reduced-&gt;GetXaxis()-&gt;LabelsOption(<span class="stringliteral">&quot;v&quot;</span>);</div>
<div class="line"><span class="lineno"> 1598</span> </div>
<div class="line"><span class="lineno"> 1599</span>    Corr1DHist_Reduced-&gt;SetMaximum(+1.);</div>
<div class="line"><span class="lineno"> 1600</span>    Corr1DHist_Reduced-&gt;SetMinimum(-1.);</div>
<div class="line"><span class="lineno"> 1601</span>    Corr1DHist_Reduced-&gt;Draw();</div>
<div class="line"><span class="lineno"> 1602</span> </div>
<div class="line"><span class="lineno"> 1603</span>    <a class="code hl_variable" href="classMCMCProcessor.html#a82e6cfef1ba6fcfc8ac8f61acb5bf931">Posterior</a>-&gt;Write(Form(<span class="stringliteral">&quot;%s_Red&quot;</span>, Corr1DHist_Reduced-&gt;GetTitle()));</div>
<div class="line"><span class="lineno"> 1604</span>    <span class="keywordflow">if</span>(<a class="code hl_variable" href="classMCMCProcessor.html#ad73755714ae3d6dc951158d5513c6eee">printToPDF</a>) <a class="code hl_variable" href="classMCMCProcessor.html#a82e6cfef1ba6fcfc8ac8f61acb5bf931">Posterior</a>-&gt;Print(<a class="code hl_variable" href="classMCMCProcessor.html#ab5aec3dc293919701d31e6ae705601dd">CanvasName</a>);</div>
<div class="line"><span class="lineno"> 1605</span> </div>
<div class="line"><span class="lineno"> 1606</span>    <span class="keyword">delete</span> Corr1DHist_Reduced;</div>
<div class="line"><span class="lineno"> 1607</span>  }</div>
<div class="line"><span class="lineno"> 1608</span> </div>
<div class="line"><span class="lineno"> 1609</span>  CorrDir-&gt;Close();</div>
<div class="line"><span class="lineno"> 1610</span>  <span class="keyword">delete</span> CorrDir;</div>
<div class="line"><span class="lineno"> 1611</span> </div>
<div class="line"><span class="lineno"> 1612</span>  <a class="code hl_variable" href="classMCMCProcessor.html#a62035b99df4617ab334cd1abd6ed0346">OutputFile</a>-&gt;cd();</div>
<div class="line"><span class="lineno"> 1613</span> </div>
<div class="line"><span class="lineno"> 1614</span>  <a class="code hl_variable" href="classMCMCProcessor.html#a82e6cfef1ba6fcfc8ac8f61acb5bf931">Posterior</a>-&gt;SetTopMargin(TopMargin);</div>
<div class="line"><span class="lineno"> 1615</span>  <a class="code hl_variable" href="classMCMCProcessor.html#a82e6cfef1ba6fcfc8ac8f61acb5bf931">Posterior</a>-&gt;SetBottomMargin(BottomMargin);</div>
<div class="line"><span class="lineno"> 1616</span>  gStyle-&gt;SetOptTitle(OptTitle);</div>
<div class="line"><span class="lineno"> 1617</span>}</div>
<div class="ttc" id="aGetPenaltyTerm_8cpp_html_a439227feff9d7f55384e8780cfc2eb82"><div class="ttname"><a href="GetPenaltyTerm_8cpp.html#a439227feff9d7f55384e8780cfc2eb82">size</a></div><div class="ttdeci">int size</div><div class="ttdef"><b>Definition:</b> <a href="GetPenaltyTerm_8cpp_source.html#l00038">GetPenaltyTerm.cpp:38</a></div></div>
<div class="ttc" id="aclassMCMCProcessor_html_a95fa49737432818bc830a44898d0d850"><div class="ttname"><a href="classMCMCProcessor.html#a95fa49737432818bc830a44898d0d850">MCMCProcessor::IamVaried</a></div><div class="ttdeci">std::vector&lt; bool &gt; IamVaried</div><div class="ttdoc">Is the ith parameter varied.</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8h_source.html#l00360">MCMCProcessor.h:360</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a8d9b9c1c780a51b130fe528583dc5019" name="a8d9b9c1c780a51b130fe528583dc5019"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8d9b9c1c780a51b130fe528583dc5019">&#9670;&#160;</a></span>DrawCovariance()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void MCMCProcessor::DrawCovariance </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Draw the post-fit covariances. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8cpp_source.html#l01381">1381</a> of file <a class="el" href="MCMCProcessor_8cpp_source.html">MCMCProcessor.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1381</span>                                   {</div>
<div class="line"><span class="lineno"> 1382</span><span class="comment">// *********************</span></div>
<div class="line"><span class="lineno"> 1383</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> RightMargin  = <a class="code hl_variable" href="classMCMCProcessor.html#a82e6cfef1ba6fcfc8ac8f61acb5bf931">Posterior</a>-&gt;GetRightMargin();</div>
<div class="line"><span class="lineno"> 1384</span>  <a class="code hl_variable" href="classMCMCProcessor.html#a82e6cfef1ba6fcfc8ac8f61acb5bf931">Posterior</a>-&gt;SetRightMargin(0.15);</div>
<div class="line"><span class="lineno"> 1385</span> </div>
<div class="line"><span class="lineno"> 1386</span>  <span class="comment">// The Covariance matrix from the fit</span></div>
<div class="line"><span class="lineno"> 1387</span>  std::unique_ptr&lt;TH2D&gt; hCov = std::make_unique&lt;TH2D&gt;(<span class="stringliteral">&quot;hCov&quot;</span>, <span class="stringliteral">&quot;hCov&quot;</span>, <a class="code hl_variable" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>, 0, <a class="code hl_variable" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>, <a class="code hl_variable" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>, 0, <a class="code hl_variable" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>);</div>
<div class="line"><span class="lineno"> 1388</span>  hCov-&gt;GetZaxis()-&gt;SetTitle(<span class="stringliteral">&quot;Covariance&quot;</span>);</div>
<div class="line"><span class="lineno"> 1389</span>  <span class="comment">// The Covariance matrix square root, with correct sign</span></div>
<div class="line"><span class="lineno"> 1390</span>  std::unique_ptr&lt;TH2D&gt; hCovSq = std::make_unique&lt;TH2D&gt;(<span class="stringliteral">&quot;hCovSq&quot;</span>, <span class="stringliteral">&quot;hCovSq&quot;</span>, <a class="code hl_variable" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>, 0, <a class="code hl_variable" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>, <a class="code hl_variable" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>, 0, <a class="code hl_variable" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>);</div>
<div class="line"><span class="lineno"> 1391</span>  hCovSq-&gt;GetZaxis()-&gt;SetTitle(<span class="stringliteral">&quot;Covariance&quot;</span>);</div>
<div class="line"><span class="lineno"> 1392</span>  <span class="comment">// The Correlation</span></div>
<div class="line"><span class="lineno"> 1393</span>  std::unique_ptr&lt;TH2D&gt; hCorr = std::make_unique&lt;TH2D&gt;(<span class="stringliteral">&quot;hCorr&quot;</span>, <span class="stringliteral">&quot;hCorr&quot;</span>, <a class="code hl_variable" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>, 0, <a class="code hl_variable" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>, <a class="code hl_variable" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>, 0, <a class="code hl_variable" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>);</div>
<div class="line"><span class="lineno"> 1394</span>  hCorr-&gt;GetZaxis()-&gt;SetTitle(<span class="stringliteral">&quot;Correlation&quot;</span>);</div>
<div class="line"><span class="lineno"> 1395</span>  hCorr-&gt;SetMinimum(-1);</div>
<div class="line"><span class="lineno"> 1396</span>  hCorr-&gt;SetMaximum(1);</div>
<div class="line"><span class="lineno"> 1397</span>  hCov-&gt;GetXaxis()-&gt;SetLabelSize(0.015);</div>
<div class="line"><span class="lineno"> 1398</span>  hCov-&gt;GetYaxis()-&gt;SetLabelSize(0.015);</div>
<div class="line"><span class="lineno"> 1399</span>  hCovSq-&gt;GetXaxis()-&gt;SetLabelSize(0.015);</div>
<div class="line"><span class="lineno"> 1400</span>  hCovSq-&gt;GetYaxis()-&gt;SetLabelSize(0.015);</div>
<div class="line"><span class="lineno"> 1401</span>  hCorr-&gt;GetXaxis()-&gt;SetLabelSize(0.015);</div>
<div class="line"><span class="lineno"> 1402</span>  hCorr-&gt;GetYaxis()-&gt;SetLabelSize(0.015);</div>
<div class="line"><span class="lineno"> 1403</span> </div>
<div class="line"><span class="lineno"> 1404</span>  <span class="comment">// Loop over the Covariance matrix entries</span></div>
<div class="line"><span class="lineno"> 1405</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_variable" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>; ++i)</div>
<div class="line"><span class="lineno"> 1406</span>  {</div>
<div class="line"><span class="lineno"> 1407</span>    TString titlex = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><span class="lineno"> 1408</span>    <span class="keywordtype">double</span> nom, err;</div>
<div class="line"><span class="lineno"> 1409</span>    <a class="code hl_function" href="classMCMCProcessor.html#a28dfe42f1bf6fd3a145287be1e63fb0b">GetNthParameter</a>(i, nom, err, titlex);</div>
<div class="line"><span class="lineno"> 1410</span>    </div>
<div class="line"><span class="lineno"> 1411</span>    hCov-&gt;GetXaxis()-&gt;SetBinLabel(i+1, titlex);</div>
<div class="line"><span class="lineno"> 1412</span>    hCovSq-&gt;GetXaxis()-&gt;SetBinLabel(i+1, titlex);</div>
<div class="line"><span class="lineno"> 1413</span>    hCorr-&gt;GetXaxis()-&gt;SetBinLabel(i+1, titlex);</div>
<div class="line"><span class="lineno"> 1414</span> </div>
<div class="line"><span class="lineno"> 1415</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a class="code hl_variable" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>; ++j)</div>
<div class="line"><span class="lineno"> 1416</span>    {</div>
<div class="line"><span class="lineno"> 1417</span>      <span class="comment">// The value of the Covariance</span></div>
<div class="line"><span class="lineno"> 1418</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> cov = (*Covariance)(i,j);</div>
<div class="line"><span class="lineno"> 1419</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> corr = (*Correlation)(i,j);</div>
<div class="line"><span class="lineno"> 1420</span> </div>
<div class="line"><span class="lineno"> 1421</span>      hCov-&gt;SetBinContent(i+1, j+1, cov);</div>
<div class="line"><span class="lineno"> 1422</span>      hCovSq-&gt;SetBinContent(i+1, j+1, ((cov &gt; 0) - (cov &lt; 0))*std::sqrt(std::fabs(cov)));</div>
<div class="line"><span class="lineno"> 1423</span>      hCorr-&gt;SetBinContent(i+1, j+1, corr);</div>
<div class="line"><span class="lineno"> 1424</span> </div>
<div class="line"><span class="lineno"> 1425</span>      TString titley = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><span class="lineno"> 1426</span>      <span class="keywordtype">double</span> nom_j, err_j;</div>
<div class="line"><span class="lineno"> 1427</span>      <a class="code hl_function" href="classMCMCProcessor.html#a28dfe42f1bf6fd3a145287be1e63fb0b">GetNthParameter</a>(j, nom_j, err_j, titley);</div>
<div class="line"><span class="lineno"> 1428</span> </div>
<div class="line"><span class="lineno"> 1429</span>      hCov-&gt;GetYaxis()-&gt;SetBinLabel(j+1, titley);</div>
<div class="line"><span class="lineno"> 1430</span>      hCovSq-&gt;GetYaxis()-&gt;SetBinLabel(j+1, titley);</div>
<div class="line"><span class="lineno"> 1431</span>      hCorr-&gt;GetYaxis()-&gt;SetBinLabel(j+1, titley);</div>
<div class="line"><span class="lineno"> 1432</span>    }</div>
<div class="line"><span class="lineno"> 1433</span>  }</div>
<div class="line"><span class="lineno"> 1434</span> </div>
<div class="line"><span class="lineno"> 1435</span>  <span class="comment">// Take away the stat box</span></div>
<div class="line"><span class="lineno"> 1436</span>  gStyle-&gt;SetOptStat(0);</div>
<div class="line"><span class="lineno"> 1437</span>  <span class="keywordflow">if</span>(<a class="code hl_variable" href="classMCMCProcessor.html#aa7611f55ac3c0ea70607761d037fbd91">plotBinValue</a>)gStyle-&gt;SetPaintTextFormat(<span class="stringliteral">&quot;4.1f&quot;</span>); <span class="comment">//Precision of value in matrix element</span></div>
<div class="line"><span class="lineno"> 1438</span>  <span class="comment">// Make pretty Correlation colors (red to blue)</span></div>
<div class="line"><span class="lineno"> 1439</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> NRGBs = 5;</div>
<div class="line"><span class="lineno"> 1440</span>  TColor::InitializeColors();</div>
<div class="line"><span class="lineno"> 1441</span>  Double_t stops[NRGBs] = { 0.00, 0.25, 0.50, 0.75, 1.00 };</div>
<div class="line"><span class="lineno"> 1442</span>  Double_t red[NRGBs]   = { 0.00, 0.25, 1.00, 1.00, 0.50 };</div>
<div class="line"><span class="lineno"> 1443</span>  Double_t green[NRGBs] = { 0.00, 0.25, 1.00, 0.25, 0.00 };</div>
<div class="line"><span class="lineno"> 1444</span>  Double_t blue[NRGBs]  = { 0.50, 1.00, 1.00, 0.25, 0.00 };</div>
<div class="line"><span class="lineno"> 1445</span>  TColor::CreateGradientColorTable(5, stops, red, green, blue, 255);</div>
<div class="line"><span class="lineno"> 1446</span>  gStyle-&gt;SetNumberContours(255);</div>
<div class="line"><span class="lineno"> 1447</span> </div>
<div class="line"><span class="lineno"> 1448</span>  <span class="comment">// cd into the correlation directory</span></div>
<div class="line"><span class="lineno"> 1449</span>  <a class="code hl_variable" href="classMCMCProcessor.html#a62035b99df4617ab334cd1abd6ed0346">OutputFile</a>-&gt;cd();</div>
<div class="line"><span class="lineno"> 1450</span> </div>
<div class="line"><span class="lineno"> 1451</span>  <a class="code hl_variable" href="classMCMCProcessor.html#a82e6cfef1ba6fcfc8ac8f61acb5bf931">Posterior</a>-&gt;cd();</div>
<div class="line"><span class="lineno"> 1452</span>  <a class="code hl_variable" href="classMCMCProcessor.html#a82e6cfef1ba6fcfc8ac8f61acb5bf931">Posterior</a>-&gt;Clear();</div>
<div class="line"><span class="lineno"> 1453</span>  <span class="keywordflow">if</span>(<a class="code hl_variable" href="classMCMCProcessor.html#aa7611f55ac3c0ea70607761d037fbd91">plotBinValue</a>) hCov-&gt;Draw(<span class="stringliteral">&quot;colz text&quot;</span>);</div>
<div class="line"><span class="lineno"> 1454</span>  <span class="keywordflow">else</span> hCov-&gt;Draw(<span class="stringliteral">&quot;colz&quot;</span>);</div>
<div class="line"><span class="lineno"> 1455</span>  <span class="keywordflow">if</span>(<a class="code hl_variable" href="classMCMCProcessor.html#ad73755714ae3d6dc951158d5513c6eee">printToPDF</a>) <a class="code hl_variable" href="classMCMCProcessor.html#a82e6cfef1ba6fcfc8ac8f61acb5bf931">Posterior</a>-&gt;Print(<a class="code hl_variable" href="classMCMCProcessor.html#ab5aec3dc293919701d31e6ae705601dd">CanvasName</a>);</div>
<div class="line"><span class="lineno"> 1456</span> </div>
<div class="line"><span class="lineno"> 1457</span>  <a class="code hl_variable" href="classMCMCProcessor.html#a82e6cfef1ba6fcfc8ac8f61acb5bf931">Posterior</a>-&gt;cd();</div>
<div class="line"><span class="lineno"> 1458</span>  <a class="code hl_variable" href="classMCMCProcessor.html#a82e6cfef1ba6fcfc8ac8f61acb5bf931">Posterior</a>-&gt;Clear();</div>
<div class="line"><span class="lineno"> 1459</span>  <span class="keywordflow">if</span>(<a class="code hl_variable" href="classMCMCProcessor.html#aa7611f55ac3c0ea70607761d037fbd91">plotBinValue</a>) hCorr-&gt;Draw(<span class="stringliteral">&quot;colz text&quot;</span>);</div>
<div class="line"><span class="lineno"> 1460</span>  <span class="keywordflow">else</span> hCorr-&gt;Draw(<span class="stringliteral">&quot;colz&quot;</span>);</div>
<div class="line"><span class="lineno"> 1461</span>  <span class="keywordflow">if</span>(<a class="code hl_variable" href="classMCMCProcessor.html#ad73755714ae3d6dc951158d5513c6eee">printToPDF</a>) <a class="code hl_variable" href="classMCMCProcessor.html#a82e6cfef1ba6fcfc8ac8f61acb5bf931">Posterior</a>-&gt;Print(<a class="code hl_variable" href="classMCMCProcessor.html#ab5aec3dc293919701d31e6ae705601dd">CanvasName</a>);</div>
<div class="line"><span class="lineno"> 1462</span> </div>
<div class="line"><span class="lineno"> 1463</span>  hCov-&gt;Write(<span class="stringliteral">&quot;Covariance_plot&quot;</span>);</div>
<div class="line"><span class="lineno"> 1464</span>  hCovSq-&gt;Write(<span class="stringliteral">&quot;Covariance_sq_plot&quot;</span>);</div>
<div class="line"><span class="lineno"> 1465</span>  hCorr-&gt;Write(<span class="stringliteral">&quot;Correlation_plot&quot;</span>);</div>
<div class="line"><span class="lineno"> 1466</span>  </div>
<div class="line"><span class="lineno"> 1467</span>  <span class="comment">//Back to normal</span></div>
<div class="line"><span class="lineno"> 1468</span>  <a class="code hl_variable" href="classMCMCProcessor.html#a82e6cfef1ba6fcfc8ac8f61acb5bf931">Posterior</a>-&gt;SetRightMargin(RightMargin);</div>
<div class="line"><span class="lineno"> 1469</span>  <a class="code hl_function" href="classMCMCProcessor.html#a5b0961bcb0eea7a347e6a29ef7738d80">DrawCorrelations1D</a>();</div>
<div class="line"><span class="lineno"> 1470</span>}</div>
<div class="ttc" id="aclassMCMCProcessor_html_a5b0961bcb0eea7a347e6a29ef7738d80"><div class="ttname"><a href="classMCMCProcessor.html#a5b0961bcb0eea7a347e6a29ef7738d80">MCMCProcessor::DrawCorrelations1D</a></div><div class="ttdeci">void DrawCorrelations1D()</div><div class="ttdoc">Draw 1D correlations which might be more helpful than looking at huge 2D Corr matrix.</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8cpp_source.html#l01474">MCMCProcessor.cpp:1474</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ab420de77e598da4b02ba74cdc20f2ea9" name="ab420de77e598da4b02ba74cdc20f2ea9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab420de77e598da4b02ba74cdc20f2ea9">&#9670;&#160;</a></span>DrawPostfit()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void MCMCProcessor::DrawPostfit </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Draw the post-fit comparisons. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8cpp_source.html#l00437">437</a> of file <a class="el" href="MCMCProcessor_8cpp_source.html">MCMCProcessor.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  437</span>                                {</div>
<div class="line"><span class="lineno">  438</span><span class="comment">// *******************</span></div>
<div class="line"><span class="lineno">  439</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="classMCMCProcessor.html#a62035b99df4617ab334cd1abd6ed0346">OutputFile</a> == <span class="keyword">nullptr</span>) <a class="code hl_function" href="classMCMCProcessor.html#aa5a7761e97cf2e24c7d877a5374b7333">MakeOutputFile</a>();</div>
<div class="line"><span class="lineno">  440</span> </div>
<div class="line"><span class="lineno">  441</span>  <span class="comment">// Make the prefit plot</span></div>
<div class="line"><span class="lineno">  442</span>  TH1D* prefit = <a class="code hl_function" href="classMCMCProcessor.html#a03267ff95cb0f4dab0882db852893768">MakePrefit</a>();</div>
<div class="line"><span class="lineno">  443</span> </div>
<div class="line"><span class="lineno">  444</span>  <span class="comment">// cd into the output file</span></div>
<div class="line"><span class="lineno">  445</span>  <a class="code hl_variable" href="classMCMCProcessor.html#a62035b99df4617ab334cd1abd6ed0346">OutputFile</a>-&gt;cd();</div>
<div class="line"><span class="lineno">  446</span> </div>
<div class="line"><span class="lineno">  447</span>  std::string CutPosterior1D = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><span class="lineno">  448</span>  <span class="keywordflow">if</span>(<a class="code hl_variable" href="classMCMCProcessor.html#a85917e25c4f5b5b966c50cccd9ddd6a0">Posterior1DCut</a> != <span class="stringliteral">&quot;&quot;</span>)</div>
<div class="line"><span class="lineno">  449</span>  {</div>
<div class="line"><span class="lineno">  450</span>    CutPosterior1D = <a class="code hl_variable" href="classMCMCProcessor.html#a576f0eb874afaf7e31ff5c86b9e5b8f9">StepCut</a> +<span class="stringliteral">&quot; &amp;&amp; &quot;</span> + <a class="code hl_variable" href="classMCMCProcessor.html#a85917e25c4f5b5b966c50cccd9ddd6a0">Posterior1DCut</a>;</div>
<div class="line"><span class="lineno">  451</span>  }</div>
<div class="line"><span class="lineno">  452</span>  <span class="keywordflow">else</span> CutPosterior1D = <a class="code hl_variable" href="classMCMCProcessor.html#a576f0eb874afaf7e31ff5c86b9e5b8f9">StepCut</a>;</div>
<div class="line"><span class="lineno">  453</span> </div>
<div class="line"><span class="lineno">  454</span>  <span class="comment">// Make a TH1D of the central values and the errors</span></div>
<div class="line"><span class="lineno">  455</span>  TH1D *paramPlot = <span class="keyword">new</span> TH1D(<span class="stringliteral">&quot;paramPlot&quot;</span>, <span class="stringliteral">&quot;paramPlot&quot;</span>, <a class="code hl_variable" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>, 0, <a class="code hl_variable" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>);</div>
<div class="line"><span class="lineno">  456</span>  paramPlot-&gt;SetName(<span class="stringliteral">&quot;mach3params&quot;</span>);</div>
<div class="line"><span class="lineno">  457</span>  paramPlot-&gt;SetTitle(CutPosterior1D.c_str());</div>
<div class="line"><span class="lineno">  458</span>  paramPlot-&gt;SetFillStyle(3001);</div>
<div class="line"><span class="lineno">  459</span>  paramPlot-&gt;SetFillColor(kBlue-1);</div>
<div class="line"><span class="lineno">  460</span>  paramPlot-&gt;SetMarkerColor(paramPlot-&gt;GetFillColor());</div>
<div class="line"><span class="lineno">  461</span>  paramPlot-&gt;SetMarkerStyle(20);</div>
<div class="line"><span class="lineno">  462</span>  paramPlot-&gt;SetLineColor(paramPlot-&gt;GetFillColor());</div>
<div class="line"><span class="lineno">  463</span>  paramPlot-&gt;SetMarkerSize(prefit-&gt;GetMarkerSize());</div>
<div class="line"><span class="lineno">  464</span> </div>
<div class="line"><span class="lineno">  465</span>  <span class="comment">// Same but with Gaussian output</span></div>
<div class="line"><span class="lineno">  466</span>  TH1D *paramPlot_Gauss = <span class="keyword">static_cast&lt;</span>TH1D*<span class="keyword">&gt;</span>(paramPlot-&gt;Clone());</div>
<div class="line"><span class="lineno">  467</span>  paramPlot_Gauss-&gt;SetMarkerColor(kOrange-5);</div>
<div class="line"><span class="lineno">  468</span>  paramPlot_Gauss-&gt;SetMarkerStyle(23);</div>
<div class="line"><span class="lineno">  469</span>  paramPlot_Gauss-&gt;SetLineWidth(2);</div>
<div class="line"><span class="lineno">  470</span>  paramPlot_Gauss-&gt;SetMarkerSize((prefit-&gt;GetMarkerSize())*0.75);</div>
<div class="line"><span class="lineno">  471</span>  paramPlot_Gauss-&gt;SetFillColor(paramPlot_Gauss-&gt;GetMarkerColor());</div>
<div class="line"><span class="lineno">  472</span>  paramPlot_Gauss-&gt;SetFillStyle(3244);</div>
<div class="line"><span class="lineno">  473</span>  paramPlot_Gauss-&gt;SetLineColor(paramPlot_Gauss-&gt;GetMarkerColor());</div>
<div class="line"><span class="lineno">  474</span> </div>
<div class="line"><span class="lineno">  475</span>  <span class="comment">// Same but with Gaussian output</span></div>
<div class="line"><span class="lineno">  476</span>  TH1D *paramPlot_HPD = <span class="keyword">static_cast&lt;</span>TH1D*<span class="keyword">&gt;</span>(paramPlot-&gt;Clone());</div>
<div class="line"><span class="lineno">  477</span>  paramPlot_HPD-&gt;SetMarkerColor(kBlack);</div>
<div class="line"><span class="lineno">  478</span>  paramPlot_HPD-&gt;SetMarkerStyle(25);</div>
<div class="line"><span class="lineno">  479</span>  paramPlot_HPD-&gt;SetLineWidth(2);</div>
<div class="line"><span class="lineno">  480</span>  paramPlot_HPD-&gt;SetMarkerSize((prefit-&gt;GetMarkerSize())*0.5);</div>
<div class="line"><span class="lineno">  481</span>  paramPlot_HPD-&gt;SetFillColor(0);</div>
<div class="line"><span class="lineno">  482</span>  paramPlot_HPD-&gt;SetFillStyle(0);</div>
<div class="line"><span class="lineno">  483</span>  paramPlot_HPD-&gt;SetLineColor(paramPlot_HPD-&gt;GetMarkerColor());</div>
<div class="line"><span class="lineno">  484</span>  </div>
<div class="line"><span class="lineno">  485</span>  <span class="comment">// Set labels and data</span></div>
<div class="line"><span class="lineno">  486</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_variable" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>; ++i)</div>
<div class="line"><span class="lineno">  487</span>  {</div>
<div class="line"><span class="lineno">  488</span>    <span class="comment">//Those keep which parameter type we run currently and realtive number  </span></div>
<div class="line"><span class="lineno">  489</span>    <span class="keywordtype">int</span> ParamEnu = <a class="code hl_variable" href="classMCMCProcessor.html#aaa903949bde8f1a69800c71fe1eb538e">ParamType</a>[i];</div>
<div class="line"><span class="lineno">  490</span>    <span class="keywordtype">int</span> ParamNo = i - <a class="code hl_variable" href="classMCMCProcessor.html#aeab63979ff36256072c046a15d981875">ParamTypeStartPos</a>[<a class="code hl_enumeration" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20b">ParameterEnum</a>(ParamEnu)];</div>
<div class="line"><span class="lineno">  491</span> </div>
<div class="line"><span class="lineno">  492</span>    <span class="comment">//KS: Slightly hacky way to get relative to prior or nominal as this is convention we use</span></div>
<div class="line"><span class="lineno">  493</span>    <span class="comment">//This only applies for xsec for other systematic types doesn&#39;t matter</span></div>
<div class="line"><span class="lineno">  494</span>    <span class="keywordtype">double</span> CentralValueTemp = 0;</div>
<div class="line"><span class="lineno">  495</span>    <span class="keywordtype">double</span> Central, Central_gauss, Central_HPD;</div>
<div class="line"><span class="lineno">  496</span>    <span class="keywordtype">double</span> Err, Err_Gauss, Err_HPD;</div>
<div class="line"><span class="lineno">  497</span>    </div>
<div class="line"><span class="lineno">  498</span>    <span class="keywordflow">if</span>(<a class="code hl_variable" href="classMCMCProcessor.html#afbac2a114c15ca7db4abe71dd549504c">plotRelativeToPrior</a>)</div>
<div class="line"><span class="lineno">  499</span>    {</div>
<div class="line"><span class="lineno">  500</span>      CentralValueTemp = <a class="code hl_variable" href="classMCMCProcessor.html#a3a6614826ae320e462211e38e96d9d02">ParamCentral</a>[ParamEnu][ParamNo];</div>
<div class="line"><span class="lineno">  501</span>      <span class="comment">// Normalise the prior relative the nominal/prior, just the way we get our fit results in MaCh3</span></div>
<div class="line"><span class="lineno">  502</span>      <span class="keywordflow">if</span> ( CentralValueTemp != 0) </div>
<div class="line"><span class="lineno">  503</span>      {</div>
<div class="line"><span class="lineno">  504</span>        Central = (*Means)(i) / CentralValueTemp;</div>
<div class="line"><span class="lineno">  505</span>        Err = (*Errors)(i) / CentralValueTemp;</div>
<div class="line"><span class="lineno">  506</span>            </div>
<div class="line"><span class="lineno">  507</span>        Central_gauss = (*Means_Gauss)(i) / CentralValueTemp;</div>
<div class="line"><span class="lineno">  508</span>        Err_Gauss = (*Errors_Gauss)(i) / CentralValueTemp;</div>
<div class="line"><span class="lineno">  509</span>        </div>
<div class="line"><span class="lineno">  510</span>        Central_HPD = (*Means_HPD)(i) / CentralValueTemp;</div>
<div class="line"><span class="lineno">  511</span>        Err_HPD = (*Errors_HPD)(i) / CentralValueTemp;</div>
<div class="line"><span class="lineno">  512</span>      } </div>
<div class="line"><span class="lineno">  513</span>      <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  514</span>        Central = 1+(*Means)(i);</div>
<div class="line"><span class="lineno">  515</span>        Err = (*Errors)(i);</div>
<div class="line"><span class="lineno">  516</span>            </div>
<div class="line"><span class="lineno">  517</span>        Central_gauss = 1+(*Means_Gauss)(i);</div>
<div class="line"><span class="lineno">  518</span>        Err_Gauss = (*Errors_Gauss)(i);</div>
<div class="line"><span class="lineno">  519</span>        </div>
<div class="line"><span class="lineno">  520</span>        Central_HPD = 1+(*Means_HPD)(i) ;</div>
<div class="line"><span class="lineno">  521</span>        Err_HPD = (*Errors_HPD)(i);</div>
<div class="line"><span class="lineno">  522</span>      }</div>
<div class="line"><span class="lineno">  523</span>    }</div>
<div class="line"><span class="lineno">  524</span>    <span class="comment">//KS: Just get value of each parameter without dividing by prior</span></div>
<div class="line"><span class="lineno">  525</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  526</span>    {</div>
<div class="line"><span class="lineno">  527</span>      Central = (*Means)(i);</div>
<div class="line"><span class="lineno">  528</span>      Err = (*Errors)(i);</div>
<div class="line"><span class="lineno">  529</span>          </div>
<div class="line"><span class="lineno">  530</span>      Central_gauss = (*Means_Gauss)(i);</div>
<div class="line"><span class="lineno">  531</span>      Err_Gauss = (*Errors_Gauss)(i);</div>
<div class="line"><span class="lineno">  532</span>      </div>
<div class="line"><span class="lineno">  533</span>      Central_HPD = (*Means_HPD)(i) ;</div>
<div class="line"><span class="lineno">  534</span>      Err_HPD = (*Errors_HPD)(i);</div>
<div class="line"><span class="lineno">  535</span>    }</div>
<div class="line"><span class="lineno">  536</span>    </div>
<div class="line"><span class="lineno">  537</span>    paramPlot-&gt;SetBinContent(i+1, Central);</div>
<div class="line"><span class="lineno">  538</span>    paramPlot-&gt;SetBinError(i+1, Err);</div>
<div class="line"><span class="lineno">  539</span> </div>
<div class="line"><span class="lineno">  540</span>    paramPlot_Gauss-&gt;SetBinContent(i+1, Central_gauss);</div>
<div class="line"><span class="lineno">  541</span>    paramPlot_Gauss-&gt;SetBinError(i+1, Err_Gauss);</div>
<div class="line"><span class="lineno">  542</span> </div>
<div class="line"><span class="lineno">  543</span>    paramPlot_HPD-&gt;SetBinContent(i+1, Central_HPD);</div>
<div class="line"><span class="lineno">  544</span>    paramPlot_HPD-&gt;SetBinError(i+1, Err_HPD);</div>
<div class="line"><span class="lineno">  545</span>    </div>
<div class="line"><span class="lineno">  546</span>    paramPlot-&gt;GetXaxis()-&gt;SetBinLabel(i+1, prefit-&gt;GetXaxis()-&gt;GetBinLabel(i+1));</div>
<div class="line"><span class="lineno">  547</span>    paramPlot_Gauss-&gt;GetXaxis()-&gt;SetBinLabel(i+1, prefit-&gt;GetXaxis()-&gt;GetBinLabel(i+1));</div>
<div class="line"><span class="lineno">  548</span>    paramPlot_HPD-&gt;GetXaxis()-&gt;SetBinLabel(i+1, prefit-&gt;GetXaxis()-&gt;GetBinLabel(i+1));</div>
<div class="line"><span class="lineno">  549</span>  }</div>
<div class="line"><span class="lineno">  550</span> </div>
<div class="line"><span class="lineno">  551</span>  <span class="comment">// Make a TLegend</span></div>
<div class="line"><span class="lineno">  552</span>  <span class="keyword">auto</span> CompLeg = std::make_unique&lt;TLegend&gt;(0.33, 0.73, 0.76, 0.95);</div>
<div class="line"><span class="lineno">  553</span>  CompLeg-&gt;AddEntry(prefit, <span class="stringliteral">&quot;Prefit&quot;</span>, <span class="stringliteral">&quot;fp&quot;</span>);</div>
<div class="line"><span class="lineno">  554</span>  CompLeg-&gt;AddEntry(paramPlot, <span class="stringliteral">&quot;Postfit PDF&quot;</span>, <span class="stringliteral">&quot;fp&quot;</span>);</div>
<div class="line"><span class="lineno">  555</span>  CompLeg-&gt;AddEntry(paramPlot_Gauss, <span class="stringliteral">&quot;Postfit Gauss&quot;</span>, <span class="stringliteral">&quot;fp&quot;</span>);</div>
<div class="line"><span class="lineno">  556</span>  CompLeg-&gt;AddEntry(paramPlot_HPD, <span class="stringliteral">&quot;Postfit HPD&quot;</span>, <span class="stringliteral">&quot;lfep&quot;</span>);</div>
<div class="line"><span class="lineno">  557</span>  CompLeg-&gt;SetFillColor(0);</div>
<div class="line"><span class="lineno">  558</span>  CompLeg-&gt;SetFillStyle(0);</div>
<div class="line"><span class="lineno">  559</span>  CompLeg-&gt;SetLineWidth(0);</div>
<div class="line"><span class="lineno">  560</span>  CompLeg-&gt;SetLineStyle(0);</div>
<div class="line"><span class="lineno">  561</span>  CompLeg-&gt;SetBorderSize(0);</div>
<div class="line"><span class="lineno">  562</span> </div>
<div class="line"><span class="lineno">  563</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> BottomMargin = <a class="code hl_variable" href="classMCMCProcessor.html#a82e6cfef1ba6fcfc8ac8f61acb5bf931">Posterior</a>-&gt;GetBottomMargin();</div>
<div class="line"><span class="lineno">  564</span>  <a class="code hl_variable" href="classMCMCProcessor.html#a82e6cfef1ba6fcfc8ac8f61acb5bf931">Posterior</a>-&gt;SetBottomMargin(0.2);</div>
<div class="line"><span class="lineno">  565</span> </div>
<div class="line"><span class="lineno">  566</span>  <a class="code hl_variable" href="classMCMCProcessor.html#a62035b99df4617ab334cd1abd6ed0346">OutputFile</a>-&gt;cd();</div>
<div class="line"><span class="lineno">  567</span>  <span class="comment">//KS: Plot Xsec and Flux</span></div>
<div class="line"><span class="lineno">  568</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="classMCMCProcessor.html#a4200e7cbe1c8f811d3640ebfd648ca85">nParam</a>[<a class="code hl_enumvalue" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20ba7386f5611ea4d01b85b9bb92a5ca335f">kXSecPar</a>] &gt; 0)</div>
<div class="line"><span class="lineno">  569</span>  {</div>
<div class="line"><span class="lineno">  570</span>    <span class="keyword">const</span> <span class="keywordtype">int</span> Start = <a class="code hl_variable" href="classMCMCProcessor.html#aeab63979ff36256072c046a15d981875">ParamTypeStartPos</a>[<a class="code hl_enumvalue" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20ba7386f5611ea4d01b85b9bb92a5ca335f">kXSecPar</a>];</div>
<div class="line"><span class="lineno">  571</span>    <span class="comment">// Plot the xsec parameters (0 to ~nXsec-nFlux) nXsec == xsec + flux, quite confusing I know</span></div>
<div class="line"><span class="lineno">  572</span>    <span class="comment">// Have already looked through the branches earlier</span></div>
<div class="line"><span class="lineno">  573</span>    <span class="keywordflow">if</span>(<a class="code hl_variable" href="classMCMCProcessor.html#afbac2a114c15ca7db4abe71dd549504c">plotRelativeToPrior</a>)  prefit-&gt;GetYaxis()-&gt;SetTitle(<span class="stringliteral">&quot;Variation rel. prior&quot;</span>); </div>
<div class="line"><span class="lineno">  574</span>    <span class="keywordflow">else</span> prefit-&gt;GetYaxis()-&gt;SetTitle(<span class="stringliteral">&quot;Parameter Value&quot;</span>);</div>
<div class="line"><span class="lineno">  575</span>    prefit-&gt;GetYaxis()-&gt;SetRangeUser(-2.5, 2.5);</div>
<div class="line"><span class="lineno">  576</span>    prefit-&gt;GetXaxis()-&gt;SetTitle(<span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><span class="lineno">  577</span>    prefit-&gt;GetXaxis()-&gt;LabelsOption(<span class="stringliteral">&quot;v&quot;</span>);</div>
<div class="line"><span class="lineno">  578</span> </div>
<div class="line"><span class="lineno">  579</span>    prefit-&gt;GetXaxis()-&gt;SetRangeUser(Start, Start + <a class="code hl_variable" href="classMCMCProcessor.html#a4200e7cbe1c8f811d3640ebfd648ca85">nParam</a>[<a class="code hl_enumvalue" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20ba7386f5611ea4d01b85b9bb92a5ca335f">kXSecPar</a>]-<a class="code hl_variable" href="classMCMCProcessor.html#acfc681553c5fbba89e133dfda605db3c">nFlux</a>);</div>
<div class="line"><span class="lineno">  580</span>    paramPlot-&gt;GetXaxis()-&gt;SetRangeUser(Start, Start + <a class="code hl_variable" href="classMCMCProcessor.html#a4200e7cbe1c8f811d3640ebfd648ca85">nParam</a>[<a class="code hl_enumvalue" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20ba7386f5611ea4d01b85b9bb92a5ca335f">kXSecPar</a>]-<a class="code hl_variable" href="classMCMCProcessor.html#acfc681553c5fbba89e133dfda605db3c">nFlux</a>);</div>
<div class="line"><span class="lineno">  581</span>    paramPlot_Gauss-&gt;GetXaxis()-&gt;SetRangeUser(Start, Start+ <a class="code hl_variable" href="classMCMCProcessor.html#a4200e7cbe1c8f811d3640ebfd648ca85">nParam</a>[<a class="code hl_enumvalue" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20ba7386f5611ea4d01b85b9bb92a5ca335f">kXSecPar</a>]-<a class="code hl_variable" href="classMCMCProcessor.html#acfc681553c5fbba89e133dfda605db3c">nFlux</a>);</div>
<div class="line"><span class="lineno">  582</span>    paramPlot_HPD-&gt;GetXaxis()-&gt;SetRangeUser(Start, Start + <a class="code hl_variable" href="classMCMCProcessor.html#a4200e7cbe1c8f811d3640ebfd648ca85">nParam</a>[<a class="code hl_enumvalue" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20ba7386f5611ea4d01b85b9bb92a5ca335f">kXSecPar</a>]-<a class="code hl_variable" href="classMCMCProcessor.html#acfc681553c5fbba89e133dfda605db3c">nFlux</a>);</div>
<div class="line"><span class="lineno">  583</span> </div>
<div class="line"><span class="lineno">  584</span>    <span class="comment">// Write the individual ones</span></div>
<div class="line"><span class="lineno">  585</span>    prefit-&gt;Write(<span class="stringliteral">&quot;param_xsec_prefit&quot;</span>);</div>
<div class="line"><span class="lineno">  586</span>    paramPlot-&gt;Write(<span class="stringliteral">&quot;param_xsec&quot;</span>);</div>
<div class="line"><span class="lineno">  587</span>    paramPlot_Gauss-&gt;Write(<span class="stringliteral">&quot;param_xsec_gaus&quot;</span>);</div>
<div class="line"><span class="lineno">  588</span>    paramPlot_HPD-&gt;Write(<span class="stringliteral">&quot;param_xsec_HPD&quot;</span>);</div>
<div class="line"><span class="lineno">  589</span>    </div>
<div class="line"><span class="lineno">  590</span>    <span class="comment">// And the combined</span></div>
<div class="line"><span class="lineno">  591</span>    prefit-&gt;Draw(<span class="stringliteral">&quot;e2&quot;</span>);</div>
<div class="line"><span class="lineno">  592</span>    paramPlot-&gt;Draw(<span class="stringliteral">&quot;e2, same&quot;</span>);</div>
<div class="line"><span class="lineno">  593</span>    paramPlot_Gauss-&gt;Draw(<span class="stringliteral">&quot;e2, same&quot;</span>);</div>
<div class="line"><span class="lineno">  594</span>    paramPlot_HPD-&gt;Draw(<span class="stringliteral">&quot;e1, same&quot;</span>);</div>
<div class="line"><span class="lineno">  595</span>    CompLeg-&gt;Draw(<span class="stringliteral">&quot;same&quot;</span>);</div>
<div class="line"><span class="lineno">  596</span>    <a class="code hl_variable" href="classMCMCProcessor.html#a82e6cfef1ba6fcfc8ac8f61acb5bf931">Posterior</a>-&gt;Write(<span class="stringliteral">&quot;param_xsec_canv&quot;</span>);</div>
<div class="line"><span class="lineno">  597</span>    <span class="keywordflow">if</span>(<a class="code hl_variable" href="classMCMCProcessor.html#ad73755714ae3d6dc951158d5513c6eee">printToPDF</a>) <a class="code hl_variable" href="classMCMCProcessor.html#a82e6cfef1ba6fcfc8ac8f61acb5bf931">Posterior</a>-&gt;Print(<a class="code hl_variable" href="classMCMCProcessor.html#ab5aec3dc293919701d31e6ae705601dd">CanvasName</a>);</div>
<div class="line"><span class="lineno">  598</span>    <a class="code hl_variable" href="classMCMCProcessor.html#a82e6cfef1ba6fcfc8ac8f61acb5bf931">Posterior</a>-&gt;Clear();</div>
<div class="line"><span class="lineno">  599</span>  </div>
<div class="line"><span class="lineno">  600</span>    <a class="code hl_variable" href="classMCMCProcessor.html#a62035b99df4617ab334cd1abd6ed0346">OutputFile</a>-&gt;cd();</div>
<div class="line"><span class="lineno">  601</span>    <span class="comment">// Plot the flux parameters (nXSec to nxsec+nflux) if enabled</span></div>
<div class="line"><span class="lineno">  602</span>    <span class="comment">// Have already looked through the branches earlier</span></div>
<div class="line"><span class="lineno">  603</span>    prefit-&gt;GetYaxis()-&gt;SetRangeUser(0.7, 1.3);</div>
<div class="line"><span class="lineno">  604</span>    paramPlot-&gt;GetYaxis()-&gt;SetRangeUser(0.7, 1.3);</div>
<div class="line"><span class="lineno">  605</span>    paramPlot_Gauss-&gt;GetYaxis()-&gt;SetRangeUser(0.7, 1.3);</div>
<div class="line"><span class="lineno">  606</span>    paramPlot_HPD-&gt;GetYaxis()-&gt;SetRangeUser(0.7, 1.3);</div>
<div class="line"><span class="lineno">  607</span>    </div>
<div class="line"><span class="lineno">  608</span>    prefit-&gt;GetXaxis()-&gt;SetRangeUser(Start + <a class="code hl_variable" href="classMCMCProcessor.html#a4200e7cbe1c8f811d3640ebfd648ca85">nParam</a>[<a class="code hl_enumvalue" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20ba7386f5611ea4d01b85b9bb92a5ca335f">kXSecPar</a>]-<a class="code hl_variable" href="classMCMCProcessor.html#acfc681553c5fbba89e133dfda605db3c">nFlux</a>, Start + <a class="code hl_variable" href="classMCMCProcessor.html#a4200e7cbe1c8f811d3640ebfd648ca85">nParam</a>[<a class="code hl_enumvalue" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20ba7386f5611ea4d01b85b9bb92a5ca335f">kXSecPar</a>]);</div>
<div class="line"><span class="lineno">  609</span>    paramPlot-&gt;GetXaxis()-&gt;SetRangeUser(Start + <a class="code hl_variable" href="classMCMCProcessor.html#a4200e7cbe1c8f811d3640ebfd648ca85">nParam</a>[<a class="code hl_enumvalue" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20ba7386f5611ea4d01b85b9bb92a5ca335f">kXSecPar</a>]-<a class="code hl_variable" href="classMCMCProcessor.html#acfc681553c5fbba89e133dfda605db3c">nFlux</a>, Start + <a class="code hl_variable" href="classMCMCProcessor.html#a4200e7cbe1c8f811d3640ebfd648ca85">nParam</a>[<a class="code hl_enumvalue" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20ba7386f5611ea4d01b85b9bb92a5ca335f">kXSecPar</a>]);</div>
<div class="line"><span class="lineno">  610</span>    paramPlot_Gauss-&gt;GetXaxis()-&gt;SetRangeUser(Start + <a class="code hl_variable" href="classMCMCProcessor.html#a4200e7cbe1c8f811d3640ebfd648ca85">nParam</a>[<a class="code hl_enumvalue" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20ba7386f5611ea4d01b85b9bb92a5ca335f">kXSecPar</a>]-<a class="code hl_variable" href="classMCMCProcessor.html#acfc681553c5fbba89e133dfda605db3c">nFlux</a>, Start + <a class="code hl_variable" href="classMCMCProcessor.html#a4200e7cbe1c8f811d3640ebfd648ca85">nParam</a>[<a class="code hl_enumvalue" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20ba7386f5611ea4d01b85b9bb92a5ca335f">kXSecPar</a>]);</div>
<div class="line"><span class="lineno">  611</span>    paramPlot_HPD-&gt;GetXaxis()-&gt;SetRangeUser(Start + <a class="code hl_variable" href="classMCMCProcessor.html#a4200e7cbe1c8f811d3640ebfd648ca85">nParam</a>[<a class="code hl_enumvalue" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20ba7386f5611ea4d01b85b9bb92a5ca335f">kXSecPar</a>]-<a class="code hl_variable" href="classMCMCProcessor.html#acfc681553c5fbba89e133dfda605db3c">nFlux</a>, Start + <a class="code hl_variable" href="classMCMCProcessor.html#a4200e7cbe1c8f811d3640ebfd648ca85">nParam</a>[<a class="code hl_enumvalue" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20ba7386f5611ea4d01b85b9bb92a5ca335f">kXSecPar</a>]);</div>
<div class="line"><span class="lineno">  612</span> </div>
<div class="line"><span class="lineno">  613</span>    prefit-&gt;Write(<span class="stringliteral">&quot;param_flux_prefit&quot;</span>);</div>
<div class="line"><span class="lineno">  614</span>    paramPlot-&gt;Write(<span class="stringliteral">&quot;param_flux&quot;</span>);</div>
<div class="line"><span class="lineno">  615</span>    paramPlot_Gauss-&gt;Write(<span class="stringliteral">&quot;param_flux_gaus&quot;</span>);</div>
<div class="line"><span class="lineno">  616</span>    paramPlot_HPD-&gt;Write(<span class="stringliteral">&quot;param_flux_HPD&quot;</span>);</div>
<div class="line"><span class="lineno">  617</span> </div>
<div class="line"><span class="lineno">  618</span>    prefit-&gt;Draw(<span class="stringliteral">&quot;e2&quot;</span>);</div>
<div class="line"><span class="lineno">  619</span>    paramPlot-&gt;Draw(<span class="stringliteral">&quot;e2, same&quot;</span>);</div>
<div class="line"><span class="lineno">  620</span>    paramPlot_Gauss-&gt;Draw(<span class="stringliteral">&quot;e1, same&quot;</span>);</div>
<div class="line"><span class="lineno">  621</span>    paramPlot_HPD-&gt;Draw(<span class="stringliteral">&quot;e1, same&quot;</span>);</div>
<div class="line"><span class="lineno">  622</span>    CompLeg-&gt;Draw(<span class="stringliteral">&quot;same&quot;</span>);</div>
<div class="line"><span class="lineno">  623</span>    <a class="code hl_variable" href="classMCMCProcessor.html#a82e6cfef1ba6fcfc8ac8f61acb5bf931">Posterior</a>-&gt;Write(<span class="stringliteral">&quot;param_flux_canv&quot;</span>);</div>
<div class="line"><span class="lineno">  624</span>    <span class="keywordflow">if</span>(<a class="code hl_variable" href="classMCMCProcessor.html#ad73755714ae3d6dc951158d5513c6eee">printToPDF</a>) <a class="code hl_variable" href="classMCMCProcessor.html#a82e6cfef1ba6fcfc8ac8f61acb5bf931">Posterior</a>-&gt;Print(<a class="code hl_variable" href="classMCMCProcessor.html#ab5aec3dc293919701d31e6ae705601dd">CanvasName</a>);</div>
<div class="line"><span class="lineno">  625</span>    <a class="code hl_variable" href="classMCMCProcessor.html#a82e6cfef1ba6fcfc8ac8f61acb5bf931">Posterior</a>-&gt;Clear();</div>
<div class="line"><span class="lineno">  626</span>  }</div>
<div class="line"><span class="lineno">  627</span>  <span class="keywordflow">if</span>(<a class="code hl_variable" href="classMCMCProcessor.html#a4200e7cbe1c8f811d3640ebfd648ca85">nParam</a>[<a class="code hl_enumvalue" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20ba4ac215e1a6cd9e776ec0a230f62a0bb4">kNDPar</a>] &gt; 0)</div>
<div class="line"><span class="lineno">  628</span>  {</div>
<div class="line"><span class="lineno">  629</span>    <span class="keywordtype">int</span> Start = <a class="code hl_variable" href="classMCMCProcessor.html#aeab63979ff36256072c046a15d981875">ParamTypeStartPos</a>[<a class="code hl_enumvalue" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20ba4ac215e1a6cd9e776ec0a230f62a0bb4">kNDPar</a>];</div>
<div class="line"><span class="lineno">  630</span>    <span class="keywordtype">int</span> NDbinCounter = Start;</div>
<div class="line"><span class="lineno">  631</span>    <span class="comment">//KS: Make prefit postfit for each ND sample, having all of them at the same plot is unreadable</span></div>
<div class="line"><span class="lineno">  632</span>    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_variable" href="classMCMCProcessor.html#a27c8a25155baab660fc9658861c433ab">NDSamplesNames</a>.size(); i++ )</div>
<div class="line"><span class="lineno">  633</span>    {</div>
<div class="line"><span class="lineno">  634</span>      std::string NDname = <a class="code hl_variable" href="classMCMCProcessor.html#a27c8a25155baab660fc9658861c433ab">NDSamplesNames</a>[i];</div>
<div class="line"><span class="lineno">  635</span>      NDbinCounter += <a class="code hl_variable" href="classMCMCProcessor.html#ae76b02ce85737d30c778698ba127933b">NDSamplesBins</a>[i];</div>
<div class="line"><span class="lineno">  636</span>      <a class="code hl_variable" href="classMCMCProcessor.html#a62035b99df4617ab334cd1abd6ed0346">OutputFile</a>-&gt;cd();</div>
<div class="line"><span class="lineno">  637</span>      prefit-&gt;GetYaxis()-&gt;SetTitle((<span class="stringliteral">&quot;Variation for &quot;</span>+NDname).c_str());</div>
<div class="line"><span class="lineno">  638</span>      prefit-&gt;GetYaxis()-&gt;SetRangeUser(0.6, 1.4);</div>
<div class="line"><span class="lineno">  639</span>      prefit-&gt;GetXaxis()-&gt;SetRangeUser(Start, NDbinCounter);</div>
<div class="line"><span class="lineno">  640</span>      prefit-&gt;GetXaxis()-&gt;SetTitle();</div>
<div class="line"><span class="lineno">  641</span>      prefit-&gt;GetXaxis()-&gt;LabelsOption(<span class="stringliteral">&quot;v&quot;</span>);</div>
<div class="line"><span class="lineno">  642</span> </div>
<div class="line"><span class="lineno">  643</span>      paramPlot-&gt;GetYaxis()-&gt;SetTitle((<span class="stringliteral">&quot;Variation for &quot;</span>+NDname).c_str());</div>
<div class="line"><span class="lineno">  644</span>      paramPlot-&gt;GetYaxis()-&gt;SetRangeUser(0.6, 1.4);</div>
<div class="line"><span class="lineno">  645</span>      paramPlot-&gt;GetXaxis()-&gt;SetRangeUser(Start, NDbinCounter);</div>
<div class="line"><span class="lineno">  646</span>      paramPlot-&gt;GetXaxis()-&gt;SetTitle(<span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><span class="lineno">  647</span>      paramPlot-&gt;SetTitle(CutPosterior1D.c_str());</div>
<div class="line"><span class="lineno">  648</span>      paramPlot-&gt;GetXaxis()-&gt;LabelsOption(<span class="stringliteral">&quot;v&quot;</span>);</div>
<div class="line"><span class="lineno">  649</span> </div>
<div class="line"><span class="lineno">  650</span>      paramPlot_Gauss-&gt;GetYaxis()-&gt;SetTitle((<span class="stringliteral">&quot;Variation for &quot;</span>+NDname).c_str());</div>
<div class="line"><span class="lineno">  651</span>      paramPlot_Gauss-&gt;GetYaxis()-&gt;SetRangeUser(0.6, 1.4);</div>
<div class="line"><span class="lineno">  652</span>      paramPlot_Gauss-&gt;GetXaxis()-&gt;SetRangeUser(Start, NDbinCounter);</div>
<div class="line"><span class="lineno">  653</span>      paramPlot_Gauss-&gt;GetXaxis()-&gt;SetTitle(<span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><span class="lineno">  654</span>      paramPlot_Gauss-&gt;SetTitle(CutPosterior1D.c_str());</div>
<div class="line"><span class="lineno">  655</span>      paramPlot_Gauss-&gt;GetXaxis()-&gt;LabelsOption(<span class="stringliteral">&quot;v&quot;</span>);</div>
<div class="line"><span class="lineno">  656</span> </div>
<div class="line"><span class="lineno">  657</span>      paramPlot_HPD-&gt;GetYaxis()-&gt;SetTitle((<span class="stringliteral">&quot;Variation for &quot;</span>+NDname).c_str());</div>
<div class="line"><span class="lineno">  658</span>      paramPlot_HPD-&gt;GetYaxis()-&gt;SetRangeUser(0.6, 1.4);</div>
<div class="line"><span class="lineno">  659</span>      paramPlot_HPD-&gt;GetXaxis()-&gt;SetRangeUser(Start, NDbinCounter);</div>
<div class="line"><span class="lineno">  660</span>      paramPlot_HPD-&gt;GetXaxis()-&gt;SetTitle(<span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><span class="lineno">  661</span>      paramPlot_HPD-&gt;SetTitle(CutPosterior1D.c_str());</div>
<div class="line"><span class="lineno">  662</span>      paramPlot_HPD-&gt;GetXaxis()-&gt;LabelsOption(<span class="stringliteral">&quot;v&quot;</span>);</div>
<div class="line"><span class="lineno">  663</span> </div>
<div class="line"><span class="lineno">  664</span>      prefit-&gt;Write((<span class="stringliteral">&quot;param_&quot;</span>+NDname+<span class="stringliteral">&quot;_prefit&quot;</span>).c_str());</div>
<div class="line"><span class="lineno">  665</span>      paramPlot-&gt;Write((<span class="stringliteral">&quot;param_&quot;</span>+NDname).c_str());</div>
<div class="line"><span class="lineno">  666</span>      paramPlot_Gauss-&gt;Write((<span class="stringliteral">&quot;param_&quot;</span>+NDname+<span class="stringliteral">&quot;_gaus&quot;</span>).c_str());</div>
<div class="line"><span class="lineno">  667</span>      paramPlot_HPD-&gt;Write((<span class="stringliteral">&quot;param_&quot;</span>+NDname+<span class="stringliteral">&quot;_HPD&quot;</span>).c_str());</div>
<div class="line"><span class="lineno">  668</span> </div>
<div class="line"><span class="lineno">  669</span>      prefit-&gt;Draw(<span class="stringliteral">&quot;e2&quot;</span>);</div>
<div class="line"><span class="lineno">  670</span>      paramPlot-&gt;Draw(<span class="stringliteral">&quot;e2, same&quot;</span>);</div>
<div class="line"><span class="lineno">  671</span>      paramPlot_Gauss-&gt;Draw(<span class="stringliteral">&quot;e1, same&quot;</span>);</div>
<div class="line"><span class="lineno">  672</span>      paramPlot_HPD-&gt;Draw(<span class="stringliteral">&quot;e1, same&quot;</span>);</div>
<div class="line"><span class="lineno">  673</span>      CompLeg-&gt;Draw(<span class="stringliteral">&quot;same&quot;</span>);</div>
<div class="line"><span class="lineno">  674</span>      <a class="code hl_variable" href="classMCMCProcessor.html#a82e6cfef1ba6fcfc8ac8f61acb5bf931">Posterior</a>-&gt;Write((<span class="stringliteral">&quot;param_&quot;</span>+NDname+<span class="stringliteral">&quot;_canv&quot;</span>).c_str());</div>
<div class="line"><span class="lineno">  675</span>      <span class="keywordflow">if</span>(<a class="code hl_variable" href="classMCMCProcessor.html#ad73755714ae3d6dc951158d5513c6eee">printToPDF</a>) <a class="code hl_variable" href="classMCMCProcessor.html#a82e6cfef1ba6fcfc8ac8f61acb5bf931">Posterior</a>-&gt;Print(<a class="code hl_variable" href="classMCMCProcessor.html#ab5aec3dc293919701d31e6ae705601dd">CanvasName</a>);</div>
<div class="line"><span class="lineno">  676</span>      <a class="code hl_variable" href="classMCMCProcessor.html#a82e6cfef1ba6fcfc8ac8f61acb5bf931">Posterior</a>-&gt;Clear();</div>
<div class="line"><span class="lineno">  677</span>      Start += <a class="code hl_variable" href="classMCMCProcessor.html#ae76b02ce85737d30c778698ba127933b">NDSamplesBins</a>[i];</div>
<div class="line"><span class="lineno">  678</span>    }</div>
<div class="line"><span class="lineno">  679</span>  }</div>
<div class="line"><span class="lineno">  680</span>  <span class="keyword">delete</span> prefit;</div>
<div class="line"><span class="lineno">  681</span>  <span class="keyword">delete</span> paramPlot;</div>
<div class="line"><span class="lineno">  682</span>  <span class="keyword">delete</span> paramPlot_Gauss;</div>
<div class="line"><span class="lineno">  683</span>  <span class="keyword">delete</span> paramPlot_HPD;</div>
<div class="line"><span class="lineno">  684</span> </div>
<div class="line"><span class="lineno">  685</span>  <span class="comment">//KS: Return Margin to default one</span></div>
<div class="line"><span class="lineno">  686</span>  <a class="code hl_variable" href="classMCMCProcessor.html#a82e6cfef1ba6fcfc8ac8f61acb5bf931">Posterior</a>-&gt;SetBottomMargin(BottomMargin);</div>
<div class="line"><span class="lineno">  687</span>}</div>
<div class="ttc" id="aMCMCProcessor_8h_html_acd2848273413543fe14936252942c20b"><div class="ttname"><a href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20b">ParameterEnum</a></div><div class="ttdeci">ParameterEnum</div><div class="ttdoc">KS: Enum for different covariance classes.</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8h_source.html#l00051">MCMCProcessor.h:51</a></div></div>
<div class="ttc" id="aMCMCProcessor_8h_html_acd2848273413543fe14936252942c20ba4ac215e1a6cd9e776ec0a230f62a0bb4"><div class="ttname"><a href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20ba4ac215e1a6cd9e776ec0a230f62a0bb4">kNDPar</a></div><div class="ttdeci">@ kNDPar</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8h_source.html#l00053">MCMCProcessor.h:53</a></div></div>
<div class="ttc" id="aMCMCProcessor_8h_html_acd2848273413543fe14936252942c20ba7386f5611ea4d01b85b9bb92a5ca335f"><div class="ttname"><a href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20ba7386f5611ea4d01b85b9bb92a5ca335f">kXSecPar</a></div><div class="ttdeci">@ kXSecPar</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8h_source.html#l00052">MCMCProcessor.h:52</a></div></div>
<div class="ttc" id="aclassMCMCProcessor_html_a03267ff95cb0f4dab0882db852893768"><div class="ttname"><a href="classMCMCProcessor.html#a03267ff95cb0f4dab0882db852893768">MCMCProcessor::MakePrefit</a></div><div class="ttdeci">TH1D * MakePrefit()</div><div class="ttdoc">Prepare prefit histogram for parameter overlay plot.</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8cpp_source.html#l02319">MCMCProcessor.cpp:2319</a></div></div>
<div class="ttc" id="aclassMCMCProcessor_html_a27c8a25155baab660fc9658861c433ab"><div class="ttname"><a href="classMCMCProcessor.html#a27c8a25155baab660fc9658861c433ab">MCMCProcessor::NDSamplesNames</a></div><div class="ttdeci">std::vector&lt; std::string &gt; NDSamplesNames</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8h_source.html#l00417">MCMCProcessor.h:417</a></div></div>
<div class="ttc" id="aclassMCMCProcessor_html_aa5a7761e97cf2e24c7d877a5374b7333"><div class="ttname"><a href="classMCMCProcessor.html#aa5a7761e97cf2e24c7d877a5374b7333">MCMCProcessor::MakeOutputFile</a></div><div class="ttdeci">void MakeOutputFile()</div><div class="ttdoc">prepare output root file and canvas to which we will save EVERYTHING</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8cpp_source.html#l00205">MCMCProcessor.cpp:205</a></div></div>
<div class="ttc" id="aclassMCMCProcessor_html_aaa903949bde8f1a69800c71fe1eb538e"><div class="ttname"><a href="classMCMCProcessor.html#aaa903949bde8f1a69800c71fe1eb538e">MCMCProcessor::ParamType</a></div><div class="ttdeci">std::vector&lt; ParameterEnum &gt; ParamType</div><div class="ttdoc">Make an enum for which class this parameter belongs to so we don't have to keep string comparing.</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8h_source.html#l00371">MCMCProcessor.h:371</a></div></div>
<div class="ttc" id="aclassMCMCProcessor_html_ae76b02ce85737d30c778698ba127933b"><div class="ttname"><a href="classMCMCProcessor.html#ae76b02ce85737d30c778698ba127933b">MCMCProcessor::NDSamplesBins</a></div><div class="ttdeci">std::vector&lt; int &gt; NDSamplesBins</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8h_source.html#l00416">MCMCProcessor.h:416</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aea15e730ff77556bb93bc4cff675744c" name="aea15e730ff77556bb93bc4cff675744c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aea15e730ff77556bb93bc4cff675744c">&#9670;&#160;</a></span>FindInputFiles()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void MCMCProcessor::FindInputFiles </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Read the output MCMC file and find what inputs were used. </p>
<dl class="section warning"><dt>Warning</dt><dd>There is bit of hardcoding for names so we should revisit it </dd></dl>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8cpp_source.html#l02397">2397</a> of file <a class="el" href="MCMCProcessor_8cpp_source.html">MCMCProcessor.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2397</span>                                   {</div>
<div class="line"><span class="lineno"> 2398</span><span class="comment">// **************************</span></div>
<div class="line"><span class="lineno"> 2399</span>  <span class="comment">// Now read the MCMC file</span></div>
<div class="line"><span class="lineno"> 2400</span>  TFile *TempFile = <span class="keyword">new</span> TFile(<a class="code hl_variable" href="classMCMCProcessor.html#a6d212d77a818304a8674a7b9b18d43b8">MCMCFile</a>.c_str(), <span class="stringliteral">&quot;open&quot;</span>);</div>
<div class="line"><span class="lineno"> 2401</span>  TDirectory* CovarianceFolder = TempFile-&gt;Get&lt;TDirectory&gt;(<span class="stringliteral">&quot;CovarianceFolder&quot;</span>);</div>
<div class="line"><span class="lineno"> 2402</span> </div>
<div class="line"><span class="lineno"> 2403</span>  <span class="comment">// Get the settings for the MCMC</span></div>
<div class="line"><span class="lineno"> 2404</span>  TMacro *Config = TempFile-&gt;Get&lt;TMacro&gt;(<span class="stringliteral">&quot;MaCh3_Config&quot;</span>);</div>
<div class="line"><span class="lineno"> 2405</span> </div>
<div class="line"><span class="lineno"> 2406</span>  <span class="keywordflow">if</span> (Config == <span class="keyword">nullptr</span>) {</div>
<div class="line"><span class="lineno"> 2407</span>    <a class="code hl_define" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Didn&#39;t find MaCh3_Config tree in MCMC file! {}&quot;</span>, <a class="code hl_variable" href="classMCMCProcessor.html#a6d212d77a818304a8674a7b9b18d43b8">MCMCFile</a>);</div>
<div class="line"><span class="lineno"> 2408</span>    TempFile-&gt;ls();</div>
<div class="line"><span class="lineno"> 2409</span>    <span class="keywordflow">throw</span> <a class="code hl_class" href="classMaCh3Exception.html">MaCh3Exception</a>(__FILE__ , __LINE__ );</div>
<div class="line"><span class="lineno"> 2410</span>  }</div>
<div class="line"><span class="lineno"> 2411</span>  <span class="comment">//KS:Most inputs are in ${MACH3}/inputs/blarb.root</span></div>
<div class="line"><span class="lineno"> 2412</span>  <span class="keywordflow">if</span> (std::getenv(<span class="stringliteral">&quot;MACH3&quot;</span>) != <span class="keyword">nullptr</span>) {</div>
<div class="line"><span class="lineno"> 2413</span>    <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Found MACH3 environment variable: {}&quot;</span>, std::getenv(<span class="stringliteral">&quot;MACH3&quot;</span>));</div>
<div class="line"><span class="lineno"> 2414</span>  }</div>
<div class="line"><span class="lineno"> 2415</span> </div>
<div class="line"><span class="lineno"> 2416</span>  <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Loading YAML config from MCMC chain&quot;</span>);</div>
<div class="line"><span class="lineno"> 2417</span> </div>
<div class="line"><span class="lineno"> 2418</span>  YAML::Node Settings = <a class="code hl_function" href="YamlHelper_8h.html#a7e0ade2fd295a927676c243c97d0aa64">TMacroToYAML</a>(*Config);</div>
<div class="line"><span class="lineno"> 2419</span> </div>
<div class="line"><span class="lineno"> 2420</span>  <span class="keywordtype">bool</span> InputNotFound = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 2421</span>  <span class="comment">//CW: Get the xsec Covariance matrix</span></div>
<div class="line"><span class="lineno"> 2422</span>  <a class="code hl_variable" href="classMCMCProcessor.html#a7c6afb0ed75207fd02c28e408f0592d4">CovPos</a>[<a class="code hl_enumvalue" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20ba7386f5611ea4d01b85b9bb92a5ca335f">kXSecPar</a>] = GetFromManager&lt;std::vector&lt;std::string&gt;&gt;(Settings[<span class="stringliteral">&quot;General&quot;</span>][<span class="stringliteral">&quot;Systematics&quot;</span>][<span class="stringliteral">&quot;XsecCovFile&quot;</span>], {<span class="stringliteral">&quot;none&quot;</span>});</div>
<div class="line"><span class="lineno"> 2423</span>  <span class="keywordflow">if</span>(<a class="code hl_variable" href="classMCMCProcessor.html#a7c6afb0ed75207fd02c28e408f0592d4">CovPos</a>[<a class="code hl_enumvalue" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20ba7386f5611ea4d01b85b9bb92a5ca335f">kXSecPar</a>].back() == <span class="stringliteral">&quot;none&quot;</span>)</div>
<div class="line"><span class="lineno"> 2424</span>  {</div>
<div class="line"><span class="lineno"> 2425</span>    <a class="code hl_define" href="MaCh3Logger_8h.html#ad5b2eb6377721e3ac95def22c2386bb1">MACH3LOG_WARN</a>(<span class="stringliteral">&quot;Couldn&#39;t find XsecCov branch in output&quot;</span>);</div>
<div class="line"><span class="lineno"> 2426</span>    InputNotFound = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 2427</span>  }</div>
<div class="line"><span class="lineno"> 2428</span> </div>
<div class="line"><span class="lineno"> 2429</span> </div>
<div class="line"><span class="lineno"> 2430</span>  TMacro *XsecConfig = CovarianceFolder-&gt;Get&lt;TMacro&gt;(<span class="stringliteral">&quot;Config_xsec_cov&quot;</span>);</div>
<div class="line"><span class="lineno"> 2431</span>  <span class="keywordflow">if</span> (XsecConfig == <span class="keyword">nullptr</span>) {</div>
<div class="line"><span class="lineno"> 2432</span>    <a class="code hl_define" href="MaCh3Logger_8h.html#ad5b2eb6377721e3ac95def22c2386bb1">MACH3LOG_WARN</a>(<span class="stringliteral">&quot;Didn&#39;t find Config_xsec_cov tree in MCMC file! {}&quot;</span>, <a class="code hl_variable" href="classMCMCProcessor.html#a6d212d77a818304a8674a7b9b18d43b8">MCMCFile</a>);</div>
<div class="line"><span class="lineno"> 2433</span>  } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 2434</span>    <a class="code hl_variable" href="classMCMCProcessor.html#a4c1330a025c0b91e382bdc29c960424a">CovConfig</a>[<a class="code hl_enumvalue" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20ba7386f5611ea4d01b85b9bb92a5ca335f">kXSecPar</a>] = <a class="code hl_function" href="YamlHelper_8h.html#a7e0ade2fd295a927676c243c97d0aa64">TMacroToYAML</a>(*XsecConfig);</div>
<div class="line"><span class="lineno"> 2435</span>  }</div>
<div class="line"><span class="lineno"> 2436</span>  <span class="comment">//CW: And the ND Covariance matrix</span></div>
<div class="line"><span class="lineno"> 2437</span>  <a class="code hl_variable" href="classMCMCProcessor.html#a7c6afb0ed75207fd02c28e408f0592d4">CovPos</a>[<a class="code hl_enumvalue" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20ba4ac215e1a6cd9e776ec0a230f62a0bb4">kNDPar</a>].push_back(GetFromManager&lt;std::string&gt;(Settings[<span class="stringliteral">&quot;General&quot;</span>][<span class="stringliteral">&quot;Systematics&quot;</span>][<span class="stringliteral">&quot;NDCovFile&quot;</span>], <span class="stringliteral">&quot;none&quot;</span>));</div>
<div class="line"><span class="lineno"> 2438</span>  <span class="keywordflow">if</span>(<a class="code hl_variable" href="classMCMCProcessor.html#a7c6afb0ed75207fd02c28e408f0592d4">CovPos</a>[<a class="code hl_enumvalue" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20ba4ac215e1a6cd9e776ec0a230f62a0bb4">kNDPar</a>].back() == <span class="stringliteral">&quot;none&quot;</span>) {</div>
<div class="line"><span class="lineno"> 2439</span>    <a class="code hl_define" href="MaCh3Logger_8h.html#ad5b2eb6377721e3ac95def22c2386bb1">MACH3LOG_WARN</a>(<span class="stringliteral">&quot;Couldn&#39;t find NDCov branch in output&quot;</span>);</div>
<div class="line"><span class="lineno"> 2440</span>    InputNotFound = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 2441</span>  }</div>
<div class="line"><span class="lineno"> 2442</span> </div>
<div class="line"><span class="lineno"> 2443</span>  <span class="comment">//CW: And the FD Covariance matrix</span></div>
<div class="line"><span class="lineno"> 2444</span>  <a class="code hl_variable" href="classMCMCProcessor.html#a7c6afb0ed75207fd02c28e408f0592d4">CovPos</a>[<a class="code hl_enumvalue" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20bad7032c60390bd4bb843950e9a7afcdae">kFDDetPar</a>].push_back(GetFromManager&lt;std::string&gt;(Settings[<span class="stringliteral">&quot;General&quot;</span>][<span class="stringliteral">&quot;Systematics&quot;</span>][<span class="stringliteral">&quot;FDCovFile&quot;</span>], <span class="stringliteral">&quot;none&quot;</span>));</div>
<div class="line"><span class="lineno"> 2445</span>  <span class="keywordflow">if</span>(<a class="code hl_variable" href="classMCMCProcessor.html#a7c6afb0ed75207fd02c28e408f0592d4">CovPos</a>[<a class="code hl_enumvalue" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20bad7032c60390bd4bb843950e9a7afcdae">kFDDetPar</a>].back() == <span class="stringliteral">&quot;none&quot;</span>) {</div>
<div class="line"><span class="lineno"> 2446</span>    <a class="code hl_define" href="MaCh3Logger_8h.html#ad5b2eb6377721e3ac95def22c2386bb1">MACH3LOG_WARN</a>(<span class="stringliteral">&quot;Couldn&#39;t find FDCov branch in output&quot;</span>);</div>
<div class="line"><span class="lineno"> 2447</span>    InputNotFound = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 2448</span>  }</div>
<div class="line"><span class="lineno"> 2449</span> </div>
<div class="line"><span class="lineno"> 2450</span>  <span class="comment">//CW: And the Osc Covariance matrix</span></div>
<div class="line"><span class="lineno"> 2451</span>  <a class="code hl_variable" href="classMCMCProcessor.html#a7c6afb0ed75207fd02c28e408f0592d4">CovPos</a>[<a class="code hl_enumvalue" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20ba03865cac80b3eb8f5ef46421eb8dab06">kOSCPar</a>] = GetFromManager&lt;std::vector&lt;std::string&gt;&gt;(Settings[<span class="stringliteral">&quot;General&quot;</span>][<span class="stringliteral">&quot;Systematics&quot;</span>][<span class="stringliteral">&quot;OscCovFile&quot;</span>], {<span class="stringliteral">&quot;none&quot;</span>});</div>
<div class="line"><span class="lineno"> 2452</span>  <span class="keywordflow">if</span>(<a class="code hl_variable" href="classMCMCProcessor.html#a7c6afb0ed75207fd02c28e408f0592d4">CovPos</a>[<a class="code hl_enumvalue" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20ba03865cac80b3eb8f5ef46421eb8dab06">kOSCPar</a>].back() == <span class="stringliteral">&quot;none&quot;</span>) {</div>
<div class="line"><span class="lineno"> 2453</span>    <a class="code hl_define" href="MaCh3Logger_8h.html#ad5b2eb6377721e3ac95def22c2386bb1">MACH3LOG_WARN</a>(<span class="stringliteral">&quot;Couldn&#39;t find OscCov branch in output&quot;</span>);</div>
<div class="line"><span class="lineno"> 2454</span>    InputNotFound = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 2455</span>  }</div>
<div class="line"><span class="lineno"> 2456</span>  TMacro *OscConfig = CovarianceFolder-&gt;Get&lt;TMacro&gt;(<span class="stringliteral">&quot;Config_osc_cov&quot;</span>);</div>
<div class="line"><span class="lineno"> 2457</span>  <span class="keywordflow">if</span> (OscConfig == <span class="keyword">nullptr</span>) {</div>
<div class="line"><span class="lineno"> 2458</span>    <a class="code hl_define" href="MaCh3Logger_8h.html#ad5b2eb6377721e3ac95def22c2386bb1">MACH3LOG_WARN</a>(<span class="stringliteral">&quot;Didn&#39;t find Config_osc_cov tree in MCMC file! {}&quot;</span>, <a class="code hl_variable" href="classMCMCProcessor.html#a6d212d77a818304a8674a7b9b18d43b8">MCMCFile</a>);</div>
<div class="line"><span class="lineno"> 2459</span>  } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 2460</span>    <a class="code hl_variable" href="classMCMCProcessor.html#a4c1330a025c0b91e382bdc29c960424a">CovConfig</a>[<a class="code hl_enumvalue" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20ba03865cac80b3eb8f5ef46421eb8dab06">kOSCPar</a>] =  <a class="code hl_function" href="YamlHelper_8h.html#a7e0ade2fd295a927676c243c97d0aa64">TMacroToYAML</a>(*OscConfig);</div>
<div class="line"><span class="lineno"> 2461</span>  }</div>
<div class="line"><span class="lineno"> 2462</span> </div>
<div class="line"><span class="lineno"> 2463</span>  <span class="keywordflow">if</span>(InputNotFound) <a class="code hl_function" href="namespaceMaCh3Utils.html#aaf39f873ebf93550a417418e583ebcf8">MaCh3Utils::PrintConfig</a>(Settings);</div>
<div class="line"><span class="lineno"> 2464</span> </div>
<div class="line"><span class="lineno"> 2465</span>  <span class="keywordflow">if</span> (<span class="keyword">const</span> <span class="keywordtype">char</span> * mach3_env = std::getenv(<span class="stringliteral">&quot;MACH3&quot;</span>))</div>
<div class="line"><span class="lineno"> 2466</span>  {</div>
<div class="line"><span class="lineno"> 2467</span>    <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> i = 0; i &lt; <a class="code hl_variable" href="classMCMCProcessor.html#a7c6afb0ed75207fd02c28e408f0592d4">CovPos</a>[<a class="code hl_enumvalue" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20ba7386f5611ea4d01b85b9bb92a5ca335f">kXSecPar</a>].size(); i++)</div>
<div class="line"><span class="lineno"> 2468</span>      <a class="code hl_variable" href="classMCMCProcessor.html#a7c6afb0ed75207fd02c28e408f0592d4">CovPos</a>[<a class="code hl_enumvalue" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20ba7386f5611ea4d01b85b9bb92a5ca335f">kXSecPar</a>][i].insert(0, std::string(mach3_env)+<span class="stringliteral">&quot;/&quot;</span>);</div>
<div class="line"><span class="lineno"> 2469</span> </div>
<div class="line"><span class="lineno"> 2470</span>    <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> i = 0; i &lt; <a class="code hl_variable" href="classMCMCProcessor.html#a7c6afb0ed75207fd02c28e408f0592d4">CovPos</a>[<a class="code hl_enumvalue" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20ba4ac215e1a6cd9e776ec0a230f62a0bb4">kNDPar</a>].size(); i++)</div>
<div class="line"><span class="lineno"> 2471</span>      <a class="code hl_variable" href="classMCMCProcessor.html#a7c6afb0ed75207fd02c28e408f0592d4">CovPos</a>[<a class="code hl_enumvalue" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20ba4ac215e1a6cd9e776ec0a230f62a0bb4">kNDPar</a>][i].insert(0, std::string(mach3_env)+<span class="stringliteral">&quot;/&quot;</span>);</div>
<div class="line"><span class="lineno"> 2472</span> </div>
<div class="line"><span class="lineno"> 2473</span>    <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> i = 0; i &lt; <a class="code hl_variable" href="classMCMCProcessor.html#a7c6afb0ed75207fd02c28e408f0592d4">CovPos</a>[<a class="code hl_enumvalue" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20bad7032c60390bd4bb843950e9a7afcdae">kFDDetPar</a>].size(); i++)</div>
<div class="line"><span class="lineno"> 2474</span>      <a class="code hl_variable" href="classMCMCProcessor.html#a7c6afb0ed75207fd02c28e408f0592d4">CovPos</a>[<a class="code hl_enumvalue" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20bad7032c60390bd4bb843950e9a7afcdae">kFDDetPar</a>][i].insert(0, std::string(mach3_env)+<span class="stringliteral">&quot;/&quot;</span>);</div>
<div class="line"><span class="lineno"> 2475</span> </div>
<div class="line"><span class="lineno"> 2476</span>    <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> i = 0; i &lt; <a class="code hl_variable" href="classMCMCProcessor.html#a7c6afb0ed75207fd02c28e408f0592d4">CovPos</a>[<a class="code hl_enumvalue" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20ba03865cac80b3eb8f5ef46421eb8dab06">kOSCPar</a>].size(); i++)</div>
<div class="line"><span class="lineno"> 2477</span>      <a class="code hl_variable" href="classMCMCProcessor.html#a7c6afb0ed75207fd02c28e408f0592d4">CovPos</a>[<a class="code hl_enumvalue" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20ba03865cac80b3eb8f5ef46421eb8dab06">kOSCPar</a>][i].insert(0, std::string(mach3_env)+<span class="stringliteral">&quot;/&quot;</span>);</div>
<div class="line"><span class="lineno"> 2478</span>  }</div>
<div class="line"><span class="lineno"> 2479</span> </div>
<div class="line"><span class="lineno"> 2480</span>  <span class="comment">// Delete the TTrees and the input file handle since we&#39;ve now got the settings we need</span></div>
<div class="line"><span class="lineno"> 2481</span>  <span class="keyword">delete</span> Config;</div>
<div class="line"><span class="lineno"> 2482</span>  <span class="keyword">delete</span> XsecConfig;</div>
<div class="line"><span class="lineno"> 2483</span>  <span class="keyword">delete</span> OscConfig;</div>
<div class="line"><span class="lineno"> 2484</span> </div>
<div class="line"><span class="lineno"> 2485</span>  <span class="comment">// Delete the MCMCFile pointer we&#39;re reading</span></div>
<div class="line"><span class="lineno"> 2486</span>  CovarianceFolder-&gt;Close();</div>
<div class="line"><span class="lineno"> 2487</span>  <span class="keyword">delete</span> CovarianceFolder;</div>
<div class="line"><span class="lineno"> 2488</span>  TempFile-&gt;Close();</div>
<div class="line"><span class="lineno"> 2489</span>  <span class="keyword">delete</span> TempFile;</div>
<div class="line"><span class="lineno"> 2490</span>}</div>
<div class="ttc" id="aMCMCProcessor_8h_html_acd2848273413543fe14936252942c20ba03865cac80b3eb8f5ef46421eb8dab06"><div class="ttname"><a href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20ba03865cac80b3eb8f5ef46421eb8dab06">kOSCPar</a></div><div class="ttdeci">@ kOSCPar</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8h_source.html#l00055">MCMCProcessor.h:55</a></div></div>
<div class="ttc" id="aMCMCProcessor_8h_html_acd2848273413543fe14936252942c20bad7032c60390bd4bb843950e9a7afcdae"><div class="ttname"><a href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20bad7032c60390bd4bb843950e9a7afcdae">kFDDetPar</a></div><div class="ttdeci">@ kFDDetPar</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8h_source.html#l00054">MCMCProcessor.h:54</a></div></div>
<div class="ttc" id="aMaCh3Logger_8h_html_ad5b2eb6377721e3ac95def22c2386bb1"><div class="ttname"><a href="MaCh3Logger_8h.html#ad5b2eb6377721e3ac95def22c2386bb1">MACH3LOG_WARN</a></div><div class="ttdeci">#define MACH3LOG_WARN</div><div class="ttdef"><b>Definition:</b> <a href="MaCh3Logger_8h_source.html#l00017">MaCh3Logger.h:17</a></div></div>
<div class="ttc" id="aYamlHelper_8h_html_a7e0ade2fd295a927676c243c97d0aa64"><div class="ttname"><a href="YamlHelper_8h.html#a7e0ade2fd295a927676c243c97d0aa64">TMacroToYAML</a></div><div class="ttdeci">YAML::Node TMacroToYAML(const TMacro &amp;macro)</div><div class="ttdoc">KS: Convert a ROOT TMacro object to a YAML node.</div><div class="ttdef"><b>Definition:</b> <a href="YamlHelper_8h_source.html#l00150">YamlHelper.h:150</a></div></div>
<div class="ttc" id="anamespaceMaCh3Utils_html_aaf39f873ebf93550a417418e583ebcf8"><div class="ttname"><a href="namespaceMaCh3Utils.html#aaf39f873ebf93550a417418e583ebcf8">MaCh3Utils::PrintConfig</a></div><div class="ttdeci">void PrintConfig(const YAML::Node &amp;node)</div><div class="ttdoc">KS: Print Yaml config using logger.</div><div class="ttdef"><b>Definition:</b> <a href="Monitor_8cpp_source.html#l00273">Monitor.cpp:273</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a1fc5adc3c109227e6ead71eb0746ec4d" name="a1fc5adc3c109227e6ead71eb0746ec4d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1fc5adc3c109227e6ead71eb0746ec4d">&#9670;&#160;</a></span>GetBayesFactor()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void MCMCProcessor::GetBayesFactor </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; std::string &gt; &amp;&#160;</td>
          <td class="paramname"><em>ParName</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; std::vector&lt; double &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>Model1Bounds</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; std::vector&lt; double &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>Model2Bounds</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; std::vector&lt; std::string &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>ModelNames</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate Bayes factor for vector of params, and model boundaries. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ParName</td><td>Vector with parameter names for which we calculate Bayes factor </td></tr>
    <tr><td class="paramname">Model1Bounds</td><td>Lower and upper bound for hypothesis 1. Within this bound we calculate integral used later for Bayes Factor </td></tr>
    <tr><td class="paramname">Model2Bounds</td><td>Lower and upper bound for hypothesis 2. Within this bound we calculate integral used later for Bayes Factor </td></tr>
    <tr><td class="paramname">ModelNames</td><td>Names for hypothesis 1 and 2 </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8cpp_source.html#l02826">2826</a> of file <a class="el" href="MCMCProcessor_8cpp_source.html">MCMCProcessor.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2829</span>                                                                                     {</div>
<div class="line"><span class="lineno"> 2830</span><span class="comment">// **************************</span></div>
<div class="line"><span class="lineno"> 2831</span>  <span class="keywordflow">if</span>(<a class="code hl_variable" href="classMCMCProcessor.html#a795f661ed1ba8b8ae54c41fde5fb9496">hpost</a>[0] == <span class="keyword">nullptr</span>) <a class="code hl_function" href="classMCMCProcessor.html#a8667510132aa01395520f028287f511b">MakePostfit</a>();</div>
<div class="line"><span class="lineno"> 2832</span> </div>
<div class="line"><span class="lineno"> 2833</span>  <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Calculating Bayes Factor&quot;</span>);</div>
<div class="line"><span class="lineno"> 2834</span>  <span class="keywordflow">if</span>((ParNames.size() != Model1Bounds.size()) || (Model2Bounds.size() != Model1Bounds.size())  || (Model2Bounds.size() != ModelNames.size()))</div>
<div class="line"><span class="lineno"> 2835</span>  {</div>
<div class="line"><span class="lineno"> 2836</span>    <a class="code hl_define" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Size doesn&#39;t match&quot;</span>);</div>
<div class="line"><span class="lineno"> 2837</span>    <span class="keywordflow">throw</span> <a class="code hl_class" href="classMaCh3Exception.html">MaCh3Exception</a>(__FILE__ , __LINE__ );</div>
<div class="line"><span class="lineno"> 2838</span>  }</div>
<div class="line"><span class="lineno"> 2839</span>  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> k = 0; k &lt; ParNames.size(); ++k)</div>
<div class="line"><span class="lineno"> 2840</span>  {</div>
<div class="line"><span class="lineno"> 2841</span>    <span class="comment">//KS: First we need to find parameter number based on name</span></div>
<div class="line"><span class="lineno"> 2842</span>    <span class="keywordtype">int</span> ParamNo = <a class="code hl_function" href="classMCMCProcessor.html#a5ab91183fbbf23fff759fefc9954a1a5">GetParamIndexFromName</a>(ParNames[k]);</div>
<div class="line"><span class="lineno"> 2843</span>    <span class="keywordtype">bool</span> skip = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 2844</span>    <span class="keywordflow">if</span>(ParamNo == <a class="code hl_define" href="MCMCProcessor_8h.html#a82a6d79039474bc403b627437a7b97ec">_UNDEF_</a>)</div>
<div class="line"><span class="lineno"> 2845</span>    {</div>
<div class="line"><span class="lineno"> 2846</span>      <a class="code hl_define" href="MaCh3Logger_8h.html#ad5b2eb6377721e3ac95def22c2386bb1">MACH3LOG_WARN</a>(<span class="stringliteral">&quot;Couldn&#39;t find param {}. Will not calculate Bayes Factor&quot;</span>, ParNames[k]);</div>
<div class="line"><span class="lineno"> 2847</span>      skip = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 2848</span>    }</div>
<div class="line"><span class="lineno"> 2849</span>    <span class="keywordflow">if</span>(skip) <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 2850</span> </div>
<div class="line"><span class="lineno"> 2851</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> M1_min = Model1Bounds[k][0];</div>
<div class="line"><span class="lineno"> 2852</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> M2_min = Model2Bounds[k][0];</div>
<div class="line"><span class="lineno"> 2853</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> M1_max = Model1Bounds[k][1];</div>
<div class="line"><span class="lineno"> 2854</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> M2_max = Model2Bounds[k][1];</div>
<div class="line"><span class="lineno"> 2855</span> </div>
<div class="line"><span class="lineno"> 2856</span>    <span class="keywordtype">long</span> <span class="keywordtype">double</span> IntegralMode1 = <a class="code hl_variable" href="classMCMCProcessor.html#a795f661ed1ba8b8ae54c41fde5fb9496">hpost</a>[ParamNo]-&gt;Integral(<a class="code hl_variable" href="classMCMCProcessor.html#a795f661ed1ba8b8ae54c41fde5fb9496">hpost</a>[ParamNo]-&gt;FindFixBin(M1_min), <a class="code hl_variable" href="classMCMCProcessor.html#a795f661ed1ba8b8ae54c41fde5fb9496">hpost</a>[ParamNo]-&gt;FindFixBin(M1_max));</div>
<div class="line"><span class="lineno"> 2857</span>    <span class="keywordtype">long</span> <span class="keywordtype">double</span> IntegralMode2 = <a class="code hl_variable" href="classMCMCProcessor.html#a795f661ed1ba8b8ae54c41fde5fb9496">hpost</a>[ParamNo]-&gt;Integral(<a class="code hl_variable" href="classMCMCProcessor.html#a795f661ed1ba8b8ae54c41fde5fb9496">hpost</a>[ParamNo]-&gt;FindFixBin(M2_min), <a class="code hl_variable" href="classMCMCProcessor.html#a795f661ed1ba8b8ae54c41fde5fb9496">hpost</a>[ParamNo]-&gt;FindFixBin(M2_max));</div>
<div class="line"><span class="lineno"> 2858</span> </div>
<div class="line"><span class="lineno"> 2859</span>    <span class="keywordtype">double</span> BayesFactor = 0.;</div>
<div class="line"><span class="lineno"> 2860</span>    std::string Name = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><span class="lineno"> 2861</span>    <span class="comment">//KS: Calc Bayes Factor</span></div>
<div class="line"><span class="lineno"> 2862</span>    <span class="comment">//If M1 is more likely</span></div>
<div class="line"><span class="lineno"> 2863</span>    <span class="keywordflow">if</span>(IntegralMode1 &gt;= IntegralMode2)</div>
<div class="line"><span class="lineno"> 2864</span>    {</div>
<div class="line"><span class="lineno"> 2865</span>      BayesFactor = IntegralMode1/IntegralMode2;</div>
<div class="line"><span class="lineno"> 2866</span>      Name = <span class="stringliteral">&quot;\\mathfrak{B}(&quot;</span> + ModelNames[k][0]+ <span class="stringliteral">&quot;/&quot;</span> + ModelNames[k][1] + <span class="stringliteral">&quot;) = &quot;</span> + std::to_string(BayesFactor);</div>
<div class="line"><span class="lineno"> 2867</span>    }</div>
<div class="line"><span class="lineno"> 2868</span>    <span class="keywordflow">else</span> <span class="comment">//If M2 is more likely</span></div>
<div class="line"><span class="lineno"> 2869</span>    {</div>
<div class="line"><span class="lineno"> 2870</span>      BayesFactor = IntegralMode2/IntegralMode1;</div>
<div class="line"><span class="lineno"> 2871</span>      Name = <span class="stringliteral">&quot;\\mathfrak{B}(&quot;</span> + ModelNames[k][1]+ <span class="stringliteral">&quot;/&quot;</span> + ModelNames[k][0] + <span class="stringliteral">&quot;) = &quot;</span> + std::to_string(BayesFactor);</div>
<div class="line"><span class="lineno"> 2872</span>    }</div>
<div class="line"><span class="lineno"> 2873</span>    std::string JeffreysScale = <a class="code hl_function" href="StatisticalUtils_8h.html#aac0e253784ed2f2a3258d68df22a2568">GetJeffreysScale</a>(BayesFactor);</div>
<div class="line"><span class="lineno"> 2874</span>    std::string DunneKabothScale = <a class="code hl_function" href="StatisticalUtils_8h.html#acf403b05be9baa719893db7449e833c7">GetDunneKaboth</a>(BayesFactor);</div>
<div class="line"><span class="lineno"> 2875</span> </div>
<div class="line"><span class="lineno"> 2876</span>    <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;{} for {}&quot;</span>, Name, ParNames[k]);</div>
<div class="line"><span class="lineno"> 2877</span>    <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Following Jeffreys Scale = &quot;</span>, JeffreysScale);</div>
<div class="line"><span class="lineno"> 2878</span>    <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Following Dunne-Kaboth Scale = &quot;</span>, DunneKabothScale);</div>
<div class="line"><span class="lineno"> 2879</span>    std::cout&lt;&lt;std::endl;</div>
<div class="line"><span class="lineno"> 2880</span>  }</div>
<div class="line"><span class="lineno"> 2881</span>}</div>
<div class="ttc" id="aStatisticalUtils_8h_html_aac0e253784ed2f2a3258d68df22a2568"><div class="ttname"><a href="StatisticalUtils_8h.html#aac0e253784ed2f2a3258d68df22a2568">GetJeffreysScale</a></div><div class="ttdeci">std::string GetJeffreysScale(const double BayesFactor)</div><div class="ttdoc">KS: Following H. Jeffreys .</div><div class="ttdef"><b>Definition:</b> <a href="StatisticalUtils_8h_source.html#l00021">StatisticalUtils.h:21</a></div></div>
<div class="ttc" id="aStatisticalUtils_8h_html_acf403b05be9baa719893db7449e833c7"><div class="ttname"><a href="StatisticalUtils_8h.html#acf403b05be9baa719893db7449e833c7">GetDunneKaboth</a></div><div class="ttdeci">std::string GetDunneKaboth(const double BayesFactor)</div><div class="ttdoc">KS: Based on Table 1 in https://www.t2k.org/docs/technotes/435.</div><div class="ttdef"><b>Definition:</b> <a href="StatisticalUtils_8h_source.html#l00038">StatisticalUtils.h:38</a></div></div>
<div class="ttc" id="aclassMCMCProcessor_html_a5ab91183fbbf23fff759fefc9954a1a5"><div class="ttname"><a href="classMCMCProcessor.html#a5ab91183fbbf23fff759fefc9954a1a5">MCMCProcessor::GetParamIndexFromName</a></div><div class="ttdeci">int GetParamIndexFromName(const std::string &amp;Name)</div><div class="ttdoc">Get parameter number based on name.</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8cpp_source.html#l02708">MCMCProcessor.cpp:2708</a></div></div>
<div class="ttc" id="aclassMCMCProcessor_html_a8667510132aa01395520f028287f511b"><div class="ttname"><a href="classMCMCProcessor.html#a8667510132aa01395520f028287f511b">MCMCProcessor::MakePostfit</a></div><div class="ttdeci">void MakePostfit()</div><div class="ttdoc">Make 1D projection for each parameter and prepare structure.</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8cpp_source.html#l00239">MCMCProcessor.cpp:239</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a3905a8c1e333cb52a192c0cfaf1a0949" name="a3905a8c1e333cb52a192c0cfaf1a0949"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3905a8c1e333cb52a192c0cfaf1a0949">&#9670;&#160;</a></span>GetBranchNames()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const std::vector&lt; TString &gt; &amp; MCMCProcessor::GetBranchNames </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get the vector of branch names from root file. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00208">208</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  208</span>{ <span class="keywordflow">return</span> <a class="code hl_variable" href="classMCMCProcessor.html#ad043b6b2c885f47ab9967831bc8d0f5a">BranchNames</a>;};</div>
</div><!-- fragment -->
</div>
</div>
<a id="ac9e4fdea5d2de92a1abad5b79b7daf88" name="ac9e4fdea5d2de92a1abad5b79b7daf88"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac9e4fdea5d2de92a1abad5b79b7daf88">&#9670;&#160;</a></span>GetCovariance()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void MCMCProcessor::GetCovariance </td>
          <td>(</td>
          <td class="paramtype">TMatrixDSym *&amp;&#160;</td>
          <td class="paramname"><em>Cov</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TMatrixDSym *&amp;&#160;</td>
          <td class="paramname"><em>Corr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get the post-fit covariances and correlations. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">Cov</td><td>Covariance matrix </td></tr>
    <tr><td class="paramname">Corr</td><td>Correlation matrix </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8cpp_source.html#l00196">196</a> of file <a class="el" href="MCMCProcessor_8cpp_source.html">MCMCProcessor.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  196</span>                                                                       {</div>
<div class="line"><span class="lineno">  197</span><span class="comment">// ***************</span></div>
<div class="line"><span class="lineno">  198</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="classMCMCProcessor.html#aea84f0315695aa05ec41fcf965b1b031">CacheMCMC</a>) <a class="code hl_function" href="classMCMCProcessor.html#ab367cb5f56606338bb1fce780f2414e8">MakeCovariance_MP</a>();</div>
<div class="line"><span class="lineno">  199</span>  <span class="keywordflow">else</span> <a class="code hl_function" href="classMCMCProcessor.html#afc94f21ffd599b1e2dd7e62f24f6c4de">MakeCovariance</a>();</div>
<div class="line"><span class="lineno">  200</span>  Cov = <span class="keyword">static_cast&lt;</span>TMatrixDSym*<span class="keyword">&gt;</span>(<a class="code hl_variable" href="classMCMCProcessor.html#af9a40632e2d7f1266d69a74d5b5f2244">Covariance</a>-&gt;Clone());</div>
<div class="line"><span class="lineno">  201</span>  Corr = <span class="keyword">static_cast&lt;</span>TMatrixDSym*<span class="keyword">&gt;</span>(<a class="code hl_variable" href="classMCMCProcessor.html#a03f28431158777cdd81d058b6632a92f">Correlation</a>-&gt;Clone());</div>
<div class="line"><span class="lineno">  202</span>}</div>
<div class="ttc" id="aclassMCMCProcessor_html_ab367cb5f56606338bb1fce780f2414e8"><div class="ttname"><a href="classMCMCProcessor.html#ab367cb5f56606338bb1fce780f2414e8">MCMCProcessor::MakeCovariance_MP</a></div><div class="ttdeci">void MakeCovariance_MP(const bool Mute=false)</div><div class="ttdoc">Calculate covariance by making 2D projection of each combination of parameters using multithreading.</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8cpp_source.html#l01204">MCMCProcessor.cpp:1204</a></div></div>
<div class="ttc" id="aclassMCMCProcessor_html_afc94f21ffd599b1e2dd7e62f24f6c4de"><div class="ttname"><a href="classMCMCProcessor.html#afc94f21ffd599b1e2dd7e62f24f6c4de">MCMCProcessor::MakeCovariance</a></div><div class="ttdeci">void MakeCovariance()</div><div class="ttdoc">Calculate covariance by making 2D projection of each combination of parameters.</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8cpp_source.html#l00987">MCMCProcessor.cpp:987</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ab831ff0257b1f3137e1711df115a8b8d" name="ab831ff0257b1f3137e1711df115a8b8d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab831ff0257b1f3137e1711df115a8b8d">&#9670;&#160;</a></span>GetFDCov()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::string MCMCProcessor::GetFDCov </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00195">195</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  195</span>{ <span class="keywordflow">return</span> <a class="code hl_variable" href="classMCMCProcessor.html#a7c6afb0ed75207fd02c28e408f0592d4">CovPos</a>[<a class="code hl_enumvalue" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20bad7032c60390bd4bb843950e9a7afcdae">kFDDetPar</a>].back(); };</div>
</div><!-- fragment -->
</div>
</div>
<a id="a70f5590946414af43c3b6c3a5cd315de" name="a70f5590946414af43c3b6c3a5cd315de"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a70f5590946414af43c3b6c3a5cd315de">&#9670;&#160;</a></span>GetHpost()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">TH1D * MCMCProcessor::GetHpost </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>i</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get 1D posterior for a given parameter. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">i</td><td>parameter index </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00182">182</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  182</span>{ <span class="keywordflow">return</span> <a class="code hl_variable" href="classMCMCProcessor.html#a795f661ed1ba8b8ae54c41fde5fb9496">hpost</a>[i]; };</div>
</div><!-- fragment -->
</div>
</div>
<a id="a7882d6c6a54bb345df394ef13b2962d1" name="a7882d6c6a54bb345df394ef13b2962d1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7882d6c6a54bb345df394ef13b2962d1">&#9670;&#160;</a></span>GetHpost2D()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">TH2D * MCMCProcessor::GetHpost2D </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>j</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get 2D posterior for a given parameter combination. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">i</td><td>parameter index X </td></tr>
    <tr><td class="paramname">j</td><td>parameter index Y </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00186">186</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  186</span>{ <span class="keywordflow">return</span> <a class="code hl_variable" href="classMCMCProcessor.html#a0ddcfa4ba1e4dcdea366d88decc64391">hpost2D</a>[i][j]; };</div>
</div><!-- fragment -->
</div>
</div>
<a id="ad26a853f53f50f5625b1c8043534dbe0" name="ad26a853f53f50f5625b1c8043534dbe0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad26a853f53f50f5625b1c8043534dbe0">&#9670;&#160;</a></span>GetNDCov()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::string MCMCProcessor::GetNDCov </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00194">194</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  194</span>{ <span class="keywordflow">return</span> <a class="code hl_variable" href="classMCMCProcessor.html#a7c6afb0ed75207fd02c28e408f0592d4">CovPos</a>[<a class="code hl_enumvalue" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20ba4ac215e1a6cd9e776ec0a230f62a0bb4">kNDPar</a>].back(); };</div>
</div><!-- fragment -->
</div>
</div>
<a id="a7f00ad66e9eb7a910ef6e9e081c4154d" name="a7f00ad66e9eb7a910ef6e9e081c4154d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7f00ad66e9eb7a910ef6e9e081c4154d">&#9670;&#160;</a></span>GetnEntries()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Long64_t MCMCProcessor::GetnEntries </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get Number of entries that Chain has, for merged chains will not be the same Nsteps. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00214">214</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  214</span>{<span class="keywordflow">return</span> <a class="code hl_variable" href="classMCMCProcessor.html#af3a19b885e9c34e1674aea8cfbe14e1c">nEntries</a>;};</div>
</div><!-- fragment -->
</div>
</div>
<a id="ad376c15dcf60a4284dfa23368e097450" name="ad376c15dcf60a4284dfa23368e097450"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad376c15dcf60a4284dfa23368e097450">&#9670;&#160;</a></span>GetNFD()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int MCMCProcessor::GetNFD </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00177">177</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  177</span>{ <span class="keywordflow">return</span> <a class="code hl_variable" href="classMCMCProcessor.html#a4200e7cbe1c8f811d3640ebfd648ca85">nParam</a>[<a class="code hl_enumvalue" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20bad7032c60390bd4bb843950e9a7afcdae">kFDDetPar</a>]; };</div>
</div><!-- fragment -->
</div>
</div>
<a id="a82e67c2a28b286aae353636782c93a23" name="a82e67c2a28b286aae353636782c93a23"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a82e67c2a28b286aae353636782c93a23">&#9670;&#160;</a></span>GetNFlux()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int MCMCProcessor::GetNFlux </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00174">174</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  174</span>{ <span class="keywordflow">return</span> <a class="code hl_variable" href="classMCMCProcessor.html#acfc681553c5fbba89e133dfda605db3c">nFlux</a>; };</div>
</div><!-- fragment -->
</div>
</div>
<a id="af92fab1bce506912ae00d1aa5d9b7233" name="af92fab1bce506912ae00d1aa5d9b7233"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af92fab1bce506912ae00d1aa5d9b7233">&#9670;&#160;</a></span>GetNND()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int MCMCProcessor::GetNND </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00176">176</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  176</span>{ <span class="keywordflow">return</span> <a class="code hl_variable" href="classMCMCProcessor.html#a4200e7cbe1c8f811d3640ebfd648ca85">nParam</a>[<a class="code hl_enumvalue" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20ba4ac215e1a6cd9e776ec0a230f62a0bb4">kNDPar</a>]; };</div>
</div><!-- fragment -->
</div>
</div>
<a id="adbde2f115d983b233d0a9ea896187586" name="adbde2f115d983b233d0a9ea896187586"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adbde2f115d983b233d0a9ea896187586">&#9670;&#160;</a></span>GetNParams()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int MCMCProcessor::GetNParams </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get total number of used parameters. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00173">173</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  173</span>{ <span class="keywordflow">return</span> <a class="code hl_variable" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>; };</div>
</div><!-- fragment -->
</div>
</div>
<a id="aa2ebe9262f7f28778d92148164a54d4b" name="aa2ebe9262f7f28778d92148164a54d4b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa2ebe9262f7f28778d92148164a54d4b">&#9670;&#160;</a></span>GetnSteps()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Long64_t MCMCProcessor::GetnSteps </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get Number of Steps that Chain has, for merged chains will not be the same nEntries. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00216">216</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  216</span>{<span class="keywordflow">return</span> <a class="code hl_variable" href="classMCMCProcessor.html#aae0016a4e1d105d5d65243438c622a97">nSteps</a>;};</div>
</div><!-- fragment -->
</div>
</div>
<a id="a28dfe42f1bf6fd3a145287be1e63fb0b" name="a28dfe42f1bf6fd3a145287be1e63fb0b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a28dfe42f1bf6fd3a145287be1e63fb0b">&#9670;&#160;</a></span>GetNthParameter()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void MCMCProcessor::GetNthParameter </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>param</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>Prior</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>PriorError</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TString &amp;&#160;</td>
          <td class="paramname"><em>Title</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get properties of parameter by passing it number. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8cpp_source.html#l02695">2695</a> of file <a class="el" href="MCMCProcessor_8cpp_source.html">MCMCProcessor.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2695</span>                                                                                                     {</div>
<div class="line"><span class="lineno"> 2696</span><span class="comment">// **************************</span></div>
<div class="line"><span class="lineno"> 2697</span>  <a class="code hl_enumeration" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20b">ParameterEnum</a> ParType = <a class="code hl_variable" href="classMCMCProcessor.html#aaa903949bde8f1a69800c71fe1eb538e">ParamType</a>[param];</div>
<div class="line"><span class="lineno"> 2698</span>  <span class="keywordtype">int</span> ParamNo = <a class="code hl_define" href="MCMCProcessor_8h.html#a82a6d79039474bc403b627437a7b97ec">_UNDEF_</a>;</div>
<div class="line"><span class="lineno"> 2699</span>  ParamNo = param - <a class="code hl_variable" href="classMCMCProcessor.html#aeab63979ff36256072c046a15d981875">ParamTypeStartPos</a>[ParType];</div>
<div class="line"><span class="lineno"> 2700</span> </div>
<div class="line"><span class="lineno"> 2701</span>  Prior = <a class="code hl_variable" href="classMCMCProcessor.html#a3a6614826ae320e462211e38e96d9d02">ParamCentral</a>[ParType][ParamNo];</div>
<div class="line"><span class="lineno"> 2702</span>  PriorError = <a class="code hl_variable" href="classMCMCProcessor.html#a3a97e3cb4be3ceb9eb721eac51d82d60">ParamErrors</a>[ParType][ParamNo];</div>
<div class="line"><span class="lineno"> 2703</span>  Title = <a class="code hl_variable" href="classMCMCProcessor.html#adecc55689f7d37b9412f8886fe3480dc">ParamNames</a>[ParType][ParamNo];</div>
<div class="line"><span class="lineno"> 2704</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ae5ba9ac70fefcd01afd5066281438883" name="ae5ba9ac70fefcd01afd5066281438883"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae5ba9ac70fefcd01afd5066281438883">&#9670;&#160;</a></span>GetNXSec()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int MCMCProcessor::GetNXSec </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00175">175</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  175</span>{ <span class="keywordflow">return</span> <a class="code hl_variable" href="classMCMCProcessor.html#a4200e7cbe1c8f811d3640ebfd648ca85">nParam</a>[<a class="code hl_enumvalue" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20ba7386f5611ea4d01b85b9bb92a5ca335f">kXSecPar</a>]; };</div>
</div><!-- fragment -->
</div>
</div>
<a id="a6aaa70eeca8d40c94f9836b3108cf579" name="a6aaa70eeca8d40c94f9836b3108cf579"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6aaa70eeca8d40c94f9836b3108cf579">&#9670;&#160;</a></span>GetOSC()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int MCMCProcessor::GetOSC </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00178">178</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  178</span>{ <span class="keywordflow">return</span> <a class="code hl_variable" href="classMCMCProcessor.html#a4200e7cbe1c8f811d3640ebfd648ca85">nParam</a>[<a class="code hl_enumvalue" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20ba03865cac80b3eb8f5ef46421eb8dab06">kOSCPar</a>]; };</div>
</div><!-- fragment -->
</div>
</div>
<a id="ae1d255f2216d4f4e9bc64c300d396d1e" name="ae1d255f2216d4f4e9bc64c300d396d1e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae1d255f2216d4f4e9bc64c300d396d1e">&#9670;&#160;</a></span>GetOscCov()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; std::string &gt; MCMCProcessor::GetOscCov </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00196">196</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  196</span>{ <span class="keywordflow">return</span> <a class="code hl_variable" href="classMCMCProcessor.html#a7c6afb0ed75207fd02c28e408f0592d4">CovPos</a>[<a class="code hl_enumvalue" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20ba03865cac80b3eb8f5ef46421eb8dab06">kOSCPar</a>]; };</div>
</div><!-- fragment -->
</div>
</div>
<a id="a5ab91183fbbf23fff759fefc9954a1a5" name="a5ab91183fbbf23fff759fefc9954a1a5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5ab91183fbbf23fff759fefc9954a1a5">&#9670;&#160;</a></span>GetParamIndexFromName()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int MCMCProcessor::GetParamIndexFromName </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>Name</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get parameter number based on name. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8cpp_source.html#l02708">2708</a> of file <a class="el" href="MCMCProcessor_8cpp_source.html">MCMCProcessor.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2708</span>                                                             {</div>
<div class="line"><span class="lineno"> 2709</span><span class="comment">// **************************</span></div>
<div class="line"><span class="lineno"> 2710</span>  <span class="keywordtype">int</span> ParamNo = <a class="code hl_define" href="MCMCProcessor_8h.html#a82a6d79039474bc403b627437a7b97ec">_UNDEF_</a>;</div>
<div class="line"><span class="lineno"> 2711</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_variable" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>; ++i)</div>
<div class="line"><span class="lineno"> 2712</span>  {</div>
<div class="line"><span class="lineno"> 2713</span>    TString Title = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><span class="lineno"> 2714</span>    <span class="keywordtype">double</span> Prior = 1.0;</div>
<div class="line"><span class="lineno"> 2715</span>    <span class="keywordtype">double</span> PriorError = 1.0;</div>
<div class="line"><span class="lineno"> 2716</span> </div>
<div class="line"><span class="lineno"> 2717</span>    <a class="code hl_function" href="classMCMCProcessor.html#a28dfe42f1bf6fd3a145287be1e63fb0b">GetNthParameter</a>(i, Prior, PriorError, Title);</div>
<div class="line"><span class="lineno"> 2718</span> </div>
<div class="line"><span class="lineno"> 2719</span>    <span class="keywordflow">if</span>(Name == Title)</div>
<div class="line"><span class="lineno"> 2720</span>    {</div>
<div class="line"><span class="lineno"> 2721</span>      ParamNo = i;</div>
<div class="line"><span class="lineno"> 2722</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2723</span>    }</div>
<div class="line"><span class="lineno"> 2724</span>  }</div>
<div class="line"><span class="lineno"> 2725</span>  <span class="keywordflow">return</span> ParamNo;</div>
<div class="line"><span class="lineno"> 2726</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ac358c3ffe7c060e8872c762259973c6b" name="ac358c3ffe7c060e8872c762259973c6b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac358c3ffe7c060e8872c762259973c6b">&#9670;&#160;</a></span>GetPolarPlot()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void MCMCProcessor::GetPolarPlot </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; std::string &gt; &amp;&#160;</td>
          <td class="paramname"><em>ParNames</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Make funny polar plot. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ParNames</td><td>Vector with parameter names for which Polar Plot will be made </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8cpp_source.html#l02748">2748</a> of file <a class="el" href="MCMCProcessor_8cpp_source.html">MCMCProcessor.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2748</span>                                                                    {</div>
<div class="line"><span class="lineno"> 2749</span><span class="comment">// **************************</span></div>
<div class="line"><span class="lineno"> 2750</span>  <span class="keywordflow">if</span>(<a class="code hl_variable" href="classMCMCProcessor.html#a795f661ed1ba8b8ae54c41fde5fb9496">hpost</a>[0] == <span class="keyword">nullptr</span>) <a class="code hl_function" href="classMCMCProcessor.html#a8667510132aa01395520f028287f511b">MakePostfit</a>();</div>
<div class="line"><span class="lineno"> 2751</span> </div>
<div class="line"><span class="lineno"> 2752</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> TopMargin = <a class="code hl_variable" href="classMCMCProcessor.html#a82e6cfef1ba6fcfc8ac8f61acb5bf931">Posterior</a>-&gt;GetTopMargin();</div>
<div class="line"><span class="lineno"> 2753</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> BottomMargin = <a class="code hl_variable" href="classMCMCProcessor.html#a82e6cfef1ba6fcfc8ac8f61acb5bf931">Posterior</a>-&gt;GetBottomMargin();</div>
<div class="line"><span class="lineno"> 2754</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> LeftMargin = <a class="code hl_variable" href="classMCMCProcessor.html#a82e6cfef1ba6fcfc8ac8f61acb5bf931">Posterior</a>-&gt;GetLeftMargin();</div>
<div class="line"><span class="lineno"> 2755</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> RightMargin = <a class="code hl_variable" href="classMCMCProcessor.html#a82e6cfef1ba6fcfc8ac8f61acb5bf931">Posterior</a>-&gt;GetRightMargin();</div>
<div class="line"><span class="lineno"> 2756</span> </div>
<div class="line"><span class="lineno"> 2757</span>  <a class="code hl_variable" href="classMCMCProcessor.html#a82e6cfef1ba6fcfc8ac8f61acb5bf931">Posterior</a>-&gt;SetTopMargin(0.1);</div>
<div class="line"><span class="lineno"> 2758</span>  <a class="code hl_variable" href="classMCMCProcessor.html#a82e6cfef1ba6fcfc8ac8f61acb5bf931">Posterior</a>-&gt;SetBottomMargin(0.1);</div>
<div class="line"><span class="lineno"> 2759</span>  <a class="code hl_variable" href="classMCMCProcessor.html#a82e6cfef1ba6fcfc8ac8f61acb5bf931">Posterior</a>-&gt;SetLeftMargin(0.1);</div>
<div class="line"><span class="lineno"> 2760</span>  <a class="code hl_variable" href="classMCMCProcessor.html#a82e6cfef1ba6fcfc8ac8f61acb5bf931">Posterior</a>-&gt;SetRightMargin(0.1);</div>
<div class="line"><span class="lineno"> 2761</span>  <a class="code hl_variable" href="classMCMCProcessor.html#a82e6cfef1ba6fcfc8ac8f61acb5bf931">Posterior</a>-&gt;Update();</div>
<div class="line"><span class="lineno"> 2762</span> </div>
<div class="line"><span class="lineno"> 2763</span>  <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Calculating Polar Plot&quot;</span>);</div>
<div class="line"><span class="lineno"> 2764</span>  TDirectory *PolarDir = <a class="code hl_variable" href="classMCMCProcessor.html#a62035b99df4617ab334cd1abd6ed0346">OutputFile</a>-&gt;mkdir(<span class="stringliteral">&quot;PolarDir&quot;</span>);</div>
<div class="line"><span class="lineno"> 2765</span>  PolarDir-&gt;cd();</div>
<div class="line"><span class="lineno"> 2766</span> </div>
<div class="line"><span class="lineno"> 2767</span>  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> k = 0; k &lt; ParNames.size(); ++k)</div>
<div class="line"><span class="lineno"> 2768</span>  {</div>
<div class="line"><span class="lineno"> 2769</span>    <span class="comment">//KS: First we need to find parameter number based on name</span></div>
<div class="line"><span class="lineno"> 2770</span>    <span class="keywordtype">int</span> ParamNo = <a class="code hl_function" href="classMCMCProcessor.html#a5ab91183fbbf23fff759fefc9954a1a5">GetParamIndexFromName</a>(ParNames[k]);</div>
<div class="line"><span class="lineno"> 2771</span>    <span class="keywordtype">bool</span> skip = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 2772</span>    <span class="keywordflow">if</span>(ParamNo == <a class="code hl_define" href="MCMCProcessor_8h.html#a82a6d79039474bc403b627437a7b97ec">_UNDEF_</a>)</div>
<div class="line"><span class="lineno"> 2773</span>    {</div>
<div class="line"><span class="lineno"> 2774</span>      <a class="code hl_define" href="MaCh3Logger_8h.html#ad5b2eb6377721e3ac95def22c2386bb1">MACH3LOG_WARN</a>(<span class="stringliteral">&quot;Couldn&#39;t find param {}. Will not calculate Polar Plot&quot;</span>, ParNames[k]);</div>
<div class="line"><span class="lineno"> 2775</span>      skip = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 2776</span>    }</div>
<div class="line"><span class="lineno"> 2777</span>    <span class="keywordflow">if</span>(skip) <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 2778</span> </div>
<div class="line"><span class="lineno"> 2779</span>    TString Title = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><span class="lineno"> 2780</span>    <span class="keywordtype">double</span> Prior = 1.0;</div>
<div class="line"><span class="lineno"> 2781</span>    <span class="keywordtype">double</span> PriorError = 1.0;</div>
<div class="line"><span class="lineno"> 2782</span>    <a class="code hl_function" href="classMCMCProcessor.html#a28dfe42f1bf6fd3a145287be1e63fb0b">GetNthParameter</a>(ParamNo, Prior, PriorError, Title);</div>
<div class="line"><span class="lineno"> 2783</span> </div>
<div class="line"><span class="lineno"> 2784</span>    std::vector&lt;double&gt; x_val(<a class="code hl_variable" href="classMCMCProcessor.html#a6b74f8195bcbca0979f9e9fe43468bae">nBins</a>);</div>
<div class="line"><span class="lineno"> 2785</span>    std::vector&lt;double&gt; y_val(<a class="code hl_variable" href="classMCMCProcessor.html#a6b74f8195bcbca0979f9e9fe43468bae">nBins</a>);</div>
<div class="line"><span class="lineno"> 2786</span> </div>
<div class="line"><span class="lineno"> 2787</span>    <span class="keywordtype">double</span> xmin = 0;</div>
<div class="line"><span class="lineno"> 2788</span>    <span class="keywordtype">double</span> xmax = 2*TMath::Pi();</div>
<div class="line"><span class="lineno"> 2789</span> </div>
<div class="line"><span class="lineno"> 2790</span>    <span class="keywordtype">double</span> Integral = <a class="code hl_variable" href="classMCMCProcessor.html#a795f661ed1ba8b8ae54c41fde5fb9496">hpost</a>[ParamNo]-&gt;Integral();</div>
<div class="line"><span class="lineno"> 2791</span>    <span class="keywordflow">for</span> (Int_t ipt = 0; ipt &lt; <a class="code hl_variable" href="classMCMCProcessor.html#a6b74f8195bcbca0979f9e9fe43468bae">nBins</a>; ipt++)</div>
<div class="line"><span class="lineno"> 2792</span>    {</div>
<div class="line"><span class="lineno"> 2793</span>      x_val[ipt] = ipt*(xmax-xmin)/<a class="code hl_variable" href="classMCMCProcessor.html#a6b74f8195bcbca0979f9e9fe43468bae">nBins</a>+xmin;</div>
<div class="line"><span class="lineno"> 2794</span>      y_val[ipt] = <a class="code hl_variable" href="classMCMCProcessor.html#a795f661ed1ba8b8ae54c41fde5fb9496">hpost</a>[ParamNo]-&gt;GetBinContent(ipt+1)/Integral;</div>
<div class="line"><span class="lineno"> 2795</span>    }</div>
<div class="line"><span class="lineno"> 2796</span> </div>
<div class="line"><span class="lineno"> 2797</span>    <span class="keyword">auto</span> PolarGraph = std::make_unique&lt;TGraphPolar&gt;(<a class="code hl_variable" href="classMCMCProcessor.html#a6b74f8195bcbca0979f9e9fe43468bae">nBins</a>, x_val.data(), y_val.data());</div>
<div class="line"><span class="lineno"> 2798</span>    PolarGraph-&gt;SetLineWidth(2);</div>
<div class="line"><span class="lineno"> 2799</span>    PolarGraph-&gt;SetFillStyle(3001);</div>
<div class="line"><span class="lineno"> 2800</span>    PolarGraph-&gt;SetLineColor(kRed);</div>
<div class="line"><span class="lineno"> 2801</span>    PolarGraph-&gt;SetFillColor(kRed);</div>
<div class="line"><span class="lineno"> 2802</span>    PolarGraph-&gt;Draw(<span class="stringliteral">&quot;AFL&quot;</span>);</div>
<div class="line"><span class="lineno"> 2803</span> </div>
<div class="line"><span class="lineno"> 2804</span>    <span class="keyword">auto</span> Text = std::make_unique&lt;TText&gt;(0.6, 0.1, Title);</div>
<div class="line"><span class="lineno"> 2805</span>    Text-&gt;SetTextSize(0.04);</div>
<div class="line"><span class="lineno"> 2806</span>    Text-&gt;SetNDC(<span class="keyword">true</span>);</div>
<div class="line"><span class="lineno"> 2807</span>    Text-&gt;Draw(<span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><span class="lineno"> 2808</span> </div>
<div class="line"><span class="lineno"> 2809</span>    <a class="code hl_variable" href="classMCMCProcessor.html#a82e6cfef1ba6fcfc8ac8f61acb5bf931">Posterior</a>-&gt;Print(<a class="code hl_variable" href="classMCMCProcessor.html#ab5aec3dc293919701d31e6ae705601dd">CanvasName</a>);</div>
<div class="line"><span class="lineno"> 2810</span>    <a class="code hl_variable" href="classMCMCProcessor.html#a82e6cfef1ba6fcfc8ac8f61acb5bf931">Posterior</a>-&gt;Write(Title);</div>
<div class="line"><span class="lineno"> 2811</span>  } <span class="comment">//End loop over parameters</span></div>
<div class="line"><span class="lineno"> 2812</span> </div>
<div class="line"><span class="lineno"> 2813</span>  PolarDir-&gt;Close();</div>
<div class="line"><span class="lineno"> 2814</span>  <span class="keyword">delete</span> PolarDir;</div>
<div class="line"><span class="lineno"> 2815</span> </div>
<div class="line"><span class="lineno"> 2816</span>  <a class="code hl_variable" href="classMCMCProcessor.html#a62035b99df4617ab334cd1abd6ed0346">OutputFile</a>-&gt;cd();</div>
<div class="line"><span class="lineno"> 2817</span> </div>
<div class="line"><span class="lineno"> 2818</span>  <a class="code hl_variable" href="classMCMCProcessor.html#a82e6cfef1ba6fcfc8ac8f61acb5bf931">Posterior</a>-&gt;SetTopMargin(TopMargin);</div>
<div class="line"><span class="lineno"> 2819</span>  <a class="code hl_variable" href="classMCMCProcessor.html#a82e6cfef1ba6fcfc8ac8f61acb5bf931">Posterior</a>-&gt;SetBottomMargin(BottomMargin);</div>
<div class="line"><span class="lineno"> 2820</span>  <a class="code hl_variable" href="classMCMCProcessor.html#a82e6cfef1ba6fcfc8ac8f61acb5bf931">Posterior</a>-&gt;SetLeftMargin(LeftMargin);</div>
<div class="line"><span class="lineno"> 2821</span>  <a class="code hl_variable" href="classMCMCProcessor.html#a82e6cfef1ba6fcfc8ac8f61acb5bf931">Posterior</a>-&gt;SetRightMargin(RightMargin);</div>
<div class="line"><span class="lineno"> 2822</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a5fc015740496b821648f0e5ca8cffe80" name="a5fc015740496b821648f0e5ca8cffe80"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5fc015740496b821648f0e5ca8cffe80">&#9670;&#160;</a></span>GetPostfit()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void MCMCProcessor::GetPostfit </td>
          <td>(</td>
          <td class="paramtype">TVectorD *&amp;&#160;</td>
          <td class="paramname"><em>Central</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TVectorD *&amp;&#160;</td>
          <td class="paramname"><em>Errors</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TVectorD *&amp;&#160;</td>
          <td class="paramname"><em>Central_Gauss</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TVectorD *&amp;&#160;</td>
          <td class="paramname"><em>Errors_Gauss</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TVectorD *&amp;&#160;</td>
          <td class="paramname"><em>Peaks</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get the post-fit results (arithmetic and Gaussian) </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8cpp_source.html#l00163">163</a> of file <a class="el" href="MCMCProcessor_8cpp_source.html">MCMCProcessor.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  163</span>                                                                                                                                               {</div>
<div class="line"><span class="lineno">  164</span><span class="comment">// ***************</span></div>
<div class="line"><span class="lineno">  165</span>  <span class="comment">// Make the post fit</span></div>
<div class="line"><span class="lineno">  166</span>  <a class="code hl_function" href="classMCMCProcessor.html#a8667510132aa01395520f028287f511b">MakePostfit</a>();</div>
<div class="line"><span class="lineno">  167</span> </div>
<div class="line"><span class="lineno">  168</span>  <span class="comment">// We now have the private members</span></div>
<div class="line"><span class="lineno">  169</span>  Central_PDF = <a class="code hl_variable" href="classMCMCProcessor.html#acaf7f239136dfa3506d095b612323d0a">Means</a>;</div>
<div class="line"><span class="lineno">  170</span>  Errors_PDF = <a class="code hl_variable" href="classMCMCProcessor.html#a5174aaa900edf16ddc6e841ea4adae83">Errors</a>;</div>
<div class="line"><span class="lineno">  171</span>  Central_G = <a class="code hl_variable" href="classMCMCProcessor.html#a600fc8c39af2750df91fb7a0ff85ac74">Means_Gauss</a>;</div>
<div class="line"><span class="lineno">  172</span>  Errors_G = <a class="code hl_variable" href="classMCMCProcessor.html#aa78b7ed1bb9966f84f4eaf8cedf5e688">Errors_Gauss</a>;</div>
<div class="line"><span class="lineno">  173</span>  Peak_Values = <a class="code hl_variable" href="classMCMCProcessor.html#a32657dc39a7fc0d04804f6195a3d8c3e">Means_HPD</a>;</div>
<div class="line"><span class="lineno">  174</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a59fa9550b7c69c616929217ae89c2f42" name="a59fa9550b7c69c616929217ae89c2f42"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a59fa9550b7c69c616929217ae89c2f42">&#9670;&#160;</a></span>GetPostfit_Ind()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void MCMCProcessor::GetPostfit_Ind </td>
          <td>(</td>
          <td class="paramtype">TVectorD *&amp;&#160;</td>
          <td class="paramname"><em>Central</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TVectorD *&amp;&#160;</td>
          <td class="paramname"><em>Errors</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TVectorD *&amp;&#160;</td>
          <td class="paramname"><em>Peaks</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20b">ParameterEnum</a>&#160;</td>
          <td class="paramname"><em>kParam</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Or the individual post-fits. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8cpp_source.html#l00178">178</a> of file <a class="el" href="MCMCProcessor_8cpp_source.html">MCMCProcessor.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  178</span>                                                                                                                              {</div>
<div class="line"><span class="lineno">  179</span><span class="comment">// ***************</span></div>
<div class="line"><span class="lineno">  180</span>  <span class="comment">// Make the post fit</span></div>
<div class="line"><span class="lineno">  181</span>  <a class="code hl_function" href="classMCMCProcessor.html#a8667510132aa01395520f028287f511b">MakePostfit</a>();</div>
<div class="line"><span class="lineno">  182</span> </div>
<div class="line"><span class="lineno">  183</span>  <span class="comment">// Loop over the loaded param types</span></div>
<div class="line"><span class="lineno">  184</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> ParamTypeSize = int(<a class="code hl_variable" href="classMCMCProcessor.html#aaa903949bde8f1a69800c71fe1eb538e">ParamType</a>.size());</div>
<div class="line"><span class="lineno">  185</span>  <span class="keywordtype">int</span> ParamNumber = 0;</div>
<div class="line"><span class="lineno">  186</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; ParamTypeSize; ++i) {</div>
<div class="line"><span class="lineno">  187</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classMCMCProcessor.html#aaa903949bde8f1a69800c71fe1eb538e">ParamType</a>[i] != kParam) <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  188</span>    (*PDF_Central)(ParamNumber) = (*<a class="code hl_variable" href="classMCMCProcessor.html#acaf7f239136dfa3506d095b612323d0a">Means</a>)(i);</div>
<div class="line"><span class="lineno">  189</span>    (*PDF_Errors)(ParamNumber) = (*<a class="code hl_variable" href="classMCMCProcessor.html#a5174aaa900edf16ddc6e841ea4adae83">Errors</a>)(i);</div>
<div class="line"><span class="lineno">  190</span>    (*Peak_Values)(ParamNumber) = (*<a class="code hl_variable" href="classMCMCProcessor.html#a32657dc39a7fc0d04804f6195a3d8c3e">Means_HPD</a>)(i);</div>
<div class="line"><span class="lineno">  191</span>    ++ParamNumber;</div>
<div class="line"><span class="lineno">  192</span>  }</div>
<div class="line"><span class="lineno">  193</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ad09b1ad60fa52fdd87450ab8834e9cd9" name="ad09b1ad60fa52fdd87450ab8834e9cd9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad09b1ad60fa52fdd87450ab8834e9cd9">&#9670;&#160;</a></span>GetSavageDickey()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void MCMCProcessor::GetSavageDickey </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; std::string &gt; &amp;&#160;</td>
          <td class="paramname"><em>ParName</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>EvaluationPoint</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; std::vector&lt; double &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>Bounds</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate Bayes factor for point like hypothesis using SavageDickey. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8cpp_source.html#l02885">2885</a> of file <a class="el" href="MCMCProcessor_8cpp_source.html">MCMCProcessor.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2887</span>                                                                               {</div>
<div class="line"><span class="lineno"> 2888</span><span class="comment">// **************************</span></div>
<div class="line"><span class="lineno"> 2889</span>  <span class="keywordflow">if</span>((ParNames.size() != EvaluationPoint.size()) || (Bounds.size() != EvaluationPoint.size()))</div>
<div class="line"><span class="lineno"> 2890</span>  {</div>
<div class="line"><span class="lineno"> 2891</span>    <a class="code hl_define" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Size doesn&#39;t match&quot;</span>);</div>
<div class="line"><span class="lineno"> 2892</span>    <span class="keywordflow">throw</span> <a class="code hl_class" href="classMaCh3Exception.html">MaCh3Exception</a>(__FILE__ , __LINE__ );</div>
<div class="line"><span class="lineno"> 2893</span>  }</div>
<div class="line"><span class="lineno"> 2894</span>  </div>
<div class="line"><span class="lineno"> 2895</span>  <span class="keywordflow">if</span>(<a class="code hl_variable" href="classMCMCProcessor.html#a795f661ed1ba8b8ae54c41fde5fb9496">hpost</a>[0] == <span class="keyword">nullptr</span>) <a class="code hl_function" href="classMCMCProcessor.html#a8667510132aa01395520f028287f511b">MakePostfit</a>();</div>
<div class="line"><span class="lineno"> 2896</span> </div>
<div class="line"><span class="lineno"> 2897</span>  <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Calculating Savage Dickey&quot;</span>);</div>
<div class="line"><span class="lineno"> 2898</span>  TDirectory *SavageDickeyDir = <a class="code hl_variable" href="classMCMCProcessor.html#a62035b99df4617ab334cd1abd6ed0346">OutputFile</a>-&gt;mkdir(<span class="stringliteral">&quot;SavageDickey&quot;</span>);</div>
<div class="line"><span class="lineno"> 2899</span>  SavageDickeyDir-&gt;cd();</div>
<div class="line"><span class="lineno"> 2900</span>  </div>
<div class="line"><span class="lineno"> 2901</span>  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> k = 0; k &lt; ParNames.size(); ++k)</div>
<div class="line"><span class="lineno"> 2902</span>  {</div>
<div class="line"><span class="lineno"> 2903</span>    <span class="comment">//KS: First we need to find parameter number based on name</span></div>
<div class="line"><span class="lineno"> 2904</span>    <span class="keywordtype">int</span> ParamNo = <a class="code hl_function" href="classMCMCProcessor.html#a5ab91183fbbf23fff759fefc9954a1a5">GetParamIndexFromName</a>(ParNames[k]);</div>
<div class="line"><span class="lineno"> 2905</span>    <span class="keywordtype">bool</span> skip = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 2906</span>    <span class="keywordflow">if</span>(ParamNo == <a class="code hl_define" href="MCMCProcessor_8h.html#a82a6d79039474bc403b627437a7b97ec">_UNDEF_</a>)</div>
<div class="line"><span class="lineno"> 2907</span>    {</div>
<div class="line"><span class="lineno"> 2908</span>      <a class="code hl_define" href="MaCh3Logger_8h.html#ad5b2eb6377721e3ac95def22c2386bb1">MACH3LOG_WARN</a>(<span class="stringliteral">&quot;Couldn&#39;t find param {}. Will not calculate SavageDickey&quot;</span>, ParNames[k]);</div>
<div class="line"><span class="lineno"> 2909</span>      skip = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 2910</span>    }</div>
<div class="line"><span class="lineno"> 2911</span>    <span class="keywordflow">if</span>(skip) <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 2912</span>    </div>
<div class="line"><span class="lineno"> 2913</span>    TString Title = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><span class="lineno"> 2914</span>    <span class="keywordtype">double</span> Prior = 1.0;</div>
<div class="line"><span class="lineno"> 2915</span>    <span class="keywordtype">double</span> PriorError = 1.0;</div>
<div class="line"><span class="lineno"> 2916</span>    <span class="keywordtype">bool</span> FlatPrior = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 2917</span>    <a class="code hl_function" href="classMCMCProcessor.html#a28dfe42f1bf6fd3a145287be1e63fb0b">GetNthParameter</a>(ParamNo, Prior, PriorError, Title);</div>
<div class="line"><span class="lineno"> 2918</span>    </div>
<div class="line"><span class="lineno"> 2919</span>    <a class="code hl_enumeration" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20b">ParameterEnum</a> ParType = <a class="code hl_variable" href="classMCMCProcessor.html#aaa903949bde8f1a69800c71fe1eb538e">ParamType</a>[ParamNo];</div>
<div class="line"><span class="lineno"> 2920</span>    <span class="keywordtype">int</span> ParamTemp = ParamNo - <a class="code hl_variable" href="classMCMCProcessor.html#aeab63979ff36256072c046a15d981875">ParamTypeStartPos</a>[ParType];</div>
<div class="line"><span class="lineno"> 2921</span>    FlatPrior = <a class="code hl_variable" href="classMCMCProcessor.html#a4be1eedb743e4ea410009a4fa45720f7">ParamFlat</a>[ParType][ParamTemp];</div>
<div class="line"><span class="lineno"> 2922</span>    </div>
<div class="line"><span class="lineno"> 2923</span>    TH1D* PosteriorHist = <span class="keyword">static_cast&lt;</span>TH1D *<span class="keyword">&gt;</span>(<a class="code hl_variable" href="classMCMCProcessor.html#a795f661ed1ba8b8ae54c41fde5fb9496">hpost</a>[ParamNo]-&gt;Clone(Title));</div>
<div class="line"><span class="lineno"> 2924</span>    <a class="code hl_function" href="Structs_8cpp.html#a85463c0c6943e3d544d5fcb3f96bf18a">RemoveFitter</a>(PosteriorHist, <span class="stringliteral">&quot;Gauss&quot;</span>);</div>
<div class="line"><span class="lineno"> 2925</span>            </div>
<div class="line"><span class="lineno"> 2926</span>    TH1D* PriorHist = <span class="keyword">nullptr</span>;</div>
<div class="line"><span class="lineno"> 2927</span>    <span class="comment">//KS: If flat prior we need to have well defined bounds otherwise Prior distribution will not make sense</span></div>
<div class="line"><span class="lineno"> 2928</span>    <span class="keywordflow">if</span>(FlatPrior)</div>
<div class="line"><span class="lineno"> 2929</span>    {</div>
<div class="line"><span class="lineno"> 2930</span>      <span class="keywordtype">int</span> NBins = PosteriorHist-&gt;GetNbinsX();</div>
<div class="line"><span class="lineno"> 2931</span>      <span class="keywordflow">if</span>(Bounds[k][0] &gt; Bounds[k][1])</div>
<div class="line"><span class="lineno"> 2932</span>      {</div>
<div class="line"><span class="lineno"> 2933</span>        <a class="code hl_define" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Lower bound is higher than upper bound&quot;</span>);</div>
<div class="line"><span class="lineno"> 2934</span>        <span class="keywordflow">throw</span> <a class="code hl_class" href="classMaCh3Exception.html">MaCh3Exception</a>(__FILE__ , __LINE__ );</div>
<div class="line"><span class="lineno"> 2935</span>      }</div>
<div class="line"><span class="lineno"> 2936</span>      PriorHist = <span class="keyword">new</span> TH1D(<span class="stringliteral">&quot;PriorHist&quot;</span>, Title, NBins, Bounds[k][0], Bounds[k][1]);</div>
<div class="line"><span class="lineno"> 2937</span>      </div>
<div class="line"><span class="lineno"> 2938</span>      <span class="keywordtype">double</span> FlatProb = ( Bounds[k][1] - Bounds[k][0]) / NBins;</div>
<div class="line"><span class="lineno"> 2939</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> g = 0; g &lt; NBins + 1; ++g) </div>
<div class="line"><span class="lineno"> 2940</span>      {</div>
<div class="line"><span class="lineno"> 2941</span>        PriorHist-&gt;SetBinContent(g+1, FlatProb);</div>
<div class="line"><span class="lineno"> 2942</span>      }</div>
<div class="line"><span class="lineno"> 2943</span>    }</div>
<div class="line"><span class="lineno"> 2944</span>    <span class="keywordflow">else</span> <span class="comment">//KS: Otherwise throw from Gaussian</span></div>
<div class="line"><span class="lineno"> 2945</span>    {</div>
<div class="line"><span class="lineno"> 2946</span>      PriorHist = <span class="keyword">static_cast&lt;</span>TH1D*<span class="keyword">&gt;</span>(PosteriorHist-&gt;Clone(<span class="stringliteral">&quot;Prior&quot;</span>));</div>
<div class="line"><span class="lineno"> 2947</span>      PriorHist-&gt;Reset(<span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><span class="lineno"> 2948</span>      PriorHist-&gt;Fill(0.0, 0.0);</div>
<div class="line"><span class="lineno"> 2949</span>      </div>
<div class="line"><span class="lineno"> 2950</span>      <span class="keyword">auto</span> rand = std::make_unique&lt;TRandom3&gt;(0);</div>
<div class="line"><span class="lineno"> 2951</span>      <span class="comment">//KS: Throw nice gaussian, just need big number to have smooth distribution</span></div>
<div class="line"><span class="lineno"> 2952</span>      <span class="keywordflow">for</span>(<span class="keywordtype">int</span> g = 0; g &lt; 1000000; ++g)</div>
<div class="line"><span class="lineno"> 2953</span>      {</div>
<div class="line"><span class="lineno"> 2954</span>        PriorHist-&gt;Fill(rand-&gt;Gaus(Prior, PriorError));</div>
<div class="line"><span class="lineno"> 2955</span>      }</div>
<div class="line"><span class="lineno"> 2956</span>    }</div>
<div class="line"><span class="lineno"> 2957</span>    <span class="comment">// Area normalise the distributions</span></div>
<div class="line"><span class="lineno"> 2958</span>    PriorHist-&gt;Scale(1./PriorHist-&gt;Integral(), <span class="stringliteral">&quot;width&quot;</span>);</div>
<div class="line"><span class="lineno"> 2959</span>    PosteriorHist-&gt;Scale(1./PosteriorHist-&gt;Integral(), <span class="stringliteral">&quot;width&quot;</span>);</div>
<div class="line"><span class="lineno"> 2960</span>      </div>
<div class="line"><span class="lineno"> 2961</span>    PriorHist-&gt;SetLineColor(kRed);</div>
<div class="line"><span class="lineno"> 2962</span>    PriorHist-&gt;SetMarkerColor(kRed);</div>
<div class="line"><span class="lineno"> 2963</span>    PriorHist-&gt;SetFillColorAlpha(kRed, 0.35);</div>
<div class="line"><span class="lineno"> 2964</span>    PriorHist-&gt;SetFillStyle(1001);</div>
<div class="line"><span class="lineno"> 2965</span>    PriorHist-&gt;GetXaxis()-&gt;SetTitle(Title);</div>
<div class="line"><span class="lineno"> 2966</span>    PriorHist-&gt;GetYaxis()-&gt;SetTitle(<span class="stringliteral">&quot;Posterior Probability&quot;</span>);</div>
<div class="line"><span class="lineno"> 2967</span>    PriorHist-&gt;SetMaximum(PosteriorHist-&gt;GetMaximum()*1.5);</div>
<div class="line"><span class="lineno"> 2968</span>    PriorHist-&gt;GetYaxis()-&gt;SetLabelOffset(999);</div>
<div class="line"><span class="lineno"> 2969</span>    PriorHist-&gt;GetYaxis()-&gt;SetLabelSize(0);</div>
<div class="line"><span class="lineno"> 2970</span>    PriorHist-&gt;SetLineWidth(2);</div>
<div class="line"><span class="lineno"> 2971</span>    PriorHist-&gt;SetLineStyle(kSolid);</div>
<div class="line"><span class="lineno"> 2972</span>    </div>
<div class="line"><span class="lineno"> 2973</span>    PosteriorHist-&gt;SetLineColor(kBlue);</div>
<div class="line"><span class="lineno"> 2974</span>    PosteriorHist-&gt;SetMarkerColor(kBlue);</div>
<div class="line"><span class="lineno"> 2975</span>    PosteriorHist-&gt;SetFillColorAlpha(kBlue, 0.35);</div>
<div class="line"><span class="lineno"> 2976</span>    PosteriorHist-&gt;SetFillStyle(1001);</div>
<div class="line"><span class="lineno"> 2977</span>   </div>
<div class="line"><span class="lineno"> 2978</span>    PriorHist-&gt;Draw(<span class="stringliteral">&quot;hist&quot;</span>);</div>
<div class="line"><span class="lineno"> 2979</span>    PosteriorHist-&gt;Draw(<span class="stringliteral">&quot;hist same&quot;</span>);</div>
<div class="line"><span class="lineno"> 2980</span> </div>
<div class="line"><span class="lineno"> 2981</span>    <span class="keywordtype">double</span> ProbPrior = PriorHist-&gt;GetBinContent(PriorHist-&gt;FindBin(EvaluationPoint[k]));</div>
<div class="line"><span class="lineno"> 2982</span>    <span class="comment">//KS: In case we go so far away that prior is 0, set this to small value to avoid dividing by 0</span></div>
<div class="line"><span class="lineno"> 2983</span>    <span class="keywordflow">if</span>(ProbPrior &lt; 0) ProbPrior = 0.00001;</div>
<div class="line"><span class="lineno"> 2984</span>    <span class="keywordtype">double</span> ProbPosterior = PosteriorHist-&gt;GetBinContent(PosteriorHist-&gt;FindBin(EvaluationPoint[k]));</div>
<div class="line"><span class="lineno"> 2985</span>    <span class="keywordtype">double</span> SavageDickey = ProbPosterior/ProbPrior;</div>
<div class="line"><span class="lineno"> 2986</span>    </div>
<div class="line"><span class="lineno"> 2987</span>    std::string DunneKabothScale = <a class="code hl_function" href="StatisticalUtils_8h.html#acf403b05be9baa719893db7449e833c7">GetDunneKaboth</a>(SavageDickey);</div>
<div class="line"><span class="lineno"> 2988</span>    <span class="comment">//Get Best point</span></div>
<div class="line"><span class="lineno"> 2989</span>    std::unique_ptr&lt;TGraph&gt; PostPoint(<span class="keyword">new</span> TGraph(1));</div>
<div class="line"><span class="lineno"> 2990</span>    PostPoint-&gt;SetPoint(0, EvaluationPoint[k], ProbPosterior);</div>
<div class="line"><span class="lineno"> 2991</span>    PostPoint-&gt;SetMarkerStyle(20);</div>
<div class="line"><span class="lineno"> 2992</span>    PostPoint-&gt;SetMarkerSize(1);</div>
<div class="line"><span class="lineno"> 2993</span>    PostPoint-&gt;Draw(<span class="stringliteral">&quot;P same&quot;</span>);</div>
<div class="line"><span class="lineno"> 2994</span>    </div>
<div class="line"><span class="lineno"> 2995</span>    std::unique_ptr&lt;TGraph&gt; PriorPoint(<span class="keyword">new</span> TGraph(1));</div>
<div class="line"><span class="lineno"> 2996</span>    PriorPoint-&gt;SetPoint(0, EvaluationPoint[k], ProbPrior);</div>
<div class="line"><span class="lineno"> 2997</span>    PriorPoint-&gt;SetMarkerStyle(20);</div>
<div class="line"><span class="lineno"> 2998</span>    PriorPoint-&gt;SetMarkerSize(1);</div>
<div class="line"><span class="lineno"> 2999</span>    PriorPoint-&gt;Draw(<span class="stringliteral">&quot;P same&quot;</span>);</div>
<div class="line"><span class="lineno"> 3000</span>    </div>
<div class="line"><span class="lineno"> 3001</span>    <span class="keyword">auto</span> legend = std::make_unique&lt;TLegend&gt;(0.12, 0.6, 0.6, 0.97);</div>
<div class="line"><span class="lineno"> 3002</span>    legend-&gt;SetTextSize(0.04);</div>
<div class="line"><span class="lineno"> 3003</span>    legend-&gt;AddEntry(PriorHist, <span class="stringliteral">&quot;Prior&quot;</span>, <span class="stringliteral">&quot;l&quot;</span>);</div>
<div class="line"><span class="lineno"> 3004</span>    legend-&gt;AddEntry(PosteriorHist, <span class="stringliteral">&quot;Posterior&quot;</span>, <span class="stringliteral">&quot;l&quot;</span>);</div>
<div class="line"><span class="lineno"> 3005</span>    legend-&gt;AddEntry(PostPoint.get(), Form(<span class="stringliteral">&quot;SavageDickey = %.2f, (%s)&quot;</span>, SavageDickey, DunneKabothScale.c_str()),<span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><span class="lineno"> 3006</span>    legend-&gt;SetLineColor(0);</div>
<div class="line"><span class="lineno"> 3007</span>    legend-&gt;SetLineStyle(0);</div>
<div class="line"><span class="lineno"> 3008</span>    legend-&gt;SetFillColor(0);</div>
<div class="line"><span class="lineno"> 3009</span>    legend-&gt;SetFillStyle(0);</div>
<div class="line"><span class="lineno"> 3010</span>    legend-&gt;SetBorderSize(0);</div>
<div class="line"><span class="lineno"> 3011</span>    legend-&gt;Draw(<span class="stringliteral">&quot;same&quot;</span>);</div>
<div class="line"><span class="lineno"> 3012</span>  </div>
<div class="line"><span class="lineno"> 3013</span>    <a class="code hl_variable" href="classMCMCProcessor.html#a82e6cfef1ba6fcfc8ac8f61acb5bf931">Posterior</a>-&gt;Print(<a class="code hl_variable" href="classMCMCProcessor.html#ab5aec3dc293919701d31e6ae705601dd">CanvasName</a>);</div>
<div class="line"><span class="lineno"> 3014</span>    <a class="code hl_variable" href="classMCMCProcessor.html#a82e6cfef1ba6fcfc8ac8f61acb5bf931">Posterior</a>-&gt;Write(Title);</div>
<div class="line"><span class="lineno"> 3015</span>    </div>
<div class="line"><span class="lineno"> 3016</span>    <span class="keyword">delete</span> PosteriorHist;</div>
<div class="line"><span class="lineno"> 3017</span>    <span class="keyword">delete</span> PriorHist;</div>
<div class="line"><span class="lineno"> 3018</span>  } <span class="comment">//End loop over parameters</span></div>
<div class="line"><span class="lineno"> 3019</span> </div>
<div class="line"><span class="lineno"> 3020</span>  SavageDickeyDir-&gt;Close();</div>
<div class="line"><span class="lineno"> 3021</span>  <span class="keyword">delete</span> SavageDickeyDir;</div>
<div class="line"><span class="lineno"> 3022</span> </div>
<div class="line"><span class="lineno"> 3023</span>  <a class="code hl_variable" href="classMCMCProcessor.html#a62035b99df4617ab334cd1abd6ed0346">OutputFile</a>-&gt;cd();</div>
<div class="line"><span class="lineno"> 3024</span>}</div>
<div class="ttc" id="aStructs_8cpp_html_a85463c0c6943e3d544d5fcb3f96bf18a"><div class="ttname"><a href="Structs_8cpp.html#a85463c0c6943e3d544d5fcb3f96bf18a">RemoveFitter</a></div><div class="ttdeci">void RemoveFitter(TH1D *hist, const std::string &amp;name)</div><div class="ttdoc">KS: Remove fitted TF1 from hist to make comparison easier.</div><div class="ttdef"><b>Definition:</b> <a href="Structs_8cpp_source.html#l00419">Structs.cpp:419</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a4ecd30520854d1379946bd8b1f2992f2" name="a4ecd30520854d1379946bd8b1f2992f2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4ecd30520854d1379946bd8b1f2992f2">&#9670;&#160;</a></span>GetViolin()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">TH2D * MCMCProcessor::GetViolin </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get Violin plot for all parameters with posterior values. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00188">188</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  188</span>{ <span class="keywordflow">return</span> <a class="code hl_variable" href="classMCMCProcessor.html#a556988f03b24e3af33e9a29b23d2b1e2">hviolin</a>; };</div>
</div><!-- fragment -->
</div>
</div>
<a id="a0489e9f57b847389bc0c9f8af5a0abdb" name="a0489e9f57b847389bc0c9f8af5a0abdb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0489e9f57b847389bc0c9f8af5a0abdb">&#9670;&#160;</a></span>GetViolinPrior()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">TH2D * MCMCProcessor::GetViolinPrior </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get Violin plot for all parameters with prior values. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00190">190</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  190</span>{ <span class="keywordflow">return</span> <a class="code hl_variable" href="classMCMCProcessor.html#a25d79f451d5d584c3e7ef0e1423e5e8e">hviolin_prior</a>; };</div>
</div><!-- fragment -->
</div>
</div>
<a id="ad4fa1cfa19aad913c370143b4dc2fa6b" name="ad4fa1cfa19aad913c370143b4dc2fa6b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad4fa1cfa19aad913c370143b4dc2fa6b">&#9670;&#160;</a></span>GetXSecCov()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; std::string &gt; MCMCProcessor::GetXSecCov </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00193">193</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  193</span>{ <span class="keywordflow">return</span> <a class="code hl_variable" href="classMCMCProcessor.html#a7c6afb0ed75207fd02c28e408f0592d4">CovPos</a>[<a class="code hl_enumvalue" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20ba7386f5611ea4d01b85b9bb92a5ca335f">kXSecPar</a>]; };</div>
</div><!-- fragment -->
</div>
</div>
<a id="a03b7c4bb9cd9a90aa7d284b0f1a6156b" name="a03b7c4bb9cd9a90aa7d284b0f1a6156b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a03b7c4bb9cd9a90aa7d284b0f1a6156b">&#9670;&#160;</a></span>GewekeDiagnostic()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void MCMCProcessor::GewekeDiagnostic </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Geweke Diagnostic based on the methods described by Fang (2014) and Karlsbakk (2011). <a class="el" href="citelist.html#CITEREF_Fang2014GewekeDiagnostics">[6]</a> <a class="el" href="citelist.html#CITEREF_karlsbakk2011">[12]</a>. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8cpp_source.html#l04223">4223</a> of file <a class="el" href="MCMCProcessor_8cpp_source.html">MCMCProcessor.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 4223</span>                                     {</div>
<div class="line"><span class="lineno"> 4224</span><span class="comment">// **************************</span></div>
<div class="line"><span class="lineno"> 4225</span>  <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Making Geweke Diagnostic&quot;</span>);</div>
<div class="line"><span class="lineno"> 4226</span> </div>
<div class="line"><span class="lineno"> 4227</span>  <span class="comment">//KS: Up refers to upper limit we check, it stays constant, in literature it is mostly 50% thus using 0.5 for threshold</span></div>
<div class="line"><span class="lineno"> 4228</span>  std::vector&lt;double&gt; MeanUp(<a class="code hl_variable" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>, 0.0);</div>
<div class="line"><span class="lineno"> 4229</span>  std::vector&lt;double&gt; SpectralVarianceUp(<a class="code hl_variable" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>, 0.0);</div>
<div class="line"><span class="lineno"> 4230</span>  std::vector&lt;int&gt; DenomCounterUp(<a class="code hl_variable" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>, 0);</div>
<div class="line"><span class="lineno"> 4231</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> Threshold = 0.5 * <a class="code hl_variable" href="classMCMCProcessor.html#aae0016a4e1d105d5d65243438c622a97">nSteps</a>;</div>
<div class="line"><span class="lineno"> 4232</span> </div>
<div class="line"><span class="lineno"> 4233</span>  <span class="comment">//KS: Select values between which you want to scan, for example 0 means 0% burn in and 1 100% burn in.</span></div>
<div class="line"><span class="lineno"> 4234</span>  <span class="keyword">constexpr</span> <span class="keywordtype">double</span> LowerThreshold = 0;</div>
<div class="line"><span class="lineno"> 4235</span>  <span class="keyword">constexpr</span> <span class="keywordtype">double</span> UpperThreshold = 1.0;</div>
<div class="line"><span class="lineno"> 4236</span>  <span class="comment">// Tells how many intervals between thresholds we want to check</span></div>
<div class="line"><span class="lineno"> 4237</span>  <span class="keyword">constexpr</span> <span class="keywordtype">int</span> NChecks = 100;</div>
<div class="line"><span class="lineno"> 4238</span>  <span class="keyword">constexpr</span> <span class="keywordtype">double</span> Division = (UpperThreshold - LowerThreshold)/NChecks;</div>
<div class="line"><span class="lineno"> 4239</span> </div>
<div class="line"><span class="lineno"> 4240</span>  std::vector&lt;std::unique_ptr&lt;TH1D&gt;&gt; GewekePlots(<a class="code hl_variable" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>);</div>
<div class="line"><span class="lineno"> 4241</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a class="code hl_variable" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>; ++j)</div>
<div class="line"><span class="lineno"> 4242</span>  {</div>
<div class="line"><span class="lineno"> 4243</span>    TString Title = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><span class="lineno"> 4244</span>    <span class="keywordtype">double</span> Prior = 1.0;</div>
<div class="line"><span class="lineno"> 4245</span>    <span class="keywordtype">double</span> PriorError = 1.0;</div>
<div class="line"><span class="lineno"> 4246</span>    <a class="code hl_function" href="classMCMCProcessor.html#a28dfe42f1bf6fd3a145287be1e63fb0b">GetNthParameter</a>(j, Prior, PriorError, Title);</div>
<div class="line"><span class="lineno"> 4247</span>    std::string HistName = Form(<span class="stringliteral">&quot;%s_%s_Geweke&quot;</span>, Title.Data(), <a class="code hl_variable" href="classMCMCProcessor.html#ad043b6b2c885f47ab9967831bc8d0f5a">BranchNames</a>[j].Data());</div>
<div class="line"><span class="lineno"> 4248</span>    GewekePlots[j] = std::make_unique&lt;TH1D&gt;(HistName.c_str(), HistName.c_str(), NChecks, 0.0, 100 * UpperThreshold);</div>
<div class="line"><span class="lineno"> 4249</span>    GewekePlots[j]-&gt;GetXaxis()-&gt;SetTitle(<span class="stringliteral">&quot;Burn-In (%)&quot;</span>);</div>
<div class="line"><span class="lineno"> 4250</span>    GewekePlots[j]-&gt;GetYaxis()-&gt;SetTitle(<span class="stringliteral">&quot;Geweke T score&quot;</span>);</div>
<div class="line"><span class="lineno"> 4251</span>  }</div>
<div class="line"><span class="lineno"> 4252</span> </div>
<div class="line"><span class="lineno"> 4253</span><span class="comment">//KS: Start parallel region</span></div>
<div class="line"><span class="lineno"> 4254</span><span class="preprocessor">#ifdef MULTITHREAD</span></div>
<div class="line"><span class="lineno"> 4255</span><span class="preprocessor">#pragma omp parallel</span></div>
<div class="line"><span class="lineno"> 4256</span>{</div>
<div class="line"><span class="lineno"> 4257</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 4258</span>  <span class="comment">//KS: First we calculate mean and spectral variance for the upper limit, this doesn&#39;t change and in literature is most often 50%</span></div>
<div class="line"><span class="lineno"> 4259</span><span class="preprocessor">  #ifdef MULTITHREAD</span></div>
<div class="line"><span class="lineno"> 4260</span><span class="preprocessor">  #pragma omp for</span></div>
<div class="line"><span class="lineno"> 4261</span><span class="preprocessor">  #endif</span></div>
<div class="line"><span class="lineno"> 4262</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a class="code hl_variable" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>; ++j)</div>
<div class="line"><span class="lineno"> 4263</span>  {</div>
<div class="line"><span class="lineno"> 4264</span>    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_variable" href="classMCMCProcessor.html#af3a19b885e9c34e1674aea8cfbe14e1c">nEntries</a>; ++i)</div>
<div class="line"><span class="lineno"> 4265</span>    {</div>
<div class="line"><span class="lineno"> 4266</span>      <span class="keywordflow">if</span>(<a class="code hl_variable" href="classMCMCProcessor.html#a07549f3b67ca5409218d80c679f6e69e">StepNumber</a>[i] &gt; Threshold)</div>
<div class="line"><span class="lineno"> 4267</span>      {</div>
<div class="line"><span class="lineno"> 4268</span>        MeanUp[j] += <a class="code hl_variable" href="classMCMCProcessor.html#a087dca88a306acdc28afea7213e3623c">ParStep</a>[j][i];</div>
<div class="line"><span class="lineno"> 4269</span>        DenomCounterUp[j]++;</div>
<div class="line"><span class="lineno"> 4270</span>      }</div>
<div class="line"><span class="lineno"> 4271</span>    }</div>
<div class="line"><span class="lineno"> 4272</span>    MeanUp[j] = MeanUp[j]/DenomCounterUp[j];</div>
<div class="line"><span class="lineno"> 4273</span>  }</div>
<div class="line"><span class="lineno"> 4274</span> </div>
<div class="line"><span class="lineno"> 4275</span>  <span class="comment">//KS: now Spectral variance which in this case is sample variance</span></div>
<div class="line"><span class="lineno"> 4276</span><span class="preprocessor">  #ifdef MULTITHREAD</span></div>
<div class="line"><span class="lineno"> 4277</span><span class="preprocessor">  #pragma omp for collapse(2)</span></div>
<div class="line"><span class="lineno"> 4278</span><span class="preprocessor">  #endif</span></div>
<div class="line"><span class="lineno"> 4279</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a class="code hl_variable" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>; ++j)</div>
<div class="line"><span class="lineno"> 4280</span>  {</div>
<div class="line"><span class="lineno"> 4281</span>    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_variable" href="classMCMCProcessor.html#af3a19b885e9c34e1674aea8cfbe14e1c">nEntries</a>; ++i)</div>
<div class="line"><span class="lineno"> 4282</span>    {</div>
<div class="line"><span class="lineno"> 4283</span>      <span class="keywordflow">if</span>(<a class="code hl_variable" href="classMCMCProcessor.html#a07549f3b67ca5409218d80c679f6e69e">StepNumber</a>[i] &gt; Threshold)</div>
<div class="line"><span class="lineno"> 4284</span>      {</div>
<div class="line"><span class="lineno"> 4285</span>        SpectralVarianceUp[j] += (<a class="code hl_variable" href="classMCMCProcessor.html#a087dca88a306acdc28afea7213e3623c">ParStep</a>[j][i] - MeanUp[j])*(<a class="code hl_variable" href="classMCMCProcessor.html#a087dca88a306acdc28afea7213e3623c">ParStep</a>[j][i] - MeanUp[j]);</div>
<div class="line"><span class="lineno"> 4286</span>      }</div>
<div class="line"><span class="lineno"> 4287</span>    }</div>
<div class="line"><span class="lineno"> 4288</span>  }</div>
<div class="line"><span class="lineno"> 4289</span> </div>
<div class="line"><span class="lineno"> 4290</span>  <span class="comment">//Loop over how many intervals we calculate</span></div>
<div class="line"><span class="lineno"> 4291</span><span class="preprocessor">  #ifdef MULTITHREAD</span></div>
<div class="line"><span class="lineno"> 4292</span><span class="preprocessor">  #pragma omp for</span></div>
<div class="line"><span class="lineno"> 4293</span><span class="preprocessor">  #endif</span></div>
<div class="line"><span class="lineno"> 4294</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 1; k &lt; NChecks+1; ++k)</div>
<div class="line"><span class="lineno"> 4295</span>  {</div>
<div class="line"><span class="lineno"> 4296</span>    <span class="comment">//KS each thread has it&#39;s own</span></div>
<div class="line"><span class="lineno"> 4297</span>    std::vector&lt;double&gt; MeanDown(<a class="code hl_variable" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>, 0.0);</div>
<div class="line"><span class="lineno"> 4298</span>    std::vector&lt;double&gt; SpectralVarianceDown(<a class="code hl_variable" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>, 0.0);</div>
<div class="line"><span class="lineno"> 4299</span>    std::vector&lt;int&gt; DenomCounterDown(<a class="code hl_variable" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>, 0);</div>
<div class="line"><span class="lineno"> 4300</span> </div>
<div class="line"><span class="lineno"> 4301</span>    <span class="keyword">const</span> <span class="keywordtype">int</span> ThresholsCheck = Division*k*<a class="code hl_variable" href="classMCMCProcessor.html#aae0016a4e1d105d5d65243438c622a97">nSteps</a>;</div>
<div class="line"><span class="lineno"> 4302</span>    <span class="comment">//KS: First mean</span></div>
<div class="line"><span class="lineno"> 4303</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a class="code hl_variable" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>; ++j)</div>
<div class="line"><span class="lineno"> 4304</span>    {</div>
<div class="line"><span class="lineno"> 4305</span>      <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_variable" href="classMCMCProcessor.html#af3a19b885e9c34e1674aea8cfbe14e1c">nEntries</a>; ++i)</div>
<div class="line"><span class="lineno"> 4306</span>      {</div>
<div class="line"><span class="lineno"> 4307</span>        <span class="keywordflow">if</span>(<a class="code hl_variable" href="classMCMCProcessor.html#a07549f3b67ca5409218d80c679f6e69e">StepNumber</a>[i] &lt; ThresholsCheck)</div>
<div class="line"><span class="lineno"> 4308</span>        {</div>
<div class="line"><span class="lineno"> 4309</span>          MeanDown[j] += <a class="code hl_variable" href="classMCMCProcessor.html#a087dca88a306acdc28afea7213e3623c">ParStep</a>[j][i];</div>
<div class="line"><span class="lineno"> 4310</span>          DenomCounterDown[j]++;</div>
<div class="line"><span class="lineno"> 4311</span>        }</div>
<div class="line"><span class="lineno"> 4312</span>      }</div>
<div class="line"><span class="lineno"> 4313</span>      MeanDown[j] = MeanDown[j]/DenomCounterDown[j];</div>
<div class="line"><span class="lineno"> 4314</span>    }</div>
<div class="line"><span class="lineno"> 4315</span>    <span class="comment">//Now spectral variance</span></div>
<div class="line"><span class="lineno"> 4316</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a class="code hl_variable" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>; ++j)</div>
<div class="line"><span class="lineno"> 4317</span>    {</div>
<div class="line"><span class="lineno"> 4318</span>      <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_variable" href="classMCMCProcessor.html#af3a19b885e9c34e1674aea8cfbe14e1c">nEntries</a>; ++i)</div>
<div class="line"><span class="lineno"> 4319</span>      {</div>
<div class="line"><span class="lineno"> 4320</span>        <span class="keywordflow">if</span>(<a class="code hl_variable" href="classMCMCProcessor.html#a07549f3b67ca5409218d80c679f6e69e">StepNumber</a>[i] &lt; ThresholsCheck)</div>
<div class="line"><span class="lineno"> 4321</span>        {</div>
<div class="line"><span class="lineno"> 4322</span>          SpectralVarianceDown[j] += (<a class="code hl_variable" href="classMCMCProcessor.html#a087dca88a306acdc28afea7213e3623c">ParStep</a>[j][i] - MeanDown[j])*(<a class="code hl_variable" href="classMCMCProcessor.html#a087dca88a306acdc28afea7213e3623c">ParStep</a>[j][i] - MeanDown[j]);</div>
<div class="line"><span class="lineno"> 4323</span>        }</div>
<div class="line"><span class="lineno"> 4324</span>      }</div>
<div class="line"><span class="lineno"> 4325</span>    }</div>
<div class="line"><span class="lineno"> 4326</span>    <span class="comment">//Lastly calc T score and fill histogram entry</span></div>
<div class="line"><span class="lineno"> 4327</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a class="code hl_variable" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>; ++j)</div>
<div class="line"><span class="lineno"> 4328</span>    {</div>
<div class="line"><span class="lineno"> 4329</span>      <span class="keywordtype">double</span> T_score = std::fabs((MeanDown[j] - MeanUp[j])/std::sqrt(SpectralVarianceDown[j]/DenomCounterDown[j] + SpectralVarianceUp[j]/DenomCounterUp[j]));</div>
<div class="line"><span class="lineno"> 4330</span>      GewekePlots[j]-&gt;SetBinContent(k, T_score);</div>
<div class="line"><span class="lineno"> 4331</span>    }</div>
<div class="line"><span class="lineno"> 4332</span>  } <span class="comment">//end loop over intervals</span></div>
<div class="line"><span class="lineno"> 4333</span><span class="preprocessor">#ifdef MULTITHREAD</span></div>
<div class="line"><span class="lineno"> 4334</span>} <span class="comment">//End parallel region</span></div>
<div class="line"><span class="lineno"> 4335</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 4336</span> </div>
<div class="line"><span class="lineno"> 4337</span>  <span class="comment">//Finally save it to TFile</span></div>
<div class="line"><span class="lineno"> 4338</span>  <a class="code hl_variable" href="classMCMCProcessor.html#a62035b99df4617ab334cd1abd6ed0346">OutputFile</a>-&gt;cd();</div>
<div class="line"><span class="lineno"> 4339</span>  TDirectory *GewekeDir = <a class="code hl_variable" href="classMCMCProcessor.html#a62035b99df4617ab334cd1abd6ed0346">OutputFile</a>-&gt;mkdir(<span class="stringliteral">&quot;Geweke&quot;</span>);</div>
<div class="line"><span class="lineno"> 4340</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a class="code hl_variable" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>; ++j)</div>
<div class="line"><span class="lineno"> 4341</span>  {</div>
<div class="line"><span class="lineno"> 4342</span>    GewekeDir-&gt;cd();</div>
<div class="line"><span class="lineno"> 4343</span>    GewekePlots[j]-&gt;Write();</div>
<div class="line"><span class="lineno"> 4344</span>  }</div>
<div class="line"><span class="lineno"> 4345</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_variable" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>; ++i) {</div>
<div class="line"><span class="lineno"> 4346</span>    <span class="keyword">delete</span>[] <a class="code hl_variable" href="classMCMCProcessor.html#a087dca88a306acdc28afea7213e3623c">ParStep</a>[i];</div>
<div class="line"><span class="lineno"> 4347</span>  }</div>
<div class="line"><span class="lineno"> 4348</span>  <span class="keyword">delete</span>[] <a class="code hl_variable" href="classMCMCProcessor.html#a087dca88a306acdc28afea7213e3623c">ParStep</a>;</div>
<div class="line"><span class="lineno"> 4349</span> </div>
<div class="line"><span class="lineno"> 4350</span>  GewekeDir-&gt;Close();</div>
<div class="line"><span class="lineno"> 4351</span>  <span class="keyword">delete</span> GewekeDir;</div>
<div class="line"><span class="lineno"> 4352</span> </div>
<div class="line"><span class="lineno"> 4353</span>  <a class="code hl_variable" href="classMCMCProcessor.html#a62035b99df4617ab334cd1abd6ed0346">OutputFile</a>-&gt;cd();</div>
<div class="line"><span class="lineno"> 4354</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a224995a0b47bd9cbd04e099cc3ca634c" name="a224995a0b47bd9cbd04e099cc3ca634c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a224995a0b47bd9cbd04e099cc3ca634c">&#9670;&#160;</a></span>Initialise()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void MCMCProcessor::Initialise </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Scan chain, what parameters we have and load information from covariance matrices. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8cpp_source.html#l00153">153</a> of file <a class="el" href="MCMCProcessor_8cpp_source.html">MCMCProcessor.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  153</span>                              {</div>
<div class="line"><span class="lineno">  154</span><span class="comment">// ***************</span></div>
<div class="line"><span class="lineno">  155</span>  <span class="comment">// Scan the ROOT file for useful branches</span></div>
<div class="line"><span class="lineno">  156</span>  <a class="code hl_function" href="classMCMCProcessor.html#aeff2174617268c1e55333529459bffb6">ScanInput</a>();</div>
<div class="line"><span class="lineno">  157</span> </div>
<div class="line"><span class="lineno">  158</span>  <span class="comment">// Setup the output</span></div>
<div class="line"><span class="lineno">  159</span>  <a class="code hl_function" href="classMCMCProcessor.html#aa4761be1345f1be3defe162b278a9d8e">SetupOutput</a>();</div>
<div class="line"><span class="lineno">  160</span>}</div>
<div class="ttc" id="aclassMCMCProcessor_html_aa4761be1345f1be3defe162b278a9d8e"><div class="ttname"><a href="classMCMCProcessor.html#aa4761be1345f1be3defe162b278a9d8e">MCMCProcessor::SetupOutput</a></div><div class="ttdeci">void SetupOutput()</div><div class="ttdoc">Prepare all objects used for output.</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8cpp_source.html#l02245">MCMCProcessor.cpp:2245</a></div></div>
<div class="ttc" id="aclassMCMCProcessor_html_aeff2174617268c1e55333529459bffb6"><div class="ttname"><a href="classMCMCProcessor.html#aeff2174617268c1e55333529459bffb6">MCMCProcessor::ScanInput</a></div><div class="ttdeci">void ScanInput()</div><div class="ttdoc">Scan Input etc.</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8cpp_source.html#l02124">MCMCProcessor.cpp:2124</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="afc94f21ffd599b1e2dd7e62f24f6c4de" name="afc94f21ffd599b1e2dd7e62f24f6c4de"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afc94f21ffd599b1e2dd7e62f24f6c4de">&#9670;&#160;</a></span>MakeCovariance()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void MCMCProcessor::MakeCovariance </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate covariance by making 2D projection of each combination of parameters. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8cpp_source.html#l00987">987</a> of file <a class="el" href="MCMCProcessor_8cpp_source.html">MCMCProcessor.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  987</span>                                   {</div>
<div class="line"><span class="lineno">  988</span><span class="comment">// *********************</span></div>
<div class="line"><span class="lineno">  989</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="classMCMCProcessor.html#a62035b99df4617ab334cd1abd6ed0346">OutputFile</a> == <span class="keyword">nullptr</span>) <a class="code hl_function" href="classMCMCProcessor.html#aa5a7761e97cf2e24c7d877a5374b7333">MakeOutputFile</a>();</div>
<div class="line"><span class="lineno">  990</span> </div>
<div class="line"><span class="lineno">  991</span>  <span class="keywordtype">bool</span> HaveMadeDiagonal = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  992</span>  <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Making post-fit covariances...&quot;</span>);</div>
<div class="line"><span class="lineno">  993</span>  <span class="comment">// Check that the diagonal entries have been filled</span></div>
<div class="line"><span class="lineno">  994</span>  <span class="comment">// i.e. MakePostfit() has been called</span></div>
<div class="line"><span class="lineno">  995</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_variable" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>; ++i) {</div>
<div class="line"><span class="lineno">  996</span>    <span class="keywordflow">if</span> ((*<a class="code hl_variable" href="classMCMCProcessor.html#af9a40632e2d7f1266d69a74d5b5f2244">Covariance</a>)(i,i) == <a class="code hl_define" href="MCMCProcessor_8h.html#a82a6d79039474bc403b627437a7b97ec">_UNDEF_</a>) {</div>
<div class="line"><span class="lineno">  997</span>      HaveMadeDiagonal = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  998</span>      <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Have not run diagonal elements in covariance, will do so now by calling MakePostfit()&quot;</span>);</div>
<div class="line"><span class="lineno">  999</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1000</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1001</span>      HaveMadeDiagonal = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1002</span>    }</div>
<div class="line"><span class="lineno"> 1003</span>  }</div>
<div class="line"><span class="lineno"> 1004</span> </div>
<div class="line"><span class="lineno"> 1005</span>  <span class="keywordflow">if</span> (HaveMadeDiagonal == <span class="keyword">false</span>) {</div>
<div class="line"><span class="lineno"> 1006</span>    <a class="code hl_function" href="classMCMCProcessor.html#a8667510132aa01395520f028287f511b">MakePostfit</a>();</div>
<div class="line"><span class="lineno"> 1007</span>  }</div>
<div class="line"><span class="lineno"> 1008</span>  gStyle-&gt;SetPalette(55);</div>
<div class="line"><span class="lineno"> 1009</span>  <span class="comment">// Now we are sure we have the diagonal elements, let&#39;s make the off-diagonals</span></div>
<div class="line"><span class="lineno"> 1010</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_variable" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>; ++i)</div>
<div class="line"><span class="lineno"> 1011</span>  {</div>
<div class="line"><span class="lineno"> 1012</span>    <span class="keywordflow">if</span> (i % (<a class="code hl_variable" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>/5) == 0)</div>
<div class="line"><span class="lineno"> 1013</span>      <a class="code hl_function" href="namespaceMaCh3Utils.html#a4c8bdeb1d34606aed192e9f1311a72f5">MaCh3Utils::PrintProgressBar</a>(i, <a class="code hl_variable" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>);</div>
<div class="line"><span class="lineno"> 1014</span> </div>
<div class="line"><span class="lineno"> 1015</span>    TString Title_i = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><span class="lineno"> 1016</span>    <span class="keywordtype">double</span> Prior_i, PriorError;</div>
<div class="line"><span class="lineno"> 1017</span> </div>
<div class="line"><span class="lineno"> 1018</span>    <a class="code hl_function" href="classMCMCProcessor.html#a28dfe42f1bf6fd3a145287be1e63fb0b">GetNthParameter</a>(i, Prior_i, PriorError, Title_i);</div>
<div class="line"><span class="lineno"> 1019</span>    </div>
<div class="line"><span class="lineno"> 1020</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> min_i = <a class="code hl_variable" href="classMCMCProcessor.html#a6be3bbebd4a79fe9814a3da09b3bb820">Chain</a>-&gt;GetMinimum(<a class="code hl_variable" href="classMCMCProcessor.html#ad043b6b2c885f47ab9967831bc8d0f5a">BranchNames</a>[i]);</div>
<div class="line"><span class="lineno"> 1021</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> max_i = <a class="code hl_variable" href="classMCMCProcessor.html#a6be3bbebd4a79fe9814a3da09b3bb820">Chain</a>-&gt;GetMaximum(<a class="code hl_variable" href="classMCMCProcessor.html#ad043b6b2c885f47ab9967831bc8d0f5a">BranchNames</a>[i]);</div>
<div class="line"><span class="lineno"> 1022</span> </div>
<div class="line"><span class="lineno"> 1023</span>    <span class="comment">// Loop over the other parameters to get the correlations</span></div>
<div class="line"><span class="lineno"> 1024</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt;= i; ++j) {</div>
<div class="line"><span class="lineno"> 1025</span> </div>
<div class="line"><span class="lineno"> 1026</span>      <span class="comment">// Skip the diagonal elements which we&#39;ve already done above</span></div>
<div class="line"><span class="lineno"> 1027</span>      <span class="keywordflow">if</span> (j == i) <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 1028</span> </div>
<div class="line"><span class="lineno"> 1029</span>      <span class="comment">// If this parameter isn&#39;t varied</span></div>
<div class="line"><span class="lineno"> 1030</span>      <span class="keywordflow">if</span> (<a class="code hl_variable" href="classMCMCProcessor.html#a95fa49737432818bc830a44898d0d850">IamVaried</a>[j] == <span class="keyword">false</span>) {</div>
<div class="line"><span class="lineno"> 1031</span>        (*Covariance)(i,j) = 0.0;</div>
<div class="line"><span class="lineno"> 1032</span>        (*Covariance)(j,i) = (*<a class="code hl_variable" href="classMCMCProcessor.html#af9a40632e2d7f1266d69a74d5b5f2244">Covariance</a>)(i,j);</div>
<div class="line"><span class="lineno"> 1033</span>        (*Correlation)(i,j) = 0.0;</div>
<div class="line"><span class="lineno"> 1034</span>        (*Correlation)(j,i) = (*<a class="code hl_variable" href="classMCMCProcessor.html#a03f28431158777cdd81d058b6632a92f">Correlation</a>)(i,j);</div>
<div class="line"><span class="lineno"> 1035</span>        <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 1036</span>      }</div>
<div class="line"><span class="lineno"> 1037</span> </div>
<div class="line"><span class="lineno"> 1038</span>      TString Title_j = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><span class="lineno"> 1039</span>      <span class="keywordtype">double</span> Prior_j, PriorError_j;</div>
<div class="line"><span class="lineno"> 1040</span>      <a class="code hl_function" href="classMCMCProcessor.html#a28dfe42f1bf6fd3a145287be1e63fb0b">GetNthParameter</a>(j, Prior_j, PriorError_j, Title_j);</div>
<div class="line"><span class="lineno"> 1041</span> </div>
<div class="line"><span class="lineno"> 1042</span>      <a class="code hl_variable" href="classMCMCProcessor.html#a62035b99df4617ab334cd1abd6ed0346">OutputFile</a>-&gt;cd();</div>
<div class="line"><span class="lineno"> 1043</span> </div>
<div class="line"><span class="lineno"> 1044</span>      <span class="comment">// The draw which we want to perform</span></div>
<div class="line"><span class="lineno"> 1045</span>      TString DrawMe = <a class="code hl_variable" href="classMCMCProcessor.html#ad043b6b2c885f47ab9967831bc8d0f5a">BranchNames</a>[j]+<span class="stringliteral">&quot;:&quot;</span>+<a class="code hl_variable" href="classMCMCProcessor.html#ad043b6b2c885f47ab9967831bc8d0f5a">BranchNames</a>[i];</div>
<div class="line"><span class="lineno"> 1046</span> </div>
<div class="line"><span class="lineno"> 1047</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> max_j = <a class="code hl_variable" href="classMCMCProcessor.html#a6be3bbebd4a79fe9814a3da09b3bb820">Chain</a>-&gt;GetMaximum(<a class="code hl_variable" href="classMCMCProcessor.html#ad043b6b2c885f47ab9967831bc8d0f5a">BranchNames</a>[j]);</div>
<div class="line"><span class="lineno"> 1048</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> min_j = <a class="code hl_variable" href="classMCMCProcessor.html#a6be3bbebd4a79fe9814a3da09b3bb820">Chain</a>-&gt;GetMinimum(<a class="code hl_variable" href="classMCMCProcessor.html#ad043b6b2c885f47ab9967831bc8d0f5a">BranchNames</a>[j]);</div>
<div class="line"><span class="lineno"> 1049</span> </div>
<div class="line"><span class="lineno"> 1050</span>      <span class="comment">// TH2F to hold the Correlation </span></div>
<div class="line"><span class="lineno"> 1051</span>      std::unique_ptr&lt;TH2D&gt; hpost_2D = std::make_unique&lt;TH2D&gt;(DrawMe, DrawMe, <a class="code hl_variable" href="classMCMCProcessor.html#a6b74f8195bcbca0979f9e9fe43468bae">nBins</a>, min_i, max_i, <a class="code hl_variable" href="classMCMCProcessor.html#a6b74f8195bcbca0979f9e9fe43468bae">nBins</a>, min_j, max_j);</div>
<div class="line"><span class="lineno"> 1052</span>      hpost_2D-&gt;SetMinimum(0);</div>
<div class="line"><span class="lineno"> 1053</span>      hpost_2D-&gt;GetXaxis()-&gt;SetTitle(Title_i);</div>
<div class="line"><span class="lineno"> 1054</span>      hpost_2D-&gt;GetYaxis()-&gt;SetTitle(Title_j);</div>
<div class="line"><span class="lineno"> 1055</span>      hpost_2D-&gt;GetZaxis()-&gt;SetTitle(<span class="stringliteral">&quot;Steps&quot;</span>);</div>
<div class="line"><span class="lineno"> 1056</span> </div>
<div class="line"><span class="lineno"> 1057</span>      <span class="comment">// The draw command we want, i.e. draw param j vs param i</span></div>
<div class="line"><span class="lineno"> 1058</span>      <a class="code hl_variable" href="classMCMCProcessor.html#a6be3bbebd4a79fe9814a3da09b3bb820">Chain</a>-&gt;Project(DrawMe, DrawMe, <a class="code hl_variable" href="classMCMCProcessor.html#a576f0eb874afaf7e31ff5c86b9e5b8f9">StepCut</a>.c_str());</div>
<div class="line"><span class="lineno"> 1059</span>      </div>
<div class="line"><span class="lineno"> 1060</span>      <span class="keywordflow">if</span>(<a class="code hl_variable" href="classMCMCProcessor.html#a682c1c47626542f5820d633ba2bc010c">ApplySmoothing</a>) hpost_2D-&gt;Smooth();</div>
<div class="line"><span class="lineno"> 1061</span>      <span class="comment">// Get the Covariance for these two parameters</span></div>
<div class="line"><span class="lineno"> 1062</span>      (*Covariance)(i,j) = hpost_2D-&gt;GetCovariance();</div>
<div class="line"><span class="lineno"> 1063</span>      (*Covariance)(j,i) = (*<a class="code hl_variable" href="classMCMCProcessor.html#af9a40632e2d7f1266d69a74d5b5f2244">Covariance</a>)(i,j);</div>
<div class="line"><span class="lineno"> 1064</span> </div>
<div class="line"><span class="lineno"> 1065</span>      (*Correlation)(i,j) = hpost_2D-&gt;GetCorrelationFactor();</div>
<div class="line"><span class="lineno"> 1066</span>      (*Correlation)(j,i) = (*<a class="code hl_variable" href="classMCMCProcessor.html#a03f28431158777cdd81d058b6632a92f">Correlation</a>)(i,j);</div>
<div class="line"><span class="lineno"> 1067</span> </div>
<div class="line"><span class="lineno"> 1068</span>      <span class="keywordflow">if</span>(<a class="code hl_variable" href="classMCMCProcessor.html#ad73755714ae3d6dc951158d5513c6eee">printToPDF</a>)</div>
<div class="line"><span class="lineno"> 1069</span>      {</div>
<div class="line"><span class="lineno"> 1070</span>        <span class="comment">//KS: Skip Flux Params</span></div>
<div class="line"><span class="lineno"> 1071</span>        <span class="keywordflow">if</span>(<a class="code hl_variable" href="classMCMCProcessor.html#aaa903949bde8f1a69800c71fe1eb538e">ParamType</a>[i] == <a class="code hl_enumvalue" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20ba7386f5611ea4d01b85b9bb92a5ca335f">kXSecPar</a> &amp;&amp; <a class="code hl_variable" href="classMCMCProcessor.html#aaa903949bde8f1a69800c71fe1eb538e">ParamType</a>[j] == <a class="code hl_enumvalue" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20ba7386f5611ea4d01b85b9bb92a5ca335f">kXSecPar</a>)</div>
<div class="line"><span class="lineno"> 1072</span>        {</div>
<div class="line"><span class="lineno"> 1073</span>          <span class="keywordflow">if</span>(<a class="code hl_variable" href="classMCMCProcessor.html#a2c06d64020e9246e720cc131a9f4986d">IsXsec</a>[j] &amp;&amp; <a class="code hl_variable" href="classMCMCProcessor.html#a2c06d64020e9246e720cc131a9f4986d">IsXsec</a>[i] &amp;&amp; std::fabs((*<a class="code hl_variable" href="classMCMCProcessor.html#a03f28431158777cdd81d058b6632a92f">Correlation</a>)(i,j)) &gt; <a class="code hl_variable" href="classMCMCProcessor.html#a25e4685b6299181021b02ac0e0b74681">Post2DPlotThreshold</a>)</div>
<div class="line"><span class="lineno"> 1074</span>          {</div>
<div class="line"><span class="lineno"> 1075</span>            <a class="code hl_variable" href="classMCMCProcessor.html#a82e6cfef1ba6fcfc8ac8f61acb5bf931">Posterior</a>-&gt;cd();</div>
<div class="line"><span class="lineno"> 1076</span>            hpost_2D-&gt;Draw(<span class="stringliteral">&quot;colz&quot;</span>);</div>
<div class="line"><span class="lineno"> 1077</span>            <a class="code hl_variable" href="classMCMCProcessor.html#a82e6cfef1ba6fcfc8ac8f61acb5bf931">Posterior</a>-&gt;SetName(hpost_2D-&gt;GetName());</div>
<div class="line"><span class="lineno"> 1078</span>            <a class="code hl_variable" href="classMCMCProcessor.html#a82e6cfef1ba6fcfc8ac8f61acb5bf931">Posterior</a>-&gt;SetTitle(hpost_2D-&gt;GetTitle());</div>
<div class="line"><span class="lineno"> 1079</span>            <a class="code hl_variable" href="classMCMCProcessor.html#a82e6cfef1ba6fcfc8ac8f61acb5bf931">Posterior</a>-&gt;Print(<a class="code hl_variable" href="classMCMCProcessor.html#ab5aec3dc293919701d31e6ae705601dd">CanvasName</a>);</div>
<div class="line"><span class="lineno"> 1080</span>          }</div>
<div class="line"><span class="lineno"> 1081</span>        }</div>
<div class="line"><span class="lineno"> 1082</span>      }</div>
<div class="line"><span class="lineno"> 1083</span>      <span class="comment">// Write it to root file</span></div>
<div class="line"><span class="lineno"> 1084</span>      <span class="comment">//OutputFile-&gt;cd();</span></div>
<div class="line"><span class="lineno"> 1085</span>      <span class="comment">//if( std::fabs((*Correlation)(i,j)) &gt; Post2DPlotThreshold ) hpost_2D-&gt;Write();</span></div>
<div class="line"><span class="lineno"> 1086</span>    } <span class="comment">// End j loop</span></div>
<div class="line"><span class="lineno"> 1087</span>  } <span class="comment">// End i loop</span></div>
<div class="line"><span class="lineno"> 1088</span>  <a class="code hl_variable" href="classMCMCProcessor.html#a62035b99df4617ab334cd1abd6ed0346">OutputFile</a>-&gt;cd();</div>
<div class="line"><span class="lineno"> 1089</span>  <a class="code hl_variable" href="classMCMCProcessor.html#af9a40632e2d7f1266d69a74d5b5f2244">Covariance</a>-&gt;Write(<span class="stringliteral">&quot;Covariance&quot;</span>);</div>
<div class="line"><span class="lineno"> 1090</span>  <a class="code hl_variable" href="classMCMCProcessor.html#a03f28431158777cdd81d058b6632a92f">Correlation</a>-&gt;Write(<span class="stringliteral">&quot;Correlation&quot;</span>);</div>
<div class="line"><span class="lineno"> 1091</span>}</div>
<div class="ttc" id="aclassMCMCProcessor_html_a2c06d64020e9246e720cc131a9f4986d"><div class="ttname"><a href="classMCMCProcessor.html#a2c06d64020e9246e720cc131a9f4986d">MCMCProcessor::IsXsec</a></div><div class="ttdeci">std::vector&lt; bool &gt; IsXsec</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8h_source.html#l00378">MCMCProcessor.h:378</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ab367cb5f56606338bb1fce780f2414e8" name="ab367cb5f56606338bb1fce780f2414e8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab367cb5f56606338bb1fce780f2414e8">&#9670;&#160;</a></span>MakeCovariance_MP()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void MCMCProcessor::MakeCovariance_MP </td>
          <td>(</td>
          <td class="paramtype">const bool&#160;</td>
          <td class="paramname"><em>Mute</em> = <code>false</code></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate covariance by making 2D projection of each combination of parameters using multithreading. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">Mute</td><td>Allow silencing many messages, especially important if we calculate matrix many times </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8cpp_source.html#l01204">1204</a> of file <a class="el" href="MCMCProcessor_8cpp_source.html">MCMCProcessor.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1204</span>                                               {</div>
<div class="line"><span class="lineno"> 1205</span><span class="comment">// *********************</span></div>
<div class="line"><span class="lineno"> 1206</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="classMCMCProcessor.html#a62035b99df4617ab334cd1abd6ed0346">OutputFile</a> == <span class="keyword">nullptr</span>) <a class="code hl_function" href="classMCMCProcessor.html#aa5a7761e97cf2e24c7d877a5374b7333">MakeOutputFile</a>();</div>
<div class="line"><span class="lineno"> 1207</span>    </div>
<div class="line"><span class="lineno"> 1208</span>  <span class="keywordflow">if</span>(!<a class="code hl_variable" href="classMCMCProcessor.html#aea84f0315695aa05ec41fcf965b1b031">CacheMCMC</a>) <a class="code hl_function" href="classMCMCProcessor.html#ace48a54fb08e2a3943d4e2ed1f8c4a4b">CacheSteps</a>();</div>
<div class="line"><span class="lineno"> 1209</span>  </div>
<div class="line"><span class="lineno"> 1210</span>  <span class="keywordtype">bool</span> HaveMadeDiagonal = <span class="keyword">false</span>;    </div>
<div class="line"><span class="lineno"> 1211</span>  <span class="comment">// Check that the diagonal entries have been filled</span></div>
<div class="line"><span class="lineno"> 1212</span>  <span class="comment">// i.e. MakePostfit() has been called</span></div>
<div class="line"><span class="lineno"> 1213</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_variable" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>; ++i) {</div>
<div class="line"><span class="lineno"> 1214</span>    <span class="keywordflow">if</span> ((*<a class="code hl_variable" href="classMCMCProcessor.html#af9a40632e2d7f1266d69a74d5b5f2244">Covariance</a>)(i,i) == <a class="code hl_define" href="MCMCProcessor_8h.html#a82a6d79039474bc403b627437a7b97ec">_UNDEF_</a>) {</div>
<div class="line"><span class="lineno"> 1215</span>      HaveMadeDiagonal = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1216</span>      <a class="code hl_define" href="MaCh3Logger_8h.html#ad5b2eb6377721e3ac95def22c2386bb1">MACH3LOG_WARN</a>(<span class="stringliteral">&quot;Have not run diagonal elements in covariance, will do so now by calling MakePostfit()&quot;</span>);</div>
<div class="line"><span class="lineno"> 1217</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1218</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1219</span>      HaveMadeDiagonal = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1220</span>    }</div>
<div class="line"><span class="lineno"> 1221</span>  }</div>
<div class="line"><span class="lineno"> 1222</span>    </div>
<div class="line"><span class="lineno"> 1223</span>  <span class="keywordflow">if</span> (HaveMadeDiagonal == <span class="keyword">false</span>) <a class="code hl_function" href="classMCMCProcessor.html#a8667510132aa01395520f028287f511b">MakePostfit</a>();</div>
<div class="line"><span class="lineno"> 1224</span>  <span class="keywordflow">if</span>(!Mute) <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Calculating covariance matrix&quot;</span>);</div>
<div class="line"><span class="lineno"> 1225</span>  TStopwatch clock;</div>
<div class="line"><span class="lineno"> 1226</span>  <span class="keywordflow">if</span>(!Mute) clock.Start();</div>
<div class="line"><span class="lineno"> 1227</span> </div>
<div class="line"><span class="lineno"> 1228</span>  gStyle-&gt;SetPalette(55);</div>
<div class="line"><span class="lineno"> 1229</span>  <span class="comment">// Now we are sure we have the diagonal elements, let&#39;s make the off-diagonals</span></div>
<div class="line"><span class="lineno"> 1230</span><span class="preprocessor">  #ifdef MULTITHREAD</span></div>
<div class="line"><span class="lineno"> 1231</span><span class="preprocessor">  #pragma omp parallel for</span></div>
<div class="line"><span class="lineno"> 1232</span><span class="preprocessor">  #endif</span></div>
<div class="line"><span class="lineno"> 1233</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_variable" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>; ++i)</div>
<div class="line"><span class="lineno"> 1234</span>  {    </div>
<div class="line"><span class="lineno"> 1235</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt;= i; ++j)</div>
<div class="line"><span class="lineno"> 1236</span>    {</div>
<div class="line"><span class="lineno"> 1237</span>      <span class="comment">// Skip the diagonal elements which we&#39;ve already done above</span></div>
<div class="line"><span class="lineno"> 1238</span>      <span class="keywordflow">if</span> (j == i) <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 1239</span>      </div>
<div class="line"><span class="lineno"> 1240</span>      <span class="comment">// If this parameter isn&#39;t varied</span></div>
<div class="line"><span class="lineno"> 1241</span>      <span class="keywordflow">if</span> (<a class="code hl_variable" href="classMCMCProcessor.html#a95fa49737432818bc830a44898d0d850">IamVaried</a>[j] == <span class="keyword">false</span>) {</div>
<div class="line"><span class="lineno"> 1242</span>        (*Covariance)(i,j) = 0.0;</div>
<div class="line"><span class="lineno"> 1243</span>        (*Covariance)(j,i) = (*<a class="code hl_variable" href="classMCMCProcessor.html#af9a40632e2d7f1266d69a74d5b5f2244">Covariance</a>)(i,j);</div>
<div class="line"><span class="lineno"> 1244</span>        (*Correlation)(i,j) = 0.0;</div>
<div class="line"><span class="lineno"> 1245</span>        (*Correlation)(j,i) = (*<a class="code hl_variable" href="classMCMCProcessor.html#a03f28431158777cdd81d058b6632a92f">Correlation</a>)(i,j);</div>
<div class="line"><span class="lineno"> 1246</span>        <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 1247</span>      }</div>
<div class="line"><span class="lineno"> 1248</span>      <a class="code hl_variable" href="classMCMCProcessor.html#a0ddcfa4ba1e4dcdea366d88decc64391">hpost2D</a>[i][j]-&gt;SetMinimum(0);</div>
<div class="line"><span class="lineno"> 1249</span>          </div>
<div class="line"><span class="lineno"> 1250</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; <a class="code hl_variable" href="classMCMCProcessor.html#af3a19b885e9c34e1674aea8cfbe14e1c">nEntries</a>; ++k)</div>
<div class="line"><span class="lineno"> 1251</span>      {</div>
<div class="line"><span class="lineno"> 1252</span>        <span class="comment">//KS: Burn in cut</span></div>
<div class="line"><span class="lineno"> 1253</span>        <span class="keywordflow">if</span>(<a class="code hl_variable" href="classMCMCProcessor.html#a07549f3b67ca5409218d80c679f6e69e">StepNumber</a>[k] &lt; <a class="code hl_variable" href="classMCMCProcessor.html#a22f82dadceccbe87dd8c5b7daa8432e8">BurnInCut</a>) <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 1254</span> </div>
<div class="line"><span class="lineno"> 1255</span>        <span class="comment">//KS: Fill histogram with cached steps</span></div>
<div class="line"><span class="lineno"> 1256</span>        <a class="code hl_variable" href="classMCMCProcessor.html#a0ddcfa4ba1e4dcdea366d88decc64391">hpost2D</a>[i][j]-&gt;Fill(<a class="code hl_variable" href="classMCMCProcessor.html#a087dca88a306acdc28afea7213e3623c">ParStep</a>[i][k], <a class="code hl_variable" href="classMCMCProcessor.html#a087dca88a306acdc28afea7213e3623c">ParStep</a>[j][k]);</div>
<div class="line"><span class="lineno"> 1257</span>      }</div>
<div class="line"><span class="lineno"> 1258</span>      <span class="keywordflow">if</span>(<a class="code hl_variable" href="classMCMCProcessor.html#a682c1c47626542f5820d633ba2bc010c">ApplySmoothing</a>) <a class="code hl_variable" href="classMCMCProcessor.html#a0ddcfa4ba1e4dcdea366d88decc64391">hpost2D</a>[i][j]-&gt;Smooth();</div>
<div class="line"><span class="lineno"> 1259</span>      </div>
<div class="line"><span class="lineno"> 1260</span>      <span class="comment">// Get the Covariance for these two parameters</span></div>
<div class="line"><span class="lineno"> 1261</span>      (*Covariance)(i,j) = <a class="code hl_variable" href="classMCMCProcessor.html#a0ddcfa4ba1e4dcdea366d88decc64391">hpost2D</a>[i][j]-&gt;<a class="code hl_function" href="classMCMCProcessor.html#ac9e4fdea5d2de92a1abad5b79b7daf88">GetCovariance</a>();</div>
<div class="line"><span class="lineno"> 1262</span>      (*Covariance)(j,i) = (*<a class="code hl_variable" href="classMCMCProcessor.html#af9a40632e2d7f1266d69a74d5b5f2244">Covariance</a>)(i,j);</div>
<div class="line"><span class="lineno"> 1263</span> </div>
<div class="line"><span class="lineno"> 1264</span>      <span class="comment">//KS: Since we already have covariance consider calculating correlation using it, right now we effectively calculate covariance twice</span></div>
<div class="line"><span class="lineno"> 1265</span>      <span class="comment">//https://root.cern.ch/doc/master/TH2_8cxx_source.html#l01099</span></div>
<div class="line"><span class="lineno"> 1266</span>      (*Correlation)(i,j) = <a class="code hl_variable" href="classMCMCProcessor.html#a0ddcfa4ba1e4dcdea366d88decc64391">hpost2D</a>[i][j]-&gt;GetCorrelationFactor();</div>
<div class="line"><span class="lineno"> 1267</span>      (*Correlation)(j,i) = (*<a class="code hl_variable" href="classMCMCProcessor.html#a03f28431158777cdd81d058b6632a92f">Correlation</a>)(i,j);</div>
<div class="line"><span class="lineno"> 1268</span>    }<span class="comment">// End j loop</span></div>
<div class="line"><span class="lineno"> 1269</span>  }<span class="comment">// End i loop</span></div>
<div class="line"><span class="lineno"> 1270</span> </div>
<div class="line"><span class="lineno"> 1271</span>  <span class="keywordflow">if</span>(!Mute) {</div>
<div class="line"><span class="lineno"> 1272</span>    clock.Stop();</div>
<div class="line"><span class="lineno"> 1273</span>    <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Making Covariance took {:.2f}s to finish for {} steps&quot;</span>, clock.RealTime(), <a class="code hl_variable" href="classMCMCProcessor.html#af3a19b885e9c34e1674aea8cfbe14e1c">nEntries</a>);</div>
<div class="line"><span class="lineno"> 1274</span>  }</div>
<div class="line"><span class="lineno"> 1275</span>  <a class="code hl_variable" href="classMCMCProcessor.html#a62035b99df4617ab334cd1abd6ed0346">OutputFile</a>-&gt;cd();</div>
<div class="line"><span class="lineno"> 1276</span>  <span class="keywordflow">if</span>(<a class="code hl_variable" href="classMCMCProcessor.html#ad73755714ae3d6dc951158d5513c6eee">printToPDF</a>)</div>
<div class="line"><span class="lineno"> 1277</span>  {</div>
<div class="line"><span class="lineno"> 1278</span>    <a class="code hl_variable" href="classMCMCProcessor.html#a82e6cfef1ba6fcfc8ac8f61acb5bf931">Posterior</a>-&gt;cd();</div>
<div class="line"><span class="lineno"> 1279</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_variable" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>; ++i)</div>
<div class="line"><span class="lineno"> 1280</span>    {    </div>
<div class="line"><span class="lineno"> 1281</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt;= i; ++j)</div>
<div class="line"><span class="lineno"> 1282</span>      {</div>
<div class="line"><span class="lineno"> 1283</span>        <span class="comment">// Skip the diagonal elements which we&#39;ve already done above</span></div>
<div class="line"><span class="lineno"> 1284</span>        <span class="keywordflow">if</span> (j == i) <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 1285</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classMCMCProcessor.html#a95fa49737432818bc830a44898d0d850">IamVaried</a>[j] == <span class="keyword">false</span>) <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 1286</span> </div>
<div class="line"><span class="lineno"> 1287</span>        <span class="keywordflow">if</span>(<a class="code hl_variable" href="classMCMCProcessor.html#aaa903949bde8f1a69800c71fe1eb538e">ParamType</a>[i] == <a class="code hl_enumvalue" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20ba7386f5611ea4d01b85b9bb92a5ca335f">kXSecPar</a> &amp;&amp; <a class="code hl_variable" href="classMCMCProcessor.html#aaa903949bde8f1a69800c71fe1eb538e">ParamType</a>[j] == <a class="code hl_enumvalue" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20ba7386f5611ea4d01b85b9bb92a5ca335f">kXSecPar</a>)</div>
<div class="line"><span class="lineno"> 1288</span>        {</div>
<div class="line"><span class="lineno"> 1289</span>          <span class="comment">//KS: Skip Flux Params</span></div>
<div class="line"><span class="lineno"> 1290</span>          <span class="keywordflow">if</span>(<a class="code hl_variable" href="classMCMCProcessor.html#a2c06d64020e9246e720cc131a9f4986d">IsXsec</a>[j] &amp;&amp; <a class="code hl_variable" href="classMCMCProcessor.html#a2c06d64020e9246e720cc131a9f4986d">IsXsec</a>[i] &amp;&amp; std::fabs((*<a class="code hl_variable" href="classMCMCProcessor.html#a03f28431158777cdd81d058b6632a92f">Correlation</a>)(i,j)) &gt; <a class="code hl_variable" href="classMCMCProcessor.html#a25e4685b6299181021b02ac0e0b74681">Post2DPlotThreshold</a>)</div>
<div class="line"><span class="lineno"> 1291</span>          {</div>
<div class="line"><span class="lineno"> 1292</span>            <a class="code hl_variable" href="classMCMCProcessor.html#a0ddcfa4ba1e4dcdea366d88decc64391">hpost2D</a>[i][j]-&gt;Draw(<span class="stringliteral">&quot;colz&quot;</span>);</div>
<div class="line"><span class="lineno"> 1293</span>            <a class="code hl_variable" href="classMCMCProcessor.html#a82e6cfef1ba6fcfc8ac8f61acb5bf931">Posterior</a>-&gt;SetName(<a class="code hl_variable" href="classMCMCProcessor.html#a0ddcfa4ba1e4dcdea366d88decc64391">hpost2D</a>[i][j]-&gt;GetName());</div>
<div class="line"><span class="lineno"> 1294</span>            <a class="code hl_variable" href="classMCMCProcessor.html#a82e6cfef1ba6fcfc8ac8f61acb5bf931">Posterior</a>-&gt;SetTitle(<a class="code hl_variable" href="classMCMCProcessor.html#a0ddcfa4ba1e4dcdea366d88decc64391">hpost2D</a>[i][j]-&gt;GetTitle());</div>
<div class="line"><span class="lineno"> 1295</span>            <a class="code hl_variable" href="classMCMCProcessor.html#a82e6cfef1ba6fcfc8ac8f61acb5bf931">Posterior</a>-&gt;Print(<a class="code hl_variable" href="classMCMCProcessor.html#ab5aec3dc293919701d31e6ae705601dd">CanvasName</a>);</div>
<div class="line"><span class="lineno"> 1296</span>          }</div>
<div class="line"><span class="lineno"> 1297</span>        }</div>
<div class="line"><span class="lineno"> 1298</span>        <span class="comment">//if( std::fabs((*Correlation)(i,j)) &gt; Post2DPlotThreshold) hpost2D[i][j]-&gt;Write();</span></div>
<div class="line"><span class="lineno"> 1299</span>      }<span class="comment">// End j loop</span></div>
<div class="line"><span class="lineno"> 1300</span>    }<span class="comment">// End i loop</span></div>
<div class="line"><span class="lineno"> 1301</span>  } <span class="comment">//end if pdf</span></div>
<div class="line"><span class="lineno"> 1302</span>  <span class="keywordflow">if</span>(!Mute) {</div>
<div class="line"><span class="lineno"> 1303</span>    <a class="code hl_variable" href="classMCMCProcessor.html#af9a40632e2d7f1266d69a74d5b5f2244">Covariance</a>-&gt;Write(<span class="stringliteral">&quot;Covariance&quot;</span>);</div>
<div class="line"><span class="lineno"> 1304</span>    <a class="code hl_variable" href="classMCMCProcessor.html#a03f28431158777cdd81d058b6632a92f">Correlation</a>-&gt;Write(<span class="stringliteral">&quot;Correlation&quot;</span>);</div>
<div class="line"><span class="lineno"> 1305</span>  }</div>
<div class="line"><span class="lineno"> 1306</span>}</div>
<div class="ttc" id="aclassMCMCProcessor_html_a22f82dadceccbe87dd8c5b7daa8432e8"><div class="ttname"><a href="classMCMCProcessor.html#a22f82dadceccbe87dd8c5b7daa8432e8">MCMCProcessor::BurnInCut</a></div><div class="ttdeci">int BurnInCut</div><div class="ttdoc">Value of burn in cut.</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8h_source.html#l00340">MCMCProcessor.h:340</a></div></div>
<div class="ttc" id="aclassMCMCProcessor_html_ac9e4fdea5d2de92a1abad5b79b7daf88"><div class="ttname"><a href="classMCMCProcessor.html#ac9e4fdea5d2de92a1abad5b79b7daf88">MCMCProcessor::GetCovariance</a></div><div class="ttdeci">void GetCovariance(TMatrixDSym *&amp;Cov, TMatrixDSym *&amp;Corr)</div><div class="ttdoc">Get the post-fit covariances and correlations.</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8cpp_source.html#l00196">MCMCProcessor.cpp:196</a></div></div>
<div class="ttc" id="aclassMCMCProcessor_html_ace48a54fb08e2a3943d4e2ed1f8c4a4b"><div class="ttname"><a href="classMCMCProcessor.html#ace48a54fb08e2a3943d4e2ed1f8c4a4b">MCMCProcessor::CacheSteps</a></div><div class="ttdeci">void CacheSteps()</div><div class="ttdoc">KS:By caching each step we use multithreading.</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8cpp_source.html#l01095">MCMCProcessor.cpp:1095</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a17c0f09bfce82d1701a83645f748988a" name="a17c0f09bfce82d1701a83645f748988a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a17c0f09bfce82d1701a83645f748988a">&#9670;&#160;</a></span>MakeCredibleIntervals()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void MCMCProcessor::MakeCredibleIntervals </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>CredibleIntervals</em> = <code>{0.99,&#160;0.90,&#160;0.68&#160;}</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; Color_t &gt; &amp;&#160;</td>
          <td class="paramname"><em>CredibleIntervalsColours</em> = <code>{kCyan+4,&#160;kCyan-2,&#160;kCyan-10}</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const bool&#160;</td>
          <td class="paramname"><em>CredibleInSigmas</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Make and Draw Credible intervals. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">CredibleIntervals</td><td>Vector with values of credible intervals, must be in descending order </td></tr>
    <tr><td class="paramname">CredibleIntervalsColours</td><td>Color_t telling what colour to use for each Interval line </td></tr>
    <tr><td class="paramname">CredibleInSigmas</td><td>Bool telling whether intervals are in percentage or in sigmas, then special conversions is used </td></tr>
  </table>
  </dd>
</dl>
<p>Scale the histograms so it shows the posterior probability</p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8cpp_source.html#l00691">691</a> of file <a class="el" href="MCMCProcessor_8cpp_source.html">MCMCProcessor.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  693</span>                                                                       {</div>
<div class="line"><span class="lineno">  694</span><span class="comment">// *********************</span></div>
<div class="line"><span class="lineno">  695</span>  <span class="keywordflow">if</span>(<a class="code hl_variable" href="classMCMCProcessor.html#a795f661ed1ba8b8ae54c41fde5fb9496">hpost</a>[0] == <span class="keyword">nullptr</span>) <a class="code hl_function" href="classMCMCProcessor.html#a8667510132aa01395520f028287f511b">MakePostfit</a>();</div>
<div class="line"><span class="lineno">  696</span> </div>
<div class="line"><span class="lineno">  697</span>  <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Making Credible Intervals &quot;</span>);</div>
<div class="line"><span class="lineno">  698</span> </div>
<div class="line"><span class="lineno">  699</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> LeftMargin = <a class="code hl_variable" href="classMCMCProcessor.html#a82e6cfef1ba6fcfc8ac8f61acb5bf931">Posterior</a>-&gt;GetLeftMargin();</div>
<div class="line"><span class="lineno">  700</span>  <a class="code hl_variable" href="classMCMCProcessor.html#a82e6cfef1ba6fcfc8ac8f61acb5bf931">Posterior</a>-&gt;SetLeftMargin(0.15);</div>
<div class="line"><span class="lineno">  701</span> </div>
<div class="line"><span class="lineno">  702</span>  <span class="keywordflow">if</span>(CredibleIntervals.size() != CredibleIntervalsColours.size())</div>
<div class="line"><span class="lineno">  703</span>  {</div>
<div class="line"><span class="lineno">  704</span>    <a class="code hl_define" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Size of  CredibleIntervals is not equal to size of CredibleIntervalsColours&quot;</span>);</div>
<div class="line"><span class="lineno">  705</span>    <span class="keywordflow">throw</span> <a class="code hl_class" href="classMaCh3Exception.html">MaCh3Exception</a>(__FILE__ , __LINE__ );</div>
<div class="line"><span class="lineno">  706</span>  }</div>
<div class="line"><span class="lineno">  707</span> </div>
<div class="line"><span class="lineno">  708</span>  <span class="keywordflow">if</span>(CredibleIntervals.size() &gt; 1)</div>
<div class="line"><span class="lineno">  709</span>  {</div>
<div class="line"><span class="lineno">  710</span>    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 1; i &lt; CredibleIntervals.size(); i++ )</div>
<div class="line"><span class="lineno">  711</span>    {</div>
<div class="line"><span class="lineno">  712</span>      <span class="keywordflow">if</span>(CredibleIntervals[i] &gt; CredibleIntervals[i-1])</div>
<div class="line"><span class="lineno">  713</span>      {</div>
<div class="line"><span class="lineno">  714</span>        <a class="code hl_define" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Interval {} is smaller than {}&quot;</span>, i, i-1);</div>
<div class="line"><span class="lineno">  715</span>        <a class="code hl_define" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;{:.2f} {:.2f}&quot;</span>, CredibleIntervals[i], CredibleIntervals[i-1]);</div>
<div class="line"><span class="lineno">  716</span>        <a class="code hl_define" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;They should be grouped in decreasing order&quot;</span>);</div>
<div class="line"><span class="lineno">  717</span>        <span class="keywordflow">throw</span> <a class="code hl_class" href="classMaCh3Exception.html">MaCh3Exception</a>(__FILE__ , __LINE__ );</div>
<div class="line"><span class="lineno">  718</span>      }</div>
<div class="line"><span class="lineno">  719</span>    }</div>
<div class="line"><span class="lineno">  720</span>  }</div>
<div class="line"><span class="lineno">  721</span> </div>
<div class="line"><span class="lineno">  722</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> nCredible = int(CredibleIntervals.size());</div>
<div class="line"><span class="lineno">  723</span>  std::vector&lt;TH1D*&gt; hpost_copy(<a class="code hl_variable" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>);</div>
<div class="line"><span class="lineno">  724</span>  std::vector&lt;std::vector&lt;TH1D*&gt;&gt; hpost_cl(<a class="code hl_variable" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>);</div>
<div class="line"><span class="lineno">  725</span> </div>
<div class="line"><span class="lineno">  726</span>  <span class="comment">//KS: Copy all histograms to be thread safe</span></div>
<div class="line"><span class="lineno">  727</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_variable" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>; ++i)</div>
<div class="line"><span class="lineno">  728</span>  {</div>
<div class="line"><span class="lineno">  729</span>    hpost_copy[i] = <span class="keyword">static_cast&lt;</span>TH1D*<span class="keyword">&gt;</span>(<a class="code hl_variable" href="classMCMCProcessor.html#a795f661ed1ba8b8ae54c41fde5fb9496">hpost</a>[i]-&gt;Clone(Form(<span class="stringliteral">&quot;hpost_copy_%i&quot;</span>, i)));</div>
<div class="line"><span class="lineno">  730</span>    hpost_cl[i].resize(nCredible);</div>
<div class="line"><span class="lineno">  731</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; nCredible; ++j)</div>
<div class="line"><span class="lineno">  732</span>    {</div>
<div class="line"><span class="lineno">  733</span>      hpost_cl[i][j] = <span class="keyword">static_cast&lt;</span>TH1D*<span class="keyword">&gt;</span>(<a class="code hl_variable" href="classMCMCProcessor.html#a795f661ed1ba8b8ae54c41fde5fb9496">hpost</a>[i]-&gt;Clone(Form(<span class="stringliteral">&quot;hpost_copy_%i_CL_%f&quot;</span>, i, CredibleIntervals[j])));</div>
<div class="line"><span class="lineno">  734</span> </div>
<div class="line"><span class="lineno">  735</span>      <span class="comment">//KS: Reset to get rid to TF1 otherwise we run into segfault :(</span></div>
<div class="line"><span class="lineno">  736</span>      hpost_cl[i][j]-&gt;Reset(<span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><span class="lineno">  737</span>      hpost_cl[i][j]-&gt;Fill(0.0, 0.0);</div>
<div class="line"><span class="lineno">  738</span>    }</div>
<div class="line"><span class="lineno">  739</span>  }</div>
<div class="line"><span class="lineno">  740</span> </div>
<div class="line"><span class="lineno">  741</span><span class="preprocessor">  #ifdef MULTITHREAD</span></div>
<div class="line"><span class="lineno">  742</span><span class="preprocessor">  #pragma omp parallel for</span></div>
<div class="line"><span class="lineno">  743</span><span class="preprocessor">  #endif</span></div>
<div class="line"><span class="lineno">  744</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_variable" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>; ++i)</div>
<div class="line"><span class="lineno">  745</span>  {</div>
<div class="line"><span class="lineno">  747</span>    hpost_copy[i]-&gt;Scale(1. / hpost_copy[i]-&gt;Integral());</div>
<div class="line"><span class="lineno">  748</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; nCredible; ++j)</div>
<div class="line"><span class="lineno">  749</span>    {</div>
<div class="line"><span class="lineno">  750</span>      <span class="comment">// Scale the histograms before gettindg credible intervals</span></div>
<div class="line"><span class="lineno">  751</span>      hpost_cl[i][j]-&gt;Scale(1. / hpost_cl[i][j]-&gt;Integral());</div>
<div class="line"><span class="lineno">  752</span> </div>
<div class="line"><span class="lineno">  753</span>      <span class="comment">//KS: We have slightly different approach depending if you passed percentage or sigmas</span></div>
<div class="line"><span class="lineno">  754</span>      <span class="keywordflow">if</span>(CredibleInSigmas)</div>
<div class="line"><span class="lineno">  755</span>      {</div>
<div class="line"><span class="lineno">  756</span>        <span class="comment">//KS: Convert sigmas into percentage</span></div>
<div class="line"><span class="lineno">  757</span>        <span class="keyword">const</span> <span class="keywordtype">double</span> CredInter = <a class="code hl_function" href="StatisticalUtils_8h.html#a04394b98587b44b98b003bd1226606ed">GetSigmaValue</a>(<span class="keywordtype">int</span>(std::round(CredibleIntervals[j])));</div>
<div class="line"><span class="lineno">  758</span>        <a class="code hl_function" href="StatisticalUtils_8h.html#aac24043cc7a5ef6a05fc1b10d3860875">GetCredibleInterval</a>(hpost_copy[i], hpost_cl[i][j], CredInter);</div>
<div class="line"><span class="lineno">  759</span>      }</div>
<div class="line"><span class="lineno">  760</span>      <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  761</span>      {</div>
<div class="line"><span class="lineno">  762</span>        <a class="code hl_function" href="StatisticalUtils_8h.html#aac24043cc7a5ef6a05fc1b10d3860875">GetCredibleInterval</a>(hpost_copy[i], hpost_cl[i][j], CredibleIntervals[j]);</div>
<div class="line"><span class="lineno">  763</span>      }</div>
<div class="line"><span class="lineno">  764</span> </div>
<div class="line"><span class="lineno">  765</span>      hpost_cl[i][j]-&gt;SetFillColor(CredibleIntervalsColours[j]);</div>
<div class="line"><span class="lineno">  766</span>      hpost_cl[i][j]-&gt;SetLineWidth(1);</div>
<div class="line"><span class="lineno">  767</span>    }</div>
<div class="line"><span class="lineno">  768</span>    hpost_copy[i]-&gt;GetYaxis()-&gt;SetTitleOffset(1.8);</div>
<div class="line"><span class="lineno">  769</span>    hpost_copy[i]-&gt;SetLineWidth(1);</div>
<div class="line"><span class="lineno">  770</span>    hpost_copy[i]-&gt;SetMaximum(hpost_copy[i]-&gt;GetMaximum()*1.2);</div>
<div class="line"><span class="lineno">  771</span>    hpost_copy[i]-&gt;SetLineWidth(2);</div>
<div class="line"><span class="lineno">  772</span>    hpost_copy[i]-&gt;SetLineColor(kBlack);</div>
<div class="line"><span class="lineno">  773</span>    hpost_copy[i]-&gt;GetYaxis()-&gt;SetTitle(<span class="stringliteral">&quot;Posterior Probability&quot;</span>);</div>
<div class="line"><span class="lineno">  774</span>  }</div>
<div class="line"><span class="lineno">  775</span> </div>
<div class="line"><span class="lineno">  776</span>  <a class="code hl_variable" href="classMCMCProcessor.html#a62035b99df4617ab334cd1abd6ed0346">OutputFile</a>-&gt;cd();</div>
<div class="line"><span class="lineno">  777</span>  TDirectory *CredibleDir = <a class="code hl_variable" href="classMCMCProcessor.html#a62035b99df4617ab334cd1abd6ed0346">OutputFile</a>-&gt;mkdir(<span class="stringliteral">&quot;Credible&quot;</span>);</div>
<div class="line"><span class="lineno">  778</span> </div>
<div class="line"><span class="lineno">  779</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_variable" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>; ++i)</div>
<div class="line"><span class="lineno">  780</span>  {</div>
<div class="line"><span class="lineno">  781</span>    <span class="keywordflow">if</span>(!<a class="code hl_variable" href="classMCMCProcessor.html#a95fa49737432818bc830a44898d0d850">IamVaried</a>[i]) <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  782</span> </div>
<div class="line"><span class="lineno">  783</span>    <span class="comment">// Now make the TLine for the Asimov</span></div>
<div class="line"><span class="lineno">  784</span>    TString Title = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><span class="lineno">  785</span>    <span class="keywordtype">double</span> Prior = 1.0;</div>
<div class="line"><span class="lineno">  786</span>    <span class="keywordtype">double</span> PriorError = 1.0;</div>
<div class="line"><span class="lineno">  787</span> </div>
<div class="line"><span class="lineno">  788</span>    <a class="code hl_function" href="classMCMCProcessor.html#a28dfe42f1bf6fd3a145287be1e63fb0b">GetNthParameter</a>(i, Prior, PriorError, Title);</div>
<div class="line"><span class="lineno">  789</span> </div>
<div class="line"><span class="lineno">  790</span>    <span class="keyword">auto</span> Asimov = std::make_unique&lt;TLine&gt;(Prior, hpost_copy[i]-&gt;GetMinimum(), Prior, hpost_copy[i]-&gt;GetMaximum());</div>
<div class="line"><span class="lineno">  791</span>    Asimov-&gt;SetLineColor(kRed-3);</div>
<div class="line"><span class="lineno">  792</span>    Asimov-&gt;SetLineWidth(2);</div>
<div class="line"><span class="lineno">  793</span>    Asimov-&gt;SetLineStyle(kDashed);</div>
<div class="line"><span class="lineno">  794</span> </div>
<div class="line"><span class="lineno">  795</span>    <span class="keyword">auto</span> legend = std::make_unique&lt;TLegend&gt;(0.20, 0.7, 0.4, 0.92);</div>
<div class="line"><span class="lineno">  796</span>    legend-&gt;SetTextSize(0.03);</div>
<div class="line"><span class="lineno">  797</span>    legend-&gt;SetFillColor(0);</div>
<div class="line"><span class="lineno">  798</span>    legend-&gt;SetFillStyle(0);</div>
<div class="line"><span class="lineno">  799</span>    legend-&gt;SetLineColor(0);</div>
<div class="line"><span class="lineno">  800</span>    legend-&gt;SetLineStyle(0);</div>
<div class="line"><span class="lineno">  801</span>    legend-&gt;SetBorderSize(0);</div>
<div class="line"><span class="lineno">  802</span>    hpost_copy[i]-&gt;Draw(<span class="stringliteral">&quot;HIST&quot;</span>);</div>
<div class="line"><span class="lineno">  803</span> </div>
<div class="line"><span class="lineno">  804</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; nCredible; ++j)</div>
<div class="line"><span class="lineno">  805</span>        hpost_cl[i][j]-&gt;Draw(<span class="stringliteral">&quot;HIST SAME&quot;</span>);</div>
<div class="line"><span class="lineno">  806</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = nCredible-1; j &gt;= 0; --j)</div>
<div class="line"><span class="lineno">  807</span>    {</div>
<div class="line"><span class="lineno">  808</span>      <span class="keywordflow">if</span>(CredibleInSigmas)</div>
<div class="line"><span class="lineno">  809</span>        legend-&gt;AddEntry(hpost_cl[i][j], Form(<span class="stringliteral">&quot;%.0f#sigma Credible Interval&quot;</span>, CredibleIntervals[j]), <span class="stringliteral">&quot;f&quot;</span>);</div>
<div class="line"><span class="lineno">  810</span>      <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  811</span>        legend-&gt;AddEntry(hpost_cl[i][j], Form(<span class="stringliteral">&quot;%.0f%% Credible Interval&quot;</span>, CredibleIntervals[j]*100), <span class="stringliteral">&quot;f&quot;</span>);</div>
<div class="line"><span class="lineno">  812</span>    }</div>
<div class="line"><span class="lineno">  813</span>    legend-&gt;AddEntry(Asimov.get(), Form(<span class="stringliteral">&quot;#splitline{Prior}{x = %.2f , #sigma = %.2f}&quot;</span>, Prior, PriorError), <span class="stringliteral">&quot;l&quot;</span>);</div>
<div class="line"><span class="lineno">  814</span>    legend-&gt;Draw(<span class="stringliteral">&quot;SAME&quot;</span>);</div>
<div class="line"><span class="lineno">  815</span>    Asimov-&gt;Draw(<span class="stringliteral">&quot;SAME&quot;</span>);</div>
<div class="line"><span class="lineno">  816</span> </div>
<div class="line"><span class="lineno">  817</span>    <span class="comment">// Write to file</span></div>
<div class="line"><span class="lineno">  818</span>    <a class="code hl_variable" href="classMCMCProcessor.html#a82e6cfef1ba6fcfc8ac8f61acb5bf931">Posterior</a>-&gt;SetName(<a class="code hl_variable" href="classMCMCProcessor.html#a795f661ed1ba8b8ae54c41fde5fb9496">hpost</a>[i]-&gt;GetName());</div>
<div class="line"><span class="lineno">  819</span>    <a class="code hl_variable" href="classMCMCProcessor.html#a82e6cfef1ba6fcfc8ac8f61acb5bf931">Posterior</a>-&gt;SetTitle(<a class="code hl_variable" href="classMCMCProcessor.html#a795f661ed1ba8b8ae54c41fde5fb9496">hpost</a>[i]-&gt;GetTitle());</div>
<div class="line"><span class="lineno">  820</span> </div>
<div class="line"><span class="lineno">  821</span>    <span class="keywordflow">if</span>(<a class="code hl_variable" href="classMCMCProcessor.html#ad73755714ae3d6dc951158d5513c6eee">printToPDF</a>) <a class="code hl_variable" href="classMCMCProcessor.html#a82e6cfef1ba6fcfc8ac8f61acb5bf931">Posterior</a>-&gt;Print(<a class="code hl_variable" href="classMCMCProcessor.html#ab5aec3dc293919701d31e6ae705601dd">CanvasName</a>);</div>
<div class="line"><span class="lineno">  822</span>    <span class="comment">// cd into directory in root file</span></div>
<div class="line"><span class="lineno">  823</span>    CredibleDir-&gt;cd();</div>
<div class="line"><span class="lineno">  824</span>    <a class="code hl_variable" href="classMCMCProcessor.html#a82e6cfef1ba6fcfc8ac8f61acb5bf931">Posterior</a>-&gt;Write();</div>
<div class="line"><span class="lineno">  825</span>  }</div>
<div class="line"><span class="lineno">  826</span> </div>
<div class="line"><span class="lineno">  827</span>  <span class="comment">//KS: Remove histograms</span></div>
<div class="line"><span class="lineno">  828</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_variable" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>; ++i) {</div>
<div class="line"><span class="lineno">  829</span>    <span class="keyword">delete</span> hpost_copy[i];</div>
<div class="line"><span class="lineno">  830</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; nCredible; ++j) {</div>
<div class="line"><span class="lineno">  831</span>      <span class="keyword">delete</span> hpost_cl[i][j];</div>
<div class="line"><span class="lineno">  832</span>    }</div>
<div class="line"><span class="lineno">  833</span>  }</div>
<div class="line"><span class="lineno">  834</span> </div>
<div class="line"><span class="lineno">  835</span>  CredibleDir-&gt;Close();</div>
<div class="line"><span class="lineno">  836</span>  <span class="keyword">delete</span> CredibleDir;</div>
<div class="line"><span class="lineno">  837</span> </div>
<div class="line"><span class="lineno">  838</span>  <a class="code hl_variable" href="classMCMCProcessor.html#a62035b99df4617ab334cd1abd6ed0346">OutputFile</a>-&gt;cd();</div>
<div class="line"><span class="lineno">  839</span> </div>
<div class="line"><span class="lineno">  840</span>  <span class="comment">//Set back to normal</span></div>
<div class="line"><span class="lineno">  841</span>  <a class="code hl_variable" href="classMCMCProcessor.html#a82e6cfef1ba6fcfc8ac8f61acb5bf931">Posterior</a>-&gt;SetLeftMargin(LeftMargin);</div>
<div class="line"><span class="lineno">  842</span>}</div>
<div class="ttc" id="aStatisticalUtils_8h_html_a04394b98587b44b98b003bd1226606ed"><div class="ttname"><a href="StatisticalUtils_8h.html#a04394b98587b44b98b003bd1226606ed">GetSigmaValue</a></div><div class="ttdeci">double GetSigmaValue(const int sigma)</div><div class="ttdoc">KS: Convert sigma from normal distribution into percentage.</div><div class="ttdef"><b>Definition:</b> <a href="StatisticalUtils_8h_source.html#l00055">StatisticalUtils.h:55</a></div></div>
<div class="ttc" id="aStatisticalUtils_8h_html_aac24043cc7a5ef6a05fc1b10d3860875"><div class="ttname"><a href="StatisticalUtils_8h.html#aac24043cc7a5ef6a05fc1b10d3860875">GetCredibleInterval</a></div><div class="ttdeci">void GetCredibleInterval(TH1D *const hist, TH1D *hpost_copy, const double coverage=0.6827)</div><div class="ttdoc">KS: Get 1D histogram within credible interval, hpost_copy has to have the same binning,...</div><div class="ttdef"><b>Definition:</b> <a href="StatisticalUtils_8h_source.html#l00375">StatisticalUtils.h:375</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a304adbe4407166ec42d76329c4bd17ff" name="a304adbe4407166ec42d76329c4bd17ff"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a304adbe4407166ec42d76329c4bd17ff">&#9670;&#160;</a></span>MakeCredibleRegions()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void MCMCProcessor::MakeCredibleRegions </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>CredibleRegions</em> = <code>{0.99,&#160;0.90,&#160;0.68}</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; Style_t &gt; &amp;&#160;</td>
          <td class="paramname"><em>CredibleRegionStyle</em> = <code>{kDashed,&#160;kSolid,&#160;kDotted}</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; Color_t &gt; &amp;&#160;</td>
          <td class="paramname"><em>CredibleRegionColor</em> = <code>{kGreen-3,&#160;kGreen-10,&#160;kGreen}</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const bool&#160;</td>
          <td class="paramname"><em>CredibleInSigmas</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Make and Draw Credible Regions. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">CredibleRegions</td><td>Vector with values of credible intervals, must be in descending order </td></tr>
    <tr><td class="paramname">CredibleRegionStyle</td><td>Style_t telling what line style to use for each Interval line </td></tr>
    <tr><td class="paramname">CredibleRegionColor</td><td>Color_t telling what colour to use for each Interval line </td></tr>
    <tr><td class="paramname">CredibleInSigmas</td><td>Bool telling whether intervals are in percentage or in sigmas, then special conversions is used </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8cpp_source.html#l01621">1621</a> of file <a class="el" href="MCMCProcessor_8cpp_source.html">MCMCProcessor.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1624</span>                                                                     {</div>
<div class="line"><span class="lineno"> 1625</span><span class="comment">// *********************</span></div>
<div class="line"><span class="lineno"> 1626</span> </div>
<div class="line"><span class="lineno"> 1627</span>  <span class="keywordflow">if</span>(<a class="code hl_variable" href="classMCMCProcessor.html#a0ddcfa4ba1e4dcdea366d88decc64391">hpost2D</a> == <span class="keyword">nullptr</span>) <a class="code hl_function" href="classMCMCProcessor.html#ab367cb5f56606338bb1fce780f2414e8">MakeCovariance_MP</a>();</div>
<div class="line"><span class="lineno"> 1628</span>  <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Making Credible Regions&quot;</span>);</div>
<div class="line"><span class="lineno"> 1629</span> </div>
<div class="line"><span class="lineno"> 1630</span>  <span class="keywordflow">if</span>( (CredibleRegions.size() != CredibleRegionStyle.size()) || (CredibleRegionStyle.size() != CredibleRegionColor.size()) )</div>
<div class="line"><span class="lineno"> 1631</span>  {</div>
<div class="line"><span class="lineno"> 1632</span>    <a class="code hl_define" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Size of  CredibleRegions is not equat to size of CredibleRegionStyle&quot;</span>);</div>
<div class="line"><span class="lineno"> 1633</span>    <span class="keywordflow">throw</span> <a class="code hl_class" href="classMaCh3Exception.html">MaCh3Exception</a>(__FILE__ , __LINE__ );</div>
<div class="line"><span class="lineno"> 1634</span>  }</div>
<div class="line"><span class="lineno"> 1635</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> nCredible = int(CredibleRegions.size());</div>
<div class="line"><span class="lineno"> 1636</span> </div>
<div class="line"><span class="lineno"> 1637</span> </div>
<div class="line"><span class="lineno"> 1638</span>  std::vector&lt;std::vector&lt;TH2D*&gt;&gt; hpost_2D_copy(<a class="code hl_variable" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>);</div>
<div class="line"><span class="lineno"> 1639</span>  std::vector&lt;std::vector&lt;std::vector&lt;TH2D*&gt;&gt;&gt; hpost_2D_cl(<a class="code hl_variable" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>);</div>
<div class="line"><span class="lineno"> 1640</span>  <span class="comment">//KS: Copy all histograms to be thread safe</span></div>
<div class="line"><span class="lineno"> 1641</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_variable" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>; ++i)</div>
<div class="line"><span class="lineno"> 1642</span>  {</div>
<div class="line"><span class="lineno"> 1643</span>    hpost_2D_copy[i].resize(<a class="code hl_variable" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>);</div>
<div class="line"><span class="lineno"> 1644</span>    hpost_2D_cl[i].resize(<a class="code hl_variable" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>);</div>
<div class="line"><span class="lineno"> 1645</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt;= i; ++j)</div>
<div class="line"><span class="lineno"> 1646</span>    {</div>
<div class="line"><span class="lineno"> 1647</span>      hpost_2D_copy[i][j] = <span class="keyword">static_cast&lt;</span>TH2D*<span class="keyword">&gt;</span>(<a class="code hl_variable" href="classMCMCProcessor.html#a0ddcfa4ba1e4dcdea366d88decc64391">hpost2D</a>[i][j]-&gt;Clone(Form(<span class="stringliteral">&quot;hpost_copy_%i_%i&quot;</span>, i, j)));</div>
<div class="line"><span class="lineno"> 1648</span>      hpost_2D_cl[i][j].resize(nCredible);</div>
<div class="line"><span class="lineno"> 1649</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; nCredible; ++k)</div>
<div class="line"><span class="lineno"> 1650</span>      {</div>
<div class="line"><span class="lineno"> 1651</span>        hpost_2D_cl[i][j][k] = <span class="keyword">static_cast&lt;</span>TH2D*<span class="keyword">&gt;</span>(<a class="code hl_variable" href="classMCMCProcessor.html#a0ddcfa4ba1e4dcdea366d88decc64391">hpost2D</a>[i][j]-&gt;Clone(Form(<span class="stringliteral">&quot;hpost_copy_%i_%i_CL_%f&quot;</span>, i, j, CredibleRegions[k])));</div>
<div class="line"><span class="lineno"> 1652</span>      }</div>
<div class="line"><span class="lineno"> 1653</span>    }</div>
<div class="line"><span class="lineno"> 1654</span>  }</div>
<div class="line"><span class="lineno"> 1655</span> </div>
<div class="line"><span class="lineno"> 1656</span><span class="preprocessor">  #ifdef MULTITHREAD</span></div>
<div class="line"><span class="lineno"> 1657</span><span class="preprocessor">  #pragma omp parallel for</span></div>
<div class="line"><span class="lineno"> 1658</span><span class="preprocessor">  #endif</span></div>
<div class="line"><span class="lineno"> 1659</span>  <span class="comment">//Calculate credible histogram</span></div>
<div class="line"><span class="lineno"> 1660</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_variable" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>; ++i)</div>
<div class="line"><span class="lineno"> 1661</span>  {</div>
<div class="line"><span class="lineno"> 1662</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt;= i; ++j)</div>
<div class="line"><span class="lineno"> 1663</span>    {</div>
<div class="line"><span class="lineno"> 1664</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; nCredible; ++k)</div>
<div class="line"><span class="lineno"> 1665</span>      {</div>
<div class="line"><span class="lineno"> 1666</span>        <span class="keywordflow">if</span>(CredibleInSigmas)</div>
<div class="line"><span class="lineno"> 1667</span>        {</div>
<div class="line"><span class="lineno"> 1668</span>          <span class="comment">//KS: Convert sigmas into percentage</span></div>
<div class="line"><span class="lineno"> 1669</span>          <span class="keywordtype">double</span> CredReg = <a class="code hl_function" href="StatisticalUtils_8h.html#a04394b98587b44b98b003bd1226606ed">GetSigmaValue</a>(<span class="keywordtype">int</span>(std::round(CredibleRegions[k])));</div>
<div class="line"><span class="lineno"> 1670</span>          <a class="code hl_function" href="StatisticalUtils_8h.html#add6570517afa2cca738b9aca56aa3883">GetCredibleRegion</a>(hpost_2D_cl[i][j][k], CredReg);</div>
<div class="line"><span class="lineno"> 1671</span>        }</div>
<div class="line"><span class="lineno"> 1672</span>        <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1673</span>        {</div>
<div class="line"><span class="lineno"> 1674</span>          <a class="code hl_function" href="StatisticalUtils_8h.html#add6570517afa2cca738b9aca56aa3883">GetCredibleRegion</a>(hpost_2D_cl[i][j][k], CredibleRegions[k]);</div>
<div class="line"><span class="lineno"> 1675</span>        }</div>
<div class="line"><span class="lineno"> 1676</span>        hpost_2D_cl[i][j][k]-&gt;SetLineColor(CredibleRegionColor[k]);</div>
<div class="line"><span class="lineno"> 1677</span>        hpost_2D_cl[i][j][k]-&gt;SetLineWidth(2);</div>
<div class="line"><span class="lineno"> 1678</span>        hpost_2D_cl[i][j][k]-&gt;SetLineStyle(CredibleRegionStyle[k]);</div>
<div class="line"><span class="lineno"> 1679</span>      }</div>
<div class="line"><span class="lineno"> 1680</span>    }</div>
<div class="line"><span class="lineno"> 1681</span>  }</div>
<div class="line"><span class="lineno"> 1682</span> </div>
<div class="line"><span class="lineno"> 1683</span>  gStyle-&gt;SetPalette(51);</div>
<div class="line"><span class="lineno"> 1684</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_variable" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>; ++i)</div>
<div class="line"><span class="lineno"> 1685</span>  {</div>
<div class="line"><span class="lineno"> 1686</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt;= i; ++j)</div>
<div class="line"><span class="lineno"> 1687</span>    {</div>
<div class="line"><span class="lineno"> 1688</span>      <span class="comment">// Skip the diagonal elements which we&#39;ve already done above</span></div>
<div class="line"><span class="lineno"> 1689</span>      <span class="keywordflow">if</span> (j == i) <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 1690</span>      <span class="keywordflow">if</span> (<a class="code hl_variable" href="classMCMCProcessor.html#a95fa49737432818bc830a44898d0d850">IamVaried</a>[j] == <span class="keyword">false</span>) <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 1691</span> </div>
<div class="line"><span class="lineno"> 1692</span>      <span class="keyword">auto</span> legend = std::make_unique&lt;TLegend&gt;(0.20, 0.7, 0.4, 0.92);</div>
<div class="line"><span class="lineno"> 1693</span>      legend-&gt;SetTextColor(kRed);</div>
<div class="line"><span class="lineno"> 1694</span>      legend-&gt;SetTextSize(0.03);</div>
<div class="line"><span class="lineno"> 1695</span>      legend-&gt;SetFillColor(0);</div>
<div class="line"><span class="lineno"> 1696</span>      legend-&gt;SetFillStyle(0);</div>
<div class="line"><span class="lineno"> 1697</span>      legend-&gt;SetLineColor(0);</div>
<div class="line"><span class="lineno"> 1698</span>      legend-&gt;SetLineStyle(0);</div>
<div class="line"><span class="lineno"> 1699</span>      legend-&gt;SetBorderSize(0);</div>
<div class="line"><span class="lineno"> 1700</span> </div>
<div class="line"><span class="lineno"> 1701</span>      <span class="comment">//Get Best point</span></div>
<div class="line"><span class="lineno"> 1702</span>      <span class="keyword">auto</span> bestfitM = std::make_unique&lt;TGraph&gt;(1);</div>
<div class="line"><span class="lineno"> 1703</span>      <span class="keyword">const</span> <span class="keywordtype">int</span> MaxBin = hpost_2D_copy[i][j]-&gt;GetMaximumBin();</div>
<div class="line"><span class="lineno"> 1704</span>      <span class="keywordtype">int</span> Mbx, Mby, Mbz;</div>
<div class="line"><span class="lineno"> 1705</span>      hpost_2D_copy[i][j]-&gt;GetBinXYZ(MaxBin, Mbx, Mby, Mbz);</div>
<div class="line"><span class="lineno"> 1706</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> Mx = hpost_2D_copy[i][j]-&gt;GetXaxis()-&gt;GetBinCenter(Mbx);</div>
<div class="line"><span class="lineno"> 1707</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> My = hpost_2D_copy[i][j]-&gt;GetYaxis()-&gt;GetBinCenter(Mby);</div>
<div class="line"><span class="lineno"> 1708</span> </div>
<div class="line"><span class="lineno"> 1709</span>      bestfitM-&gt;SetPoint(0, Mx, My);</div>
<div class="line"><span class="lineno"> 1710</span>      bestfitM-&gt;SetMarkerStyle(22);</div>
<div class="line"><span class="lineno"> 1711</span>      bestfitM-&gt;SetMarkerSize(1);</div>
<div class="line"><span class="lineno"> 1712</span>      bestfitM-&gt;SetMarkerColor(kMagenta);</div>
<div class="line"><span class="lineno"> 1713</span>      legend-&gt;AddEntry(bestfitM.get(),<span class="stringliteral">&quot;Best Fit&quot;</span>,<span class="stringliteral">&quot;p&quot;</span>);</div>
<div class="line"><span class="lineno"> 1714</span> </div>
<div class="line"><span class="lineno"> 1715</span>      <span class="comment">//Plot default 2D posterior</span></div>
<div class="line"><span class="lineno"> 1716</span>      hpost_2D_copy[i][j]-&gt;Draw(<span class="stringliteral">&quot;COLZ&quot;</span>);</div>
<div class="line"><span class="lineno"> 1717</span> </div>
<div class="line"><span class="lineno"> 1718</span>      <span class="comment">//Now credible regions</span></div>
<div class="line"><span class="lineno"> 1719</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; nCredible; ++k)</div>
<div class="line"><span class="lineno"> 1720</span>        hpost_2D_cl[i][j][k]-&gt;Draw(<span class="stringliteral">&quot;CONT3 SAME&quot;</span>);</div>
<div class="line"><span class="lineno"> 1721</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = nCredible-1; k &gt;= 0; --k)</div>
<div class="line"><span class="lineno"> 1722</span>      {</div>
<div class="line"><span class="lineno"> 1723</span>        <span class="keywordflow">if</span>(CredibleInSigmas)</div>
<div class="line"><span class="lineno"> 1724</span>          legend-&gt;AddEntry(hpost_2D_cl[i][j][k], Form(<span class="stringliteral">&quot;%.0f#sigma Credible Interval&quot;</span>, CredibleRegions[k]), <span class="stringliteral">&quot;l&quot;</span>);</div>
<div class="line"><span class="lineno"> 1725</span>        <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1726</span>          legend-&gt;AddEntry(hpost_2D_cl[i][j][k], Form(<span class="stringliteral">&quot;%.0f%% Credible Region&quot;</span>, CredibleRegions[k]*100), <span class="stringliteral">&quot;l&quot;</span>);</div>
<div class="line"><span class="lineno"> 1727</span>      }</div>
<div class="line"><span class="lineno"> 1728</span>      legend-&gt;Draw(<span class="stringliteral">&quot;SAME&quot;</span>);</div>
<div class="line"><span class="lineno"> 1729</span>      bestfitM-&gt;Draw(<span class="stringliteral">&quot;SAME.P&quot;</span>);</div>
<div class="line"><span class="lineno"> 1730</span> </div>
<div class="line"><span class="lineno"> 1731</span>      <span class="comment">// Write to file</span></div>
<div class="line"><span class="lineno"> 1732</span>      <a class="code hl_variable" href="classMCMCProcessor.html#a82e6cfef1ba6fcfc8ac8f61acb5bf931">Posterior</a>-&gt;SetName(<a class="code hl_variable" href="classMCMCProcessor.html#a0ddcfa4ba1e4dcdea366d88decc64391">hpost2D</a>[i][j]-&gt;GetName());</div>
<div class="line"><span class="lineno"> 1733</span>      <a class="code hl_variable" href="classMCMCProcessor.html#a82e6cfef1ba6fcfc8ac8f61acb5bf931">Posterior</a>-&gt;SetTitle(<a class="code hl_variable" href="classMCMCProcessor.html#a0ddcfa4ba1e4dcdea366d88decc64391">hpost2D</a>[i][j]-&gt;GetTitle());</div>
<div class="line"><span class="lineno"> 1734</span> </div>
<div class="line"><span class="lineno"> 1735</span>      <span class="comment">//KS: Print only regions with correlation greater than specified value, by defualt 0.2. This is done to avoid dumping thousands of plots</span></div>
<div class="line"><span class="lineno"> 1736</span>      <span class="keywordflow">if</span>(<a class="code hl_variable" href="classMCMCProcessor.html#ad73755714ae3d6dc951158d5513c6eee">printToPDF</a> &amp;&amp; std::fabs((*<a class="code hl_variable" href="classMCMCProcessor.html#a03f28431158777cdd81d058b6632a92f">Correlation</a>)(i,j)) &gt; <a class="code hl_variable" href="classMCMCProcessor.html#a25e4685b6299181021b02ac0e0b74681">Post2DPlotThreshold</a>) <a class="code hl_variable" href="classMCMCProcessor.html#a82e6cfef1ba6fcfc8ac8f61acb5bf931">Posterior</a>-&gt;Print(<a class="code hl_variable" href="classMCMCProcessor.html#ab5aec3dc293919701d31e6ae705601dd">CanvasName</a>);</div>
<div class="line"><span class="lineno"> 1737</span>      <span class="comment">// Write it to root file</span></div>
<div class="line"><span class="lineno"> 1738</span>      <span class="comment">//OutputFile-&gt;cd();</span></div>
<div class="line"><span class="lineno"> 1739</span>      <span class="comment">//if( std::fabs((*Correlation)(i,j)) &gt; Post2DPlotThreshold ) Posterior-&gt;Write();</span></div>
<div class="line"><span class="lineno"> 1740</span>    }</div>
<div class="line"><span class="lineno"> 1741</span>  }</div>
<div class="line"><span class="lineno"> 1742</span> </div>
<div class="line"><span class="lineno"> 1743</span>  <a class="code hl_variable" href="classMCMCProcessor.html#a62035b99df4617ab334cd1abd6ed0346">OutputFile</a>-&gt;cd();</div>
<div class="line"><span class="lineno"> 1744</span>  <span class="comment">//KS: Remove histograms</span></div>
<div class="line"><span class="lineno"> 1745</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_variable" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>; ++i)</div>
<div class="line"><span class="lineno"> 1746</span>  {</div>
<div class="line"><span class="lineno"> 1747</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt;= i; ++j)</div>
<div class="line"><span class="lineno"> 1748</span>    {</div>
<div class="line"><span class="lineno"> 1749</span>      <span class="keyword">delete</span> hpost_2D_copy[i][j];</div>
<div class="line"><span class="lineno"> 1750</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; nCredible; ++k)</div>
<div class="line"><span class="lineno"> 1751</span>      {</div>
<div class="line"><span class="lineno"> 1752</span>        <span class="keyword">delete</span> hpost_2D_cl[i][j][k];</div>
<div class="line"><span class="lineno"> 1753</span>      }</div>
<div class="line"><span class="lineno"> 1754</span>    }</div>
<div class="line"><span class="lineno"> 1755</span>  }</div>
<div class="line"><span class="lineno"> 1756</span>}</div>
<div class="ttc" id="aStatisticalUtils_8h_html_add6570517afa2cca738b9aca56aa3883"><div class="ttname"><a href="StatisticalUtils_8h.html#add6570517afa2cca738b9aca56aa3883">GetCredibleRegion</a></div><div class="ttdeci">void GetCredibleRegion(TH2D *const hist2D, const double coverage=0.6827)</div><div class="ttdoc">KS: Set 2D contour within some coverage.</div><div class="ttdef"><b>Definition:</b> <a href="StatisticalUtils_8h_source.html#l00429">StatisticalUtils.h:429</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aa5a7761e97cf2e24c7d877a5374b7333" name="aa5a7761e97cf2e24c7d877a5374b7333"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa5a7761e97cf2e24c7d877a5374b7333">&#9670;&#160;</a></span>MakeOutputFile()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void MCMCProcessor::MakeOutputFile </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>prepare output root file and canvas to which we will save EVERYTHING </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8cpp_source.html#l00205">205</a> of file <a class="el" href="MCMCProcessor_8cpp_source.html">MCMCProcessor.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  205</span>                                   {</div>
<div class="line"><span class="lineno">  206</span><span class="comment">// ***************</span></div>
<div class="line"><span class="lineno">  207</span>  <span class="comment">//KS: ROOT hates me... but we can create several instances of MCMC Processor, each with own TCanvas ROOT is mad and will delete if there is more than one canvas with the same name, so we add random number to avoid issue</span></div>
<div class="line"><span class="lineno">  208</span>  <span class="keyword">auto</span> rand = std::make_unique&lt;TRandom3&gt;(0);</div>
<div class="line"><span class="lineno">  209</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> uniform = int(rand-&gt;Uniform(0, 10000));</div>
<div class="line"><span class="lineno">  210</span>  <span class="comment">// Open a TCanvas to write the posterior onto</span></div>
<div class="line"><span class="lineno">  211</span>  <a class="code hl_variable" href="classMCMCProcessor.html#a82e6cfef1ba6fcfc8ac8f61acb5bf931">Posterior</a> = <span class="keyword">new</span> TCanvas((<span class="stringliteral">&quot;Posterior&quot;</span> + std::to_string(uniform)).c_str(), (<span class="stringliteral">&quot;Posterior&quot;</span> + std::to_string(uniform)).c_str(), 0, 0, 1024, 1024);</div>
<div class="line"><span class="lineno">  212</span>  <span class="comment">//KS: No idea why but ROOT changed treatment of violin in R6. If you have non uniform binning this will results in very hard to see violin plots.</span></div>
<div class="line"><span class="lineno">  213</span>  TCandle::SetScaledViolin(<span class="keyword">false</span>);</div>
<div class="line"><span class="lineno">  214</span> </div>
<div class="line"><span class="lineno">  215</span>  <a class="code hl_variable" href="classMCMCProcessor.html#a82e6cfef1ba6fcfc8ac8f61acb5bf931">Posterior</a>-&gt;SetGrid();</div>
<div class="line"><span class="lineno">  216</span>  gStyle-&gt;SetOptStat(0);</div>
<div class="line"><span class="lineno">  217</span>  gStyle-&gt;SetOptTitle(0);</div>
<div class="line"><span class="lineno">  218</span>  <a class="code hl_variable" href="classMCMCProcessor.html#a82e6cfef1ba6fcfc8ac8f61acb5bf931">Posterior</a>-&gt;SetTickx();</div>
<div class="line"><span class="lineno">  219</span>  <a class="code hl_variable" href="classMCMCProcessor.html#a82e6cfef1ba6fcfc8ac8f61acb5bf931">Posterior</a>-&gt;SetTicky();</div>
<div class="line"><span class="lineno">  220</span> </div>
<div class="line"><span class="lineno">  221</span>  <a class="code hl_variable" href="classMCMCProcessor.html#a82e6cfef1ba6fcfc8ac8f61acb5bf931">Posterior</a>-&gt;SetBottomMargin(0.1);</div>
<div class="line"><span class="lineno">  222</span>  <a class="code hl_variable" href="classMCMCProcessor.html#a82e6cfef1ba6fcfc8ac8f61acb5bf931">Posterior</a>-&gt;SetTopMargin(0.05);</div>
<div class="line"><span class="lineno">  223</span>  <a class="code hl_variable" href="classMCMCProcessor.html#a82e6cfef1ba6fcfc8ac8f61acb5bf931">Posterior</a>-&gt;SetRightMargin(0.03);</div>
<div class="line"><span class="lineno">  224</span>  <a class="code hl_variable" href="classMCMCProcessor.html#a82e6cfef1ba6fcfc8ac8f61acb5bf931">Posterior</a>-&gt;SetLeftMargin(0.15);</div>
<div class="line"><span class="lineno">  225</span> </div>
<div class="line"><span class="lineno">  226</span>  <span class="comment">//To avoid TCanvas::Print&gt; messages</span></div>
<div class="line"><span class="lineno">  227</span>  gErrorIgnoreLevel = kWarning;</div>
<div class="line"><span class="lineno">  228</span>  </div>
<div class="line"><span class="lineno">  229</span>  <span class="comment">// Output file to write to</span></div>
<div class="line"><span class="lineno">  230</span>  <a class="code hl_variable" href="classMCMCProcessor.html#a3d17c1720b91d6d0361da0b5dabfbbff">OutputName</a> = <a class="code hl_variable" href="classMCMCProcessor.html#a6d212d77a818304a8674a7b9b18d43b8">MCMCFile</a> + <a class="code hl_variable" href="classMCMCProcessor.html#aa34b50ce33fb2cb7d9e9ef2d9f2f67c1">OutputSuffix</a> +<span class="stringliteral">&quot;.root&quot;</span>;</div>
<div class="line"><span class="lineno">  231</span> </div>
<div class="line"><span class="lineno">  232</span>  <span class="comment">// Output file</span></div>
<div class="line"><span class="lineno">  233</span>  <a class="code hl_variable" href="classMCMCProcessor.html#a62035b99df4617ab334cd1abd6ed0346">OutputFile</a> = <span class="keyword">new</span> TFile(<a class="code hl_variable" href="classMCMCProcessor.html#a3d17c1720b91d6d0361da0b5dabfbbff">OutputName</a>.c_str(), <span class="stringliteral">&quot;recreate&quot;</span>);</div>
<div class="line"><span class="lineno">  234</span>  <a class="code hl_variable" href="classMCMCProcessor.html#a62035b99df4617ab334cd1abd6ed0346">OutputFile</a>-&gt;cd();</div>
<div class="line"><span class="lineno">  235</span>}</div>
<div class="ttc" id="aclassMCMCProcessor_html_a3d17c1720b91d6d0361da0b5dabfbbff"><div class="ttname"><a href="classMCMCProcessor.html#a3d17c1720b91d6d0361da0b5dabfbbff">MCMCProcessor::OutputName</a></div><div class="ttdeci">std::string OutputName</div><div class="ttdoc">Name of output files.</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8h_source.html#l00389">MCMCProcessor.h:389</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a8667510132aa01395520f028287f511b" name="a8667510132aa01395520f028287f511b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8667510132aa01395520f028287f511b">&#9670;&#160;</a></span>MakePostfit()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void MCMCProcessor::MakePostfit </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Make 1D projection for each parameter and prepare structure. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8cpp_source.html#l00239">239</a> of file <a class="el" href="MCMCProcessor_8cpp_source.html">MCMCProcessor.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  239</span>                                {</div>
<div class="line"><span class="lineno">  240</span><span class="comment">// ****************************</span></div>
<div class="line"><span class="lineno">  241</span> </div>
<div class="line"><span class="lineno">  242</span>  <span class="comment">// Check if we&#39;ve already made post-fit</span></div>
<div class="line"><span class="lineno">  243</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="classMCMCProcessor.html#aecc35d4ea7d2c7e020e50388ba0ffb64">MadePostfit</a> == <span class="keyword">true</span>) <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  244</span>  <a class="code hl_variable" href="classMCMCProcessor.html#aecc35d4ea7d2c7e020e50388ba0ffb64">MadePostfit</a> = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  245</span> </div>
<div class="line"><span class="lineno">  246</span>  <span class="comment">// Check if the output file is ready</span></div>
<div class="line"><span class="lineno">  247</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="classMCMCProcessor.html#a62035b99df4617ab334cd1abd6ed0346">OutputFile</a> == <span class="keyword">nullptr</span>) <a class="code hl_function" href="classMCMCProcessor.html#aa5a7761e97cf2e24c7d877a5374b7333">MakeOutputFile</a>();</div>
<div class="line"><span class="lineno">  248</span>  </div>
<div class="line"><span class="lineno">  249</span>  <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;MCMCProcessor is making post-fit plots...&quot;</span>);</div>
<div class="line"><span class="lineno">  250</span> </div>
<div class="line"><span class="lineno">  251</span>  <span class="comment">// Directory for posteriors</span></div>
<div class="line"><span class="lineno">  252</span>  TDirectory *PostDir = <a class="code hl_variable" href="classMCMCProcessor.html#a62035b99df4617ab334cd1abd6ed0346">OutputFile</a>-&gt;mkdir(<span class="stringliteral">&quot;Post&quot;</span>);</div>
<div class="line"><span class="lineno">  253</span>  TDirectory *PostHistDir = <a class="code hl_variable" href="classMCMCProcessor.html#a62035b99df4617ab334cd1abd6ed0346">OutputFile</a>-&gt;mkdir(<span class="stringliteral">&quot;Post_1d_hists&quot;</span>);</div>
<div class="line"><span class="lineno">  254</span> </div>
<div class="line"><span class="lineno">  255</span>  <span class="comment">// We fit with this Gaussian</span></div>
<div class="line"><span class="lineno">  256</span>  <a class="code hl_variable" href="classMCMCProcessor.html#a92c1d9b0ebdf90951221cdaf2ac4cc2c">Gauss</a> = <span class="keyword">new</span> TF1(<span class="stringliteral">&quot;Gauss&quot;</span>,<span class="stringliteral">&quot;[0]/sqrt(2.0*3.14159)/[2]*TMath::Exp(-0.5*pow(x-[1],2)/[2]/[2])&quot;</span>,-5,5);</div>
<div class="line"><span class="lineno">  257</span>  <a class="code hl_variable" href="classMCMCProcessor.html#a92c1d9b0ebdf90951221cdaf2ac4cc2c">Gauss</a>-&gt;SetLineWidth(2);</div>
<div class="line"><span class="lineno">  258</span>  <a class="code hl_variable" href="classMCMCProcessor.html#a92c1d9b0ebdf90951221cdaf2ac4cc2c">Gauss</a>-&gt;SetLineColor(kOrange-5);</div>
<div class="line"><span class="lineno">  259</span>  </div>
<div class="line"><span class="lineno">  260</span>  <span class="comment">// nDraw is number of draws we want to do</span></div>
<div class="line"><span class="lineno">  261</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_variable" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>; ++i)</div>
<div class="line"><span class="lineno">  262</span>  {</div>
<div class="line"><span class="lineno">  263</span>    <span class="keywordflow">if</span> (i % (<a class="code hl_variable" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>/5) == 0) {</div>
<div class="line"><span class="lineno">  264</span>      <a class="code hl_function" href="namespaceMaCh3Utils.html#a4c8bdeb1d34606aed192e9f1311a72f5">MaCh3Utils::PrintProgressBar</a>(i, <a class="code hl_variable" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>);</div>
<div class="line"><span class="lineno">  265</span>    }</div>
<div class="line"><span class="lineno">  266</span>    <a class="code hl_variable" href="classMCMCProcessor.html#a62035b99df4617ab334cd1abd6ed0346">OutputFile</a>-&gt;cd();</div>
<div class="line"><span class="lineno">  267</span>    TString Title = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><span class="lineno">  268</span>    <span class="keywordtype">double</span> Prior = 1.0;</div>
<div class="line"><span class="lineno">  269</span>    <span class="keywordtype">double</span> PriorError = 1.0;</div>
<div class="line"><span class="lineno">  270</span>    </div>
<div class="line"><span class="lineno">  271</span>    <a class="code hl_function" href="classMCMCProcessor.html#a28dfe42f1bf6fd3a145287be1e63fb0b">GetNthParameter</a>(i, Prior, PriorError, Title);</div>
<div class="line"><span class="lineno">  272</span> </div>
<div class="line"><span class="lineno">  273</span>    <span class="comment">// This holds the posterior density</span></div>
<div class="line"><span class="lineno">  274</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> maxi = <a class="code hl_variable" href="classMCMCProcessor.html#a6be3bbebd4a79fe9814a3da09b3bb820">Chain</a>-&gt;GetMaximum(<a class="code hl_variable" href="classMCMCProcessor.html#ad043b6b2c885f47ab9967831bc8d0f5a">BranchNames</a>[i]);</div>
<div class="line"><span class="lineno">  275</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> mini = <a class="code hl_variable" href="classMCMCProcessor.html#a6be3bbebd4a79fe9814a3da09b3bb820">Chain</a>-&gt;GetMinimum(<a class="code hl_variable" href="classMCMCProcessor.html#ad043b6b2c885f47ab9967831bc8d0f5a">BranchNames</a>[i]);</div>
<div class="line"><span class="lineno">  276</span>    <span class="comment">// This holds the posterior density</span></div>
<div class="line"><span class="lineno">  277</span>    <a class="code hl_variable" href="classMCMCProcessor.html#a795f661ed1ba8b8ae54c41fde5fb9496">hpost</a>[i] = <span class="keyword">new</span> TH1D(<a class="code hl_variable" href="classMCMCProcessor.html#ad043b6b2c885f47ab9967831bc8d0f5a">BranchNames</a>[i], <a class="code hl_variable" href="classMCMCProcessor.html#ad043b6b2c885f47ab9967831bc8d0f5a">BranchNames</a>[i], <a class="code hl_variable" href="classMCMCProcessor.html#a6b74f8195bcbca0979f9e9fe43468bae">nBins</a>, mini, maxi);</div>
<div class="line"><span class="lineno">  278</span>    <a class="code hl_variable" href="classMCMCProcessor.html#a795f661ed1ba8b8ae54c41fde5fb9496">hpost</a>[i]-&gt;SetMinimum(0);</div>
<div class="line"><span class="lineno">  279</span>    <a class="code hl_variable" href="classMCMCProcessor.html#a795f661ed1ba8b8ae54c41fde5fb9496">hpost</a>[i]-&gt;GetYaxis()-&gt;SetTitle(<span class="stringliteral">&quot;Steps&quot;</span>);</div>
<div class="line"><span class="lineno">  280</span>    <a class="code hl_variable" href="classMCMCProcessor.html#a795f661ed1ba8b8ae54c41fde5fb9496">hpost</a>[i]-&gt;GetYaxis()-&gt;SetNoExponent(<span class="keyword">false</span>);</div>
<div class="line"><span class="lineno">  281</span> </div>
<div class="line"><span class="lineno">  282</span>    <span class="comment">//KS: Apply additional Cuts, like mass ordering</span></div>
<div class="line"><span class="lineno">  283</span>    std::string CutPosterior1D = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><span class="lineno">  284</span>    <span class="keywordflow">if</span>(<a class="code hl_variable" href="classMCMCProcessor.html#a85917e25c4f5b5b966c50cccd9ddd6a0">Posterior1DCut</a> != <span class="stringliteral">&quot;&quot;</span>)</div>
<div class="line"><span class="lineno">  285</span>    {</div>
<div class="line"><span class="lineno">  286</span>      CutPosterior1D = <a class="code hl_variable" href="classMCMCProcessor.html#a576f0eb874afaf7e31ff5c86b9e5b8f9">StepCut</a> +<span class="stringliteral">&quot; &amp;&amp; &quot;</span> + <a class="code hl_variable" href="classMCMCProcessor.html#a85917e25c4f5b5b966c50cccd9ddd6a0">Posterior1DCut</a>;</div>
<div class="line"><span class="lineno">  287</span>    }</div>
<div class="line"><span class="lineno">  288</span>    <span class="keywordflow">else</span> CutPosterior1D = <a class="code hl_variable" href="classMCMCProcessor.html#a576f0eb874afaf7e31ff5c86b9e5b8f9">StepCut</a>;</div>
<div class="line"><span class="lineno">  289</span> </div>
<div class="line"><span class="lineno">  290</span>    <span class="comment">// Project BranchNames[i] onto hpost, applying stepcut</span></div>
<div class="line"><span class="lineno">  291</span>    <a class="code hl_variable" href="classMCMCProcessor.html#a6be3bbebd4a79fe9814a3da09b3bb820">Chain</a>-&gt;Project(<a class="code hl_variable" href="classMCMCProcessor.html#ad043b6b2c885f47ab9967831bc8d0f5a">BranchNames</a>[i], <a class="code hl_variable" href="classMCMCProcessor.html#ad043b6b2c885f47ab9967831bc8d0f5a">BranchNames</a>[i], CutPosterior1D.c_str());</div>
<div class="line"><span class="lineno">  292</span> </div>
<div class="line"><span class="lineno">  293</span>    <span class="keywordflow">if</span>(<a class="code hl_variable" href="classMCMCProcessor.html#a682c1c47626542f5820d633ba2bc010c">ApplySmoothing</a>) <a class="code hl_variable" href="classMCMCProcessor.html#a795f661ed1ba8b8ae54c41fde5fb9496">hpost</a>[i]-&gt;Smooth();</div>
<div class="line"><span class="lineno">  294</span> </div>
<div class="line"><span class="lineno">  295</span>    (*Central_Value)(i) = Prior;</div>
<div class="line"><span class="lineno">  296</span> </div>
<div class="line"><span class="lineno">  297</span>    <span class="keywordtype">double</span> <a class="code hl_variable" href="RHat_8cpp.html#ab7d224b5fffa9367046f2976bb4972d1">Mean</a>, Err, Err_p, Err_m;</div>
<div class="line"><span class="lineno">  298</span>    <a class="code hl_function" href="StatisticalUtils_8h.html#ab4dc9e4455015e55031e2cc8a076349d">GetArithmetic</a>(<a class="code hl_variable" href="classMCMCProcessor.html#a795f661ed1ba8b8ae54c41fde5fb9496">hpost</a>[i], <a class="code hl_variable" href="RHat_8cpp.html#ab7d224b5fffa9367046f2976bb4972d1">Mean</a>, Err);</div>
<div class="line"><span class="lineno">  299</span>    (*Means)(i) = <a class="code hl_variable" href="RHat_8cpp.html#ab7d224b5fffa9367046f2976bb4972d1">Mean</a>;</div>
<div class="line"><span class="lineno">  300</span>    (*Errors)(i) = Err;</div>
<div class="line"><span class="lineno">  301</span> </div>
<div class="line"><span class="lineno">  302</span>    <a class="code hl_function" href="StatisticalUtils_8h.html#a7237fc819d10a341c286a5597f584a96">GetGaussian</a>(<a class="code hl_variable" href="classMCMCProcessor.html#a795f661ed1ba8b8ae54c41fde5fb9496">hpost</a>[i], <a class="code hl_variable" href="classMCMCProcessor.html#a92c1d9b0ebdf90951221cdaf2ac4cc2c">Gauss</a>, <a class="code hl_variable" href="RHat_8cpp.html#ab7d224b5fffa9367046f2976bb4972d1">Mean</a>, Err);</div>
<div class="line"><span class="lineno">  303</span>    (*Means_Gauss)(i) = <a class="code hl_variable" href="RHat_8cpp.html#ab7d224b5fffa9367046f2976bb4972d1">Mean</a>;</div>
<div class="line"><span class="lineno">  304</span>    (*Errors_Gauss)(i) = Err;</div>
<div class="line"><span class="lineno">  305</span> </div>
<div class="line"><span class="lineno">  306</span>    <a class="code hl_function" href="StatisticalUtils_8h.html#aadbb121e8fc7db8e4e28d6b04d351460">GetHPD</a>(<a class="code hl_variable" href="classMCMCProcessor.html#a795f661ed1ba8b8ae54c41fde5fb9496">hpost</a>[i], <a class="code hl_variable" href="RHat_8cpp.html#ab7d224b5fffa9367046f2976bb4972d1">Mean</a>, Err, Err_p, Err_m);</div>
<div class="line"><span class="lineno">  307</span>    (*Means_HPD)(i) = <a class="code hl_variable" href="RHat_8cpp.html#ab7d224b5fffa9367046f2976bb4972d1">Mean</a>;</div>
<div class="line"><span class="lineno">  308</span>    (*Errors_HPD)(i) = Err;</div>
<div class="line"><span class="lineno">  309</span>    (*Errors_HPD_Positive)(i) = Err_p;</div>
<div class="line"><span class="lineno">  310</span>    (*Errors_HPD_Negative)(i) = Err_m;</div>
<div class="line"><span class="lineno">  311</span> </div>
<div class="line"><span class="lineno">  312</span>    <span class="comment">// Write the results from the projection into the TVectors and TMatrices</span></div>
<div class="line"><span class="lineno">  313</span>    (*Covariance)(i,i) = (*<a class="code hl_variable" href="classMCMCProcessor.html#a5174aaa900edf16ddc6e841ea4adae83">Errors</a>)(i)*(*<a class="code hl_variable" href="classMCMCProcessor.html#a5174aaa900edf16ddc6e841ea4adae83">Errors</a>)(i);</div>
<div class="line"><span class="lineno">  314</span>    (*Correlation)(i,i) = 1.0;</div>
<div class="line"><span class="lineno">  315</span> </div>
<div class="line"><span class="lineno">  316</span>    <span class="comment">//KS: This need to be before SetMaximum(), this way plot is nicer as line end at the maximum</span></div>
<div class="line"><span class="lineno">  317</span>    <span class="keyword">auto</span> hpd = std::make_unique&lt;TLine&gt;((*<a class="code hl_variable" href="classMCMCProcessor.html#a32657dc39a7fc0d04804f6195a3d8c3e">Means_HPD</a>)(i), <a class="code hl_variable" href="classMCMCProcessor.html#a795f661ed1ba8b8ae54c41fde5fb9496">hpost</a>[i]-&gt;GetMinimum(), (*<a class="code hl_variable" href="classMCMCProcessor.html#a32657dc39a7fc0d04804f6195a3d8c3e">Means_HPD</a>)(i), <a class="code hl_variable" href="classMCMCProcessor.html#a795f661ed1ba8b8ae54c41fde5fb9496">hpost</a>[i]-&gt;GetMaximum());</div>
<div class="line"><span class="lineno">  318</span>    hpd-&gt;SetLineColor(kBlack);</div>
<div class="line"><span class="lineno">  319</span>    hpd-&gt;SetLineWidth(2);</div>
<div class="line"><span class="lineno">  320</span>    hpd-&gt;SetLineStyle(kSolid);</div>
<div class="line"><span class="lineno">  321</span>    </div>
<div class="line"><span class="lineno">  322</span>    <a class="code hl_variable" href="classMCMCProcessor.html#a795f661ed1ba8b8ae54c41fde5fb9496">hpost</a>[i]-&gt;SetLineWidth(2);</div>
<div class="line"><span class="lineno">  323</span>    <a class="code hl_variable" href="classMCMCProcessor.html#a795f661ed1ba8b8ae54c41fde5fb9496">hpost</a>[i]-&gt;SetLineColor(kBlue-1);</div>
<div class="line"><span class="lineno">  324</span>    <a class="code hl_variable" href="classMCMCProcessor.html#a795f661ed1ba8b8ae54c41fde5fb9496">hpost</a>[i]-&gt;SetMaximum(<a class="code hl_variable" href="classMCMCProcessor.html#a795f661ed1ba8b8ae54c41fde5fb9496">hpost</a>[i]-&gt;GetMaximum()*<a class="code hl_variable" href="classMCMCProcessor.html#a4abe633b264acd9b0459c7b8ccd8b9df">DrawRange</a>);</div>
<div class="line"><span class="lineno">  325</span>    <a class="code hl_variable" href="classMCMCProcessor.html#a795f661ed1ba8b8ae54c41fde5fb9496">hpost</a>[i]-&gt;SetTitle(Title);</div>
<div class="line"><span class="lineno">  326</span>    <a class="code hl_variable" href="classMCMCProcessor.html#a795f661ed1ba8b8ae54c41fde5fb9496">hpost</a>[i]-&gt;GetXaxis()-&gt;SetTitle(<a class="code hl_variable" href="classMCMCProcessor.html#a795f661ed1ba8b8ae54c41fde5fb9496">hpost</a>[i]-&gt;GetTitle());</div>
<div class="line"><span class="lineno">  327</span>    </div>
<div class="line"><span class="lineno">  328</span>    <span class="comment">// Now make the TLine for the Asimov</span></div>
<div class="line"><span class="lineno">  329</span>    <span class="keyword">auto</span> Asimov = std::make_unique&lt;TLine&gt;(Prior, <a class="code hl_variable" href="classMCMCProcessor.html#a795f661ed1ba8b8ae54c41fde5fb9496">hpost</a>[i]-&gt;GetMinimum(), Prior, <a class="code hl_variable" href="classMCMCProcessor.html#a795f661ed1ba8b8ae54c41fde5fb9496">hpost</a>[i]-&gt;GetMaximum());</div>
<div class="line"><span class="lineno">  330</span>    Asimov-&gt;SetLineColor(kRed-3);</div>
<div class="line"><span class="lineno">  331</span>    Asimov-&gt;SetLineWidth(2);</div>
<div class="line"><span class="lineno">  332</span>    Asimov-&gt;SetLineStyle(kDashed);</div>
<div class="line"><span class="lineno">  333</span> </div>
<div class="line"><span class="lineno">  334</span>    <span class="keyword">auto</span> leg = std::make_unique&lt;TLegend&gt;(0.12, 0.6, 0.6, 0.97);</div>
<div class="line"><span class="lineno">  335</span>    leg-&gt;SetTextSize(0.04);</div>
<div class="line"><span class="lineno">  336</span>    leg-&gt;AddEntry(<a class="code hl_variable" href="classMCMCProcessor.html#a795f661ed1ba8b8ae54c41fde5fb9496">hpost</a>[i], Form(<span class="stringliteral">&quot;#splitline{PDF}{#mu = %.2f, #sigma = %.2f}&quot;</span>, <a class="code hl_variable" href="classMCMCProcessor.html#a795f661ed1ba8b8ae54c41fde5fb9496">hpost</a>[i]-&gt;GetMean(), <a class="code hl_variable" href="classMCMCProcessor.html#a795f661ed1ba8b8ae54c41fde5fb9496">hpost</a>[i]-&gt;GetRMS()), <span class="stringliteral">&quot;l&quot;</span>);</div>
<div class="line"><span class="lineno">  337</span>    leg-&gt;AddEntry(<a class="code hl_variable" href="classMCMCProcessor.html#a92c1d9b0ebdf90951221cdaf2ac4cc2c">Gauss</a>, Form(<span class="stringliteral">&quot;#splitline{Gauss}{#mu = %.2f, #sigma = %.2f}&quot;</span>, <a class="code hl_variable" href="classMCMCProcessor.html#a92c1d9b0ebdf90951221cdaf2ac4cc2c">Gauss</a>-&gt;GetParameter(1), <a class="code hl_variable" href="classMCMCProcessor.html#a92c1d9b0ebdf90951221cdaf2ac4cc2c">Gauss</a>-&gt;GetParameter(2)), <span class="stringliteral">&quot;l&quot;</span>);</div>
<div class="line"><span class="lineno">  338</span>    leg-&gt;AddEntry(hpd.get(), Form(<span class="stringliteral">&quot;#splitline{HPD}{#mu = %.2f, #sigma = %.2f (+%.2f-%.2f)}&quot;</span>, (*<a class="code hl_variable" href="classMCMCProcessor.html#a32657dc39a7fc0d04804f6195a3d8c3e">Means_HPD</a>)(i), (*<a class="code hl_variable" href="classMCMCProcessor.html#abb5c6ad85c89227bbb9bc5de2eb71272">Errors_HPD</a>)(i), (*<a class="code hl_variable" href="classMCMCProcessor.html#af96664fa8cc51c49ad1385da07a343b8">Errors_HPD_Positive</a>)(i), (*<a class="code hl_variable" href="classMCMCProcessor.html#a7b85df39f22390dac24f4d66a89518e5">Errors_HPD_Negative</a>)(i)), <span class="stringliteral">&quot;l&quot;</span>);</div>
<div class="line"><span class="lineno">  339</span>    leg-&gt;AddEntry(Asimov.get(), Form(<span class="stringliteral">&quot;#splitline{Prior}{x = %.2f , #sigma = %.2f}&quot;</span>, Prior, PriorError), <span class="stringliteral">&quot;l&quot;</span>);</div>
<div class="line"><span class="lineno">  340</span>    leg-&gt;SetLineColor(0);</div>
<div class="line"><span class="lineno">  341</span>    leg-&gt;SetLineStyle(0);</div>
<div class="line"><span class="lineno">  342</span>    leg-&gt;SetFillColor(0);</div>
<div class="line"><span class="lineno">  343</span>    leg-&gt;SetFillStyle(0);</div>
<div class="line"><span class="lineno">  344</span> </div>
<div class="line"><span class="lineno">  345</span>    <span class="comment">//CW: Don&#39;t plot if this is a fixed histogram (i.e. the peak is the whole integral)</span></div>
<div class="line"><span class="lineno">  346</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classMCMCProcessor.html#a795f661ed1ba8b8ae54c41fde5fb9496">hpost</a>[i]-&gt;GetMaximum() == <a class="code hl_variable" href="classMCMCProcessor.html#a795f661ed1ba8b8ae54c41fde5fb9496">hpost</a>[i]-&gt;Integral()*<a class="code hl_variable" href="classMCMCProcessor.html#a4abe633b264acd9b0459c7b8ccd8b9df">DrawRange</a>) </div>
<div class="line"><span class="lineno">  347</span>    {</div>
<div class="line"><span class="lineno">  348</span>      <a class="code hl_define" href="MaCh3Logger_8h.html#ad5b2eb6377721e3ac95def22c2386bb1">MACH3LOG_WARN</a>(<span class="stringliteral">&quot;Found fixed parameter, moving on&quot;</span>);</div>
<div class="line"><span class="lineno">  349</span>      <a class="code hl_variable" href="classMCMCProcessor.html#a95fa49737432818bc830a44898d0d850">IamVaried</a>[i] = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  350</span>      <span class="comment">//KS:Set mean and error to prior for fixed parameters, it looks much better when fixed parameter has mean on prior rather than on 0 with 0 error.</span></div>
<div class="line"><span class="lineno">  351</span>      (*Means_HPD)(i)  = Prior;</div>
<div class="line"><span class="lineno">  352</span>      (*Errors_HPD)(i) = PriorError;</div>
<div class="line"><span class="lineno">  353</span>      <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  354</span>    }</div>
<div class="line"><span class="lineno">  355</span> </div>
<div class="line"><span class="lineno">  356</span>    <span class="comment">// Store that this parameter is indeed being varied</span></div>
<div class="line"><span class="lineno">  357</span>    <a class="code hl_variable" href="classMCMCProcessor.html#a95fa49737432818bc830a44898d0d850">IamVaried</a>[i] = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  358</span> </div>
<div class="line"><span class="lineno">  359</span>    <span class="comment">// Write to file</span></div>
<div class="line"><span class="lineno">  360</span>    <a class="code hl_variable" href="classMCMCProcessor.html#a82e6cfef1ba6fcfc8ac8f61acb5bf931">Posterior</a>-&gt;SetName(Title);</div>
<div class="line"><span class="lineno">  361</span>    <a class="code hl_variable" href="classMCMCProcessor.html#a82e6cfef1ba6fcfc8ac8f61acb5bf931">Posterior</a>-&gt;SetTitle(Title);</div>
<div class="line"><span class="lineno">  362</span> </div>
<div class="line"><span class="lineno">  363</span>    <span class="comment">// Draw onto the TCanvas</span></div>
<div class="line"><span class="lineno">  364</span>    <a class="code hl_variable" href="classMCMCProcessor.html#a795f661ed1ba8b8ae54c41fde5fb9496">hpost</a>[i]-&gt;Draw();</div>
<div class="line"><span class="lineno">  365</span>    hpd-&gt;Draw(<span class="stringliteral">&quot;same&quot;</span>);</div>
<div class="line"><span class="lineno">  366</span>    Asimov-&gt;Draw(<span class="stringliteral">&quot;same&quot;</span>);</div>
<div class="line"><span class="lineno">  367</span>    leg-&gt;Draw(<span class="stringliteral">&quot;same&quot;</span>);  </div>
<div class="line"><span class="lineno">  368</span>    </div>
<div class="line"><span class="lineno">  369</span>    <span class="keywordflow">if</span>(<a class="code hl_variable" href="classMCMCProcessor.html#ad73755714ae3d6dc951158d5513c6eee">printToPDF</a>) <a class="code hl_variable" href="classMCMCProcessor.html#a82e6cfef1ba6fcfc8ac8f61acb5bf931">Posterior</a>-&gt;Print(<a class="code hl_variable" href="classMCMCProcessor.html#ab5aec3dc293919701d31e6ae705601dd">CanvasName</a>);</div>
<div class="line"><span class="lineno">  370</span>        </div>
<div class="line"><span class="lineno">  371</span>    <span class="comment">// cd into params directory in root file</span></div>
<div class="line"><span class="lineno">  372</span>    PostDir-&gt;cd();</div>
<div class="line"><span class="lineno">  373</span>    <a class="code hl_variable" href="classMCMCProcessor.html#a82e6cfef1ba6fcfc8ac8f61acb5bf931">Posterior</a>-&gt;Write();</div>
<div class="line"><span class="lineno">  374</span>    </div>
<div class="line"><span class="lineno">  375</span>    <a class="code hl_variable" href="classMCMCProcessor.html#a795f661ed1ba8b8ae54c41fde5fb9496">hpost</a>[i]-&gt;SetName(Title);</div>
<div class="line"><span class="lineno">  376</span>    <a class="code hl_variable" href="classMCMCProcessor.html#a795f661ed1ba8b8ae54c41fde5fb9496">hpost</a>[i]-&gt;SetTitle(Title);</div>
<div class="line"><span class="lineno">  377</span>    PostHistDir-&gt;cd();</div>
<div class="line"><span class="lineno">  378</span>    <a class="code hl_variable" href="classMCMCProcessor.html#a795f661ed1ba8b8ae54c41fde5fb9496">hpost</a>[i]-&gt;Write();</div>
<div class="line"><span class="lineno">  379</span>  } <span class="comment">// end the for loop over nDraw</span></div>
<div class="line"><span class="lineno">  380</span> </div>
<div class="line"><span class="lineno">  381</span>  <a class="code hl_variable" href="classMCMCProcessor.html#a62035b99df4617ab334cd1abd6ed0346">OutputFile</a>-&gt;cd();</div>
<div class="line"><span class="lineno">  382</span>  TTree *SettingsBranch = <span class="keyword">new</span> TTree(<span class="stringliteral">&quot;Settings&quot;</span>, <span class="stringliteral">&quot;Settings&quot;</span>);</div>
<div class="line"><span class="lineno">  383</span>  <span class="keywordtype">int</span> <a class="code hl_variable" href="GetPostfitParamPlots_8cpp.html#a5307771642312031f0050189b493a621">CrossSectionParameters</a> = <a class="code hl_variable" href="classMCMCProcessor.html#a4200e7cbe1c8f811d3640ebfd648ca85">nParam</a>[<a class="code hl_enumvalue" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20ba7386f5611ea4d01b85b9bb92a5ca335f">kXSecPar</a>];</div>
<div class="line"><span class="lineno">  384</span>  SettingsBranch-&gt;Branch(<span class="stringliteral">&quot;CrossSectionParameters&quot;</span>, &amp;<a class="code hl_variable" href="GetPostfitParamPlots_8cpp.html#a5307771642312031f0050189b493a621">CrossSectionParameters</a>);</div>
<div class="line"><span class="lineno">  385</span>  <span class="keywordtype">int</span> CrossSectionParametersStartingPos = <a class="code hl_variable" href="classMCMCProcessor.html#aeab63979ff36256072c046a15d981875">ParamTypeStartPos</a>[<a class="code hl_enumvalue" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20ba7386f5611ea4d01b85b9bb92a5ca335f">kXSecPar</a>];</div>
<div class="line"><span class="lineno">  386</span>  SettingsBranch-&gt;Branch(<span class="stringliteral">&quot;CrossSectionParametersStartingPos&quot;</span>, &amp;CrossSectionParametersStartingPos);</div>
<div class="line"><span class="lineno">  387</span>  <span class="keywordtype">int</span> <a class="code hl_variable" href="GetPostfitParamPlots_8cpp.html#adf4147e2ac31f2cb321121a90cb8c853">FluxParameters</a> = <a class="code hl_variable" href="classMCMCProcessor.html#acfc681553c5fbba89e133dfda605db3c">nFlux</a>;</div>
<div class="line"><span class="lineno">  388</span>  SettingsBranch-&gt;Branch(<span class="stringliteral">&quot;FluxParameters&quot;</span>, &amp;<a class="code hl_variable" href="GetPostfitParamPlots_8cpp.html#adf4147e2ac31f2cb321121a90cb8c853">FluxParameters</a>);</div>
<div class="line"><span class="lineno">  389</span>  </div>
<div class="line"><span class="lineno">  390</span>  <span class="keywordtype">int</span> <a class="code hl_variable" href="GetPostfitParamPlots_8cpp.html#adb4ee3a874472b4ffccc8734da66250e">NDParameters</a> = <a class="code hl_variable" href="classMCMCProcessor.html#a4200e7cbe1c8f811d3640ebfd648ca85">nParam</a>[<a class="code hl_enumvalue" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20ba4ac215e1a6cd9e776ec0a230f62a0bb4">kNDPar</a>];</div>
<div class="line"><span class="lineno">  391</span>  SettingsBranch-&gt;Branch(<span class="stringliteral">&quot;NDParameters&quot;</span>, &amp;<a class="code hl_variable" href="GetPostfitParamPlots_8cpp.html#adb4ee3a874472b4ffccc8734da66250e">NDParameters</a>);</div>
<div class="line"><span class="lineno">  392</span>  <span class="keywordtype">int</span> <a class="code hl_variable" href="GetPostfitParamPlots_8cpp.html#aa7bc6e5554391b57acf10c691b6374e0">NDParametersStartingPos</a> = <a class="code hl_variable" href="classMCMCProcessor.html#aeab63979ff36256072c046a15d981875">ParamTypeStartPos</a>[<a class="code hl_enumvalue" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20ba4ac215e1a6cd9e776ec0a230f62a0bb4">kNDPar</a>];</div>
<div class="line"><span class="lineno">  393</span>  SettingsBranch-&gt;Branch(<span class="stringliteral">&quot;NDParametersStartingPos&quot;</span>, &amp;<a class="code hl_variable" href="GetPostfitParamPlots_8cpp.html#aa7bc6e5554391b57acf10c691b6374e0">NDParametersStartingPos</a>);</div>
<div class="line"><span class="lineno">  394</span> </div>
<div class="line"><span class="lineno">  395</span>  <span class="keywordtype">int</span> <a class="code hl_variable" href="GetPostfitParamPlots_8cpp.html#a15657a5f07a9fde98fc9210b7ae80f9e">FDParameters</a> = <a class="code hl_variable" href="classMCMCProcessor.html#a4200e7cbe1c8f811d3640ebfd648ca85">nParam</a>[<a class="code hl_enumvalue" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20bad7032c60390bd4bb843950e9a7afcdae">kFDDetPar</a>];</div>
<div class="line"><span class="lineno">  396</span>  SettingsBranch-&gt;Branch(<span class="stringliteral">&quot;FDParameters&quot;</span>, &amp;<a class="code hl_variable" href="GetPostfitParamPlots_8cpp.html#a15657a5f07a9fde98fc9210b7ae80f9e">FDParameters</a>);</div>
<div class="line"><span class="lineno">  397</span>  <span class="keywordtype">int</span> <a class="code hl_variable" href="GetPostfitParamPlots_8cpp.html#a6dfe886b2ff4881ee2434479a9028985">FDParametersStartingPos</a> = <a class="code hl_variable" href="classMCMCProcessor.html#aeab63979ff36256072c046a15d981875">ParamTypeStartPos</a>[<a class="code hl_enumvalue" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20bad7032c60390bd4bb843950e9a7afcdae">kFDDetPar</a>];</div>
<div class="line"><span class="lineno">  398</span>  SettingsBranch-&gt;Branch(<span class="stringliteral">&quot;FDParametersStartingPos&quot;</span>, &amp;<a class="code hl_variable" href="GetPostfitParamPlots_8cpp.html#a6dfe886b2ff4881ee2434479a9028985">FDParametersStartingPos</a>);</div>
<div class="line"><span class="lineno">  399</span>  </div>
<div class="line"><span class="lineno">  400</span>  <span class="keywordtype">int</span> <a class="code hl_variable" href="GetPostfitParamPlots_8cpp.html#a5aedbc0849506477d31e20d345c967eb">OscParameters</a> = <a class="code hl_variable" href="classMCMCProcessor.html#a4200e7cbe1c8f811d3640ebfd648ca85">nParam</a>[<a class="code hl_enumvalue" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20ba03865cac80b3eb8f5ef46421eb8dab06">kOSCPar</a>];</div>
<div class="line"><span class="lineno">  401</span>  SettingsBranch-&gt;Branch(<span class="stringliteral">&quot;OscParameters&quot;</span>, &amp;<a class="code hl_variable" href="GetPostfitParamPlots_8cpp.html#a5aedbc0849506477d31e20d345c967eb">OscParameters</a>);</div>
<div class="line"><span class="lineno">  402</span>  <span class="keywordtype">int</span> <a class="code hl_variable" href="GetPostfitParamPlots_8cpp.html#a3ec8e00c5c17bd6768473b08156f6c1c">OscParametersStartingPos</a> = <a class="code hl_variable" href="classMCMCProcessor.html#aeab63979ff36256072c046a15d981875">ParamTypeStartPos</a>[<a class="code hl_enumvalue" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20ba03865cac80b3eb8f5ef46421eb8dab06">kOSCPar</a>];</div>
<div class="line"><span class="lineno">  403</span>  SettingsBranch-&gt;Branch(<span class="stringliteral">&quot;OscParametersStartingPos&quot;</span>, &amp;<a class="code hl_variable" href="GetPostfitParamPlots_8cpp.html#a3ec8e00c5c17bd6768473b08156f6c1c">OscParametersStartingPos</a>);</div>
<div class="line"><span class="lineno">  404</span>  </div>
<div class="line"><span class="lineno">  405</span>  SettingsBranch-&gt;Branch(<span class="stringliteral">&quot;NDSamplesBins&quot;</span>, &amp;<a class="code hl_variable" href="classMCMCProcessor.html#ae76b02ce85737d30c778698ba127933b">NDSamplesBins</a>);</div>
<div class="line"><span class="lineno">  406</span>  SettingsBranch-&gt;Branch(<span class="stringliteral">&quot;NDSamplesNames&quot;</span>, &amp;<a class="code hl_variable" href="classMCMCProcessor.html#a27c8a25155baab660fc9658861c433ab">NDSamplesNames</a>);</div>
<div class="line"><span class="lineno">  407</span> </div>
<div class="line"><span class="lineno">  408</span>  SettingsBranch-&gt;Fill();</div>
<div class="line"><span class="lineno">  409</span>  SettingsBranch-&gt;Write();</div>
<div class="line"><span class="lineno">  410</span> </div>
<div class="line"><span class="lineno">  411</span>  <span class="keyword">delete</span> SettingsBranch;</div>
<div class="line"><span class="lineno">  412</span> </div>
<div class="line"><span class="lineno">  413</span>  TDirectory *Names = <a class="code hl_variable" href="classMCMCProcessor.html#a62035b99df4617ab334cd1abd6ed0346">OutputFile</a>-&gt;mkdir(<span class="stringliteral">&quot;Names&quot;</span>);</div>
<div class="line"><span class="lineno">  414</span>  Names-&gt;cd();</div>
<div class="line"><span class="lineno">  415</span>  <span class="keywordflow">for</span> (std::vector&lt;TString&gt;::iterator it = <a class="code hl_variable" href="classMCMCProcessor.html#ad043b6b2c885f47ab9967831bc8d0f5a">BranchNames</a>.begin(); it != <a class="code hl_variable" href="classMCMCProcessor.html#ad043b6b2c885f47ab9967831bc8d0f5a">BranchNames</a>.end(); ++it) {</div>
<div class="line"><span class="lineno">  416</span>    TObjString((*it)).Write();</div>
<div class="line"><span class="lineno">  417</span>  }</div>
<div class="line"><span class="lineno">  418</span>  <a class="code hl_variable" href="classMCMCProcessor.html#a62035b99df4617ab334cd1abd6ed0346">OutputFile</a>-&gt;cd();</div>
<div class="line"><span class="lineno">  419</span>  <a class="code hl_variable" href="classMCMCProcessor.html#aad661c6d53f9f891e18ff8ccdbd08479">Central_Value</a>-&gt;Write(<span class="stringliteral">&quot;Central_Value&quot;</span>);</div>
<div class="line"><span class="lineno">  420</span>  <a class="code hl_variable" href="classMCMCProcessor.html#acaf7f239136dfa3506d095b612323d0a">Means</a>-&gt;Write(<span class="stringliteral">&quot;PDF_Means&quot;</span>);</div>
<div class="line"><span class="lineno">  421</span>  <a class="code hl_variable" href="classMCMCProcessor.html#a5174aaa900edf16ddc6e841ea4adae83">Errors</a>-&gt;Write(<span class="stringliteral">&quot;PDF_Error&quot;</span>);</div>
<div class="line"><span class="lineno">  422</span>  <a class="code hl_variable" href="classMCMCProcessor.html#a600fc8c39af2750df91fb7a0ff85ac74">Means_Gauss</a>-&gt;Write(<span class="stringliteral">&quot;Gauss_Means&quot;</span>);</div>
<div class="line"><span class="lineno">  423</span>  <a class="code hl_variable" href="classMCMCProcessor.html#aa78b7ed1bb9966f84f4eaf8cedf5e688">Errors_Gauss</a>-&gt;Write(<span class="stringliteral">&quot;Gauss_Errors&quot;</span>);</div>
<div class="line"><span class="lineno">  424</span>  <a class="code hl_variable" href="classMCMCProcessor.html#a32657dc39a7fc0d04804f6195a3d8c3e">Means_HPD</a>-&gt;Write(<span class="stringliteral">&quot;Means_HPD&quot;</span>);</div>
<div class="line"><span class="lineno">  425</span>  <a class="code hl_variable" href="classMCMCProcessor.html#abb5c6ad85c89227bbb9bc5de2eb71272">Errors_HPD</a>-&gt;Write(<span class="stringliteral">&quot;Errors_HPD&quot;</span>);</div>
<div class="line"><span class="lineno">  426</span>  <a class="code hl_variable" href="classMCMCProcessor.html#af96664fa8cc51c49ad1385da07a343b8">Errors_HPD_Positive</a>-&gt;Write(<span class="stringliteral">&quot;Errors_HPD_Positive&quot;</span>);</div>
<div class="line"><span class="lineno">  427</span>  <a class="code hl_variable" href="classMCMCProcessor.html#a7b85df39f22390dac24f4d66a89518e5">Errors_HPD_Negative</a>-&gt;Write(<span class="stringliteral">&quot;Errors_HPD_Negative&quot;</span>);</div>
<div class="line"><span class="lineno">  428</span> </div>
<div class="line"><span class="lineno">  429</span>  PostDir-&gt;Close();</div>
<div class="line"><span class="lineno">  430</span>  <span class="keyword">delete</span> PostDir;</div>
<div class="line"><span class="lineno">  431</span>  PostHistDir-&gt;Close();</div>
<div class="line"><span class="lineno">  432</span>  <span class="keyword">delete</span> PostHistDir;</div>
<div class="line"><span class="lineno">  433</span>} <span class="comment">// Have now written the postfit projections</span></div>
<div class="ttc" id="aGetPostfitParamPlots_8cpp_html_a15657a5f07a9fde98fc9210b7ae80f9e"><div class="ttname"><a href="GetPostfitParamPlots_8cpp.html#a15657a5f07a9fde98fc9210b7ae80f9e">FDParameters</a></div><div class="ttdeci">int FDParameters</div><div class="ttdef"><b>Definition:</b> <a href="GetPostfitParamPlots_8cpp_source.html#l00053">GetPostfitParamPlots.cpp:53</a></div></div>
<div class="ttc" id="aGetPostfitParamPlots_8cpp_html_a3ec8e00c5c17bd6768473b08156f6c1c"><div class="ttname"><a href="GetPostfitParamPlots_8cpp.html#a3ec8e00c5c17bd6768473b08156f6c1c">OscParametersStartingPos</a></div><div class="ttdeci">int OscParametersStartingPos</div><div class="ttdef"><b>Definition:</b> <a href="GetPostfitParamPlots_8cpp_source.html#l00057">GetPostfitParamPlots.cpp:57</a></div></div>
<div class="ttc" id="aGetPostfitParamPlots_8cpp_html_a5307771642312031f0050189b493a621"><div class="ttname"><a href="GetPostfitParamPlots_8cpp.html#a5307771642312031f0050189b493a621">CrossSectionParameters</a></div><div class="ttdeci">int CrossSectionParameters</div><div class="ttdef"><b>Definition:</b> <a href="GetPostfitParamPlots_8cpp_source.html#l00059">GetPostfitParamPlots.cpp:59</a></div></div>
<div class="ttc" id="aGetPostfitParamPlots_8cpp_html_a5aedbc0849506477d31e20d345c967eb"><div class="ttname"><a href="GetPostfitParamPlots_8cpp.html#a5aedbc0849506477d31e20d345c967eb">OscParameters</a></div><div class="ttdeci">int OscParameters</div><div class="ttdef"><b>Definition:</b> <a href="GetPostfitParamPlots_8cpp_source.html#l00056">GetPostfitParamPlots.cpp:56</a></div></div>
<div class="ttc" id="aGetPostfitParamPlots_8cpp_html_a6dfe886b2ff4881ee2434479a9028985"><div class="ttname"><a href="GetPostfitParamPlots_8cpp.html#a6dfe886b2ff4881ee2434479a9028985">FDParametersStartingPos</a></div><div class="ttdeci">int FDParametersStartingPos</div><div class="ttdef"><b>Definition:</b> <a href="GetPostfitParamPlots_8cpp_source.html#l00054">GetPostfitParamPlots.cpp:54</a></div></div>
<div class="ttc" id="aGetPostfitParamPlots_8cpp_html_aa7bc6e5554391b57acf10c691b6374e0"><div class="ttname"><a href="GetPostfitParamPlots_8cpp.html#aa7bc6e5554391b57acf10c691b6374e0">NDParametersStartingPos</a></div><div class="ttdeci">int NDParametersStartingPos</div><div class="ttdef"><b>Definition:</b> <a href="GetPostfitParamPlots_8cpp_source.html#l00051">GetPostfitParamPlots.cpp:51</a></div></div>
<div class="ttc" id="aGetPostfitParamPlots_8cpp_html_adb4ee3a874472b4ffccc8734da66250e"><div class="ttname"><a href="GetPostfitParamPlots_8cpp.html#adb4ee3a874472b4ffccc8734da66250e">NDParameters</a></div><div class="ttdeci">int NDParameters</div><div class="ttdef"><b>Definition:</b> <a href="GetPostfitParamPlots_8cpp_source.html#l00050">GetPostfitParamPlots.cpp:50</a></div></div>
<div class="ttc" id="aGetPostfitParamPlots_8cpp_html_adf4147e2ac31f2cb321121a90cb8c853"><div class="ttname"><a href="GetPostfitParamPlots_8cpp.html#adf4147e2ac31f2cb321121a90cb8c853">FluxParameters</a></div><div class="ttdeci">int FluxParameters</div><div class="ttdef"><b>Definition:</b> <a href="GetPostfitParamPlots_8cpp_source.html#l00062">GetPostfitParamPlots.cpp:62</a></div></div>
<div class="ttc" id="aRHat_8cpp_html_ab7d224b5fffa9367046f2976bb4972d1"><div class="ttname"><a href="RHat_8cpp.html#ab7d224b5fffa9367046f2976bb4972d1">Mean</a></div><div class="ttdeci">double ** Mean</div><div class="ttdef"><b>Definition:</b> <a href="RHat_8cpp_source.html#l00059">RHat.cpp:59</a></div></div>
<div class="ttc" id="aStatisticalUtils_8h_html_a7237fc819d10a341c286a5597f584a96"><div class="ttname"><a href="StatisticalUtils_8h.html#a7237fc819d10a341c286a5597f584a96">GetGaussian</a></div><div class="ttdeci">void GetGaussian(TH1D *&amp;hist, TF1 *gauss, double &amp;Mean, double &amp;Error)</div><div class="ttdoc">CW: Fit Gaussian to posterior.</div><div class="ttdef"><b>Definition:</b> <a href="StatisticalUtils_8h_source.html#l00257">StatisticalUtils.h:257</a></div></div>
<div class="ttc" id="aStatisticalUtils_8h_html_aadbb121e8fc7db8e4e28d6b04d351460"><div class="ttname"><a href="StatisticalUtils_8h.html#aadbb121e8fc7db8e4e28d6b04d351460">GetHPD</a></div><div class="ttdeci">void GetHPD(TH1D *const hist, double &amp;Mean, double &amp;Error, double &amp;Error_p, double &amp;Error_m, const double coverage=0.6827)</div><div class="ttdoc">Get Highest Posterior Density (HPD)</div><div class="ttdef"><b>Definition:</b> <a href="StatisticalUtils_8h_source.html#l00284">StatisticalUtils.h:284</a></div></div>
<div class="ttc" id="aStatisticalUtils_8h_html_ab4dc9e4455015e55031e2cc8a076349d"><div class="ttname"><a href="StatisticalUtils_8h.html#ab4dc9e4455015e55031e2cc8a076349d">GetArithmetic</a></div><div class="ttdeci">void GetArithmetic(TH1D *const hist, double &amp;Mean, double &amp;Error)</div><div class="ttdoc">CW: Get Arithmetic mean from posterior.</div><div class="ttdef"><b>Definition:</b> <a href="StatisticalUtils_8h_source.html#l00245">StatisticalUtils.h:245</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a03267ff95cb0f4dab0882db852893768" name="a03267ff95cb0f4dab0882db852893768"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a03267ff95cb0f4dab0882db852893768">&#9670;&#160;</a></span>MakePrefit()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">TH1D * MCMCProcessor::MakePrefit </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Prepare prefit histogram for parameter overlay plot. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8cpp_source.html#l02319">2319</a> of file <a class="el" href="MCMCProcessor_8cpp_source.html">MCMCProcessor.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2319</span>                                {</div>
<div class="line"><span class="lineno"> 2320</span><span class="comment">// *****************************</span></div>
<div class="line"><span class="lineno"> 2321</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="classMCMCProcessor.html#a62035b99df4617ab334cd1abd6ed0346">OutputFile</a> == <span class="keyword">nullptr</span>) <a class="code hl_function" href="classMCMCProcessor.html#aa5a7761e97cf2e24c7d877a5374b7333">MakeOutputFile</a>();</div>
<div class="line"><span class="lineno"> 2322</span> </div>
<div class="line"><span class="lineno"> 2323</span>  TH1D *PreFitPlot = <span class="keyword">new</span> TH1D(<span class="stringliteral">&quot;Prefit&quot;</span>, <span class="stringliteral">&quot;Prefit&quot;</span>, <a class="code hl_variable" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>, 0, <a class="code hl_variable" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>);</div>
<div class="line"><span class="lineno"> 2324</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; PreFitPlot-&gt;GetNbinsX() + 1; ++i) {</div>
<div class="line"><span class="lineno"> 2325</span>    PreFitPlot-&gt;SetBinContent(i+1, 0);</div>
<div class="line"><span class="lineno"> 2326</span>    PreFitPlot-&gt;SetBinError(i+1, 0);</div>
<div class="line"><span class="lineno"> 2327</span>  }</div>
<div class="line"><span class="lineno"> 2328</span> </div>
<div class="line"><span class="lineno"> 2329</span>  <span class="comment">//KS: Slightly hacky way to get relative to prior or nominal as this is convention we use,</span></div>
<div class="line"><span class="lineno"> 2330</span>  <span class="comment">//Only applies for xsec, for other systematic it make no difference</span></div>
<div class="line"><span class="lineno"> 2331</span>  <span class="keywordtype">double</span> CentralValueTemp, Central, Error;</div>
<div class="line"><span class="lineno"> 2332</span> </div>
<div class="line"><span class="lineno"> 2333</span>  <span class="comment">// Set labels and data</span></div>
<div class="line"><span class="lineno"> 2334</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_variable" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>; ++i)</div>
<div class="line"><span class="lineno"> 2335</span>  {</div>
<div class="line"><span class="lineno"> 2336</span>    <span class="comment">//Those keep which parameter type we run currently and relative number</span></div>
<div class="line"><span class="lineno"> 2337</span>    <span class="keywordtype">int</span> ParamEnum = <a class="code hl_variable" href="classMCMCProcessor.html#aaa903949bde8f1a69800c71fe1eb538e">ParamType</a>[i];</div>
<div class="line"><span class="lineno"> 2338</span>    <span class="keywordtype">int</span> ParamNo = i - <a class="code hl_variable" href="classMCMCProcessor.html#aeab63979ff36256072c046a15d981875">ParamTypeStartPos</a>[<a class="code hl_enumeration" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20b">ParameterEnum</a>(ParamEnum)];</div>
<div class="line"><span class="lineno"> 2339</span>    CentralValueTemp = <a class="code hl_variable" href="classMCMCProcessor.html#a3a6614826ae320e462211e38e96d9d02">ParamCentral</a>[ParamEnum][ParamNo];</div>
<div class="line"><span class="lineno"> 2340</span>    <span class="keywordflow">if</span>(<a class="code hl_variable" href="classMCMCProcessor.html#afbac2a114c15ca7db4abe71dd549504c">plotRelativeToPrior</a>) </div>
<div class="line"><span class="lineno"> 2341</span>    {</div>
<div class="line"><span class="lineno"> 2342</span>      <span class="comment">// Normalise the prior relative the nominal/prior, just the way we get our fit results in MaCh3</span></div>
<div class="line"><span class="lineno"> 2343</span>      <span class="keywordflow">if</span> ( CentralValueTemp != 0)</div>
<div class="line"><span class="lineno"> 2344</span>      {</div>
<div class="line"><span class="lineno"> 2345</span>        Central = <a class="code hl_variable" href="classMCMCProcessor.html#a3a6614826ae320e462211e38e96d9d02">ParamCentral</a>[ParamEnum][ParamNo] / CentralValueTemp;</div>
<div class="line"><span class="lineno"> 2346</span>        Error = <a class="code hl_variable" href="classMCMCProcessor.html#a3a97e3cb4be3ceb9eb721eac51d82d60">ParamErrors</a>[ParamEnum][ParamNo]/CentralValueTemp;</div>
<div class="line"><span class="lineno"> 2347</span>      } <span class="keywordflow">else</span> </div>
<div class="line"><span class="lineno"> 2348</span>      {</div>
<div class="line"><span class="lineno"> 2349</span>        Central = CentralValueTemp + 1.0;</div>
<div class="line"><span class="lineno"> 2350</span>        Error = <a class="code hl_variable" href="classMCMCProcessor.html#a3a97e3cb4be3ceb9eb721eac51d82d60">ParamErrors</a>[ParamEnum][ParamNo];</div>
<div class="line"><span class="lineno"> 2351</span>      }</div>
<div class="line"><span class="lineno"> 2352</span>    }</div>
<div class="line"><span class="lineno"> 2353</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 2354</span>    {</div>
<div class="line"><span class="lineno"> 2355</span>      Central = CentralValueTemp;</div>
<div class="line"><span class="lineno"> 2356</span>      Error = <a class="code hl_variable" href="classMCMCProcessor.html#a3a97e3cb4be3ceb9eb721eac51d82d60">ParamErrors</a>[ParamEnum][ParamNo];</div>
<div class="line"><span class="lineno"> 2357</span>    }</div>
<div class="line"><span class="lineno"> 2358</span>    <span class="comment">//KS: If plotting error for param with flat prior is turned off and given param really has flat prior set error to 0</span></div>
<div class="line"><span class="lineno"> 2359</span>    <span class="keywordflow">if</span>(!<a class="code hl_variable" href="classMCMCProcessor.html#ad24411a2556504c440ff0af045e8e7aa">PlotFlatPrior</a> &amp;&amp; <a class="code hl_variable" href="classMCMCProcessor.html#a4be1eedb743e4ea410009a4fa45720f7">ParamFlat</a>[ParamEnum][ParamNo])</div>
<div class="line"><span class="lineno"> 2360</span>    {</div>
<div class="line"><span class="lineno"> 2361</span>      Error = 0.;</div>
<div class="line"><span class="lineno"> 2362</span>    }</div>
<div class="line"><span class="lineno"> 2363</span> </div>
<div class="line"><span class="lineno"> 2364</span>    PreFitPlot-&gt;SetBinContent(i+1, Central);</div>
<div class="line"><span class="lineno"> 2365</span>    PreFitPlot-&gt;SetBinError(i+1, Error);</div>
<div class="line"><span class="lineno"> 2366</span>    PreFitPlot-&gt;GetXaxis()-&gt;SetBinLabel(i+1, <a class="code hl_variable" href="classMCMCProcessor.html#adecc55689f7d37b9412f8886fe3480dc">ParamNames</a>[ParamEnum][ParamNo]);</div>
<div class="line"><span class="lineno"> 2367</span>  }</div>
<div class="line"><span class="lineno"> 2368</span>  PreFitPlot-&gt;SetDirectory(<span class="keyword">nullptr</span>);</div>
<div class="line"><span class="lineno"> 2369</span> </div>
<div class="line"><span class="lineno"> 2370</span>  PreFitPlot-&gt;SetFillStyle(1001);</div>
<div class="line"><span class="lineno"> 2371</span>  PreFitPlot-&gt;SetFillColor(kRed-3);</div>
<div class="line"><span class="lineno"> 2372</span>  PreFitPlot-&gt;SetMarkerStyle(21);</div>
<div class="line"><span class="lineno"> 2373</span>  PreFitPlot-&gt;SetMarkerSize(2.4);</div>
<div class="line"><span class="lineno"> 2374</span>  PreFitPlot-&gt;SetMarkerColor(kWhite);</div>
<div class="line"><span class="lineno"> 2375</span>  PreFitPlot-&gt;SetLineColor(PreFitPlot-&gt;GetFillColor());</div>
<div class="line"><span class="lineno"> 2376</span>  PreFitPlot-&gt;GetXaxis()-&gt;LabelsOption(<span class="stringliteral">&quot;v&quot;</span>);</div>
<div class="line"><span class="lineno"> 2377</span> </div>
<div class="line"><span class="lineno"> 2378</span>  <span class="keywordflow">return</span> PreFitPlot;</div>
<div class="line"><span class="lineno"> 2379</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="afac304b884238cc3624f5471b43f1a7e" name="afac304b884238cc3624f5471b43f1a7e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afac304b884238cc3624f5471b43f1a7e">&#9670;&#160;</a></span>MakeSubOptimality()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void MCMCProcessor::MakeSubOptimality </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>NIntervals</em> = <code>10</code></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Make and Draw SubOptimality <a class="el" href="citelist.html#CITEREF_roberts2009adaptive">[15]</a>. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8cpp_source.html#l01311">1311</a> of file <a class="el" href="MCMCProcessor_8cpp_source.html">MCMCProcessor.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1311</span>                                                          {</div>
<div class="line"><span class="lineno"> 1312</span><span class="comment">// *********************</span></div>
<div class="line"><span class="lineno"> 1313</span> </div>
<div class="line"><span class="lineno"> 1314</span>  <span class="comment">//Save burn in cut, at the end of the loop we will return to default values</span></div>
<div class="line"><span class="lineno"> 1315</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> DefaultUpperCut = <a class="code hl_variable" href="classMCMCProcessor.html#a840c686f15f419c0156df01c4ed62931">UpperCut</a>;</div>
<div class="line"><span class="lineno"> 1316</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> DefaultBurnInCut = <a class="code hl_variable" href="classMCMCProcessor.html#a22f82dadceccbe87dd8c5b7daa8432e8">BurnInCut</a>;</div>
<div class="line"><span class="lineno"> 1317</span>  <span class="keywordtype">bool</span> defaultPrintToPDF = <a class="code hl_variable" href="classMCMCProcessor.html#ad73755714ae3d6dc951158d5513c6eee">printToPDF</a>;</div>
<div class="line"><span class="lineno"> 1318</span>  <a class="code hl_variable" href="classMCMCProcessor.html#a22f82dadceccbe87dd8c5b7daa8432e8">BurnInCut</a> = 0;</div>
<div class="line"><span class="lineno"> 1319</span>  <a class="code hl_variable" href="classMCMCProcessor.html#a840c686f15f419c0156df01c4ed62931">UpperCut</a> = 0;</div>
<div class="line"><span class="lineno"> 1320</span>  <a class="code hl_variable" href="classMCMCProcessor.html#ad73755714ae3d6dc951158d5513c6eee">printToPDF</a> = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1321</span> </div>
<div class="line"><span class="lineno"> 1322</span>  <span class="comment">//Set via config in future</span></div>
<div class="line"><span class="lineno"> 1323</span>  <span class="keywordtype">int</span> MaxStep = <a class="code hl_variable" href="classMCMCProcessor.html#aae0016a4e1d105d5d65243438c622a97">nSteps</a>;</div>
<div class="line"><span class="lineno"> 1324</span>  <span class="keywordtype">int</span> MinStep = 0;</div>
<div class="line"><span class="lineno"> 1325</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> IntervalsSize = <a class="code hl_variable" href="classMCMCProcessor.html#aae0016a4e1d105d5d65243438c622a97">nSteps</a>/NIntervals;</div>
<div class="line"><span class="lineno"> 1326</span> </div>
<div class="line"><span class="lineno"> 1327</span>  <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Making Suboptimality&quot;</span>);</div>
<div class="line"><span class="lineno"> 1328</span>  TStopwatch clock;</div>
<div class="line"><span class="lineno"> 1329</span>  clock.Start();</div>
<div class="line"><span class="lineno"> 1330</span> </div>
<div class="line"><span class="lineno"> 1331</span>  std::unique_ptr&lt;TH1D&gt; SubOptimality = std::make_unique&lt;TH1D&gt;(<span class="stringliteral">&quot;Suboptimality&quot;</span>, <span class="stringliteral">&quot;Suboptimality&quot;</span>, NIntervals, MinStep, MaxStep);</div>
<div class="line"><span class="lineno"> 1332</span>  SubOptimality-&gt;GetXaxis()-&gt;SetTitle(<span class="stringliteral">&quot;Step&quot;</span>);</div>
<div class="line"><span class="lineno"> 1333</span>  SubOptimality-&gt;GetYaxis()-&gt;SetTitle(<span class="stringliteral">&quot;Suboptimality&quot;</span>);</div>
<div class="line"><span class="lineno"> 1334</span>  SubOptimality-&gt;SetLineWidth(2);</div>
<div class="line"><span class="lineno"> 1335</span>  SubOptimality-&gt;SetLineColor(kBlue);</div>
<div class="line"><span class="lineno"> 1336</span> </div>
<div class="line"><span class="lineno"> 1337</span>  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; NIntervals; ++i)</div>
<div class="line"><span class="lineno"> 1338</span>  {</div>
<div class="line"><span class="lineno"> 1339</span>    <span class="comment">//Reset our cov matrix</span></div>
<div class="line"><span class="lineno"> 1340</span>    <a class="code hl_function" href="classMCMCProcessor.html#a36441ec3d5b0e24e48040282ffcda3eb">ResetHistograms</a>();</div>
<div class="line"><span class="lineno"> 1341</span> </div>
<div class="line"><span class="lineno"> 1342</span>    <span class="comment">//Set threshold for calculating new matrix</span></div>
<div class="line"><span class="lineno"> 1343</span>    <a class="code hl_variable" href="classMCMCProcessor.html#a840c686f15f419c0156df01c4ed62931">UpperCut</a> = i*IntervalsSize;</div>
<div class="line"><span class="lineno"> 1344</span>    <span class="comment">//Calculate cov matrix</span></div>
<div class="line"><span class="lineno"> 1345</span>    <a class="code hl_function" href="classMCMCProcessor.html#ab367cb5f56606338bb1fce780f2414e8">MakeCovariance_MP</a>(<span class="keyword">true</span>);</div>
<div class="line"><span class="lineno"> 1346</span> </div>
<div class="line"><span class="lineno"> 1347</span>    <span class="comment">//Calculate eigen values</span></div>
<div class="line"><span class="lineno"> 1348</span>    TMatrixDSymEigen eigen(*<a class="code hl_variable" href="classMCMCProcessor.html#af9a40632e2d7f1266d69a74d5b5f2244">Covariance</a>);</div>
<div class="line"><span class="lineno"> 1349</span>    TVectorD eigen_values;</div>
<div class="line"><span class="lineno"> 1350</span>    eigen_values.ResizeTo(eigen.GetEigenValues());</div>
<div class="line"><span class="lineno"> 1351</span>    eigen_values = eigen.GetEigenValues();</div>
<div class="line"><span class="lineno"> 1352</span> </div>
<div class="line"><span class="lineno"> 1353</span>    <span class="comment">//KS: Converting from ROOT to vector as to make using other libraires (Eigen) easier in future</span></div>
<div class="line"><span class="lineno"> 1354</span>    std::vector&lt;double&gt; EigenValues(eigen_values.GetNrows());</div>
<div class="line"><span class="lineno"> 1355</span>    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j = 0; j &lt; EigenValues.size(); j++)</div>
<div class="line"><span class="lineno"> 1356</span>    {</div>
<div class="line"><span class="lineno"> 1357</span>      EigenValues[j] = eigen_values(j);</div>
<div class="line"><span class="lineno"> 1358</span>    }</div>
<div class="line"><span class="lineno"> 1359</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> SubOptimalityValue = <a class="code hl_function" href="StatisticalUtils_8h.html#a34d5232bfb12e29ec9d63acaa8744b58">GetSubOptimality</a>(EigenValues, <a class="code hl_variable" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>);</div>
<div class="line"><span class="lineno"> 1360</span>    SubOptimality-&gt;SetBinContent(i+1, SubOptimalityValue);</div>
<div class="line"><span class="lineno"> 1361</span>  }</div>
<div class="line"><span class="lineno"> 1362</span>  clock.Stop();</div>
<div class="line"><span class="lineno"> 1363</span>  <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Making Suboptimality took {:.2f}s to finish for {} steps&quot;</span>, clock.RealTime(), <a class="code hl_variable" href="classMCMCProcessor.html#af3a19b885e9c34e1674aea8cfbe14e1c">nEntries</a>);</div>
<div class="line"><span class="lineno"> 1364</span> </div>
<div class="line"><span class="lineno"> 1365</span>  <a class="code hl_variable" href="classMCMCProcessor.html#a840c686f15f419c0156df01c4ed62931">UpperCut</a> = DefaultUpperCut;</div>
<div class="line"><span class="lineno"> 1366</span>  <a class="code hl_variable" href="classMCMCProcessor.html#a22f82dadceccbe87dd8c5b7daa8432e8">BurnInCut</a> = DefaultBurnInCut;</div>
<div class="line"><span class="lineno"> 1367</span>  <a class="code hl_variable" href="classMCMCProcessor.html#ad73755714ae3d6dc951158d5513c6eee">printToPDF</a> = defaultPrintToPDF;</div>
<div class="line"><span class="lineno"> 1368</span> </div>
<div class="line"><span class="lineno"> 1369</span>  SubOptimality-&gt;Draw(<span class="stringliteral">&quot;l&quot;</span>);</div>
<div class="line"><span class="lineno"> 1370</span>  <a class="code hl_variable" href="classMCMCProcessor.html#a82e6cfef1ba6fcfc8ac8f61acb5bf931">Posterior</a>-&gt;SetName(SubOptimality-&gt;GetName());</div>
<div class="line"><span class="lineno"> 1371</span>  <a class="code hl_variable" href="classMCMCProcessor.html#a82e6cfef1ba6fcfc8ac8f61acb5bf931">Posterior</a>-&gt;SetTitle(SubOptimality-&gt;GetTitle());</div>
<div class="line"><span class="lineno"> 1372</span> </div>
<div class="line"><span class="lineno"> 1373</span>  <span class="keywordflow">if</span>(<a class="code hl_variable" href="classMCMCProcessor.html#ad73755714ae3d6dc951158d5513c6eee">printToPDF</a>) <a class="code hl_variable" href="classMCMCProcessor.html#a82e6cfef1ba6fcfc8ac8f61acb5bf931">Posterior</a>-&gt;Print(<a class="code hl_variable" href="classMCMCProcessor.html#ab5aec3dc293919701d31e6ae705601dd">CanvasName</a>);</div>
<div class="line"><span class="lineno"> 1374</span>  <span class="comment">// Write it to root file</span></div>
<div class="line"><span class="lineno"> 1375</span>  <a class="code hl_variable" href="classMCMCProcessor.html#a62035b99df4617ab334cd1abd6ed0346">OutputFile</a>-&gt;cd();</div>
<div class="line"><span class="lineno"> 1376</span>  <a class="code hl_variable" href="classMCMCProcessor.html#a82e6cfef1ba6fcfc8ac8f61acb5bf931">Posterior</a>-&gt;Write();</div>
<div class="line"><span class="lineno"> 1377</span>}</div>
<div class="ttc" id="aStatisticalUtils_8h_html_a34d5232bfb12e29ec9d63acaa8744b58"><div class="ttname"><a href="StatisticalUtils_8h.html#a34d5232bfb12e29ec9d63acaa8744b58">GetSubOptimality</a></div><div class="ttdeci">double GetSubOptimality(const std::vector&lt; double &gt; &amp;EigenValues, const int TotalTarameters)</div><div class="ttdoc">Based on .</div><div class="ttdef"><b>Definition:</b> <a href="StatisticalUtils_8h_source.html#l00224">StatisticalUtils.h:224</a></div></div>
<div class="ttc" id="aclassMCMCProcessor_html_a36441ec3d5b0e24e48040282ffcda3eb"><div class="ttname"><a href="classMCMCProcessor.html#a36441ec3d5b0e24e48040282ffcda3eb">MCMCProcessor::ResetHistograms</a></div><div class="ttdeci">void ResetHistograms()</div><div class="ttdoc">Reset 2D posteriors, in case we would like to calculate in again with different BurnInCut.</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8cpp_source.html#l02730">MCMCProcessor.cpp:2730</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a3ae80722efa0c94eec066ee91f3cf997" name="a3ae80722efa0c94eec066ee91f3cf997"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3ae80722efa0c94eec066ee91f3cf997">&#9670;&#160;</a></span>MakeTrianglePlot()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void MCMCProcessor::MakeTrianglePlot </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; std::string &gt; &amp;&#160;</td>
          <td class="paramname"><em>ParNames</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>CredibleIntervals</em> = <code>{0.99,&#160;0.90,&#160;0.68&#160;}</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; Color_t &gt; &amp;&#160;</td>
          <td class="paramname"><em>CredibleIntervalsColours</em> = <code>{kCyan+4,&#160;kCyan-2,&#160;kCyan-10}</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>CredibleRegions</em> = <code>{0.99,&#160;0.90,&#160;0.68}</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; Style_t &gt; &amp;&#160;</td>
          <td class="paramname"><em>CredibleRegionStyle</em> = <code>{kDashed,&#160;kSolid,&#160;kDotted}</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; Color_t &gt; &amp;&#160;</td>
          <td class="paramname"><em>CredibleRegionColor</em> = <code>{kGreen-3,&#160;kGreen-10,&#160;kGreen}</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const bool&#160;</td>
          <td class="paramname"><em>CredibleInSigmas</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Make fancy triangle plot for selected parameters. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">CredibleIntervals</td><td>Vector with values of credible intervals, must be in descending order </td></tr>
    <tr><td class="paramname">CredibleIntervalsColours</td><td>Color_t telling what colour to use for each Interval line </td></tr>
    <tr><td class="paramname">CredibleInSigmas</td><td>Bool telling whether intervals are in percentage or in sigmas, then special conversions is used </td></tr>
    <tr><td class="paramname">CredibleRegions</td><td>Vector with values of credible intervals, must be in descending order </td></tr>
    <tr><td class="paramname">CredibleRegionStyle</td><td>Style_t telling what line style to use for each Interval line </td></tr>
    <tr><td class="paramname">CredibleRegionColor</td><td>Color_t telling what colour to use for each Interval line </td></tr>
    <tr><td class="paramname">CredibleInSigmas</td><td>Bool telling whether intervals are in percentage or in sigmas, then special conversions is used </td></tr>
  </table>
  </dd>
</dl>
<p>Scale the histograms so it shows the posterior probability</p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8cpp_source.html#l01760">1760</a> of file <a class="el" href="MCMCProcessor_8cpp_source.html">MCMCProcessor.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1769</span>                                                                  {</div>
<div class="line"><span class="lineno"> 1770</span><span class="comment">// *********************</span></div>
<div class="line"><span class="lineno"> 1771</span> </div>
<div class="line"><span class="lineno"> 1772</span>  <span class="keywordflow">if</span>(<a class="code hl_variable" href="classMCMCProcessor.html#a0ddcfa4ba1e4dcdea366d88decc64391">hpost2D</a> == <span class="keyword">nullptr</span>) <a class="code hl_function" href="classMCMCProcessor.html#ab367cb5f56606338bb1fce780f2414e8">MakeCovariance_MP</a>();</div>
<div class="line"><span class="lineno"> 1773</span>  <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Making Triangle Plot&quot;</span>);</div>
<div class="line"><span class="lineno"> 1774</span> </div>
<div class="line"><span class="lineno"> 1775</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> nParamPlot = int(ParNames.size());</div>
<div class="line"><span class="lineno"> 1776</span>  std::vector&lt;int&gt; ParamNumber;</div>
<div class="line"><span class="lineno"> 1777</span>  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j = 0; j &lt; nParamPlot; ++j)</div>
<div class="line"><span class="lineno"> 1778</span>  {</div>
<div class="line"><span class="lineno"> 1779</span>    <span class="comment">//KS: First we need to find parameter number based on name</span></div>
<div class="line"><span class="lineno"> 1780</span>    <span class="keywordtype">int</span> ParamNo = <a class="code hl_define" href="MCMCProcessor_8h.html#a82a6d79039474bc403b627437a7b97ec">_UNDEF_</a>;</div>
<div class="line"><span class="lineno"> 1781</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_variable" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>; ++i)</div>
<div class="line"><span class="lineno"> 1782</span>    {</div>
<div class="line"><span class="lineno"> 1783</span>      TString Title = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><span class="lineno"> 1784</span>      <span class="keywordtype">double</span> Prior = 1.0;</div>
<div class="line"><span class="lineno"> 1785</span>      <span class="keywordtype">double</span> PriorError = 1.0;</div>
<div class="line"><span class="lineno"> 1786</span> </div>
<div class="line"><span class="lineno"> 1787</span>      <a class="code hl_function" href="classMCMCProcessor.html#a28dfe42f1bf6fd3a145287be1e63fb0b">GetNthParameter</a>(i, Prior, PriorError, Title);</div>
<div class="line"><span class="lineno"> 1788</span> </div>
<div class="line"><span class="lineno"> 1789</span>      <span class="keywordflow">if</span>(ParNames[j] == Title) ParamNo = i;</div>
<div class="line"><span class="lineno"> 1790</span>    }</div>
<div class="line"><span class="lineno"> 1791</span>    <span class="keywordflow">if</span>(ParamNo == <a class="code hl_define" href="MCMCProcessor_8h.html#a82a6d79039474bc403b627437a7b97ec">_UNDEF_</a>)</div>
<div class="line"><span class="lineno"> 1792</span>    {</div>
<div class="line"><span class="lineno"> 1793</span>      <a class="code hl_define" href="MaCh3Logger_8h.html#ad5b2eb6377721e3ac95def22c2386bb1">MACH3LOG_WARN</a>(<span class="stringliteral">&quot;Couldn&#39;t find param {}. Will not plot Triangle plot&quot;</span>, ParNames[j]);</div>
<div class="line"><span class="lineno"> 1794</span>      <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno"> 1795</span>    }</div>
<div class="line"><span class="lineno"> 1796</span>    ParamNumber.push_back(ParamNo);</div>
<div class="line"><span class="lineno"> 1797</span>  }</div>
<div class="line"><span class="lineno"> 1798</span> </div>
<div class="line"><span class="lineno"> 1799</span>  <span class="comment">//KS: Store it as we go back to them at the end</span></div>
<div class="line"><span class="lineno"> 1800</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> TopMargin    = <a class="code hl_variable" href="classMCMCProcessor.html#a82e6cfef1ba6fcfc8ac8f61acb5bf931">Posterior</a>-&gt;GetTopMargin();</div>
<div class="line"><span class="lineno"> 1801</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> BottomMargin = <a class="code hl_variable" href="classMCMCProcessor.html#a82e6cfef1ba6fcfc8ac8f61acb5bf931">Posterior</a>-&gt;GetBottomMargin();</div>
<div class="line"><span class="lineno"> 1802</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> LeftMargin   = <a class="code hl_variable" href="classMCMCProcessor.html#a82e6cfef1ba6fcfc8ac8f61acb5bf931">Posterior</a>-&gt;GetLeftMargin();</div>
<div class="line"><span class="lineno"> 1803</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> RighMargin   = <a class="code hl_variable" href="classMCMCProcessor.html#a82e6cfef1ba6fcfc8ac8f61acb5bf931">Posterior</a>-&gt;GetRightMargin();</div>
<div class="line"><span class="lineno"> 1804</span>  <a class="code hl_variable" href="classMCMCProcessor.html#a82e6cfef1ba6fcfc8ac8f61acb5bf931">Posterior</a>-&gt;SetTopMargin(0.001);</div>
<div class="line"><span class="lineno"> 1805</span>  <a class="code hl_variable" href="classMCMCProcessor.html#a82e6cfef1ba6fcfc8ac8f61acb5bf931">Posterior</a>-&gt;SetBottomMargin(0.001);</div>
<div class="line"><span class="lineno"> 1806</span>  <a class="code hl_variable" href="classMCMCProcessor.html#a82e6cfef1ba6fcfc8ac8f61acb5bf931">Posterior</a>-&gt;SetLeftMargin(0.001);</div>
<div class="line"><span class="lineno"> 1807</span>  <a class="code hl_variable" href="classMCMCProcessor.html#a82e6cfef1ba6fcfc8ac8f61acb5bf931">Posterior</a>-&gt;SetRightMargin(0.001);</div>
<div class="line"><span class="lineno"> 1808</span> </div>
<div class="line"><span class="lineno"> 1809</span>  <a class="code hl_variable" href="classMCMCProcessor.html#a82e6cfef1ba6fcfc8ac8f61acb5bf931">Posterior</a>-&gt;cd();</div>
<div class="line"><span class="lineno"> 1810</span>  <a class="code hl_variable" href="classMCMCProcessor.html#a82e6cfef1ba6fcfc8ac8f61acb5bf931">Posterior</a>-&gt;Clear();</div>
<div class="line"><span class="lineno"> 1811</span>  <a class="code hl_variable" href="classMCMCProcessor.html#a82e6cfef1ba6fcfc8ac8f61acb5bf931">Posterior</a>-&gt;Update();</div>
<div class="line"><span class="lineno"> 1812</span> </div>
<div class="line"><span class="lineno"> 1813</span>  <span class="comment">//KS: We sort to have parameters from highest to lowest, this is related to how we make 2D projections in MakeCovariance_MP</span></div>
<div class="line"><span class="lineno"> 1814</span>  std::sort(ParamNumber.begin(), ParamNumber.end(),  std::greater&lt;int&gt;());</div>
<div class="line"><span class="lineno"> 1815</span> </div>
<div class="line"><span class="lineno"> 1816</span>  <span class="comment">//KS: Calculate how many pads/plots we need</span></div>
<div class="line"><span class="lineno"> 1817</span>  <span class="keywordtype">int</span> Npad = 0;</div>
<div class="line"><span class="lineno"> 1818</span>  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j = 1; j &lt; nParamPlot+1; j++) Npad += j;</div>
<div class="line"><span class="lineno"> 1819</span>  <a class="code hl_variable" href="classMCMCProcessor.html#a82e6cfef1ba6fcfc8ac8f61acb5bf931">Posterior</a>-&gt;cd();</div>
<div class="line"><span class="lineno"> 1820</span> </div>
<div class="line"><span class="lineno"> 1821</span>  <span class="keywordflow">if</span>(CredibleIntervals.size() != CredibleIntervalsColours.size())</div>
<div class="line"><span class="lineno"> 1822</span>  {</div>
<div class="line"><span class="lineno"> 1823</span>    <a class="code hl_define" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;size of  CredibleIntervals is not equat to size of CredibleIntervalsColours&quot;</span>);</div>
<div class="line"><span class="lineno"> 1824</span>    <span class="keywordflow">throw</span> <a class="code hl_class" href="classMaCh3Exception.html">MaCh3Exception</a>(__FILE__ , __LINE__ );</div>
<div class="line"><span class="lineno"> 1825</span>  }</div>
<div class="line"><span class="lineno"> 1826</span>  <span class="keywordflow">if</span>(CredibleIntervals.size() &gt; 1)</div>
<div class="line"><span class="lineno"> 1827</span>  {</div>
<div class="line"><span class="lineno"> 1828</span>    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 1; i &lt; CredibleIntervals.size(); i++ )</div>
<div class="line"><span class="lineno"> 1829</span>    {</div>
<div class="line"><span class="lineno"> 1830</span>      <span class="keywordflow">if</span>(CredibleIntervals[i] &gt; CredibleIntervals[i-1])</div>
<div class="line"><span class="lineno"> 1831</span>      {</div>
<div class="line"><span class="lineno"> 1832</span>        <a class="code hl_define" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Interval {} is smaller than {}&quot;</span>, i, i-1);</div>
<div class="line"><span class="lineno"> 1833</span>        <a class="code hl_define" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;{:.2f} {:.2f}&quot;</span>, CredibleIntervals[i], CredibleIntervals[i-1]);</div>
<div class="line"><span class="lineno"> 1834</span>        <a class="code hl_define" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;They should be grouped in decreasing order&quot;</span>);</div>
<div class="line"><span class="lineno"> 1835</span>        <span class="keywordflow">throw</span> <a class="code hl_class" href="classMaCh3Exception.html">MaCh3Exception</a>(__FILE__ , __LINE__ );</div>
<div class="line"><span class="lineno"> 1836</span>      }</div>
<div class="line"><span class="lineno"> 1837</span>    }</div>
<div class="line"><span class="lineno"> 1838</span>  }</div>
<div class="line"><span class="lineno"> 1839</span>  <span class="keywordflow">if</span>( (CredibleRegions.size() != CredibleRegionStyle.size()) || (CredibleRegionStyle.size() != CredibleRegionColor.size()) )</div>
<div class="line"><span class="lineno"> 1840</span>  {</div>
<div class="line"><span class="lineno"> 1841</span>    <a class="code hl_define" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;size of  CredibleRegions is not equat to size of CredibleRegionStyle&quot;</span>);</div>
<div class="line"><span class="lineno"> 1842</span>    <span class="keywordflow">throw</span> <a class="code hl_class" href="classMaCh3Exception.html">MaCh3Exception</a>(__FILE__ , __LINE__ );</div>
<div class="line"><span class="lineno"> 1843</span>  }</div>
<div class="line"><span class="lineno"> 1844</span>  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 1; i &lt; CredibleRegions.size(); i++ )</div>
<div class="line"><span class="lineno"> 1845</span>  {</div>
<div class="line"><span class="lineno"> 1846</span>    <span class="keywordflow">if</span>(CredibleRegions[i] &gt; CredibleRegions[i-1])</div>
<div class="line"><span class="lineno"> 1847</span>    {</div>
<div class="line"><span class="lineno"> 1848</span>      <a class="code hl_define" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Interval {} is smaller than {}&quot;</span>, i, i-1);</div>
<div class="line"><span class="lineno"> 1849</span>      <a class="code hl_define" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;{:.2f} {:.2f}&quot;</span>, CredibleRegions[i], CredibleRegions[i-1]);</div>
<div class="line"><span class="lineno"> 1850</span>      <a class="code hl_define" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;They should be grouped in decreasing order&quot;</span>);</div>
<div class="line"><span class="lineno"> 1851</span>      <span class="keywordflow">throw</span> <a class="code hl_class" href="classMaCh3Exception.html">MaCh3Exception</a>(__FILE__ , __LINE__ );</div>
<div class="line"><span class="lineno"> 1852</span>    }</div>
<div class="line"><span class="lineno"> 1853</span>  }</div>
<div class="line"><span class="lineno"> 1854</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> nCredibleIntervals = int(CredibleIntervals.size());</div>
<div class="line"><span class="lineno"> 1855</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> nCredibleRegions = int(CredibleRegions.size());</div>
<div class="line"><span class="lineno"> 1856</span> </div>
<div class="line"><span class="lineno"> 1857</span>  <span class="comment">//KS: Initialise Tpad histograms etc we will need</span></div>
<div class="line"><span class="lineno"> 1858</span>  TPad** TrianglePad = <span class="keyword">new</span> TPad*[Npad];</div>
<div class="line"><span class="lineno"> 1859</span>  <span class="comment">//KS: 1D copy of posterior, we need it as we modify them</span></div>
<div class="line"><span class="lineno"> 1860</span>  TH1D** hpost_copy = <span class="keyword">new</span> TH1D*[nParamPlot];</div>
<div class="line"><span class="lineno"> 1861</span>  TH1D*** hpost_cl = <span class="keyword">new</span> TH1D**[nParamPlot];</div>
<div class="line"><span class="lineno"> 1862</span>  TText **TriangleText = <span class="keyword">new</span> TText *[nParamPlot*2];</div>
<div class="line"><span class="lineno"> 1863</span>  TH2D** hpost_2D_copy = <span class="keyword">new</span> TH2D*[Npad-nParamPlot];</div>
<div class="line"><span class="lineno"> 1864</span>  TH2D*** hpost_2D_cl = <span class="keyword">new</span> TH2D**[Npad-nParamPlot];</div>
<div class="line"><span class="lineno"> 1865</span>  gStyle-&gt;SetPalette(51);</div>
<div class="line"><span class="lineno"> 1866</span> </div>
<div class="line"><span class="lineno"> 1867</span>  <span class="comment">//KS: Super convoluted way of calculating ranges for our pads, trust me it works...</span></div>
<div class="line"><span class="lineno"> 1868</span>  std::vector&lt;double&gt; X_Min(nParamPlot);</div>
<div class="line"><span class="lineno"> 1869</span>  std::vector&lt;double&gt; X_Max(nParamPlot);</div>
<div class="line"><span class="lineno"> 1870</span> </div>
<div class="line"><span class="lineno"> 1871</span>  X_Min[0] = 0.10;</div>
<div class="line"><span class="lineno"> 1872</span>  <span class="keywordtype">double</span> xScale = (0.95 - (X_Min[0]+0.05))/nParamPlot;</div>
<div class="line"><span class="lineno"> 1873</span>  <span class="comment">//KS: 0.05 is because we need additional offset for labels</span></div>
<div class="line"><span class="lineno"> 1874</span>  X_Max[0] = X_Min[0]+xScale+0.05;</div>
<div class="line"><span class="lineno"> 1875</span>  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 1; i &lt; nParamPlot; i++)</div>
<div class="line"><span class="lineno"> 1876</span>  {</div>
<div class="line"><span class="lineno"> 1877</span>    X_Min[i] = X_Max[i-1];</div>
<div class="line"><span class="lineno"> 1878</span>    X_Max[i] = X_Min[i]+xScale;</div>
<div class="line"><span class="lineno"> 1879</span>  }</div>
<div class="line"><span class="lineno"> 1880</span>  std::vector&lt;double&gt; Y_Min(nParamPlot);</div>
<div class="line"><span class="lineno"> 1881</span>  std::vector&lt;double&gt; Y_Max(nParamPlot);</div>
<div class="line"><span class="lineno"> 1882</span>  Y_Max[0] = 0.95;</div>
<div class="line"><span class="lineno"> 1883</span>  <span class="comment">//KS: 0.10 is becasue we need additional offset for labels</span></div>
<div class="line"><span class="lineno"> 1884</span>  <span class="keywordtype">double</span> yScale = std::fabs(0.10 - (Y_Max[0]))/nParamPlot;</div>
<div class="line"><span class="lineno"> 1885</span>  Y_Min[0] = Y_Max[0]-yScale;</div>
<div class="line"><span class="lineno"> 1886</span>  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 1; i &lt; nParamPlot; i++)</div>
<div class="line"><span class="lineno"> 1887</span>  {</div>
<div class="line"><span class="lineno"> 1888</span>    Y_Max[i] = Y_Min[i-1];</div>
<div class="line"><span class="lineno"> 1889</span>    Y_Min[i] = Y_Max[i]-yScale;</div>
<div class="line"><span class="lineno"> 1890</span>  }</div>
<div class="line"><span class="lineno"> 1891</span> </div>
<div class="line"><span class="lineno"> 1892</span>  <span class="comment">//KS: We store as numbering of isn&#39;t straightforward</span></div>
<div class="line"><span class="lineno"> 1893</span>  <span class="keywordtype">int</span> counterPad = 0;</div>
<div class="line"><span class="lineno"> 1894</span>  <span class="keywordtype">int</span> counterText = 0;</div>
<div class="line"><span class="lineno"> 1895</span>  <span class="keywordtype">int</span> counterPost = 0;</div>
<div class="line"><span class="lineno"> 1896</span>  <span class="keywordtype">int</span> counter2DPost = 0;</div>
<div class="line"><span class="lineno"> 1897</span>  <span class="comment">//KS: We start from top of the plot, might be confusing but works very well</span></div>
<div class="line"><span class="lineno"> 1898</span>  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> y = 0; y &lt; nParamPlot; y++)</div>
<div class="line"><span class="lineno"> 1899</span>  {</div>
<div class="line"><span class="lineno"> 1900</span>    <span class="comment">//KS: start from left and go right, depending on y</span></div>
<div class="line"><span class="lineno"> 1901</span>    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> x = 0; x &lt;= y; x++)</div>
<div class="line"><span class="lineno"> 1902</span>    {</div>
<div class="line"><span class="lineno"> 1903</span>      <span class="comment">//KS: Need to go to canvas every time to have our pads in the same canvas, not pads in the pads</span></div>
<div class="line"><span class="lineno"> 1904</span>      <a class="code hl_variable" href="classMCMCProcessor.html#a82e6cfef1ba6fcfc8ac8f61acb5bf931">Posterior</a>-&gt;cd();</div>
<div class="line"><span class="lineno"> 1905</span>      TrianglePad[counterPad] = <span class="keyword">new</span> TPad(Form(<span class="stringliteral">&quot;TPad_%i&quot;</span>, counterPad), Form(<span class="stringliteral">&quot;TPad_%i&quot;</span>, counterPad),</div>
<div class="line"><span class="lineno"> 1906</span>                                         X_Min[x], Y_Min[y], X_Max[x], Y_Max[y]);</div>
<div class="line"><span class="lineno"> 1907</span> </div>
<div class="line"><span class="lineno"> 1908</span>      TrianglePad[counterPad]-&gt;SetTopMargin(0);</div>
<div class="line"><span class="lineno"> 1909</span>      TrianglePad[counterPad]-&gt;SetRightMargin(0);</div>
<div class="line"><span class="lineno"> 1910</span> </div>
<div class="line"><span class="lineno"> 1911</span>      TrianglePad[counterPad]-&gt;SetGrid();</div>
<div class="line"><span class="lineno"> 1912</span>      TrianglePad[counterPad]-&gt;SetFrameBorderMode(0);</div>
<div class="line"><span class="lineno"> 1913</span>      TrianglePad[counterPad]-&gt;SetBorderMode(0);</div>
<div class="line"><span class="lineno"> 1914</span>      TrianglePad[counterPad]-&gt;SetBorderSize(0);</div>
<div class="line"><span class="lineno"> 1915</span> </div>
<div class="line"><span class="lineno"> 1916</span>      <span class="comment">//KS: Corresponds to bottom part of the plot, need margins for labels</span></div>
<div class="line"><span class="lineno"> 1917</span>      <span class="keywordflow">if</span>(y == (nParamPlot-1)) TrianglePad[counterPad]-&gt;SetBottomMargin(0.1);</div>
<div class="line"><span class="lineno"> 1918</span>      <span class="keywordflow">else</span> TrianglePad[counterPad]-&gt;SetBottomMargin(0);</div>
<div class="line"><span class="lineno"> 1919</span> </div>
<div class="line"><span class="lineno"> 1920</span>      <span class="comment">//KS: Corresponds to left part, need margins for labels</span></div>
<div class="line"><span class="lineno"> 1921</span>      <span class="keywordflow">if</span>(x == 0) TrianglePad[counterPad]-&gt;SetLeftMargin(0.15);</div>
<div class="line"><span class="lineno"> 1922</span>      <span class="keywordflow">else</span> TrianglePad[counterPad]-&gt;SetLeftMargin(0);</div>
<div class="line"><span class="lineno"> 1923</span> </div>
<div class="line"><span class="lineno"> 1924</span>      TrianglePad[counterPad]-&gt;Draw();</div>
<div class="line"><span class="lineno"> 1925</span>      TrianglePad[counterPad]-&gt;cd();</div>
<div class="line"><span class="lineno"> 1926</span> </div>
<div class="line"><span class="lineno"> 1927</span>      <span class="comment">//KS:if diagonal plot main posterior</span></div>
<div class="line"><span class="lineno"> 1928</span>      <span class="keywordflow">if</span>(x == y)</div>
<div class="line"><span class="lineno"> 1929</span>      {</div>
<div class="line"><span class="lineno"> 1930</span>        hpost_copy[counterPost] = <span class="keyword">static_cast&lt;</span>TH1D*<span class="keyword">&gt;</span>(<a class="code hl_variable" href="classMCMCProcessor.html#a795f661ed1ba8b8ae54c41fde5fb9496">hpost</a>[ParamNumber[x]]-&gt;Clone(Form(<span class="stringliteral">&quot;hpost_copy_%i&quot;</span>, ParamNumber[x])));</div>
<div class="line"><span class="lineno"> 1931</span>        hpost_cl[counterPost] = <span class="keyword">new</span> TH1D*[nCredibleIntervals];</div>
<div class="line"><span class="lineno"> 1933</span>        hpost_copy[counterPost]-&gt;Scale(1. / hpost_copy[counterPost]-&gt;Integral());</div>
<div class="line"><span class="lineno"> 1934</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; nCredibleIntervals; ++j)</div>
<div class="line"><span class="lineno"> 1935</span>        {</div>
<div class="line"><span class="lineno"> 1936</span>          hpost_cl[counterPost][j] = <span class="keyword">static_cast&lt;</span>TH1D*<span class="keyword">&gt;</span>(<a class="code hl_variable" href="classMCMCProcessor.html#a795f661ed1ba8b8ae54c41fde5fb9496">hpost</a>[ParamNumber[x]]-&gt;Clone(Form(<span class="stringliteral">&quot;hpost_copy_%i_CL_%f&quot;</span>, ParamNumber[x], CredibleIntervals[j])));</div>
<div class="line"><span class="lineno"> 1937</span>          <span class="comment">//KS: Reset to get rid to TF1 otherwise we run into segfault :(</span></div>
<div class="line"><span class="lineno"> 1938</span>          hpost_cl[counterPost][j]-&gt;Reset(<span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><span class="lineno"> 1939</span>          hpost_cl[counterPost][j]-&gt;Fill(0.0, 0.0);</div>
<div class="line"><span class="lineno"> 1940</span> </div>
<div class="line"><span class="lineno"> 1941</span>          <span class="comment">// Scale the histograms before gettindg credible intervals</span></div>
<div class="line"><span class="lineno"> 1942</span>          hpost_cl[counterPost][j]-&gt;Scale(1. / hpost_cl[counterPost][j]-&gt;Integral());</div>
<div class="line"><span class="lineno"> 1943</span>          <span class="comment">//KS: Slightly different approach depending if intervals are in percentage or sigmas</span></div>
<div class="line"><span class="lineno"> 1944</span>          <span class="keywordflow">if</span>(CredibleInSigmas)</div>
<div class="line"><span class="lineno"> 1945</span>          {</div>
<div class="line"><span class="lineno"> 1946</span>            <span class="comment">//KS: Convert sigmas into percentage</span></div>
<div class="line"><span class="lineno"> 1947</span>            <span class="keyword">const</span> <span class="keywordtype">double</span> CredReg = <a class="code hl_function" href="StatisticalUtils_8h.html#a04394b98587b44b98b003bd1226606ed">GetSigmaValue</a>(<span class="keywordtype">int</span>(std::round(CredibleIntervals[j])));</div>
<div class="line"><span class="lineno"> 1948</span>            <a class="code hl_function" href="StatisticalUtils_8h.html#aac24043cc7a5ef6a05fc1b10d3860875">GetCredibleInterval</a>(hpost_copy[counterPost], hpost_cl[counterPost][j], CredReg);</div>
<div class="line"><span class="lineno"> 1949</span>          }</div>
<div class="line"><span class="lineno"> 1950</span>          <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1951</span>          {</div>
<div class="line"><span class="lineno"> 1952</span>            <a class="code hl_function" href="StatisticalUtils_8h.html#aac24043cc7a5ef6a05fc1b10d3860875">GetCredibleInterval</a>(hpost_copy[counterPost], hpost_cl[counterPost][j], CredibleIntervals[j]);</div>
<div class="line"><span class="lineno"> 1953</span>          }</div>
<div class="line"><span class="lineno"> 1954</span> </div>
<div class="line"><span class="lineno"> 1955</span>          hpost_cl[counterPost][j]-&gt;SetFillColor(CredibleIntervalsColours[j]);</div>
<div class="line"><span class="lineno"> 1956</span>          hpost_cl[counterPost][j]-&gt;SetLineWidth(1);</div>
<div class="line"><span class="lineno"> 1957</span>        }</div>
<div class="line"><span class="lineno"> 1958</span> </div>
<div class="line"><span class="lineno"> 1959</span>        hpost_copy[counterPost]-&gt;SetMaximum(hpost_copy[counterPost]-&gt;GetMaximum()*1.2);</div>
<div class="line"><span class="lineno"> 1960</span>        hpost_copy[counterPost]-&gt;SetLineWidth(2);</div>
<div class="line"><span class="lineno"> 1961</span>        hpost_copy[counterPost]-&gt;SetLineColor(kBlack);</div>
<div class="line"><span class="lineno"> 1962</span> </div>
<div class="line"><span class="lineno"> 1963</span>        <span class="comment">//KS: Don&#39;t want any titles</span></div>
<div class="line"><span class="lineno"> 1964</span>        hpost_copy[counterPost]-&gt;GetXaxis()-&gt;SetTitle(<span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><span class="lineno"> 1965</span>        hpost_copy[counterPost]-&gt;GetYaxis()-&gt;SetTitle(<span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><span class="lineno"> 1966</span>        hpost_copy[counterPost]-&gt;SetTitle(<span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><span class="lineno"> 1967</span> </div>
<div class="line"><span class="lineno"> 1968</span>        hpost_copy[counterPost]-&gt;GetXaxis()-&gt;SetLabelSize(0.1);</div>
<div class="line"><span class="lineno"> 1969</span>        hpost_copy[counterPost]-&gt;GetYaxis()-&gt;SetLabelSize(0.1);</div>
<div class="line"><span class="lineno"> 1970</span> </div>
<div class="line"><span class="lineno"> 1971</span>        hpost_copy[counterPost]-&gt;GetXaxis()-&gt;SetNdivisions(4);</div>
<div class="line"><span class="lineno"> 1972</span>        hpost_copy[counterPost]-&gt;GetYaxis()-&gt;SetNdivisions(4);</div>
<div class="line"><span class="lineno"> 1973</span> </div>
<div class="line"><span class="lineno"> 1974</span>        hpost_copy[counterPost]-&gt;Draw(<span class="stringliteral">&quot;HIST&quot;</span>);</div>
<div class="line"><span class="lineno"> 1975</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; nCredibleIntervals; ++j)</div>
<div class="line"><span class="lineno"> 1976</span>          hpost_cl[counterPost][j]-&gt;Draw(<span class="stringliteral">&quot;HIST SAME&quot;</span>);</div>
<div class="line"><span class="lineno"> 1977</span>        counterPost++;</div>
<div class="line"><span class="lineno"> 1978</span>      }</div>
<div class="line"><span class="lineno"> 1979</span>      <span class="comment">//KS: Here we plot 2D credible regions</span></div>
<div class="line"><span class="lineno"> 1980</span>      <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1981</span>      {</div>
<div class="line"><span class="lineno"> 1982</span>        hpost_2D_copy[counter2DPost] = <span class="keyword">static_cast&lt;</span>TH2D*<span class="keyword">&gt;</span>(<a class="code hl_variable" href="classMCMCProcessor.html#a0ddcfa4ba1e4dcdea366d88decc64391">hpost2D</a>[ParamNumber[x]][ParamNumber[y]]-&gt;Clone(</div>
<div class="line"><span class="lineno"> 1983</span>          Form(<span class="stringliteral">&quot;hpost_copy_%i_%i&quot;</span>, ParamNumber[x], ParamNumber[y])));</div>
<div class="line"><span class="lineno"> 1984</span>        hpost_2D_cl[counter2DPost] = <span class="keyword">new</span> TH2D*[nCredibleRegions];</div>
<div class="line"><span class="lineno"> 1985</span>        <span class="comment">//KS: Now copy for every credible region</span></div>
<div class="line"><span class="lineno"> 1986</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; nCredibleRegions; ++k)</div>
<div class="line"><span class="lineno"> 1987</span>        {</div>
<div class="line"><span class="lineno"> 1988</span>          hpost_2D_cl[counter2DPost][k] = <span class="keyword">static_cast&lt;</span>TH2D*<span class="keyword">&gt;</span>(<a class="code hl_variable" href="classMCMCProcessor.html#a0ddcfa4ba1e4dcdea366d88decc64391">hpost2D</a>[ParamNumber[x]][ParamNumber[y]]-&gt;Clone(</div>
<div class="line"><span class="lineno"> 1989</span>            Form(<span class="stringliteral">&quot;hpost_copy_%i_%i_CL_%f&quot;</span>, ParamNumber[x], ParamNumber[y], CredibleRegions[k])));</div>
<div class="line"><span class="lineno"> 1990</span>          <span class="keywordflow">if</span>(CredibleInSigmas)</div>
<div class="line"><span class="lineno"> 1991</span>          {</div>
<div class="line"><span class="lineno"> 1992</span>            <span class="comment">//KS: Convert sigmas into percentage</span></div>
<div class="line"><span class="lineno"> 1993</span>            <span class="keyword">const</span> <span class="keywordtype">double</span> CredReg = <a class="code hl_function" href="StatisticalUtils_8h.html#a04394b98587b44b98b003bd1226606ed">GetSigmaValue</a>(<span class="keywordtype">int</span>(std::round(CredibleRegions[k])));</div>
<div class="line"><span class="lineno"> 1994</span>            <a class="code hl_function" href="StatisticalUtils_8h.html#add6570517afa2cca738b9aca56aa3883">GetCredibleRegion</a>(hpost_2D_cl[counter2DPost][k], CredReg);</div>
<div class="line"><span class="lineno"> 1995</span>          }</div>
<div class="line"><span class="lineno"> 1996</span>          <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1997</span>          {</div>
<div class="line"><span class="lineno"> 1998</span>            <a class="code hl_function" href="StatisticalUtils_8h.html#add6570517afa2cca738b9aca56aa3883">GetCredibleRegion</a>(hpost_2D_cl[counter2DPost][k], CredibleRegions[k]);</div>
<div class="line"><span class="lineno"> 1999</span>          }</div>
<div class="line"><span class="lineno"> 2000</span> </div>
<div class="line"><span class="lineno"> 2001</span>          hpost_2D_cl[counter2DPost][k]-&gt;SetLineColor(CredibleRegionColor[k]);</div>
<div class="line"><span class="lineno"> 2002</span>          hpost_2D_cl[counter2DPost][k]-&gt;SetLineWidth(2);</div>
<div class="line"><span class="lineno"> 2003</span>          hpost_2D_cl[counter2DPost][k]-&gt;SetLineStyle(CredibleRegionStyle[k]);</div>
<div class="line"><span class="lineno"> 2004</span>        }</div>
<div class="line"><span class="lineno"> 2005</span> </div>
<div class="line"><span class="lineno"> 2006</span>        <span class="comment">//KS: Don&#39;t want any titles</span></div>
<div class="line"><span class="lineno"> 2007</span>        hpost_2D_copy[counter2DPost]-&gt;GetXaxis()-&gt;SetTitle(<span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><span class="lineno"> 2008</span>        hpost_2D_copy[counter2DPost]-&gt;GetYaxis()-&gt;SetTitle(<span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><span class="lineno"> 2009</span>        hpost_2D_copy[counter2DPost]-&gt;SetTitle(<span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><span class="lineno"> 2010</span> </div>
<div class="line"><span class="lineno"> 2011</span>        hpost_2D_copy[counter2DPost]-&gt;GetXaxis()-&gt;SetLabelSize(0.1);</div>
<div class="line"><span class="lineno"> 2012</span>        hpost_2D_copy[counter2DPost]-&gt;GetYaxis()-&gt;SetLabelSize(0.1);</div>
<div class="line"><span class="lineno"> 2013</span> </div>
<div class="line"><span class="lineno"> 2014</span>        hpost_2D_copy[counter2DPost]-&gt; GetXaxis()-&gt;SetNdivisions(4);</div>
<div class="line"><span class="lineno"> 2015</span>        hpost_2D_copy[counter2DPost]-&gt; GetYaxis()-&gt;SetNdivisions(4);</div>
<div class="line"><span class="lineno"> 2016</span>        hpost_2D_copy[counter2DPost]-&gt;Draw(<span class="stringliteral">&quot;COL&quot;</span>);</div>
<div class="line"><span class="lineno"> 2017</span>        <span class="comment">//Now credible regions</span></div>
<div class="line"><span class="lineno"> 2018</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; nCredibleRegions; ++k)</div>
<div class="line"><span class="lineno"> 2019</span>          hpost_2D_cl[counter2DPost][k]-&gt;Draw(<span class="stringliteral">&quot;CONT3 SAME&quot;</span>);</div>
<div class="line"><span class="lineno"> 2020</span>        counter2DPost++;</div>
<div class="line"><span class="lineno"> 2021</span>      }</div>
<div class="line"><span class="lineno"> 2022</span>      <span class="comment">//KS: Corresponds to bottom part of the plot</span></div>
<div class="line"><span class="lineno"> 2023</span>      <span class="keywordflow">if</span>(y == (nParamPlot-1))</div>
<div class="line"><span class="lineno"> 2024</span>      {</div>
<div class="line"><span class="lineno"> 2025</span>        <a class="code hl_variable" href="classMCMCProcessor.html#a82e6cfef1ba6fcfc8ac8f61acb5bf931">Posterior</a>-&gt;cd();</div>
<div class="line"><span class="lineno"> 2026</span>        TriangleText[counterText] = <span class="keyword">new</span> TText(X_Min[x]+ (X_Max[x]-X_Min[x])/4, 0.04, <a class="code hl_variable" href="classMCMCProcessor.html#a795f661ed1ba8b8ae54c41fde5fb9496">hpost</a>[ParamNumber[x]]-&gt;GetTitle());</div>
<div class="line"><span class="lineno"> 2027</span>        <span class="comment">//KS: Unfortunately for many plots or long names this can go out of bounds :(</span></div>
<div class="line"><span class="lineno"> 2028</span>        TriangleText[counterText]-&gt;SetTextSize(0.015);</div>
<div class="line"><span class="lineno"> 2029</span>        TriangleText[counterText]-&gt;SetNDC(<span class="keyword">true</span>);</div>
<div class="line"><span class="lineno"> 2030</span>        TriangleText[counterText]-&gt;Draw();</div>
<div class="line"><span class="lineno"> 2031</span> </div>
<div class="line"><span class="lineno"> 2032</span>        counterText++;</div>
<div class="line"><span class="lineno"> 2033</span>      }</div>
<div class="line"><span class="lineno"> 2034</span>      <span class="comment">//KS: Corresponds to left part</span></div>
<div class="line"><span class="lineno"> 2035</span>      <span class="keywordflow">if</span>(x == 0)</div>
<div class="line"><span class="lineno"> 2036</span>      {</div>
<div class="line"><span class="lineno"> 2037</span>        <a class="code hl_variable" href="classMCMCProcessor.html#a82e6cfef1ba6fcfc8ac8f61acb5bf931">Posterior</a>-&gt;cd();</div>
<div class="line"><span class="lineno"> 2038</span>        TriangleText[counterText] = <span class="keyword">new</span> TText(0.04, Y_Min[y] + (Y_Max[y]-Y_Min[y])/4, <a class="code hl_variable" href="classMCMCProcessor.html#a795f661ed1ba8b8ae54c41fde5fb9496">hpost</a>[ParamNumber[y]]-&gt;GetTitle());</div>
<div class="line"><span class="lineno"> 2039</span>        <span class="comment">//KS: Rotate as this is y axis</span></div>
<div class="line"><span class="lineno"> 2040</span>        TriangleText[counterText]-&gt;SetTextAngle(90);</div>
<div class="line"><span class="lineno"> 2041</span>        <span class="comment">//KS: Unfortunately for many plots or long names this can go out of bounds :(</span></div>
<div class="line"><span class="lineno"> 2042</span>        TriangleText[counterText]-&gt;SetTextSize(0.015);</div>
<div class="line"><span class="lineno"> 2043</span>        TriangleText[counterText]-&gt;SetNDC(<span class="keyword">true</span>);</div>
<div class="line"><span class="lineno"> 2044</span>        TriangleText[counterText]-&gt;Draw();</div>
<div class="line"><span class="lineno"> 2045</span>        counterText++;</div>
<div class="line"><span class="lineno"> 2046</span>      }</div>
<div class="line"><span class="lineno"> 2047</span>      <a class="code hl_variable" href="classMCMCProcessor.html#a82e6cfef1ba6fcfc8ac8f61acb5bf931">Posterior</a>-&gt;Update();</div>
<div class="line"><span class="lineno"> 2048</span>      counterPad++;</div>
<div class="line"><span class="lineno"> 2049</span>    }</div>
<div class="line"><span class="lineno"> 2050</span>  }</div>
<div class="line"><span class="lineno"> 2051</span> </div>
<div class="line"><span class="lineno"> 2052</span>  <a class="code hl_variable" href="classMCMCProcessor.html#a82e6cfef1ba6fcfc8ac8f61acb5bf931">Posterior</a>-&gt;cd();</div>
<div class="line"><span class="lineno"> 2053</span>  <span class="keyword">auto</span> legend = std::make_unique&lt;TLegend&gt;(0.60, 0.7, 0.9, 0.9);</div>
<div class="line"><span class="lineno"> 2054</span>  legend-&gt;SetTextSize(0.03);</div>
<div class="line"><span class="lineno"> 2055</span>  legend-&gt;SetFillColor(0);</div>
<div class="line"><span class="lineno"> 2056</span>  legend-&gt;SetFillStyle(0);</div>
<div class="line"><span class="lineno"> 2057</span>  legend-&gt;SetLineColor(0);</div>
<div class="line"><span class="lineno"> 2058</span>  legend-&gt;SetLineStyle(0);</div>
<div class="line"><span class="lineno"> 2059</span>  legend-&gt;SetBorderSize(0);</div>
<div class="line"><span class="lineno"> 2060</span>  <span class="comment">//KS: Legend is shared so just take first histograms</span></div>
<div class="line"><span class="lineno"> 2061</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = nCredibleIntervals-1; j &gt;= 0; --j)</div>
<div class="line"><span class="lineno"> 2062</span>  {</div>
<div class="line"><span class="lineno"> 2063</span>    <span class="keywordflow">if</span>(CredibleInSigmas)</div>
<div class="line"><span class="lineno"> 2064</span>      legend-&gt;AddEntry(hpost_cl[0][j], Form(<span class="stringliteral">&quot;%.0f#sigma Credible Interval&quot;</span>, CredibleIntervals[j]), <span class="stringliteral">&quot;f&quot;</span>);</div>
<div class="line"><span class="lineno"> 2065</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 2066</span>      legend-&gt;AddEntry(hpost_cl[0][j], Form(<span class="stringliteral">&quot;%.0f%% Credible Interval&quot;</span>, CredibleRegions[j]*100), <span class="stringliteral">&quot;f&quot;</span>);</div>
<div class="line"><span class="lineno"> 2067</span>  }</div>
<div class="line"><span class="lineno"> 2068</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = nCredibleRegions-1; k &gt;= 0; --k)</div>
<div class="line"><span class="lineno"> 2069</span>  {</div>
<div class="line"><span class="lineno"> 2070</span>    <span class="keywordflow">if</span>(CredibleInSigmas)</div>
<div class="line"><span class="lineno"> 2071</span>      legend-&gt;AddEntry(hpost_2D_cl[0][k], Form(<span class="stringliteral">&quot;%.0f#sigma Credible Region&quot;</span>, CredibleRegions[k]), <span class="stringliteral">&quot;l&quot;</span>);</div>
<div class="line"><span class="lineno"> 2072</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 2073</span>      legend-&gt;AddEntry(hpost_2D_cl[0][k], Form(<span class="stringliteral">&quot;%.0f%% Credible Region&quot;</span>, CredibleRegions[k]*100), <span class="stringliteral">&quot;l&quot;</span>);</div>
<div class="line"><span class="lineno"> 2074</span>  }</div>
<div class="line"><span class="lineno"> 2075</span>  legend-&gt;Draw(<span class="stringliteral">&quot;SAME&quot;</span>);</div>
<div class="line"><span class="lineno"> 2076</span>  <a class="code hl_variable" href="classMCMCProcessor.html#a82e6cfef1ba6fcfc8ac8f61acb5bf931">Posterior</a>-&gt;Update();</div>
<div class="line"><span class="lineno"> 2077</span> </div>
<div class="line"><span class="lineno"> 2078</span>  <span class="comment">// Write to file</span></div>
<div class="line"><span class="lineno"> 2079</span>  <a class="code hl_variable" href="classMCMCProcessor.html#a82e6cfef1ba6fcfc8ac8f61acb5bf931">Posterior</a>-&gt;SetName(<span class="stringliteral">&quot;TrianglePlot&quot;</span>);</div>
<div class="line"><span class="lineno"> 2080</span>  <a class="code hl_variable" href="classMCMCProcessor.html#a82e6cfef1ba6fcfc8ac8f61acb5bf931">Posterior</a>-&gt;SetTitle(<span class="stringliteral">&quot;TrianglePlot&quot;</span>);</div>
<div class="line"><span class="lineno"> 2081</span> </div>
<div class="line"><span class="lineno"> 2082</span>  <span class="keywordflow">if</span>(<a class="code hl_variable" href="classMCMCProcessor.html#ad73755714ae3d6dc951158d5513c6eee">printToPDF</a>) <a class="code hl_variable" href="classMCMCProcessor.html#a82e6cfef1ba6fcfc8ac8f61acb5bf931">Posterior</a>-&gt;Print(<a class="code hl_variable" href="classMCMCProcessor.html#ab5aec3dc293919701d31e6ae705601dd">CanvasName</a>);</div>
<div class="line"><span class="lineno"> 2083</span>  <span class="comment">// Write it to root file</span></div>
<div class="line"><span class="lineno"> 2084</span>  <a class="code hl_variable" href="classMCMCProcessor.html#a62035b99df4617ab334cd1abd6ed0346">OutputFile</a>-&gt;cd();</div>
<div class="line"><span class="lineno"> 2085</span>  <a class="code hl_variable" href="classMCMCProcessor.html#a82e6cfef1ba6fcfc8ac8f61acb5bf931">Posterior</a>-&gt;Write();</div>
<div class="line"><span class="lineno"> 2086</span> </div>
<div class="line"><span class="lineno"> 2087</span>  <span class="comment">//KS: Remove allocated structures</span></div>
<div class="line"><span class="lineno"> 2088</span>  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; Npad; i++) <span class="keyword">delete</span> TrianglePad[i];</div>
<div class="line"><span class="lineno"> 2089</span>  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; nParamPlot*2; i++) <span class="keyword">delete</span> TriangleText[i];</div>
<div class="line"><span class="lineno"> 2090</span>  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; nParamPlot; i++)</div>
<div class="line"><span class="lineno"> 2091</span>  {</div>
<div class="line"><span class="lineno"> 2092</span>    <span class="keyword">delete</span> hpost_copy[i];</div>
<div class="line"><span class="lineno"> 2093</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; nCredibleIntervals; ++j)</div>
<div class="line"><span class="lineno"> 2094</span>    {</div>
<div class="line"><span class="lineno"> 2095</span>      <span class="keyword">delete</span> hpost_cl[i][j];</div>
<div class="line"><span class="lineno"> 2096</span>    }</div>
<div class="line"><span class="lineno"> 2097</span>    <span class="keyword">delete</span>[] hpost_cl[i];</div>
<div class="line"><span class="lineno"> 2098</span>  }</div>
<div class="line"><span class="lineno"> 2099</span>  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; Npad - nParamPlot; i++)</div>
<div class="line"><span class="lineno"> 2100</span>  {</div>
<div class="line"><span class="lineno"> 2101</span>    <span class="keyword">delete</span> hpost_2D_copy[i];</div>
<div class="line"><span class="lineno"> 2102</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; nCredibleRegions; ++j)</div>
<div class="line"><span class="lineno"> 2103</span>    {</div>
<div class="line"><span class="lineno"> 2104</span>      <span class="keyword">delete</span> hpost_2D_cl[i][j];</div>
<div class="line"><span class="lineno"> 2105</span>    }</div>
<div class="line"><span class="lineno"> 2106</span>    <span class="keyword">delete</span>[] hpost_2D_cl[i];</div>
<div class="line"><span class="lineno"> 2107</span>  }</div>
<div class="line"><span class="lineno"> 2108</span>  <span class="keyword">delete</span>[] hpost_copy;</div>
<div class="line"><span class="lineno"> 2109</span>  <span class="keyword">delete</span>[] hpost_cl;</div>
<div class="line"><span class="lineno"> 2110</span>  <span class="keyword">delete</span>[] hpost_2D_copy;</div>
<div class="line"><span class="lineno"> 2111</span>  <span class="keyword">delete</span>[] hpost_2D_cl;</div>
<div class="line"><span class="lineno"> 2112</span>  <span class="keyword">delete</span>[] TrianglePad;</div>
<div class="line"><span class="lineno"> 2113</span>  <span class="keyword">delete</span>[] TriangleText;</div>
<div class="line"><span class="lineno"> 2114</span> </div>
<div class="line"><span class="lineno"> 2115</span>  <span class="comment">//KS: Restore margin</span></div>
<div class="line"><span class="lineno"> 2116</span>  <a class="code hl_variable" href="classMCMCProcessor.html#a82e6cfef1ba6fcfc8ac8f61acb5bf931">Posterior</a>-&gt;SetTopMargin(TopMargin);</div>
<div class="line"><span class="lineno"> 2117</span>  <a class="code hl_variable" href="classMCMCProcessor.html#a82e6cfef1ba6fcfc8ac8f61acb5bf931">Posterior</a>-&gt;SetLeftMargin(BottomMargin);</div>
<div class="line"><span class="lineno"> 2118</span>  <a class="code hl_variable" href="classMCMCProcessor.html#a82e6cfef1ba6fcfc8ac8f61acb5bf931">Posterior</a>-&gt;SetLeftMargin(LeftMargin);</div>
<div class="line"><span class="lineno"> 2119</span>  <a class="code hl_variable" href="classMCMCProcessor.html#a82e6cfef1ba6fcfc8ac8f61acb5bf931">Posterior</a>-&gt;SetRightMargin(RighMargin);</div>
<div class="line"><span class="lineno"> 2120</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a04976c69f0ef0b3f39edcf5f25f90981" name="a04976c69f0ef0b3f39edcf5f25f90981"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a04976c69f0ef0b3f39edcf5f25f90981">&#9670;&#160;</a></span>MakeViolin()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void MCMCProcessor::MakeViolin </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Make and Draw Violin. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8cpp_source.html#l00846">846</a> of file <a class="el" href="MCMCProcessor_8cpp_source.html">MCMCProcessor.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  846</span>                               {</div>
<div class="line"><span class="lineno">  847</span><span class="comment">// *********************</span></div>
<div class="line"><span class="lineno">  848</span>  <span class="comment">//KS: Make sure we have steps</span></div>
<div class="line"><span class="lineno">  849</span>  <span class="keywordflow">if</span>(!<a class="code hl_variable" href="classMCMCProcessor.html#aea84f0315695aa05ec41fcf965b1b031">CacheMCMC</a>) <a class="code hl_function" href="classMCMCProcessor.html#ace48a54fb08e2a3943d4e2ed1f8c4a4b">CacheSteps</a>();</div>
<div class="line"><span class="lineno">  850</span> </div>
<div class="line"><span class="lineno">  851</span>  <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Producing Violin Plot&quot;</span>);</div>
<div class="line"><span class="lineno">  852</span> </div>
<div class="line"><span class="lineno">  853</span>  <span class="comment">//KS: Find min and max to make histogram in range</span></div>
<div class="line"><span class="lineno">  854</span>  <span class="keywordtype">double</span> maxi_y = <a class="code hl_variable" href="classMCMCProcessor.html#a6be3bbebd4a79fe9814a3da09b3bb820">Chain</a>-&gt;GetMaximum(<a class="code hl_variable" href="classMCMCProcessor.html#ad043b6b2c885f47ab9967831bc8d0f5a">BranchNames</a>[0]);</div>
<div class="line"><span class="lineno">  855</span>  <span class="keywordtype">double</span> mini_y = <a class="code hl_variable" href="classMCMCProcessor.html#a6be3bbebd4a79fe9814a3da09b3bb820">Chain</a>-&gt;GetMinimum(<a class="code hl_variable" href="classMCMCProcessor.html#ad043b6b2c885f47ab9967831bc8d0f5a">BranchNames</a>[0]);</div>
<div class="line"><span class="lineno">  856</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 1; i &lt; <a class="code hl_variable" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>; ++i)</div>
<div class="line"><span class="lineno">  857</span>  {</div>
<div class="line"><span class="lineno">  858</span>    <span class="keywordflow">if</span>(<a class="code hl_variable" href="classMCMCProcessor.html#a6be3bbebd4a79fe9814a3da09b3bb820">Chain</a>-&gt;GetMaximum(<a class="code hl_variable" href="classMCMCProcessor.html#ad043b6b2c885f47ab9967831bc8d0f5a">BranchNames</a>[i]) &gt; maxi_y) maxi_y = <a class="code hl_variable" href="classMCMCProcessor.html#a6be3bbebd4a79fe9814a3da09b3bb820">Chain</a>-&gt;GetMaximum(<a class="code hl_variable" href="classMCMCProcessor.html#ad043b6b2c885f47ab9967831bc8d0f5a">BranchNames</a>[i]);</div>
<div class="line"><span class="lineno">  859</span>    <span class="keywordflow">if</span>(<a class="code hl_variable" href="classMCMCProcessor.html#a6be3bbebd4a79fe9814a3da09b3bb820">Chain</a>-&gt;GetMinimum(<a class="code hl_variable" href="classMCMCProcessor.html#ad043b6b2c885f47ab9967831bc8d0f5a">BranchNames</a>[i]) &lt; mini_y) mini_y = <a class="code hl_variable" href="classMCMCProcessor.html#a6be3bbebd4a79fe9814a3da09b3bb820">Chain</a>-&gt;GetMinimum(<a class="code hl_variable" href="classMCMCProcessor.html#ad043b6b2c885f47ab9967831bc8d0f5a">BranchNames</a>[i]);</div>
<div class="line"><span class="lineno">  860</span>  }</div>
<div class="line"><span class="lineno">  861</span> </div>
<div class="line"><span class="lineno">  862</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> vBins = (maxi_y-mini_y)*25;</div>
<div class="line"><span class="lineno">  863</span> </div>
<div class="line"><span class="lineno">  864</span>  <a class="code hl_variable" href="classMCMCProcessor.html#a556988f03b24e3af33e9a29b23d2b1e2">hviolin</a> = <span class="keyword">new</span> TH2D(<span class="stringliteral">&quot;hviolin&quot;</span>, <span class="stringliteral">&quot;hviolin&quot;</span>, <a class="code hl_variable" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>, 0, <a class="code hl_variable" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>, vBins, mini_y, maxi_y);</div>
<div class="line"><span class="lineno">  865</span> </div>
<div class="line"><span class="lineno">  866</span>  <span class="comment">//KS: Prior has larger errors so we increase range and number of bins</span></div>
<div class="line"><span class="lineno">  867</span>  <span class="keyword">constexpr</span> <span class="keywordtype">int</span> PriorFactor = 4;</div>
<div class="line"><span class="lineno">  868</span>  <a class="code hl_variable" href="classMCMCProcessor.html#a25d79f451d5d584c3e7ef0e1423e5e8e">hviolin_prior</a> = <span class="keyword">new</span> TH2D(<span class="stringliteral">&quot;hviolin_prior&quot;</span>, <span class="stringliteral">&quot;hviolin_prior&quot;</span>, <a class="code hl_variable" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>, 0, <a class="code hl_variable" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>, PriorFactor*vBins, PriorFactor*mini_y, PriorFactor*maxi_y);</div>
<div class="line"><span class="lineno">  869</span> </div>
<div class="line"><span class="lineno">  870</span>  <span class="keyword">auto</span> rand = std::make_unique&lt;TRandom3&gt;(0);</div>
<div class="line"><span class="lineno">  871</span>  std::vector&lt;double&gt; PriorVec(<a class="code hl_variable" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>);</div>
<div class="line"><span class="lineno">  872</span>  std::vector&lt;double&gt; PriorErrorVec(<a class="code hl_variable" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>);</div>
<div class="line"><span class="lineno">  873</span>  std::vector&lt;bool&gt; PriorFlatVec(<a class="code hl_variable" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>);</div>
<div class="line"><span class="lineno">  874</span> </div>
<div class="line"><span class="lineno">  875</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> x = 0; x &lt; <a class="code hl_variable" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>; ++x)</div>
<div class="line"><span class="lineno">  876</span>  {</div>
<div class="line"><span class="lineno">  877</span>    TString Title;</div>
<div class="line"><span class="lineno">  878</span>    <span class="keywordtype">double</span> Prior, PriorError;</div>
<div class="line"><span class="lineno">  879</span> </div>
<div class="line"><span class="lineno">  880</span>    <a class="code hl_function" href="classMCMCProcessor.html#a28dfe42f1bf6fd3a145287be1e63fb0b">GetNthParameter</a>(x, Prior, PriorError, Title);</div>
<div class="line"><span class="lineno">  881</span>    <span class="comment">//Set fancy labels</span></div>
<div class="line"><span class="lineno">  882</span>    <a class="code hl_variable" href="classMCMCProcessor.html#a556988f03b24e3af33e9a29b23d2b1e2">hviolin</a>-&gt;GetXaxis()-&gt;SetBinLabel(x+1, Title);</div>
<div class="line"><span class="lineno">  883</span>    <a class="code hl_variable" href="classMCMCProcessor.html#a25d79f451d5d584c3e7ef0e1423e5e8e">hviolin_prior</a>-&gt;GetXaxis()-&gt;SetBinLabel(x+1, Title);</div>
<div class="line"><span class="lineno">  884</span>    PriorVec[x] = Prior;</div>
<div class="line"><span class="lineno">  885</span>    PriorErrorVec[x] = PriorError;</div>
<div class="line"><span class="lineno">  886</span> </div>
<div class="line"><span class="lineno">  887</span>    <a class="code hl_enumeration" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20b">ParameterEnum</a> ParType = <a class="code hl_variable" href="classMCMCProcessor.html#aaa903949bde8f1a69800c71fe1eb538e">ParamType</a>[x];</div>
<div class="line"><span class="lineno">  888</span>    <span class="keywordtype">int</span> ParamTemp = x - <a class="code hl_variable" href="classMCMCProcessor.html#aeab63979ff36256072c046a15d981875">ParamTypeStartPos</a>[ParType];</div>
<div class="line"><span class="lineno">  889</span>    PriorFlatVec[x] = <a class="code hl_variable" href="classMCMCProcessor.html#a4be1eedb743e4ea410009a4fa45720f7">ParamFlat</a>[ParType][ParamTemp];</div>
<div class="line"><span class="lineno">  890</span>  }</div>
<div class="line"><span class="lineno">  891</span> </div>
<div class="line"><span class="lineno">  892</span>  TStopwatch clock;</div>
<div class="line"><span class="lineno">  893</span>  clock.Start();</div>
<div class="line"><span class="lineno">  894</span> </div>
<div class="line"><span class="lineno">  895</span>  <span class="comment">// nDraw is number of draws we want to do</span></div>
<div class="line"><span class="lineno">  896</span><span class="preprocessor">  #ifdef MULTITHREAD</span></div>
<div class="line"><span class="lineno">  897</span><span class="preprocessor">  #pragma omp parallel for</span></div>
<div class="line"><span class="lineno">  898</span><span class="preprocessor">  #endif</span></div>
<div class="line"><span class="lineno">  899</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> x = 0; x &lt; <a class="code hl_variable" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>; ++x)</div>
<div class="line"><span class="lineno">  900</span>  {</div>
<div class="line"><span class="lineno">  901</span>    <span class="comment">//KS: Consider another treatment for fixed params</span></div>
<div class="line"><span class="lineno">  902</span>    <span class="comment">//if (IamVaried[x] == false) continue;</span></div>
<div class="line"><span class="lineno">  903</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; <a class="code hl_variable" href="classMCMCProcessor.html#af3a19b885e9c34e1674aea8cfbe14e1c">nEntries</a>; ++k)</div>
<div class="line"><span class="lineno">  904</span>    {</div>
<div class="line"><span class="lineno">  905</span>      <span class="comment">//KS: Burn in cut</span></div>
<div class="line"><span class="lineno">  906</span>      <span class="keywordflow">if</span>(<a class="code hl_variable" href="classMCMCProcessor.html#a07549f3b67ca5409218d80c679f6e69e">StepNumber</a>[k] &lt; <a class="code hl_variable" href="classMCMCProcessor.html#a22f82dadceccbe87dd8c5b7daa8432e8">BurnInCut</a>) <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  907</span> </div>
<div class="line"><span class="lineno">  908</span>      <span class="comment">//Only used for Suboptimatlity</span></div>
<div class="line"><span class="lineno">  909</span>      <span class="keywordflow">if</span>(<a class="code hl_variable" href="classMCMCProcessor.html#a07549f3b67ca5409218d80c679f6e69e">StepNumber</a>[k] &gt; <a class="code hl_variable" href="classMCMCProcessor.html#a840c686f15f419c0156df01c4ed62931">UpperCut</a>) <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  910</span> </div>
<div class="line"><span class="lineno">  911</span>      <span class="comment">//KS: We know exactly which x bin we will end up, find y bin. This allow to avoid coslty Fill() and enable multithreading becasue I am master of faster</span></div>
<div class="line"><span class="lineno">  912</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> y = <a class="code hl_variable" href="classMCMCProcessor.html#a556988f03b24e3af33e9a29b23d2b1e2">hviolin</a>-&gt;GetYaxis()-&gt;FindBin(<a class="code hl_variable" href="classMCMCProcessor.html#a087dca88a306acdc28afea7213e3623c">ParStep</a>[x][k]);</div>
<div class="line"><span class="lineno">  913</span>      <a class="code hl_variable" href="classMCMCProcessor.html#a556988f03b24e3af33e9a29b23d2b1e2">hviolin</a>-&gt;SetBinContent(x+1, y,  <a class="code hl_variable" href="classMCMCProcessor.html#a556988f03b24e3af33e9a29b23d2b1e2">hviolin</a>-&gt;GetBinContent(x+1, y)+1);</div>
<div class="line"><span class="lineno">  914</span>    }</div>
<div class="line"><span class="lineno">  915</span> </div>
<div class="line"><span class="lineno">  916</span>    <span class="comment">//KS: If we set option to not plot flat prior and param has flat prior then we skip this step</span></div>
<div class="line"><span class="lineno">  917</span>    <span class="keywordflow">if</span>(!(!<a class="code hl_variable" href="classMCMCProcessor.html#ad24411a2556504c440ff0af045e8e7aa">PlotFlatPrior</a> &amp;&amp; PriorFlatVec[x]))</div>
<div class="line"><span class="lineno">  918</span>    {</div>
<div class="line"><span class="lineno">  919</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; <a class="code hl_variable" href="classMCMCProcessor.html#af3a19b885e9c34e1674aea8cfbe14e1c">nEntries</a>; ++k)</div>
<div class="line"><span class="lineno">  920</span>      {</div>
<div class="line"><span class="lineno">  921</span>        <span class="keyword">const</span> <span class="keywordtype">double</span> Entry = rand-&gt;Gaus(PriorVec[x], PriorErrorVec[x]);</div>
<div class="line"><span class="lineno">  922</span>        <span class="keyword">const</span> <span class="keywordtype">double</span> y = <a class="code hl_variable" href="classMCMCProcessor.html#a25d79f451d5d584c3e7ef0e1423e5e8e">hviolin_prior</a>-&gt;GetYaxis()-&gt;FindBin(Entry);</div>
<div class="line"><span class="lineno">  923</span>        <a class="code hl_variable" href="classMCMCProcessor.html#a25d79f451d5d584c3e7ef0e1423e5e8e">hviolin_prior</a>-&gt;SetBinContent(x+1, y,  <a class="code hl_variable" href="classMCMCProcessor.html#a25d79f451d5d584c3e7ef0e1423e5e8e">hviolin_prior</a>-&gt;GetBinContent(x+1, y)+1);</div>
<div class="line"><span class="lineno">  924</span>      }</div>
<div class="line"><span class="lineno">  925</span>    }</div>
<div class="line"><span class="lineno">  926</span>  } <span class="comment">// end the for loop over nDraw</span></div>
<div class="line"><span class="lineno">  927</span>  clock.Stop();</div>
<div class="line"><span class="lineno">  928</span>  <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Making Violin plot took {:.2f}s to finish for {} steps&quot;</span>, clock.RealTime(), <a class="code hl_variable" href="classMCMCProcessor.html#af3a19b885e9c34e1674aea8cfbe14e1c">nEntries</a>);</div>
<div class="line"><span class="lineno">  929</span> </div>
<div class="line"><span class="lineno">  930</span>  <span class="comment">//KS: Tells how many parameters in one canvas we want</span></div>
<div class="line"><span class="lineno">  931</span>  <span class="keyword">constexpr</span> <span class="keywordtype">int</span> IntervalsSize = 10;</div>
<div class="line"><span class="lineno">  932</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> NIntervals = <a class="code hl_variable" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>/IntervalsSize;</div>
<div class="line"><span class="lineno">  933</span> </div>
<div class="line"><span class="lineno">  934</span>  <a class="code hl_variable" href="classMCMCProcessor.html#a556988f03b24e3af33e9a29b23d2b1e2">hviolin</a>-&gt;GetYaxis()-&gt;SetTitle(<span class="stringliteral">&quot;Parameter Value&quot;</span>);</div>
<div class="line"><span class="lineno">  935</span>  <a class="code hl_variable" href="classMCMCProcessor.html#a556988f03b24e3af33e9a29b23d2b1e2">hviolin</a>-&gt;GetXaxis()-&gt;SetTitle();</div>
<div class="line"><span class="lineno">  936</span>  <a class="code hl_variable" href="classMCMCProcessor.html#a556988f03b24e3af33e9a29b23d2b1e2">hviolin</a>-&gt;GetXaxis()-&gt;LabelsOption(<span class="stringliteral">&quot;v&quot;</span>);</div>
<div class="line"><span class="lineno">  937</span>  </div>
<div class="line"><span class="lineno">  938</span>  <a class="code hl_variable" href="classMCMCProcessor.html#a25d79f451d5d584c3e7ef0e1423e5e8e">hviolin_prior</a>-&gt;GetYaxis()-&gt;SetTitle(<span class="stringliteral">&quot;Parameter Value&quot;</span>);</div>
<div class="line"><span class="lineno">  939</span>  <a class="code hl_variable" href="classMCMCProcessor.html#a25d79f451d5d584c3e7ef0e1423e5e8e">hviolin_prior</a>-&gt;GetXaxis()-&gt;SetTitle();</div>
<div class="line"><span class="lineno">  940</span>  <a class="code hl_variable" href="classMCMCProcessor.html#a25d79f451d5d584c3e7ef0e1423e5e8e">hviolin_prior</a>-&gt;GetXaxis()-&gt;LabelsOption(<span class="stringliteral">&quot;v&quot;</span>);</div>
<div class="line"><span class="lineno">  941</span> </div>
<div class="line"><span class="lineno">  942</span>  <a class="code hl_variable" href="classMCMCProcessor.html#a25d79f451d5d584c3e7ef0e1423e5e8e">hviolin_prior</a>-&gt;SetLineColor(kRed);</div>
<div class="line"><span class="lineno">  943</span>  <a class="code hl_variable" href="classMCMCProcessor.html#a25d79f451d5d584c3e7ef0e1423e5e8e">hviolin_prior</a>-&gt;SetMarkerColor(kRed);</div>
<div class="line"><span class="lineno">  944</span>  <a class="code hl_variable" href="classMCMCProcessor.html#a25d79f451d5d584c3e7ef0e1423e5e8e">hviolin_prior</a>-&gt;SetFillColorAlpha(kRed, 0.35);</div>
<div class="line"><span class="lineno">  945</span>  <a class="code hl_variable" href="classMCMCProcessor.html#a25d79f451d5d584c3e7ef0e1423e5e8e">hviolin_prior</a>-&gt;SetMarkerStyle(20);</div>
<div class="line"><span class="lineno">  946</span>  <a class="code hl_variable" href="classMCMCProcessor.html#a25d79f451d5d584c3e7ef0e1423e5e8e">hviolin_prior</a>-&gt;SetMarkerSize(0.5);</div>
<div class="line"><span class="lineno">  947</span> </div>
<div class="line"><span class="lineno">  948</span>  <span class="comment">// These control violin width, if you use larger then 1 they will most likely overlay, so be cautious</span></div>
<div class="line"><span class="lineno">  949</span>  <a class="code hl_variable" href="classMCMCProcessor.html#a25d79f451d5d584c3e7ef0e1423e5e8e">hviolin_prior</a>-&gt;SetBarWidth(1.0);</div>
<div class="line"><span class="lineno">  950</span>  <a class="code hl_variable" href="classMCMCProcessor.html#a25d79f451d5d584c3e7ef0e1423e5e8e">hviolin_prior</a>-&gt;SetBarOffset(0);</div>
<div class="line"><span class="lineno">  951</span> </div>
<div class="line"><span class="lineno">  952</span>  <a class="code hl_variable" href="classMCMCProcessor.html#a556988f03b24e3af33e9a29b23d2b1e2">hviolin</a>-&gt;SetLineColor(kBlue);</div>
<div class="line"><span class="lineno">  953</span>  <a class="code hl_variable" href="classMCMCProcessor.html#a556988f03b24e3af33e9a29b23d2b1e2">hviolin</a>-&gt;SetMarkerColor(kBlue);</div>
<div class="line"><span class="lineno">  954</span>  <a class="code hl_variable" href="classMCMCProcessor.html#a556988f03b24e3af33e9a29b23d2b1e2">hviolin</a>-&gt;SetFillColorAlpha(kBlue, 0.35);</div>
<div class="line"><span class="lineno">  955</span>  <a class="code hl_variable" href="classMCMCProcessor.html#a556988f03b24e3af33e9a29b23d2b1e2">hviolin</a>-&gt;SetMarkerStyle(20);</div>
<div class="line"><span class="lineno">  956</span>  <a class="code hl_variable" href="classMCMCProcessor.html#a556988f03b24e3af33e9a29b23d2b1e2">hviolin</a>-&gt;SetMarkerSize(1.0);</div>
<div class="line"><span class="lineno">  957</span>  </div>
<div class="line"><span class="lineno">  958</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> BottomMargin = <a class="code hl_variable" href="classMCMCProcessor.html#a82e6cfef1ba6fcfc8ac8f61acb5bf931">Posterior</a>-&gt;GetBottomMargin();</div>
<div class="line"><span class="lineno">  959</span>  <a class="code hl_variable" href="classMCMCProcessor.html#a82e6cfef1ba6fcfc8ac8f61acb5bf931">Posterior</a>-&gt;SetBottomMargin(0.2);</div>
<div class="line"><span class="lineno">  960</span>    </div>
<div class="line"><span class="lineno">  961</span>  <a class="code hl_variable" href="classMCMCProcessor.html#a62035b99df4617ab334cd1abd6ed0346">OutputFile</a>-&gt;cd();</div>
<div class="line"><span class="lineno">  962</span>  <a class="code hl_variable" href="classMCMCProcessor.html#a556988f03b24e3af33e9a29b23d2b1e2">hviolin</a>-&gt;Write(<span class="stringliteral">&quot;param_violin&quot;</span>);</div>
<div class="line"><span class="lineno">  963</span>  <a class="code hl_variable" href="classMCMCProcessor.html#a25d79f451d5d584c3e7ef0e1423e5e8e">hviolin_prior</a>-&gt;Write(<span class="stringliteral">&quot;param_violin_prior&quot;</span>);</div>
<div class="line"><span class="lineno">  964</span>  <span class="comment">//KS: This is mostly for example plots, we have full file in the ROOT file so can do much better plot later</span></div>
<div class="line"><span class="lineno">  965</span>  <a class="code hl_variable" href="classMCMCProcessor.html#a556988f03b24e3af33e9a29b23d2b1e2">hviolin</a>-&gt;GetYaxis()-&gt;SetRangeUser(-1, +2);</div>
<div class="line"><span class="lineno">  966</span>  <a class="code hl_variable" href="classMCMCProcessor.html#a25d79f451d5d584c3e7ef0e1423e5e8e">hviolin_prior</a>-&gt;GetYaxis()-&gt;SetRangeUser(-1, +2);</div>
<div class="line"><span class="lineno">  967</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; NIntervals+1; ++i)</div>
<div class="line"><span class="lineno">  968</span>  {</div>
<div class="line"><span class="lineno">  969</span>    <a class="code hl_variable" href="classMCMCProcessor.html#a556988f03b24e3af33e9a29b23d2b1e2">hviolin</a>-&gt;GetXaxis()-&gt;SetRangeUser(i*IntervalsSize, i*IntervalsSize+IntervalsSize);</div>
<div class="line"><span class="lineno">  970</span>    <a class="code hl_variable" href="classMCMCProcessor.html#a25d79f451d5d584c3e7ef0e1423e5e8e">hviolin_prior</a>-&gt;GetXaxis()-&gt;SetRangeUser(i*IntervalsSize, i*IntervalsSize+IntervalsSize);</div>
<div class="line"><span class="lineno">  971</span>    <span class="keywordflow">if</span>(i == NIntervals+1)</div>
<div class="line"><span class="lineno">  972</span>    {</div>
<div class="line"><span class="lineno">  973</span>      <a class="code hl_variable" href="classMCMCProcessor.html#a556988f03b24e3af33e9a29b23d2b1e2">hviolin</a>-&gt;GetXaxis()-&gt;SetRangeUser(i*IntervalsSize, <a class="code hl_variable" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>); </div>
<div class="line"><span class="lineno">  974</span>      <a class="code hl_variable" href="classMCMCProcessor.html#a25d79f451d5d584c3e7ef0e1423e5e8e">hviolin_prior</a>-&gt;GetXaxis()-&gt;SetRangeUser(i*IntervalsSize, <a class="code hl_variable" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>);</div>
<div class="line"><span class="lineno">  975</span>    }</div>
<div class="line"><span class="lineno">  976</span>    <span class="comment">//KS: ROOT6 has some additional options, consider updating it. more https://root.cern/doc/master/classTHistPainter.html#HP140b</span></div>
<div class="line"><span class="lineno">  977</span>    <a class="code hl_variable" href="classMCMCProcessor.html#a25d79f451d5d584c3e7ef0e1423e5e8e">hviolin_prior</a>-&gt;Draw(<span class="stringliteral">&quot;violinX(03100300)&quot;</span>);</div>
<div class="line"><span class="lineno">  978</span>    <a class="code hl_variable" href="classMCMCProcessor.html#a556988f03b24e3af33e9a29b23d2b1e2">hviolin</a>-&gt;Draw(<span class="stringliteral">&quot;violinX(03100300) SAME&quot;</span>);</div>
<div class="line"><span class="lineno">  979</span>    <span class="keywordflow">if</span>(<a class="code hl_variable" href="classMCMCProcessor.html#ad73755714ae3d6dc951158d5513c6eee">printToPDF</a>) <a class="code hl_variable" href="classMCMCProcessor.html#a82e6cfef1ba6fcfc8ac8f61acb5bf931">Posterior</a>-&gt;Print(<a class="code hl_variable" href="classMCMCProcessor.html#ab5aec3dc293919701d31e6ae705601dd">CanvasName</a>);</div>
<div class="line"><span class="lineno">  980</span>  }</div>
<div class="line"><span class="lineno">  981</span>  <span class="comment">//KS: Return Margin to default one</span></div>
<div class="line"><span class="lineno">  982</span>  <a class="code hl_variable" href="classMCMCProcessor.html#a82e6cfef1ba6fcfc8ac8f61acb5bf931">Posterior</a>-&gt;SetBottomMargin(BottomMargin);</div>
<div class="line"><span class="lineno">  983</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ac9a5fc93b5ac3f6ef7850d21f47fd5dd" name="ac9a5fc93b5ac3f6ef7850d21f47fd5dd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac9a5fc93b5ac3f6ef7850d21f47fd5dd">&#9670;&#160;</a></span>ParameterEvolution()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void MCMCProcessor::ParameterEvolution </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; std::string &gt; &amp;&#160;</td>
          <td class="paramname"><em>Names</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; int &gt; &amp;&#160;</td>
          <td class="paramname"><em>NIntervals</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Make .gif of parameter evolution. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ParName</td><td>Parameter names for which we do .gif </td></tr>
    <tr><td class="paramname">NIntervals</td><td>Number of intervals for a gif </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8cpp_source.html#l03131">3131</a> of file <a class="el" href="MCMCProcessor_8cpp_source.html">MCMCProcessor.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3132</span>                                                                         {</div>
<div class="line"><span class="lineno"> 3133</span><span class="comment">// **************************</span></div>
<div class="line"><span class="lineno"> 3134</span>  <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Parameter Evolution gif&quot;</span>);</div>
<div class="line"><span class="lineno"> 3135</span> </div>
<div class="line"><span class="lineno"> 3136</span>  <span class="comment">//KS: First we need to find parameter number based on name</span></div>
<div class="line"><span class="lineno"> 3137</span>  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> k = 0; k &lt; Names.size(); ++k)</div>
<div class="line"><span class="lineno"> 3138</span>  {</div>
<div class="line"><span class="lineno"> 3139</span>    <span class="comment">//KS: First we need to find parameter number based on name</span></div>
<div class="line"><span class="lineno"> 3140</span>    <span class="keywordtype">int</span> ParamNo = <a class="code hl_function" href="classMCMCProcessor.html#a5ab91183fbbf23fff759fefc9954a1a5">GetParamIndexFromName</a>(Names[k]);</div>
<div class="line"><span class="lineno"> 3141</span>    <span class="keywordflow">if</span>(ParamNo == <a class="code hl_define" href="MCMCProcessor_8h.html#a82a6d79039474bc403b627437a7b97ec">_UNDEF_</a>)</div>
<div class="line"><span class="lineno"> 3142</span>    {</div>
<div class="line"><span class="lineno"> 3143</span>      <a class="code hl_define" href="MaCh3Logger_8h.html#ad5b2eb6377721e3ac95def22c2386bb1">MACH3LOG_WARN</a>(<span class="stringliteral">&quot;Couldn&#39;t find param {}. Can&#39;t reweight Prior&quot;</span>, Names[k]);</div>
<div class="line"><span class="lineno"> 3144</span>      <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 3145</span>    }</div>
<div class="line"><span class="lineno"> 3146</span> </div>
<div class="line"><span class="lineno"> 3147</span>    <span class="keyword">const</span> <span class="keywordtype">int</span> IntervalsSize = <a class="code hl_variable" href="classMCMCProcessor.html#aae0016a4e1d105d5d65243438c622a97">nSteps</a>/NIntervals[k];</div>
<div class="line"><span class="lineno"> 3148</span> </div>
<div class="line"><span class="lineno"> 3149</span>    <span class="comment">// ROOT won&#39;t overwrite gifs so we need to delete the file if it&#39;s there already</span></div>
<div class="line"><span class="lineno"> 3150</span>    <span class="keywordtype">int</span> ret = system(fmt::format(<span class="stringliteral">&quot;rm {}.gif&quot;</span>,Names[k]).c_str());</div>
<div class="line"><span class="lineno"> 3151</span>    <span class="keywordflow">if</span> (ret != 0){</div>
<div class="line"><span class="lineno"> 3152</span>      <a class="code hl_define" href="MaCh3Logger_8h.html#ad5b2eb6377721e3ac95def22c2386bb1">MACH3LOG_WARN</a>(<span class="stringliteral">&quot;Error: system call to delete {} failed with code {}&quot;</span>, Names[k], ret);</div>
<div class="line"><span class="lineno"> 3153</span>    }</div>
<div class="line"><span class="lineno"> 3154</span> </div>
<div class="line"><span class="lineno"> 3155</span>    <span class="comment">// This holds the posterior density</span></div>
<div class="line"><span class="lineno"> 3156</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> maxi = <a class="code hl_variable" href="classMCMCProcessor.html#a6be3bbebd4a79fe9814a3da09b3bb820">Chain</a>-&gt;GetMaximum(<a class="code hl_variable" href="classMCMCProcessor.html#ad043b6b2c885f47ab9967831bc8d0f5a">BranchNames</a>[ParamNo]);</div>
<div class="line"><span class="lineno"> 3157</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> mini = <a class="code hl_variable" href="classMCMCProcessor.html#a6be3bbebd4a79fe9814a3da09b3bb820">Chain</a>-&gt;GetMinimum(<a class="code hl_variable" href="classMCMCProcessor.html#ad043b6b2c885f47ab9967831bc8d0f5a">BranchNames</a>[ParamNo]);</div>
<div class="line"><span class="lineno"> 3158</span> </div>
<div class="line"><span class="lineno"> 3159</span>    <span class="keywordtype">int</span> Counter = 0;</div>
<div class="line"><span class="lineno"> 3160</span>    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = NIntervals[k]-1; i &gt;= 0; --i)</div>
<div class="line"><span class="lineno"> 3161</span>    {</div>
<div class="line"><span class="lineno"> 3162</span>      <span class="comment">// This holds the posterior density</span></div>
<div class="line"><span class="lineno"> 3163</span>      TH1D* EvePlot = <span class="keyword">new</span> TH1D(<a class="code hl_variable" href="classMCMCProcessor.html#ad043b6b2c885f47ab9967831bc8d0f5a">BranchNames</a>[ParamNo], <a class="code hl_variable" href="classMCMCProcessor.html#ad043b6b2c885f47ab9967831bc8d0f5a">BranchNames</a>[ParamNo], <a class="code hl_variable" href="classMCMCProcessor.html#a6b74f8195bcbca0979f9e9fe43468bae">nBins</a>, mini, maxi);</div>
<div class="line"><span class="lineno"> 3164</span>      EvePlot-&gt;SetMinimum(0);</div>
<div class="line"><span class="lineno"> 3165</span>      EvePlot-&gt;GetYaxis()-&gt;SetTitle(<span class="stringliteral">&quot;PDF&quot;</span>);</div>
<div class="line"><span class="lineno"> 3166</span>      EvePlot-&gt;GetYaxis()-&gt;SetNoExponent(<span class="keyword">false</span>);</div>
<div class="line"><span class="lineno"> 3167</span> </div>
<div class="line"><span class="lineno"> 3168</span>      <span class="comment">//KS: Apply additional Cuts, like mass ordering</span></div>
<div class="line"><span class="lineno"> 3169</span>      std::string CutPosterior1D = <span class="stringliteral">&quot;step &gt; &quot;</span> + std::to_string(i*IntervalsSize+IntervalsSize);</div>
<div class="line"><span class="lineno"> 3170</span> </div>
<div class="line"><span class="lineno"> 3171</span>      std::string TextTitle = <span class="stringliteral">&quot;Steps = 0 - &quot;</span>+std::to_string(Counter*IntervalsSize+IntervalsSize);</div>
<div class="line"><span class="lineno"> 3172</span>      <span class="comment">// Project BranchNames[ParamNo] onto hpost, applying stepcut</span></div>
<div class="line"><span class="lineno"> 3173</span>      <a class="code hl_variable" href="classMCMCProcessor.html#a6be3bbebd4a79fe9814a3da09b3bb820">Chain</a>-&gt;Project(<a class="code hl_variable" href="classMCMCProcessor.html#ad043b6b2c885f47ab9967831bc8d0f5a">BranchNames</a>[ParamNo], <a class="code hl_variable" href="classMCMCProcessor.html#ad043b6b2c885f47ab9967831bc8d0f5a">BranchNames</a>[ParamNo], CutPosterior1D.c_str());</div>
<div class="line"><span class="lineno"> 3174</span> </div>
<div class="line"><span class="lineno"> 3175</span>      EvePlot-&gt;SetLineWidth(2);</div>
<div class="line"><span class="lineno"> 3176</span>      EvePlot-&gt;SetLineColor(kBlue-1);</div>
<div class="line"><span class="lineno"> 3177</span>      EvePlot-&gt;SetTitle(Names[k].c_str());</div>
<div class="line"><span class="lineno"> 3178</span>      EvePlot-&gt;GetXaxis()-&gt;SetTitle(EvePlot-&gt;GetTitle());</div>
<div class="line"><span class="lineno"> 3179</span>      EvePlot-&gt;GetYaxis()-&gt;SetLabelOffset(1000);</div>
<div class="line"><span class="lineno"> 3180</span>      <span class="keywordflow">if</span>(<a class="code hl_variable" href="classMCMCProcessor.html#a682c1c47626542f5820d633ba2bc010c">ApplySmoothing</a>) EvePlot-&gt;Smooth();</div>
<div class="line"><span class="lineno"> 3181</span> </div>
<div class="line"><span class="lineno"> 3182</span>      EvePlot-&gt;Scale(1. / EvePlot-&gt;Integral());</div>
<div class="line"><span class="lineno"> 3183</span>      EvePlot-&gt;Draw(<span class="stringliteral">&quot;HIST&quot;</span>);</div>
<div class="line"><span class="lineno"> 3184</span> </div>
<div class="line"><span class="lineno"> 3185</span>      TText text(0.3, 0.8, TextTitle.c_str());</div>
<div class="line"><span class="lineno"> 3186</span>      text.SetTextFont (43);</div>
<div class="line"><span class="lineno"> 3187</span>      text.SetTextSize (40);</div>
<div class="line"><span class="lineno"> 3188</span>      text.SetNDC(<span class="keyword">true</span>);</div>
<div class="line"><span class="lineno"> 3189</span>      text.Draw(<span class="stringliteral">&quot;SAME&quot;</span>);</div>
<div class="line"><span class="lineno"> 3190</span> </div>
<div class="line"><span class="lineno"> 3191</span>      <span class="keywordflow">if</span>(i == 0) <a class="code hl_variable" href="classMCMCProcessor.html#a82e6cfef1ba6fcfc8ac8f61acb5bf931">Posterior</a>-&gt;Print((Names[k] + <span class="stringliteral">&quot;.gif++20&quot;</span>).c_str()); <span class="comment">// produces infinite loop animated GIF</span></div>
<div class="line"><span class="lineno"> 3192</span>      <span class="keywordflow">else</span> <a class="code hl_variable" href="classMCMCProcessor.html#a82e6cfef1ba6fcfc8ac8f61acb5bf931">Posterior</a>-&gt;Print((Names[k] + <span class="stringliteral">&quot;.gif+20&quot;</span>).c_str()); <span class="comment">// add picture to .gif</span></div>
<div class="line"><span class="lineno"> 3193</span> </div>
<div class="line"><span class="lineno"> 3194</span>      <span class="keyword">delete</span> EvePlot;</div>
<div class="line"><span class="lineno"> 3195</span>      Counter++;</div>
<div class="line"><span class="lineno"> 3196</span>    }</div>
<div class="line"><span class="lineno"> 3197</span>  }</div>
<div class="line"><span class="lineno"> 3198</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a929d6efec80bb4de05eea7011257439a" name="a929d6efec80bb4de05eea7011257439a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a929d6efec80bb4de05eea7011257439a">&#9670;&#160;</a></span>ParamTraces()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void MCMCProcessor::ParamTraces </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>CW: Draw trace plots of the parameters i.e. parameter vs step. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8cpp_source.html#l03401">3401</a> of file <a class="el" href="MCMCProcessor_8cpp_source.html">MCMCProcessor.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3401</span>                                {</div>
<div class="line"><span class="lineno"> 3402</span><span class="comment">// *****************</span></div>
<div class="line"><span class="lineno"> 3403</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="classMCMCProcessor.html#a087dca88a306acdc28afea7213e3623c">ParStep</a> == <span class="keyword">nullptr</span>) <a class="code hl_function" href="classMCMCProcessor.html#a930cadafa41b31b58066dea68628de9f">PrepareDiagMCMC</a>();</div>
<div class="line"><span class="lineno"> 3404</span>  <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Making trace plots...&quot;</span>);</div>
<div class="line"><span class="lineno"> 3405</span>  <span class="comment">// Make the TH1Ds</span></div>
<div class="line"><span class="lineno"> 3406</span>  std::vector&lt;TH1D*&gt; TraceParamPlots(<a class="code hl_variable" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>);</div>
<div class="line"><span class="lineno"> 3407</span>  std::vector&lt;TH1D*&gt; TraceSamplePlots(<a class="code hl_variable" href="classMCMCProcessor.html#a419d3669dbb54a55a635e35691134cc1">nSamples</a>);</div>
<div class="line"><span class="lineno"> 3408</span>  std::vector&lt;TH1D*&gt; TraceSystsPlots(<a class="code hl_variable" href="classMCMCProcessor.html#adf518be96278f1d3901404cfbe767b67">nSysts</a>);</div>
<div class="line"><span class="lineno"> 3409</span> </div>
<div class="line"><span class="lineno"> 3410</span>  <span class="comment">// Set the titles and limits for TH2Ds</span></div>
<div class="line"><span class="lineno"> 3411</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a class="code hl_variable" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>; ++j) {</div>
<div class="line"><span class="lineno"> 3412</span> </div>
<div class="line"><span class="lineno"> 3413</span>    TString Title = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><span class="lineno"> 3414</span>    <span class="keywordtype">double</span> Prior = 1.0;</div>
<div class="line"><span class="lineno"> 3415</span>    <span class="keywordtype">double</span> PriorError = 1.0;</div>
<div class="line"><span class="lineno"> 3416</span>    </div>
<div class="line"><span class="lineno"> 3417</span>    <a class="code hl_function" href="classMCMCProcessor.html#a28dfe42f1bf6fd3a145287be1e63fb0b">GetNthParameter</a>(j, Prior, PriorError, Title);</div>
<div class="line"><span class="lineno"> 3418</span>    std::string HistName = Form(<span class="stringliteral">&quot;%s_%s_Trace&quot;</span>, Title.Data(), <a class="code hl_variable" href="classMCMCProcessor.html#ad043b6b2c885f47ab9967831bc8d0f5a">BranchNames</a>[j].Data());</div>
<div class="line"><span class="lineno"> 3419</span>    TraceParamPlots[j] = <span class="keyword">new</span> TH1D(HistName.c_str(), HistName.c_str(), <a class="code hl_variable" href="classMCMCProcessor.html#af3a19b885e9c34e1674aea8cfbe14e1c">nEntries</a>, 0, <a class="code hl_variable" href="classMCMCProcessor.html#af3a19b885e9c34e1674aea8cfbe14e1c">nEntries</a>);</div>
<div class="line"><span class="lineno"> 3420</span>    TraceParamPlots[j]-&gt;GetXaxis()-&gt;SetTitle(<span class="stringliteral">&quot;Step&quot;</span>);</div>
<div class="line"><span class="lineno"> 3421</span>    TraceParamPlots[j]-&gt;GetYaxis()-&gt;SetTitle(<span class="stringliteral">&quot;Parameter Variation&quot;</span>);</div>
<div class="line"><span class="lineno"> 3422</span>  }</div>
<div class="line"><span class="lineno"> 3423</span> </div>
<div class="line"><span class="lineno"> 3424</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a class="code hl_variable" href="classMCMCProcessor.html#a419d3669dbb54a55a635e35691134cc1">nSamples</a>; ++j) {</div>
<div class="line"><span class="lineno"> 3425</span>    std::string HistName = <a class="code hl_variable" href="classMCMCProcessor.html#a3660e404a6631cfa913a815481730a9b">SampleName_v</a>[j].Data();</div>
<div class="line"><span class="lineno"> 3426</span>    TraceSamplePlots[j] = <span class="keyword">new</span> TH1D(HistName.c_str(), HistName.c_str(), <a class="code hl_variable" href="classMCMCProcessor.html#af3a19b885e9c34e1674aea8cfbe14e1c">nEntries</a>, 0, <a class="code hl_variable" href="classMCMCProcessor.html#af3a19b885e9c34e1674aea8cfbe14e1c">nEntries</a>);</div>
<div class="line"><span class="lineno"> 3427</span>    TraceSamplePlots[j]-&gt;GetXaxis()-&gt;SetTitle(<span class="stringliteral">&quot;Step&quot;</span>);</div>
<div class="line"><span class="lineno"> 3428</span>    TraceSamplePlots[j]-&gt;GetYaxis()-&gt;SetTitle(<span class="stringliteral">&quot;Sample -logL&quot;</span>);</div>
<div class="line"><span class="lineno"> 3429</span>  }</div>
<div class="line"><span class="lineno"> 3430</span> </div>
<div class="line"><span class="lineno"> 3431</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a class="code hl_variable" href="classMCMCProcessor.html#adf518be96278f1d3901404cfbe767b67">nSysts</a>; ++j) {</div>
<div class="line"><span class="lineno"> 3432</span>    std::string HistName = <a class="code hl_variable" href="classMCMCProcessor.html#acb1871575fdd3ae156aed4bf7c7a0a73">SystName_v</a>[j].Data();</div>
<div class="line"><span class="lineno"> 3433</span>    TraceSystsPlots[j] = <span class="keyword">new</span> TH1D(HistName.c_str(), HistName.c_str(), <a class="code hl_variable" href="classMCMCProcessor.html#af3a19b885e9c34e1674aea8cfbe14e1c">nEntries</a>, 0, <a class="code hl_variable" href="classMCMCProcessor.html#af3a19b885e9c34e1674aea8cfbe14e1c">nEntries</a>);</div>
<div class="line"><span class="lineno"> 3434</span>    TraceSystsPlots[j]-&gt;GetXaxis()-&gt;SetTitle(<span class="stringliteral">&quot;Step&quot;</span>);</div>
<div class="line"><span class="lineno"> 3435</span>    TraceSystsPlots[j]-&gt;GetYaxis()-&gt;SetTitle(<span class="stringliteral">&quot;Systematic -logL&quot;</span>);</div>
<div class="line"><span class="lineno"> 3436</span>  }</div>
<div class="line"><span class="lineno"> 3437</span> </div>
<div class="line"><span class="lineno"> 3438</span>  <span class="comment">// Have now made the empty TH1Ds, now for writing content to them!</span></div>
<div class="line"><span class="lineno"> 3439</span>  <span class="comment">// Loop over the number of parameters to draw their traces</span></div>
<div class="line"><span class="lineno"> 3440</span>  <span class="comment">// Each histogram</span></div>
<div class="line"><span class="lineno"> 3441</span><span class="preprocessor">#ifdef MULTITHREAD</span></div>
<div class="line"><span class="lineno"> 3442</span>  <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Using multi-threading...&quot;</span>);</div>
<div class="line"><span class="lineno"> 3443</span><span class="preprocessor">  #pragma omp parallel for</span></div>
<div class="line"><span class="lineno"> 3444</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 3445</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_variable" href="classMCMCProcessor.html#af3a19b885e9c34e1674aea8cfbe14e1c">nEntries</a>; ++i) {</div>
<div class="line"><span class="lineno"> 3446</span>    <span class="comment">// Set bin content for the ith bin to the parameter values</span></div>
<div class="line"><span class="lineno"> 3447</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a class="code hl_variable" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>; ++j) {</div>
<div class="line"><span class="lineno"> 3448</span>      TraceParamPlots[j]-&gt;SetBinContent(i, <a class="code hl_variable" href="classMCMCProcessor.html#a087dca88a306acdc28afea7213e3623c">ParStep</a>[j][i]);</div>
<div class="line"><span class="lineno"> 3449</span>    }</div>
<div class="line"><span class="lineno"> 3450</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a class="code hl_variable" href="classMCMCProcessor.html#a419d3669dbb54a55a635e35691134cc1">nSamples</a>; ++j) {</div>
<div class="line"><span class="lineno"> 3451</span>      TraceSamplePlots[j]-&gt;SetBinContent(i, <a class="code hl_variable" href="classMCMCProcessor.html#a28e89498420221149ec97c353c430bf8">SampleValues</a>[i][j]);</div>
<div class="line"><span class="lineno"> 3452</span>    }</div>
<div class="line"><span class="lineno"> 3453</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a class="code hl_variable" href="classMCMCProcessor.html#adf518be96278f1d3901404cfbe767b67">nSysts</a>; ++j) {</div>
<div class="line"><span class="lineno"> 3454</span>      TraceSystsPlots[j]-&gt;SetBinContent(i, <a class="code hl_variable" href="classMCMCProcessor.html#a4eb2748c81b0aef9bd7e14785559e301">SystValues</a>[i][j]);</div>
<div class="line"><span class="lineno"> 3455</span>    }</div>
<div class="line"><span class="lineno"> 3456</span>  }</div>
<div class="line"><span class="lineno"> 3457</span> </div>
<div class="line"><span class="lineno"> 3458</span>  <span class="comment">// Write the output and delete the TH2Ds</span></div>
<div class="line"><span class="lineno"> 3459</span>  TDirectory *TraceDir = <a class="code hl_variable" href="classMCMCProcessor.html#a62035b99df4617ab334cd1abd6ed0346">OutputFile</a>-&gt;mkdir(<span class="stringliteral">&quot;Trace&quot;</span>);</div>
<div class="line"><span class="lineno"> 3460</span>  TraceDir-&gt;cd();</div>
<div class="line"><span class="lineno"> 3461</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a class="code hl_variable" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>; ++j) {</div>
<div class="line"><span class="lineno"> 3462</span>    <span class="comment">// Fit a linear function to the traces</span></div>
<div class="line"><span class="lineno"> 3463</span>    TF1 *Fitter = <span class="keyword">new</span> TF1(<span class="stringliteral">&quot;Fitter&quot;</span>,<span class="stringliteral">&quot;[0]&quot;</span>, <a class="code hl_variable" href="classMCMCProcessor.html#af3a19b885e9c34e1674aea8cfbe14e1c">nEntries</a>/2, <a class="code hl_variable" href="classMCMCProcessor.html#af3a19b885e9c34e1674aea8cfbe14e1c">nEntries</a>);</div>
<div class="line"><span class="lineno"> 3464</span>    Fitter-&gt;SetLineColor(kRed);</div>
<div class="line"><span class="lineno"> 3465</span>    TraceParamPlots[j]-&gt;Fit(<span class="stringliteral">&quot;Fitter&quot;</span>,<span class="stringliteral">&quot;Rq&quot;</span>);</div>
<div class="line"><span class="lineno"> 3466</span>    TraceParamPlots[j]-&gt;Write();</div>
<div class="line"><span class="lineno"> 3467</span>    <span class="keyword">delete</span> Fitter;</div>
<div class="line"><span class="lineno"> 3468</span>    <span class="keyword">delete</span> TraceParamPlots[j];</div>
<div class="line"><span class="lineno"> 3469</span>  }</div>
<div class="line"><span class="lineno"> 3470</span> </div>
<div class="line"><span class="lineno"> 3471</span>  TDirectory *LLDir = <a class="code hl_variable" href="classMCMCProcessor.html#a62035b99df4617ab334cd1abd6ed0346">OutputFile</a>-&gt;mkdir(<span class="stringliteral">&quot;LogL&quot;</span>);</div>
<div class="line"><span class="lineno"> 3472</span>  LLDir-&gt;cd();</div>
<div class="line"><span class="lineno"> 3473</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a class="code hl_variable" href="classMCMCProcessor.html#a419d3669dbb54a55a635e35691134cc1">nSamples</a>; ++j) {</div>
<div class="line"><span class="lineno"> 3474</span>    TraceSamplePlots[j]-&gt;Write();</div>
<div class="line"><span class="lineno"> 3475</span>    <span class="keyword">delete</span> TraceSamplePlots[j];</div>
<div class="line"><span class="lineno"> 3476</span>    <span class="keyword">delete</span>[] <a class="code hl_variable" href="classMCMCProcessor.html#a28e89498420221149ec97c353c430bf8">SampleValues</a>[j];</div>
<div class="line"><span class="lineno"> 3477</span>  }</div>
<div class="line"><span class="lineno"> 3478</span>  <span class="keyword">delete</span>[] <a class="code hl_variable" href="classMCMCProcessor.html#a28e89498420221149ec97c353c430bf8">SampleValues</a>;</div>
<div class="line"><span class="lineno"> 3479</span> </div>
<div class="line"><span class="lineno"> 3480</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a class="code hl_variable" href="classMCMCProcessor.html#adf518be96278f1d3901404cfbe767b67">nSysts</a>; ++j) {</div>
<div class="line"><span class="lineno"> 3481</span>    TraceSystsPlots[j]-&gt;Write();</div>
<div class="line"><span class="lineno"> 3482</span>    <span class="keyword">delete</span> TraceSystsPlots[j];</div>
<div class="line"><span class="lineno"> 3483</span>    <span class="keyword">delete</span> <a class="code hl_variable" href="classMCMCProcessor.html#a4eb2748c81b0aef9bd7e14785559e301">SystValues</a>[j];</div>
<div class="line"><span class="lineno"> 3484</span>  }</div>
<div class="line"><span class="lineno"> 3485</span>  <span class="keyword">delete</span>[] <a class="code hl_variable" href="classMCMCProcessor.html#a4eb2748c81b0aef9bd7e14785559e301">SystValues</a>;</div>
<div class="line"><span class="lineno"> 3486</span> </div>
<div class="line"><span class="lineno"> 3487</span>  TraceDir-&gt;Close();</div>
<div class="line"><span class="lineno"> 3488</span>  <span class="keyword">delete</span> TraceDir;</div>
<div class="line"><span class="lineno"> 3489</span> </div>
<div class="line"><span class="lineno"> 3490</span>  <a class="code hl_variable" href="classMCMCProcessor.html#a62035b99df4617ab334cd1abd6ed0346">OutputFile</a>-&gt;cd();</div>
<div class="line"><span class="lineno"> 3491</span>}</div>
<div class="ttc" id="aclassMCMCProcessor_html_a3660e404a6631cfa913a815481730a9b"><div class="ttname"><a href="classMCMCProcessor.html#a3660e404a6631cfa913a815481730a9b">MCMCProcessor::SampleName_v</a></div><div class="ttdeci">std::vector&lt; TString &gt; SampleName_v</div><div class="ttdoc">Vector of each systematic.</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8h_source.html#l00384">MCMCProcessor.h:384</a></div></div>
<div class="ttc" id="aclassMCMCProcessor_html_acb1871575fdd3ae156aed4bf7c7a0a73"><div class="ttname"><a href="classMCMCProcessor.html#acb1871575fdd3ae156aed4bf7c7a0a73">MCMCProcessor::SystName_v</a></div><div class="ttdeci">std::vector&lt; TString &gt; SystName_v</div><div class="ttdoc">Vector of each sample PDF object.</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8h_source.html#l00386">MCMCProcessor.h:386</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aef760d8c4bb70690a5c4114f4b2409b3" name="aef760d8c4bb70690a5c4114f4b2409b3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aef760d8c4bb70690a5c4114f4b2409b3">&#9670;&#160;</a></span>PowerSpectrumAnalysis()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void MCMCProcessor::PowerSpectrumAnalysis </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>RC: Perform spectral analysis of MCMC <a class="el" href="citelist.html#CITEREF_Dunkley:2004sv">[5]</a>. </p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000010">Todo:</a></b></dt><dd>KS: Code is awfully slow... I know how to make it faster (GPU scream in a distant) but for now just make it for two params, bit hacky sry... </dd></dl>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8cpp_source.html#l04098">4098</a> of file <a class="el" href="MCMCProcessor_8cpp_source.html">MCMCProcessor.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 4098</span>                                          {</div>
<div class="line"><span class="lineno"> 4099</span><span class="comment">// **************************</span></div>
<div class="line"><span class="lineno"> 4100</span>  TStopwatch clock;</div>
<div class="line"><span class="lineno"> 4101</span>  clock.Start();</div>
<div class="line"><span class="lineno"> 4102</span> </div>
<div class="line"><span class="lineno"> 4103</span>  <span class="comment">//KS: Store it as we go back to them at the end</span></div>
<div class="line"><span class="lineno"> 4104</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> TopMargin  = <a class="code hl_variable" href="classMCMCProcessor.html#a82e6cfef1ba6fcfc8ac8f61acb5bf931">Posterior</a>-&gt;GetTopMargin();</div>
<div class="line"><span class="lineno"> 4105</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> OptTitle = gStyle-&gt;GetOptTitle();</div>
<div class="line"><span class="lineno"> 4106</span> </div>
<div class="line"><span class="lineno"> 4107</span>  <a class="code hl_variable" href="classMCMCProcessor.html#a82e6cfef1ba6fcfc8ac8f61acb5bf931">Posterior</a>-&gt;SetTopMargin(0.1);</div>
<div class="line"><span class="lineno"> 4108</span>  gStyle-&gt;SetOptTitle(1);</div>
<div class="line"><span class="lineno"> 4109</span> </div>
<div class="line"><span class="lineno"> 4110</span>  <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Making Power Spectrum plots...&quot;</span>);</div>
<div class="line"><span class="lineno"> 4111</span> </div>
<div class="line"><span class="lineno"> 4112</span>  <span class="comment">// This is only to reduce number of computations...</span></div>
<div class="line"><span class="lineno"> 4113</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> N_Coeffs = std::min(10000, <a class="code hl_variable" href="classMCMCProcessor.html#af3a19b885e9c34e1674aea8cfbe14e1c">nEntries</a>);</div>
<div class="line"><span class="lineno"> 4114</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> start = -(N_Coeffs/2-1);</div>
<div class="line"><span class="lineno"> 4115</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> end = N_Coeffs/2-1;</div>
<div class="line"><span class="lineno"> 4116</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> v_size = end - start;</div>
<div class="line"><span class="lineno"> 4117</span> </div>
<div class="line"><span class="lineno"> 4118</span>  <span class="keywordtype">int</span> nPrams = <a class="code hl_variable" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>;</div>
<div class="line"><span class="lineno"> 4120</span>  nPrams = 2;</div>
<div class="line"><span class="lineno"> 4121</span> </div>
<div class="line"><span class="lineno"> 4122</span>  std::vector&lt;std::vector&lt;float&gt;&gt; k_j(nPrams, std::vector&lt;float&gt;(v_size, 0.0));</div>
<div class="line"><span class="lineno"> 4123</span>  std::vector&lt;std::vector&lt;float&gt;&gt; P_j(nPrams, std::vector&lt;float&gt;(v_size, 0.0));</div>
<div class="line"><span class="lineno"> 4124</span> </div>
<div class="line"><span class="lineno"> 4125</span>  <span class="keywordtype">int</span> _N = <a class="code hl_variable" href="classMCMCProcessor.html#af3a19b885e9c34e1674aea8cfbe14e1c">nEntries</a>;</div>
<div class="line"><span class="lineno"> 4126</span>  <span class="keywordflow">if</span> (_N % 2 != 0) _N -= 1; <span class="comment">// N must be even</span></div>
<div class="line"><span class="lineno"> 4127</span> </div>
<div class="line"><span class="lineno"> 4128</span>  <span class="comment">//This is being used a lot so calculate it once to increase performance</span></div>
<div class="line"><span class="lineno"> 4129</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> two_pi_over_N = 2 * TMath::Pi() / <span class="keyword">static_cast&lt;</span><span class="keywordtype">double</span><span class="keyword">&gt;</span>(_N);</div>
<div class="line"><span class="lineno"> 4130</span> </div>
<div class="line"><span class="lineno"> 4131</span>  <span class="comment">// KS: This could be moved to GPU I guess</span></div>
<div class="line"><span class="lineno"> 4132</span><span class="preprocessor">  #ifdef MULTITHREAD</span></div>
<div class="line"><span class="lineno"> 4133</span><span class="preprocessor">  #pragma omp parallel for collapse(2)</span></div>
<div class="line"><span class="lineno"> 4134</span><span class="preprocessor">  #endif</span></div>
<div class="line"><span class="lineno"> 4135</span>  <span class="comment">// RC: equation 11: for each value of j coef, from range -N/2 -&gt; N/2</span></div>
<div class="line"><span class="lineno"> 4136</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; nPrams; ++j)</div>
<div class="line"><span class="lineno"> 4137</span>  {</div>
<div class="line"><span class="lineno"> 4138</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> jj = start; jj &lt; end; ++jj)</div>
<div class="line"><span class="lineno"> 4139</span>    {</div>
<div class="line"><span class="lineno"> 4140</span>      std::complex&lt;double&gt; a_j = 0.0;</div>
<div class="line"><span class="lineno"> 4141</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> n = 0; n &lt; _N; ++n)</div>
<div class="line"><span class="lineno"> 4142</span>      {</div>
<div class="line"><span class="lineno"> 4143</span>        <span class="comment">//if(StepNumber[n] &lt; BurnInCut) continue;</span></div>
<div class="line"><span class="lineno"> 4144</span>        std::complex&lt;double&gt; exp_temp(0, two_pi_over_N * jj * n);</div>
<div class="line"><span class="lineno"> 4145</span>        a_j += <a class="code hl_variable" href="classMCMCProcessor.html#a087dca88a306acdc28afea7213e3623c">ParStep</a>[j][n] * std::exp(exp_temp);</div>
<div class="line"><span class="lineno"> 4146</span>      }</div>
<div class="line"><span class="lineno"> 4147</span>      a_j /= std::sqrt(<span class="keywordtype">float</span>(_N));</div>
<div class="line"><span class="lineno"> 4148</span>      <span class="keyword">const</span> <span class="keywordtype">int</span> _c = jj - start;</div>
<div class="line"><span class="lineno"> 4149</span> </div>
<div class="line"><span class="lineno"> 4150</span>      k_j[j][_c] = two_pi_over_N * jj;</div>
<div class="line"><span class="lineno"> 4151</span>      <span class="comment">// Equation 13</span></div>
<div class="line"><span class="lineno"> 4152</span>      P_j[j][_c] = std::norm(a_j);</div>
<div class="line"><span class="lineno"> 4153</span>    }</div>
<div class="line"><span class="lineno"> 4154</span>  }</div>
<div class="line"><span class="lineno"> 4155</span> </div>
<div class="line"><span class="lineno"> 4156</span>  TDirectory *PowerDir = <a class="code hl_variable" href="classMCMCProcessor.html#a62035b99df4617ab334cd1abd6ed0346">OutputFile</a>-&gt;mkdir(<span class="stringliteral">&quot;PowerSpectrum&quot;</span>);</div>
<div class="line"><span class="lineno"> 4157</span>  PowerDir-&gt;cd();</div>
<div class="line"><span class="lineno"> 4158</span> </div>
<div class="line"><span class="lineno"> 4159</span>  TVectorD* PowerSpectrumStepSize = <span class="keyword">new</span> TVectorD(nPrams);</div>
<div class="line"><span class="lineno"> 4160</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; nPrams; ++j)</div>
<div class="line"><span class="lineno"> 4161</span>  {</div>
<div class="line"><span class="lineno"> 4162</span>    TGraph* plot = <span class="keyword">new</span> TGraph(v_size, k_j[j].data(), P_j[j].data());</div>
<div class="line"><span class="lineno"> 4163</span> </div>
<div class="line"><span class="lineno"> 4164</span>    TString Title = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><span class="lineno"> 4165</span>    <span class="keywordtype">double</span> Prior = 1.0;</div>
<div class="line"><span class="lineno"> 4166</span>    <span class="keywordtype">double</span> PriorError = 1.0;</div>
<div class="line"><span class="lineno"> 4167</span> </div>
<div class="line"><span class="lineno"> 4168</span>    <a class="code hl_function" href="classMCMCProcessor.html#a28dfe42f1bf6fd3a145287be1e63fb0b">GetNthParameter</a>(j, Prior, PriorError, Title);</div>
<div class="line"><span class="lineno"> 4169</span> </div>
<div class="line"><span class="lineno"> 4170</span>    std::string name = Form(<span class="stringliteral">&quot;Power Spectrum of %s;k;P(k)&quot;</span>, Title.Data());</div>
<div class="line"><span class="lineno"> 4171</span> </div>
<div class="line"><span class="lineno"> 4172</span>    plot-&gt;SetTitle(name.c_str());</div>
<div class="line"><span class="lineno"> 4173</span>    name = Form(<span class="stringliteral">&quot;%s_power_spectrum&quot;</span>, Title.Data());</div>
<div class="line"><span class="lineno"> 4174</span>    plot-&gt;SetName(name.c_str());</div>
<div class="line"><span class="lineno"> 4175</span>    plot-&gt;SetMarkerStyle(7);</div>
<div class="line"><span class="lineno"> 4176</span> </div>
<div class="line"><span class="lineno"> 4177</span>    <span class="comment">// Equation 18</span></div>
<div class="line"><span class="lineno"> 4178</span>    TF1 *func = <span class="keyword">new</span> TF1(<span class="stringliteral">&quot;power_template&quot;</span>, <span class="stringliteral">&quot;[0]*( ([1] / x)^[2] / (([1] / x)^[2] +1) )&quot;</span>, 0.0, 1.0);</div>
<div class="line"><span class="lineno"> 4179</span>    <span class="comment">// P0 gives the amplitude of the white noise spectrum in the k  0 limit</span></div>
<div class="line"><span class="lineno"> 4180</span>    func-&gt;SetParameter(0, 10.0);</div>
<div class="line"><span class="lineno"> 4181</span>    <span class="comment">// k* indicates the position of the turnover to a different power law behaviour</span></div>
<div class="line"><span class="lineno"> 4182</span>    func-&gt;SetParameter(1, 0.1);</div>
<div class="line"><span class="lineno"> 4183</span>    <span class="comment">// alpha free parameter</span></div>
<div class="line"><span class="lineno"> 4184</span>    func-&gt;SetParameter(2, 2.0);</div>
<div class="line"><span class="lineno"> 4185</span> </div>
<div class="line"><span class="lineno"> 4186</span>    <span class="comment">// Set parameter limits for stability</span></div>
<div class="line"><span class="lineno"> 4187</span>    func-&gt;SetParLimits(0, 0.0, 100.0); <span class="comment">// Amplitude should be non-negative</span></div>
<div class="line"><span class="lineno"> 4188</span>    func-&gt;SetParLimits(1, 0.001, 1.0); <span class="comment">// k* should be within a reasonable range</span></div>
<div class="line"><span class="lineno"> 4189</span>    func-&gt;SetParLimits(2, 0.0, 5.0);   <span class="comment">// alpha should be positive</span></div>
<div class="line"><span class="lineno"> 4190</span> </div>
<div class="line"><span class="lineno"> 4191</span>    plot-&gt;Fit(<span class="stringliteral">&quot;power_template&quot;</span>,<span class="stringliteral">&quot;Rq&quot;</span>);</div>
<div class="line"><span class="lineno"> 4192</span> </div>
<div class="line"><span class="lineno"> 4193</span>    <a class="code hl_variable" href="classMCMCProcessor.html#a82e6cfef1ba6fcfc8ac8f61acb5bf931">Posterior</a>-&gt;SetLogx();</div>
<div class="line"><span class="lineno"> 4194</span>    <a class="code hl_variable" href="classMCMCProcessor.html#a82e6cfef1ba6fcfc8ac8f61acb5bf931">Posterior</a>-&gt;SetLogy();</div>
<div class="line"><span class="lineno"> 4195</span>    <a class="code hl_variable" href="classMCMCProcessor.html#a82e6cfef1ba6fcfc8ac8f61acb5bf931">Posterior</a>-&gt;SetGrid();</div>
<div class="line"><span class="lineno"> 4196</span>    plot-&gt;Write(plot-&gt;GetName());</div>
<div class="line"><span class="lineno"> 4197</span>    plot-&gt;Draw(<span class="stringliteral">&quot;AL&quot;</span>);</div>
<div class="line"><span class="lineno"> 4198</span>    func-&gt;Draw(<span class="stringliteral">&quot;SAME&quot;</span>);</div>
<div class="line"><span class="lineno"> 4199</span>    <span class="keywordflow">if</span>(<a class="code hl_variable" href="classMCMCProcessor.html#ad73755714ae3d6dc951158d5513c6eee">printToPDF</a>) <a class="code hl_variable" href="classMCMCProcessor.html#a82e6cfef1ba6fcfc8ac8f61acb5bf931">Posterior</a>-&gt;Print(<a class="code hl_variable" href="classMCMCProcessor.html#ab5aec3dc293919701d31e6ae705601dd">CanvasName</a>);</div>
<div class="line"><span class="lineno"> 4200</span> </div>
<div class="line"><span class="lineno"> 4201</span>    <span class="comment">//KS: I have no clue what is the reason behind this. Found this in Rick Calland code...</span></div>
<div class="line"><span class="lineno"> 4202</span>    (*PowerSpectrumStepSize)(j) = std::sqrt(func-&gt;GetParameter(0)/float(v_size*0.5));</div>
<div class="line"><span class="lineno"> 4203</span>    <span class="keyword">delete</span> func;</div>
<div class="line"><span class="lineno"> 4204</span>    <span class="keyword">delete</span> plot;</div>
<div class="line"><span class="lineno"> 4205</span>  }</div>
<div class="line"><span class="lineno"> 4206</span> </div>
<div class="line"><span class="lineno"> 4207</span>  PowerSpectrumStepSize-&gt;Write(<span class="stringliteral">&quot;PowerSpectrumStepSize&quot;</span>);</div>
<div class="line"><span class="lineno"> 4208</span>  <span class="keyword">delete</span> PowerSpectrumStepSize;</div>
<div class="line"><span class="lineno"> 4209</span>  PowerDir-&gt;Close();</div>
<div class="line"><span class="lineno"> 4210</span>  <span class="keyword">delete</span> PowerDir;</div>
<div class="line"><span class="lineno"> 4211</span> </div>
<div class="line"><span class="lineno"> 4212</span>  clock.Stop();</div>
<div class="line"><span class="lineno"> 4213</span>  <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Making Power Spectrum took {:.2f}s&quot;</span>, clock.RealTime());</div>
<div class="line"><span class="lineno"> 4214</span> </div>
<div class="line"><span class="lineno"> 4215</span>  <a class="code hl_variable" href="classMCMCProcessor.html#a82e6cfef1ba6fcfc8ac8f61acb5bf931">Posterior</a>-&gt;SetTopMargin(TopMargin);</div>
<div class="line"><span class="lineno"> 4216</span>  gStyle-&gt;SetOptTitle(OptTitle);</div>
<div class="line"><span class="lineno"> 4217</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a930cadafa41b31b58066dea68628de9f" name="a930cadafa41b31b58066dea68628de9f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a930cadafa41b31b58066dea68628de9f">&#9670;&#160;</a></span>PrepareDiagMCMC()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void MCMCProcessor::PrepareDiagMCMC </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>CW: Prepare branches etc. for DiagMCMC. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8cpp_source.html#l03233">3233</a> of file <a class="el" href="MCMCProcessor_8cpp_source.html">MCMCProcessor.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3233</span>                                    {</div>
<div class="line"><span class="lineno"> 3234</span><span class="comment">// **************************</span></div>
<div class="line"><span class="lineno"> 3235</span>  <a class="code hl_variable" href="classMCMCProcessor.html#adf449e50cf358f737fe4a2b65d9668e9">doDiagMCMC</a> = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 3236</span>    </div>
<div class="line"><span class="lineno"> 3237</span>  <span class="keywordflow">if</span>(<a class="code hl_variable" href="classMCMCProcessor.html#a087dca88a306acdc28afea7213e3623c">ParStep</a> != <span class="keyword">nullptr</span>)</div>
<div class="line"><span class="lineno"> 3238</span>  {</div>
<div class="line"><span class="lineno"> 3239</span>    <a class="code hl_define" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;It look like ParStep was already filled &quot;</span>);</div>
<div class="line"><span class="lineno"> 3240</span>    <a class="code hl_define" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Even though it is used for MakeCovariance_MP and for DiagMCMC&quot;</span>);</div>
<div class="line"><span class="lineno"> 3241</span>    <a class="code hl_define" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;it has different structure in both for cache hits, sorry &quot;</span>);</div>
<div class="line"><span class="lineno"> 3242</span>    <span class="keywordflow">throw</span> <a class="code hl_class" href="classMaCh3Exception.html">MaCh3Exception</a>(__FILE__ , __LINE__ );</div>
<div class="line"><span class="lineno"> 3243</span>  }</div>
<div class="line"><span class="lineno"> 3244</span>  <span class="keywordflow">if</span>(<a class="code hl_variable" href="classMCMCProcessor.html#a02c5a3f849cf217705816c650c678d19">nBatches</a> == 0)</div>
<div class="line"><span class="lineno"> 3245</span>  {</div>
<div class="line"><span class="lineno"> 3246</span>    <a class="code hl_define" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;nBatches is equal to 0&quot;</span>);</div>
<div class="line"><span class="lineno"> 3247</span>    <a class="code hl_define" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;please use SetnBatches to set other value fore example 20&quot;</span>);</div>
<div class="line"><span class="lineno"> 3248</span>    <span class="keywordflow">throw</span> <a class="code hl_class" href="classMaCh3Exception.html">MaCh3Exception</a>(__FILE__ , __LINE__ );</div>
<div class="line"><span class="lineno"> 3249</span>  }</div>
<div class="line"><span class="lineno"> 3250</span>    </div>
<div class="line"><span class="lineno"> 3251</span>  <span class="comment">// Initialise ParStep</span></div>
<div class="line"><span class="lineno"> 3252</span>  <a class="code hl_variable" href="classMCMCProcessor.html#a087dca88a306acdc28afea7213e3623c">ParStep</a> = <span class="keyword">new</span> <span class="keywordtype">double</span>*[<a class="code hl_variable" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>]();</div>
<div class="line"><span class="lineno"> 3253</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a class="code hl_variable" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>; ++j) {</div>
<div class="line"><span class="lineno"> 3254</span>    <a class="code hl_variable" href="classMCMCProcessor.html#a087dca88a306acdc28afea7213e3623c">ParStep</a>[j] = <span class="keyword">new</span> <span class="keywordtype">double</span>[<a class="code hl_variable" href="classMCMCProcessor.html#af3a19b885e9c34e1674aea8cfbe14e1c">nEntries</a>]();</div>
<div class="line"><span class="lineno"> 3255</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_variable" href="classMCMCProcessor.html#af3a19b885e9c34e1674aea8cfbe14e1c">nEntries</a>; ++i) {</div>
<div class="line"><span class="lineno"> 3256</span>      <a class="code hl_variable" href="classMCMCProcessor.html#a087dca88a306acdc28afea7213e3623c">ParStep</a>[j][i] = -999.99;</div>
<div class="line"><span class="lineno"> 3257</span>    }</div>
<div class="line"><span class="lineno"> 3258</span>  }</div>
<div class="line"><span class="lineno"> 3259</span> </div>
<div class="line"><span class="lineno"> 3260</span>  <a class="code hl_variable" href="classMCMCProcessor.html#a28e89498420221149ec97c353c430bf8">SampleValues</a> = <span class="keyword">new</span> <span class="keywordtype">double</span>*[<a class="code hl_variable" href="classMCMCProcessor.html#af3a19b885e9c34e1674aea8cfbe14e1c">nEntries</a>]();</div>
<div class="line"><span class="lineno"> 3261</span>  <a class="code hl_variable" href="classMCMCProcessor.html#a4eb2748c81b0aef9bd7e14785559e301">SystValues</a> = <span class="keyword">new</span> <span class="keywordtype">double</span>*[<a class="code hl_variable" href="classMCMCProcessor.html#af3a19b885e9c34e1674aea8cfbe14e1c">nEntries</a>]();</div>
<div class="line"><span class="lineno"> 3262</span>  <a class="code hl_variable" href="classMCMCProcessor.html#a88cab29770fd6098a674a0ab3628a251">AccProbValues</a> = <span class="keyword">new</span> <span class="keywordtype">double</span>[<a class="code hl_variable" href="classMCMCProcessor.html#af3a19b885e9c34e1674aea8cfbe14e1c">nEntries</a>]();</div>
<div class="line"><span class="lineno"> 3263</span>  <a class="code hl_variable" href="classMCMCProcessor.html#a07549f3b67ca5409218d80c679f6e69e">StepNumber</a> = <span class="keyword">new</span> <span class="keywordtype">int</span>[<a class="code hl_variable" href="classMCMCProcessor.html#af3a19b885e9c34e1674aea8cfbe14e1c">nEntries</a>]();</div>
<div class="line"><span class="lineno"> 3264</span> </div>
<div class="line"><span class="lineno"> 3265</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_variable" href="classMCMCProcessor.html#af3a19b885e9c34e1674aea8cfbe14e1c">nEntries</a>; ++i) {</div>
<div class="line"><span class="lineno"> 3266</span>    <a class="code hl_variable" href="classMCMCProcessor.html#a28e89498420221149ec97c353c430bf8">SampleValues</a>[i] = <span class="keyword">new</span> <span class="keywordtype">double</span>[<a class="code hl_variable" href="classMCMCProcessor.html#a419d3669dbb54a55a635e35691134cc1">nSamples</a>]();</div>
<div class="line"><span class="lineno"> 3267</span>    <a class="code hl_variable" href="classMCMCProcessor.html#a4eb2748c81b0aef9bd7e14785559e301">SystValues</a>[i] = <span class="keyword">new</span> <span class="keywordtype">double</span>[<a class="code hl_variable" href="classMCMCProcessor.html#adf518be96278f1d3901404cfbe767b67">nSysts</a>]();</div>
<div class="line"><span class="lineno"> 3268</span> </div>
<div class="line"><span class="lineno"> 3269</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a class="code hl_variable" href="classMCMCProcessor.html#a419d3669dbb54a55a635e35691134cc1">nSamples</a>; ++j) {</div>
<div class="line"><span class="lineno"> 3270</span>      <a class="code hl_variable" href="classMCMCProcessor.html#a28e89498420221149ec97c353c430bf8">SampleValues</a>[i][j] = -999.99;</div>
<div class="line"><span class="lineno"> 3271</span>    }</div>
<div class="line"><span class="lineno"> 3272</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a class="code hl_variable" href="classMCMCProcessor.html#adf518be96278f1d3901404cfbe767b67">nSysts</a>; ++j) {</div>
<div class="line"><span class="lineno"> 3273</span>      <a class="code hl_variable" href="classMCMCProcessor.html#a4eb2748c81b0aef9bd7e14785559e301">SystValues</a>[i][j] = -999.99;</div>
<div class="line"><span class="lineno"> 3274</span>    }</div>
<div class="line"><span class="lineno"> 3275</span>    <a class="code hl_variable" href="classMCMCProcessor.html#a88cab29770fd6098a674a0ab3628a251">AccProbValues</a>[i] = -999.99;</div>
<div class="line"><span class="lineno"> 3276</span> </div>
<div class="line"><span class="lineno"> 3277</span>    <a class="code hl_variable" href="classMCMCProcessor.html#a07549f3b67ca5409218d80c679f6e69e">StepNumber</a>[i] = -999.99;</div>
<div class="line"><span class="lineno"> 3278</span>  }</div>
<div class="line"><span class="lineno"> 3279</span> </div>
<div class="line"><span class="lineno"> 3280</span>  <span class="comment">// Initialise the sums</span></div>
<div class="line"><span class="lineno"> 3281</span>  <a class="code hl_variable" href="classMCMCProcessor.html#a7db98c7cf390b050f1acb927b4f55cab">ParamSums</a> = <span class="keyword">new</span> <span class="keywordtype">double</span>[<a class="code hl_variable" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>]();</div>
<div class="line"><span class="lineno"> 3282</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_variable" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>; ++i) {</div>
<div class="line"><span class="lineno"> 3283</span>    <a class="code hl_variable" href="classMCMCProcessor.html#a7db98c7cf390b050f1acb927b4f55cab">ParamSums</a>[i] = 0.0;</div>
<div class="line"><span class="lineno"> 3284</span>  }</div>
<div class="line"><span class="lineno"> 3285</span>  <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Reading input tree...&quot;</span>);</div>
<div class="line"><span class="lineno"> 3286</span>  TStopwatch clock;</div>
<div class="line"><span class="lineno"> 3287</span>  clock.Start();</div>
<div class="line"><span class="lineno"> 3288</span> </div>
<div class="line"><span class="lineno"> 3289</span>  <span class="comment">// Set all the branches to off</span></div>
<div class="line"><span class="lineno"> 3290</span>  <a class="code hl_variable" href="classMCMCProcessor.html#a6be3bbebd4a79fe9814a3da09b3bb820">Chain</a>-&gt;SetBranchStatus(<span class="stringliteral">&quot;*&quot;</span>, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno"> 3291</span> </div>
<div class="line"><span class="lineno"> 3292</span>  <span class="comment">// Turn on the branches which we want for parameters</span></div>
<div class="line"><span class="lineno"> 3293</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_variable" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>; ++i) {</div>
<div class="line"><span class="lineno"> 3294</span>    <a class="code hl_variable" href="classMCMCProcessor.html#a6be3bbebd4a79fe9814a3da09b3bb820">Chain</a>-&gt;SetBranchStatus(<a class="code hl_variable" href="classMCMCProcessor.html#ad043b6b2c885f47ab9967831bc8d0f5a">BranchNames</a>[i].Data(), <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno"> 3295</span>  }</div>
<div class="line"><span class="lineno"> 3296</span>  </div>
<div class="line"><span class="lineno"> 3297</span>  <span class="comment">// Turn on the branches which we want for LogL sample</span></div>
<div class="line"><span class="lineno"> 3298</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_variable" href="classMCMCProcessor.html#a419d3669dbb54a55a635e35691134cc1">nSamples</a>; ++i) {</div>
<div class="line"><span class="lineno"> 3299</span>    <a class="code hl_variable" href="classMCMCProcessor.html#a6be3bbebd4a79fe9814a3da09b3bb820">Chain</a>-&gt;SetBranchStatus(<a class="code hl_variable" href="classMCMCProcessor.html#a3660e404a6631cfa913a815481730a9b">SampleName_v</a>[i].Data(), <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno"> 3300</span>  }</div>
<div class="line"><span class="lineno"> 3301</span> </div>
<div class="line"><span class="lineno"> 3302</span>  <span class="comment">// Turn on the branches which we want for LogL systs</span></div>
<div class="line"><span class="lineno"> 3303</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_variable" href="classMCMCProcessor.html#adf518be96278f1d3901404cfbe767b67">nSysts</a>; ++i) {</div>
<div class="line"><span class="lineno"> 3304</span>    <a class="code hl_variable" href="classMCMCProcessor.html#a6be3bbebd4a79fe9814a3da09b3bb820">Chain</a>-&gt;SetBranchStatus(<a class="code hl_variable" href="classMCMCProcessor.html#acb1871575fdd3ae156aed4bf7c7a0a73">SystName_v</a>[i].Data(), <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno"> 3305</span>  }</div>
<div class="line"><span class="lineno"> 3306</span> </div>
<div class="line"><span class="lineno"> 3307</span>  <span class="comment">// Turn on the branches which we want for acc prob</span></div>
<div class="line"><span class="lineno"> 3308</span>  <a class="code hl_variable" href="classMCMCProcessor.html#a6be3bbebd4a79fe9814a3da09b3bb820">Chain</a>-&gt;SetBranchStatus(<span class="stringliteral">&quot;accProb&quot;</span>, <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno"> 3309</span>  </div>
<div class="line"><span class="lineno"> 3310</span>  <span class="comment">// Only needed for Geweke right now</span></div>
<div class="line"><span class="lineno"> 3311</span>  <a class="code hl_variable" href="classMCMCProcessor.html#a6be3bbebd4a79fe9814a3da09b3bb820">Chain</a>-&gt;SetBranchStatus(<span class="stringliteral">&quot;step&quot;</span>, <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno"> 3312</span> </div>
<div class="line"><span class="lineno"> 3313</span>  <span class="comment">// 10 entries output</span></div>
<div class="line"><span class="lineno"> 3314</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> countwidth = <a class="code hl_variable" href="classMCMCProcessor.html#af3a19b885e9c34e1674aea8cfbe14e1c">nEntries</a>/10;</div>
<div class="line"><span class="lineno"> 3315</span> </div>
<div class="line"><span class="lineno"> 3316</span>  <span class="comment">// Can also do the batched means here to minimize excessive loops</span></div>
<div class="line"><span class="lineno"> 3317</span>  <span class="comment">// The length of each batch</span></div>
<div class="line"><span class="lineno"> 3318</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> BatchLength = <a class="code hl_variable" href="classMCMCProcessor.html#af3a19b885e9c34e1674aea8cfbe14e1c">nEntries</a>/<a class="code hl_variable" href="classMCMCProcessor.html#a02c5a3f849cf217705816c650c678d19">nBatches</a>+1;</div>
<div class="line"><span class="lineno"> 3319</span>  <a class="code hl_variable" href="classMCMCProcessor.html#ab3f590b501162fc2ee5b78ce75689771">BatchedAverages</a> = <span class="keyword">new</span> <span class="keywordtype">double</span>*[<a class="code hl_variable" href="classMCMCProcessor.html#a02c5a3f849cf217705816c650c678d19">nBatches</a>]();</div>
<div class="line"><span class="lineno"> 3320</span>  <a class="code hl_variable" href="classMCMCProcessor.html#a523a223a4754c133121796f4591c7be3">AccProbBatchedAverages</a> = <span class="keyword">new</span> <span class="keywordtype">double</span>[<a class="code hl_variable" href="classMCMCProcessor.html#a02c5a3f849cf217705816c650c678d19">nBatches</a>]();</div>
<div class="line"><span class="lineno"> 3321</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_variable" href="classMCMCProcessor.html#a02c5a3f849cf217705816c650c678d19">nBatches</a>; ++i) {</div>
<div class="line"><span class="lineno"> 3322</span>    <a class="code hl_variable" href="classMCMCProcessor.html#ab3f590b501162fc2ee5b78ce75689771">BatchedAverages</a>[i] = <span class="keyword">new</span> <span class="keywordtype">double</span>[<a class="code hl_variable" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>];</div>
<div class="line"><span class="lineno"> 3323</span>    <a class="code hl_variable" href="classMCMCProcessor.html#a523a223a4754c133121796f4591c7be3">AccProbBatchedAverages</a>[i] = 0;</div>
<div class="line"><span class="lineno"> 3324</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a class="code hl_variable" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>; ++j) {</div>
<div class="line"><span class="lineno"> 3325</span>      <a class="code hl_variable" href="classMCMCProcessor.html#ab3f590b501162fc2ee5b78ce75689771">BatchedAverages</a>[i][j] = 0.0;</div>
<div class="line"><span class="lineno"> 3326</span>    }</div>
<div class="line"><span class="lineno"> 3327</span>  }</div>
<div class="line"><span class="lineno"> 3328</span> </div>
<div class="line"><span class="lineno"> 3329</span>  <span class="comment">// Loop over the entries</span></div>
<div class="line"><span class="lineno"> 3330</span>  <span class="comment">//KS: This is really a bottleneck right now, thus revisit with ROOT6 https://pep-root6.github.io/docs/analysis/parallell/root.html</span></div>
<div class="line"><span class="lineno"> 3331</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_variable" href="classMCMCProcessor.html#af3a19b885e9c34e1674aea8cfbe14e1c">nEntries</a>; ++i) {</div>
<div class="line"><span class="lineno"> 3332</span> </div>
<div class="line"><span class="lineno"> 3333</span>    <span class="keywordflow">if</span> (i % countwidth == 0)</div>
<div class="line"><span class="lineno"> 3334</span>      <a class="code hl_function" href="namespaceMaCh3Utils.html#a4c8bdeb1d34606aed192e9f1311a72f5">MaCh3Utils::PrintProgressBar</a>(i, <a class="code hl_variable" href="classMCMCProcessor.html#af3a19b885e9c34e1674aea8cfbe14e1c">nEntries</a>);</div>
<div class="line"><span class="lineno"> 3335</span> </div>
<div class="line"><span class="lineno"> 3336</span>    <span class="comment">// Set the branch addresses for params</span></div>
<div class="line"><span class="lineno"> 3337</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a class="code hl_variable" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>; ++j) {</div>
<div class="line"><span class="lineno"> 3338</span>      <a class="code hl_variable" href="classMCMCProcessor.html#a6be3bbebd4a79fe9814a3da09b3bb820">Chain</a>-&gt;SetBranchAddress(<a class="code hl_variable" href="classMCMCProcessor.html#ad043b6b2c885f47ab9967831bc8d0f5a">BranchNames</a>[j].Data(), &amp;<a class="code hl_variable" href="classMCMCProcessor.html#a087dca88a306acdc28afea7213e3623c">ParStep</a>[j][i]);</div>
<div class="line"><span class="lineno"> 3339</span>    }</div>
<div class="line"><span class="lineno"> 3340</span> </div>
<div class="line"><span class="lineno"> 3341</span>    <span class="comment">// Set the branch addresses for samples</span></div>
<div class="line"><span class="lineno"> 3342</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a class="code hl_variable" href="classMCMCProcessor.html#a419d3669dbb54a55a635e35691134cc1">nSamples</a>; ++j) {</div>
<div class="line"><span class="lineno"> 3343</span>      <a class="code hl_variable" href="classMCMCProcessor.html#a6be3bbebd4a79fe9814a3da09b3bb820">Chain</a>-&gt;SetBranchAddress(<a class="code hl_variable" href="classMCMCProcessor.html#a3660e404a6631cfa913a815481730a9b">SampleName_v</a>[j].Data(), &amp;<a class="code hl_variable" href="classMCMCProcessor.html#a28e89498420221149ec97c353c430bf8">SampleValues</a>[i][j]);</div>
<div class="line"><span class="lineno"> 3344</span>    }</div>
<div class="line"><span class="lineno"> 3345</span> </div>
<div class="line"><span class="lineno"> 3346</span>    <span class="comment">// Set the branch addresses for systematics</span></div>
<div class="line"><span class="lineno"> 3347</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a class="code hl_variable" href="classMCMCProcessor.html#adf518be96278f1d3901404cfbe767b67">nSysts</a>; ++j) {</div>
<div class="line"><span class="lineno"> 3348</span>      <a class="code hl_variable" href="classMCMCProcessor.html#a6be3bbebd4a79fe9814a3da09b3bb820">Chain</a>-&gt;SetBranchAddress(<a class="code hl_variable" href="classMCMCProcessor.html#acb1871575fdd3ae156aed4bf7c7a0a73">SystName_v</a>[j].Data(), &amp;<a class="code hl_variable" href="classMCMCProcessor.html#a4eb2748c81b0aef9bd7e14785559e301">SystValues</a>[i][j]);</div>
<div class="line"><span class="lineno"> 3349</span>    }</div>
<div class="line"><span class="lineno"> 3350</span>      </div>
<div class="line"><span class="lineno"> 3351</span>    <span class="comment">// Set the branch addresses for Acceptance Probability</span></div>
<div class="line"><span class="lineno"> 3352</span>    <a class="code hl_variable" href="classMCMCProcessor.html#a6be3bbebd4a79fe9814a3da09b3bb820">Chain</a>-&gt;SetBranchAddress(<span class="stringliteral">&quot;accProb&quot;</span>, &amp;<a class="code hl_variable" href="classMCMCProcessor.html#a88cab29770fd6098a674a0ab3628a251">AccProbValues</a>[i]);</div>
<div class="line"><span class="lineno"> 3353</span> </div>
<div class="line"><span class="lineno"> 3354</span>    <a class="code hl_variable" href="classMCMCProcessor.html#a6be3bbebd4a79fe9814a3da09b3bb820">Chain</a>-&gt;SetBranchAddress(<span class="stringliteral">&quot;step&quot;</span>, &amp;<a class="code hl_variable" href="classMCMCProcessor.html#a07549f3b67ca5409218d80c679f6e69e">StepNumber</a>[i]);</div>
<div class="line"><span class="lineno"> 3355</span> </div>
<div class="line"><span class="lineno"> 3356</span>    <span class="comment">// Fill up the arrays</span></div>
<div class="line"><span class="lineno"> 3357</span>    <a class="code hl_variable" href="classMCMCProcessor.html#a6be3bbebd4a79fe9814a3da09b3bb820">Chain</a>-&gt;GetEntry(i);</div>
<div class="line"><span class="lineno"> 3358</span> </div>
<div class="line"><span class="lineno"> 3359</span>    <span class="comment">// Find which batch the event belongs in</span></div>
<div class="line"><span class="lineno"> 3360</span>    <span class="keywordtype">int</span> BatchNumber = -1;</div>
<div class="line"><span class="lineno"> 3361</span>    <span class="comment">// I&#39;m so lazy! But it&#39;s OK, the major overhead here is GetEntry: saved by ROOT!</span></div>
<div class="line"><span class="lineno"> 3362</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a class="code hl_variable" href="classMCMCProcessor.html#a02c5a3f849cf217705816c650c678d19">nBatches</a>; ++j) {</div>
<div class="line"><span class="lineno"> 3363</span>      <span class="keywordflow">if</span> (i &lt; (j+1)*BatchLength) {</div>
<div class="line"><span class="lineno"> 3364</span>        BatchNumber = j;</div>
<div class="line"><span class="lineno"> 3365</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 3366</span>      }</div>
<div class="line"><span class="lineno"> 3367</span>    }</div>
<div class="line"><span class="lineno"> 3368</span> </div>
<div class="line"><span class="lineno"> 3369</span>    <span class="comment">// Fill up the sum for each j param</span></div>
<div class="line"><span class="lineno"> 3370</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a class="code hl_variable" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>; ++j) {</div>
<div class="line"><span class="lineno"> 3371</span>      <a class="code hl_variable" href="classMCMCProcessor.html#a7db98c7cf390b050f1acb927b4f55cab">ParamSums</a>[j] += <a class="code hl_variable" href="classMCMCProcessor.html#a087dca88a306acdc28afea7213e3623c">ParStep</a>[j][i];</div>
<div class="line"><span class="lineno"> 3372</span>      <a class="code hl_variable" href="classMCMCProcessor.html#ab3f590b501162fc2ee5b78ce75689771">BatchedAverages</a>[BatchNumber][j] += <a class="code hl_variable" href="classMCMCProcessor.html#a087dca88a306acdc28afea7213e3623c">ParStep</a>[j][i];</div>
<div class="line"><span class="lineno"> 3373</span>    }</div>
<div class="line"><span class="lineno"> 3374</span>    </div>
<div class="line"><span class="lineno"> 3375</span>    <span class="comment">//KS: Could easily add this to above loop but I accProb is different beast so better keep it like this</span></div>
<div class="line"><span class="lineno"> 3376</span>    <a class="code hl_variable" href="classMCMCProcessor.html#a523a223a4754c133121796f4591c7be3">AccProbBatchedAverages</a>[BatchNumber] += <a class="code hl_variable" href="classMCMCProcessor.html#a88cab29770fd6098a674a0ab3628a251">AccProbValues</a>[i];</div>
<div class="line"><span class="lineno"> 3377</span>  }</div>
<div class="line"><span class="lineno"> 3378</span> </div>
<div class="line"><span class="lineno"> 3379</span>  clock.Stop();</div>
<div class="line"><span class="lineno"> 3380</span>  <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Took {:.2f}s to finish caching statistic for Diag MCMC with {} steps&quot;</span>, clock.RealTime(), <a class="code hl_variable" href="classMCMCProcessor.html#af3a19b885e9c34e1674aea8cfbe14e1c">nEntries</a>);</div>
<div class="line"><span class="lineno"> 3381</span> </div>
<div class="line"><span class="lineno"> 3382</span>  <span class="comment">// Make the sums into average</span></div>
<div class="line"><span class="lineno"> 3383</span><span class="preprocessor">  #ifdef MULTITHREAD</span></div>
<div class="line"><span class="lineno"> 3384</span><span class="preprocessor">  #pragma omp parallel for</span></div>
<div class="line"><span class="lineno"> 3385</span><span class="preprocessor">  #endif</span></div>
<div class="line"><span class="lineno"> 3386</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_variable" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>; ++i) {</div>
<div class="line"><span class="lineno"> 3387</span>    <a class="code hl_variable" href="classMCMCProcessor.html#a7db98c7cf390b050f1acb927b4f55cab">ParamSums</a>[i] /= double(<a class="code hl_variable" href="classMCMCProcessor.html#af3a19b885e9c34e1674aea8cfbe14e1c">nEntries</a>);</div>
<div class="line"><span class="lineno"> 3388</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a class="code hl_variable" href="classMCMCProcessor.html#a02c5a3f849cf217705816c650c678d19">nBatches</a>; ++j) {</div>
<div class="line"><span class="lineno"> 3389</span>      <span class="comment">// Divide by the total number of events in the batch</span></div>
<div class="line"><span class="lineno"> 3390</span>      <a class="code hl_variable" href="classMCMCProcessor.html#ab3f590b501162fc2ee5b78ce75689771">BatchedAverages</a>[j][i] /= BatchLength;</div>
<div class="line"><span class="lineno"> 3391</span>      <span class="keywordflow">if</span>(i == 0) <a class="code hl_variable" href="classMCMCProcessor.html#a523a223a4754c133121796f4591c7be3">AccProbBatchedAverages</a>[j] /= BatchLength; <span class="comment">//KS: we have only one accProb, keep it like this for now</span></div>
<div class="line"><span class="lineno"> 3392</span>    }</div>
<div class="line"><span class="lineno"> 3393</span>  }</div>
<div class="line"><span class="lineno"> 3394</span> </div>
<div class="line"><span class="lineno"> 3395</span>  <span class="comment">// And make our sweet output file</span></div>
<div class="line"><span class="lineno"> 3396</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="classMCMCProcessor.html#a62035b99df4617ab334cd1abd6ed0346">OutputFile</a> == <span class="keyword">nullptr</span>) <a class="code hl_function" href="classMCMCProcessor.html#aa5a7761e97cf2e24c7d877a5374b7333">MakeOutputFile</a>();</div>
<div class="line"><span class="lineno"> 3397</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ae5ea421c8dd77ceac2e748008633b573" name="ae5ea421c8dd77ceac2e748008633b573"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae5ea421c8dd77ceac2e748008633b573">&#9670;&#160;</a></span>ReadFDFile()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void MCMCProcessor::ReadFDFile </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Read the FD cov file and get the input central values and errors. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8cpp_source.html#l02584">2584</a> of file <a class="el" href="MCMCProcessor_8cpp_source.html">MCMCProcessor.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2584</span>                               {</div>
<div class="line"><span class="lineno"> 2585</span><span class="comment">// ***************</span></div>
<div class="line"><span class="lineno"> 2586</span>  <span class="comment">// Do the same for the FD</span></div>
<div class="line"><span class="lineno"> 2587</span>  TFile *FDdetFile = <span class="keyword">new</span> TFile(<a class="code hl_variable" href="classMCMCProcessor.html#a7c6afb0ed75207fd02c28e408f0592d4">CovPos</a>[<a class="code hl_enumvalue" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20bad7032c60390bd4bb843950e9a7afcdae">kFDDetPar</a>].back().c_str(), <span class="stringliteral">&quot;open&quot;</span>);</div>
<div class="line"><span class="lineno"> 2588</span>  <span class="keywordflow">if</span> (FDdetFile-&gt;IsZombie()) {</div>
<div class="line"><span class="lineno"> 2589</span>    <a class="code hl_define" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Couldn&#39;t find NDdetFile {}&quot;</span>, <a class="code hl_variable" href="classMCMCProcessor.html#a7c6afb0ed75207fd02c28e408f0592d4">CovPos</a>[<a class="code hl_enumvalue" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20bad7032c60390bd4bb843950e9a7afcdae">kFDDetPar</a>].back());</div>
<div class="line"><span class="lineno"> 2590</span>    <span class="keywordflow">throw</span> <a class="code hl_class" href="classMaCh3Exception.html">MaCh3Exception</a>(__FILE__ , __LINE__ );</div>
<div class="line"><span class="lineno"> 2591</span>  }</div>
<div class="line"><span class="lineno"> 2592</span>  FDdetFile-&gt;cd();</div>
<div class="line"><span class="lineno"> 2593</span> </div>
<div class="line"><span class="lineno"> 2594</span>  TMatrixDSym *FDdetMatrix = FDdetFile-&gt;Get&lt;TMatrixDSym&gt;(<span class="stringliteral">&quot;SKJointError_Erec_Total&quot;</span>);</div>
<div class="line"><span class="lineno"> 2595</span> </div>
<div class="line"><span class="lineno"> 2596</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; FDdetMatrix-&gt;GetNrows(); ++i)</div>
<div class="line"><span class="lineno"> 2597</span>  {</div>
<div class="line"><span class="lineno"> 2598</span>    <span class="comment">//KS: FD parameters start at 1. in contrary to ND280</span></div>
<div class="line"><span class="lineno"> 2599</span>    <a class="code hl_variable" href="classMCMCProcessor.html#a4c4c6aa4827a2fe54ce37defbb3d0475">ParamNom</a>[<a class="code hl_enumvalue" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20bad7032c60390bd4bb843950e9a7afcdae">kFDDetPar</a>].push_back(1.);</div>
<div class="line"><span class="lineno"> 2600</span>    <a class="code hl_variable" href="classMCMCProcessor.html#a3a6614826ae320e462211e38e96d9d02">ParamCentral</a>[<a class="code hl_enumvalue" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20bad7032c60390bd4bb843950e9a7afcdae">kFDDetPar</a>].push_back(1.);</div>
<div class="line"><span class="lineno"> 2601</span> </div>
<div class="line"><span class="lineno"> 2602</span>    <a class="code hl_variable" href="classMCMCProcessor.html#a3a97e3cb4be3ceb9eb721eac51d82d60">ParamErrors</a>[<a class="code hl_enumvalue" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20bad7032c60390bd4bb843950e9a7afcdae">kFDDetPar</a>].push_back( std::sqrt((*FDdetMatrix)(i,i)) );</div>
<div class="line"><span class="lineno"> 2603</span>    <a class="code hl_variable" href="classMCMCProcessor.html#adecc55689f7d37b9412f8886fe3480dc">ParamNames</a>[<a class="code hl_enumvalue" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20bad7032c60390bd4bb843950e9a7afcdae">kFDDetPar</a>].push_back( Form(<span class="stringliteral">&quot;FD Det %i&quot;</span>, i) );</div>
<div class="line"><span class="lineno"> 2604</span> </div>
<div class="line"><span class="lineno"> 2605</span>    <span class="comment">//KS: Currently we can only set it via config, change it in future</span></div>
<div class="line"><span class="lineno"> 2606</span>    <a class="code hl_variable" href="classMCMCProcessor.html#a4be1eedb743e4ea410009a4fa45720f7">ParamFlat</a>[<a class="code hl_enumvalue" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20bad7032c60390bd4bb843950e9a7afcdae">kFDDetPar</a>].push_back( <span class="keyword">false</span> );</div>
<div class="line"><span class="lineno"> 2607</span>  }</div>
<div class="line"><span class="lineno"> 2608</span>  <span class="comment">//KS: The last parameter is p scale</span></div>
<div class="line"><span class="lineno"> 2609</span>  <span class="keywordflow">if</span>(<a class="code hl_variable" href="classMCMCProcessor.html#ad25fe818c94163b0c4a8fcdfd387c148">FancyPlotNames</a>) <a class="code hl_variable" href="classMCMCProcessor.html#adecc55689f7d37b9412f8886fe3480dc">ParamNames</a>[<a class="code hl_enumvalue" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20bad7032c60390bd4bb843950e9a7afcdae">kFDDetPar</a>].back() = <span class="stringliteral">&quot;Momentum Scale&quot;</span>;</div>
<div class="line"><span class="lineno"> 2610</span> </div>
<div class="line"><span class="lineno"> 2611</span>  FDdetFile-&gt;Close();</div>
<div class="line"><span class="lineno"> 2612</span>  <span class="keyword">delete</span> FDdetFile;</div>
<div class="line"><span class="lineno"> 2613</span>  <span class="keyword">delete</span> FDdetMatrix;</div>
<div class="line"><span class="lineno"> 2614</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="afef48d4fccf7551dc1845f8f6c08864f" name="afef48d4fccf7551dc1845f8f6c08864f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afef48d4fccf7551dc1845f8f6c08864f">&#9670;&#160;</a></span>ReadInputCov()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void MCMCProcessor::ReadInputCov </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>CW: Read the input Covariance matrix entries. Get stuff like parameter input errors, names, and so on. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8cpp_source.html#l02384">2384</a> of file <a class="el" href="MCMCProcessor_8cpp_source.html">MCMCProcessor.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2384</span>                                 {</div>
<div class="line"><span class="lineno"> 2385</span><span class="comment">// **************************</span></div>
<div class="line"><span class="lineno"> 2386</span>  <a class="code hl_function" href="classMCMCProcessor.html#aea15e730ff77556bb93bc4cff675744c">FindInputFiles</a>();</div>
<div class="line"><span class="lineno"> 2387</span>  <span class="keywordflow">if</span>(<a class="code hl_variable" href="classMCMCProcessor.html#a4200e7cbe1c8f811d3640ebfd648ca85">nParam</a>[<a class="code hl_enumvalue" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20ba7386f5611ea4d01b85b9bb92a5ca335f">kXSecPar</a>] &gt; 0)  <a class="code hl_function" href="classMCMCProcessor.html#a2b0b4afbf45adb93357abe96d108170b">ReadXSecFile</a>();</div>
<div class="line"><span class="lineno"> 2388</span>  <span class="keywordflow">if</span>(<a class="code hl_variable" href="classMCMCProcessor.html#a4200e7cbe1c8f811d3640ebfd648ca85">nParam</a>[<a class="code hl_enumvalue" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20ba4ac215e1a6cd9e776ec0a230f62a0bb4">kNDPar</a>] &gt; 0) <a class="code hl_function" href="classMCMCProcessor.html#a66dd0f1f88dbeb2b6a1976d42f77e136">ReadNDFile</a>();</div>
<div class="line"><span class="lineno"> 2389</span>  <span class="keywordflow">if</span>(<a class="code hl_variable" href="classMCMCProcessor.html#a4200e7cbe1c8f811d3640ebfd648ca85">nParam</a>[<a class="code hl_enumvalue" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20bad7032c60390bd4bb843950e9a7afcdae">kFDDetPar</a>] &gt; 0) <a class="code hl_function" href="classMCMCProcessor.html#ae5ea421c8dd77ceac2e748008633b573">ReadFDFile</a>();</div>
<div class="line"><span class="lineno"> 2390</span>  <span class="keywordflow">if</span>(<a class="code hl_variable" href="classMCMCProcessor.html#a4200e7cbe1c8f811d3640ebfd648ca85">nParam</a>[<a class="code hl_enumvalue" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20ba03865cac80b3eb8f5ef46421eb8dab06">kOSCPar</a>] &gt; 0)   <a class="code hl_function" href="classMCMCProcessor.html#a3733b3b753c73f79e6846bc92c4da11b">ReadOSCFile</a>();</div>
<div class="line"><span class="lineno"> 2391</span>  <span class="comment">//KS: Remove parameters which were removed</span></div>
<div class="line"><span class="lineno"> 2392</span>  <a class="code hl_function" href="classMCMCProcessor.html#a9a29c1cb64589ac136f7f927cafa18aa">RemoveParameters</a>();</div>
<div class="line"><span class="lineno"> 2393</span>}</div>
<div class="ttc" id="aclassMCMCProcessor_html_a2b0b4afbf45adb93357abe96d108170b"><div class="ttname"><a href="classMCMCProcessor.html#a2b0b4afbf45adb93357abe96d108170b">MCMCProcessor::ReadXSecFile</a></div><div class="ttdeci">void ReadXSecFile()</div><div class="ttdoc">Read the xsec file and get the input central values and errors.</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8cpp_source.html#l02494">MCMCProcessor.cpp:2494</a></div></div>
<div class="ttc" id="aclassMCMCProcessor_html_a3733b3b753c73f79e6846bc92c4da11b"><div class="ttname"><a href="classMCMCProcessor.html#a3733b3b753c73f79e6846bc92c4da11b">MCMCProcessor::ReadOSCFile</a></div><div class="ttdeci">void ReadOSCFile()</div><div class="ttdoc">Read the Osc cov file and get the input central values and errors.</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8cpp_source.html#l02618">MCMCProcessor.cpp:2618</a></div></div>
<div class="ttc" id="aclassMCMCProcessor_html_a66dd0f1f88dbeb2b6a1976d42f77e136"><div class="ttname"><a href="classMCMCProcessor.html#a66dd0f1f88dbeb2b6a1976d42f77e136">MCMCProcessor::ReadNDFile</a></div><div class="ttdeci">void ReadNDFile()</div><div class="ttdoc">Read the ND cov file and get the input central values and errors.</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8cpp_source.html#l02541">MCMCProcessor.cpp:2541</a></div></div>
<div class="ttc" id="aclassMCMCProcessor_html_a9a29c1cb64589ac136f7f927cafa18aa"><div class="ttname"><a href="classMCMCProcessor.html#a9a29c1cb64589ac136f7f927cafa18aa">MCMCProcessor::RemoveParameters</a></div><div class="ttdeci">void RemoveParameters()</div><div class="ttdoc">Remove parameter specified in config.</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8cpp_source.html#l02661">MCMCProcessor.cpp:2661</a></div></div>
<div class="ttc" id="aclassMCMCProcessor_html_ae5ea421c8dd77ceac2e748008633b573"><div class="ttname"><a href="classMCMCProcessor.html#ae5ea421c8dd77ceac2e748008633b573">MCMCProcessor::ReadFDFile</a></div><div class="ttdeci">void ReadFDFile()</div><div class="ttdoc">Read the FD cov file and get the input central values and errors.</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8cpp_source.html#l02584">MCMCProcessor.cpp:2584</a></div></div>
<div class="ttc" id="aclassMCMCProcessor_html_aea15e730ff77556bb93bc4cff675744c"><div class="ttname"><a href="classMCMCProcessor.html#aea15e730ff77556bb93bc4cff675744c">MCMCProcessor::FindInputFiles</a></div><div class="ttdeci">void FindInputFiles()</div><div class="ttdoc">Read the output MCMC file and find what inputs were used.</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8cpp_source.html#l02397">MCMCProcessor.cpp:2397</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a66dd0f1f88dbeb2b6a1976d42f77e136" name="a66dd0f1f88dbeb2b6a1976d42f77e136"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a66dd0f1f88dbeb2b6a1976d42f77e136">&#9670;&#160;</a></span>ReadNDFile()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void MCMCProcessor::ReadNDFile </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Read the ND cov file and get the input central values and errors. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8cpp_source.html#l02541">2541</a> of file <a class="el" href="MCMCProcessor_8cpp_source.html">MCMCProcessor.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2541</span>                               {</div>
<div class="line"><span class="lineno"> 2542</span><span class="comment">// ***************</span></div>
<div class="line"><span class="lineno"> 2543</span>  <span class="comment">// Do the same for the ND280</span></div>
<div class="line"><span class="lineno"> 2544</span>  TFile *NDdetFile = <span class="keyword">new</span> TFile(<a class="code hl_variable" href="classMCMCProcessor.html#a7c6afb0ed75207fd02c28e408f0592d4">CovPos</a>[<a class="code hl_enumvalue" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20ba4ac215e1a6cd9e776ec0a230f62a0bb4">kNDPar</a>].back().c_str(), <span class="stringliteral">&quot;open&quot;</span>);</div>
<div class="line"><span class="lineno"> 2545</span>  <span class="keywordflow">if</span> (NDdetFile-&gt;IsZombie()) {</div>
<div class="line"><span class="lineno"> 2546</span>    <a class="code hl_define" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Couldn&#39;t find NDdetFile {}&quot;</span>, <a class="code hl_variable" href="classMCMCProcessor.html#a7c6afb0ed75207fd02c28e408f0592d4">CovPos</a>[<a class="code hl_enumvalue" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20ba4ac215e1a6cd9e776ec0a230f62a0bb4">kNDPar</a>].back());</div>
<div class="line"><span class="lineno"> 2547</span>    <span class="keywordflow">throw</span> <a class="code hl_class" href="classMaCh3Exception.html">MaCh3Exception</a>(__FILE__ , __LINE__ );</div>
<div class="line"><span class="lineno"> 2548</span>  }</div>
<div class="line"><span class="lineno"> 2549</span>  NDdetFile-&gt;cd();</div>
<div class="line"><span class="lineno"> 2550</span> </div>
<div class="line"><span class="lineno"> 2551</span>  TMatrixDSym *NDdetMatrix = NDdetFile-&gt;Get&lt;TMatrixDSym&gt;(<span class="stringliteral">&quot;nddet_cov&quot;</span>);</div>
<div class="line"><span class="lineno"> 2552</span>  TVectorD *NDdetNominal = NDdetFile-&gt;Get&lt;TVectorD&gt;(<span class="stringliteral">&quot;det_weights&quot;</span>);</div>
<div class="line"><span class="lineno"> 2553</span>  TDirectory *BinningDirectory = NDdetFile-&gt;Get&lt;TDirectory&gt;(<span class="stringliteral">&quot;Binning&quot;</span>);</div>
<div class="line"><span class="lineno"> 2554</span> </div>
<div class="line"><span class="lineno"> 2555</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; NDdetNominal-&gt;GetNrows(); ++i)</div>
<div class="line"><span class="lineno"> 2556</span>  {</div>
<div class="line"><span class="lineno"> 2557</span>    <a class="code hl_variable" href="classMCMCProcessor.html#a4c4c6aa4827a2fe54ce37defbb3d0475">ParamNom</a>[<a class="code hl_enumvalue" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20ba4ac215e1a6cd9e776ec0a230f62a0bb4">kNDPar</a>].push_back( (*NDdetNominal)(i) );</div>
<div class="line"><span class="lineno"> 2558</span>    <a class="code hl_variable" href="classMCMCProcessor.html#a3a6614826ae320e462211e38e96d9d02">ParamCentral</a>[<a class="code hl_enumvalue" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20ba4ac215e1a6cd9e776ec0a230f62a0bb4">kNDPar</a>].push_back( (*NDdetNominal)(i) );</div>
<div class="line"><span class="lineno"> 2559</span> </div>
<div class="line"><span class="lineno"> 2560</span>    <a class="code hl_variable" href="classMCMCProcessor.html#a3a97e3cb4be3ceb9eb721eac51d82d60">ParamErrors</a>[<a class="code hl_enumvalue" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20ba4ac215e1a6cd9e776ec0a230f62a0bb4">kNDPar</a>].push_back( std::sqrt((*NDdetMatrix)(i,i)) );</div>
<div class="line"><span class="lineno"> 2561</span>    <a class="code hl_variable" href="classMCMCProcessor.html#adecc55689f7d37b9412f8886fe3480dc">ParamNames</a>[<a class="code hl_enumvalue" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20ba4ac215e1a6cd9e776ec0a230f62a0bb4">kNDPar</a>].push_back( Form(<span class="stringliteral">&quot;ND Det %i&quot;</span>, i) );</div>
<div class="line"><span class="lineno"> 2562</span>    <span class="comment">//KS: Currently we can only set it via config, change it in future</span></div>
<div class="line"><span class="lineno"> 2563</span>    <a class="code hl_variable" href="classMCMCProcessor.html#a4be1eedb743e4ea410009a4fa45720f7">ParamFlat</a>[<a class="code hl_enumvalue" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20ba4ac215e1a6cd9e776ec0a230f62a0bb4">kNDPar</a>].push_back( <span class="keyword">false</span> );</div>
<div class="line"><span class="lineno"> 2564</span>  }</div>
<div class="line"><span class="lineno"> 2565</span> </div>
<div class="line"><span class="lineno"> 2566</span>  TIter next(BinningDirectory-&gt;GetListOfKeys());</div>
<div class="line"><span class="lineno"> 2567</span>  TKey *key = <span class="keyword">nullptr</span>;</div>
<div class="line"><span class="lineno"> 2568</span>  <span class="comment">// Loop through all entries</span></div>
<div class="line"><span class="lineno"> 2569</span>  <span class="keywordflow">while</span> ((key = <span class="keyword">static_cast&lt;</span>TKey*<span class="keyword">&gt;</span>(next())))</div>
<div class="line"><span class="lineno"> 2570</span>  {</div>
<div class="line"><span class="lineno"> 2571</span>    std::string name = std::string(key-&gt;GetName());</div>
<div class="line"><span class="lineno"> 2572</span>    TH2Poly* RefPoly = BinningDirectory-&gt;Get&lt;TH2Poly&gt;((name).c_str());</div>
<div class="line"><span class="lineno"> 2573</span>    <span class="keywordtype">int</span> <a class="code hl_variable" href="GetPenaltyTerm_8cpp.html#a439227feff9d7f55384e8780cfc2eb82">size</a> = RefPoly-&gt;GetNumberOfBins();</div>
<div class="line"><span class="lineno"> 2574</span>    <a class="code hl_variable" href="classMCMCProcessor.html#ae76b02ce85737d30c778698ba127933b">NDSamplesBins</a>.push_back(<a class="code hl_variable" href="GetPenaltyTerm_8cpp.html#a439227feff9d7f55384e8780cfc2eb82">size</a>);</div>
<div class="line"><span class="lineno"> 2575</span>    <a class="code hl_variable" href="classMCMCProcessor.html#a27c8a25155baab660fc9658861c433ab">NDSamplesNames</a>.push_back(RefPoly-&gt;GetTitle());</div>
<div class="line"><span class="lineno"> 2576</span>  }</div>
<div class="line"><span class="lineno"> 2577</span> </div>
<div class="line"><span class="lineno"> 2578</span>  NDdetFile-&gt;Close();</div>
<div class="line"><span class="lineno"> 2579</span>  <span class="keyword">delete</span> NDdetFile;</div>
<div class="line"><span class="lineno"> 2580</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a3733b3b753c73f79e6846bc92c4da11b" name="a3733b3b753c73f79e6846bc92c4da11b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3733b3b753c73f79e6846bc92c4da11b">&#9670;&#160;</a></span>ReadOSCFile()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void MCMCProcessor::ReadOSCFile </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Read the Osc cov file and get the input central values and errors. </p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000009">Todo:</a></b></dt><dd>we should actually calculate central value and prior error but leave it for now... </dd></dl>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8cpp_source.html#l02618">2618</a> of file <a class="el" href="MCMCProcessor_8cpp_source.html">MCMCProcessor.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2618</span>                                {</div>
<div class="line"><span class="lineno"> 2619</span><span class="comment">// ***************</span></div>
<div class="line"><span class="lineno"> 2620</span>  YAML::Node OscFile = <a class="code hl_variable" href="classMCMCProcessor.html#a4c1330a025c0b91e382bdc29c960424a">CovConfig</a>[<a class="code hl_enumvalue" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20ba03865cac80b3eb8f5ef46421eb8dab06">kOSCPar</a>];;</div>
<div class="line"><span class="lineno"> 2621</span> </div>
<div class="line"><span class="lineno"> 2622</span>  <span class="keyword">auto</span> systematics = OscFile[<span class="stringliteral">&quot;Systematics&quot;</span>];</div>
<div class="line"><span class="lineno"> 2623</span>  <span class="keywordtype">int</span> i = 0;</div>
<div class="line"><span class="lineno"> 2624</span>  <span class="keywordflow">for</span> (<span class="keyword">auto</span> it = systematics.begin(); it != systematics.end(); ++it, ++i)</div>
<div class="line"><span class="lineno"> 2625</span>  {</div>
<div class="line"><span class="lineno"> 2626</span>    <span class="keyword">auto</span> <span class="keyword">const</span> &amp;param = *it;</div>
<div class="line"><span class="lineno"> 2627</span> </div>
<div class="line"><span class="lineno"> 2628</span>    <span class="comment">// Push back the name</span></div>
<div class="line"><span class="lineno"> 2629</span>    std::string TempString = (param[<span class="stringliteral">&quot;Systematic&quot;</span>][<span class="stringliteral">&quot;Names&quot;</span>][<span class="stringliteral">&quot;FancyName&quot;</span>].as&lt;std::string&gt;());</div>
<div class="line"><span class="lineno"> 2630</span> </div>
<div class="line"><span class="lineno"> 2631</span>    <a class="code hl_variable" href="classMCMCProcessor.html#adecc55689f7d37b9412f8886fe3480dc">ParamNames</a>[<a class="code hl_enumvalue" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20ba03865cac80b3eb8f5ef46421eb8dab06">kOSCPar</a>].push_back(TempString);</div>
<div class="line"><span class="lineno"> 2632</span> </div>
<div class="line"><span class="lineno"> 2633</span>    <a class="code hl_variable" href="classMCMCProcessor.html#a3a6614826ae320e462211e38e96d9d02">ParamCentral</a>[<a class="code hl_enumvalue" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20ba03865cac80b3eb8f5ef46421eb8dab06">kOSCPar</a>].push_back( param[<span class="stringliteral">&quot;Systematic&quot;</span>][<span class="stringliteral">&quot;ParameterValues&quot;</span>][<span class="stringliteral">&quot;PreFitValue&quot;</span>].as&lt;double&gt;() );</div>
<div class="line"><span class="lineno"> 2634</span>    <a class="code hl_variable" href="classMCMCProcessor.html#a4c4c6aa4827a2fe54ce37defbb3d0475">ParamNom</a>[<a class="code hl_enumvalue" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20ba03865cac80b3eb8f5ef46421eb8dab06">kOSCPar</a>].push_back( param[<span class="stringliteral">&quot;Systematic&quot;</span>][<span class="stringliteral">&quot;ParameterValues&quot;</span>][<span class="stringliteral">&quot;Generated&quot;</span>].as&lt;double&gt;() );</div>
<div class="line"><span class="lineno"> 2635</span>    <a class="code hl_variable" href="classMCMCProcessor.html#a3a97e3cb4be3ceb9eb721eac51d82d60">ParamErrors</a>[<a class="code hl_enumvalue" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20ba03865cac80b3eb8f5ef46421eb8dab06">kOSCPar</a>].push_back( param[<span class="stringliteral">&quot;Systematic&quot;</span>][<span class="stringliteral">&quot;Error&quot;</span>].as&lt;double&gt;() );</div>
<div class="line"><span class="lineno"> 2636</span> </div>
<div class="line"><span class="lineno"> 2637</span>    <span class="keywordtype">bool</span> flat = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 2638</span>    <span class="keywordflow">if</span> (param[<span class="stringliteral">&quot;Systematic&quot;</span>][<span class="stringliteral">&quot;FlatPrior&quot;</span>]) { flat = param[<span class="stringliteral">&quot;Systematic&quot;</span>][<span class="stringliteral">&quot;FlatPrior&quot;</span>].as&lt;<span class="keywordtype">bool</span>&gt;(); }</div>
<div class="line"><span class="lineno"> 2639</span>    <a class="code hl_variable" href="classMCMCProcessor.html#a4be1eedb743e4ea410009a4fa45720f7">ParamFlat</a>[<a class="code hl_enumvalue" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20ba03865cac80b3eb8f5ef46421eb8dab06">kOSCPar</a>].push_back( flat );</div>
<div class="line"><span class="lineno"> 2640</span>  }</div>
<div class="line"><span class="lineno"> 2641</span>  <span class="keywordflow">if</span>(<a class="code hl_variable" href="classMCMCProcessor.html#af1392c6cff68e9f0a27e2c9a4e52cf4c">PlotJarlskog</a>)</div>
<div class="line"><span class="lineno"> 2642</span>  {</div>
<div class="line"><span class="lineno"> 2643</span>    <a class="code hl_variable" href="classMCMCProcessor.html#a6be3bbebd4a79fe9814a3da09b3bb820">Chain</a>-&gt;SetAlias(<span class="stringliteral">&quot;J_cp&quot;</span>, <span class="stringliteral">&quot;TMath::Sqrt(sin2th_13)*TMath::Sqrt(1.-sin2th_13)*TMath::Sqrt(1.-sin2th_13)*TMath::Sqrt(sin2th_12)*TMath::Sqrt(1.-sin2th_12)*TMath::Sqrt(sin2th_23)*TMath::Sqrt(1.-sin2th_23)*TMath::Sin(delta_cp)&quot;</span>);</div>
<div class="line"><span class="lineno"> 2644</span>    <a class="code hl_variable" href="classMCMCProcessor.html#ad043b6b2c885f47ab9967831bc8d0f5a">BranchNames</a>.push_back(<span class="stringliteral">&quot;J_cp&quot;</span>);</div>
<div class="line"><span class="lineno"> 2645</span>    <a class="code hl_variable" href="classMCMCProcessor.html#aaa903949bde8f1a69800c71fe1eb538e">ParamType</a>.push_back(<a class="code hl_enumvalue" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20ba03865cac80b3eb8f5ef46421eb8dab06">kOSCPar</a>);</div>
<div class="line"><span class="lineno"> 2646</span>    <a class="code hl_variable" href="classMCMCProcessor.html#a4200e7cbe1c8f811d3640ebfd648ca85">nParam</a>[<a class="code hl_enumvalue" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20ba03865cac80b3eb8f5ef46421eb8dab06">kOSCPar</a>]++;</div>
<div class="line"><span class="lineno"> 2647</span>    <a class="code hl_variable" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>++;</div>
<div class="line"><span class="lineno"> 2648</span> </div>
<div class="line"><span class="lineno"> 2650</span>    <a class="code hl_variable" href="classMCMCProcessor.html#a4c4c6aa4827a2fe54ce37defbb3d0475">ParamNom</a>[<a class="code hl_enumvalue" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20ba03865cac80b3eb8f5ef46421eb8dab06">kOSCPar</a>].push_back( 0. );</div>
<div class="line"><span class="lineno"> 2651</span>    <a class="code hl_variable" href="classMCMCProcessor.html#a3a6614826ae320e462211e38e96d9d02">ParamCentral</a>[<a class="code hl_enumvalue" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20ba03865cac80b3eb8f5ef46421eb8dab06">kOSCPar</a>].push_back( 0. );</div>
<div class="line"><span class="lineno"> 2652</span>    <a class="code hl_variable" href="classMCMCProcessor.html#a3a97e3cb4be3ceb9eb721eac51d82d60">ParamErrors</a>[<a class="code hl_enumvalue" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20ba03865cac80b3eb8f5ef46421eb8dab06">kOSCPar</a>].push_back( 1. );</div>
<div class="line"><span class="lineno"> 2653</span>    <span class="comment">// Push back the name</span></div>
<div class="line"><span class="lineno"> 2654</span>    <a class="code hl_variable" href="classMCMCProcessor.html#adecc55689f7d37b9412f8886fe3480dc">ParamNames</a>[<a class="code hl_enumvalue" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20ba03865cac80b3eb8f5ef46421eb8dab06">kOSCPar</a>].push_back(<span class="stringliteral">&quot;J_cp&quot;</span>);</div>
<div class="line"><span class="lineno"> 2655</span>    <a class="code hl_variable" href="classMCMCProcessor.html#a4be1eedb743e4ea410009a4fa45720f7">ParamFlat</a>[<a class="code hl_enumvalue" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20ba03865cac80b3eb8f5ef46421eb8dab06">kOSCPar</a>].push_back( <span class="keyword">false</span> );</div>
<div class="line"><span class="lineno"> 2656</span>  }</div>
<div class="line"><span class="lineno"> 2657</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a2b0b4afbf45adb93357abe96d108170b" name="a2b0b4afbf45adb93357abe96d108170b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2b0b4afbf45adb93357abe96d108170b">&#9670;&#160;</a></span>ReadXSecFile()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void MCMCProcessor::ReadXSecFile </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Read the xsec file and get the input central values and errors. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8cpp_source.html#l02494">2494</a> of file <a class="el" href="MCMCProcessor_8cpp_source.html">MCMCProcessor.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2494</span>                                 {</div>
<div class="line"><span class="lineno"> 2495</span><span class="comment">// ***************</span></div>
<div class="line"><span class="lineno"> 2496</span>  YAML::Node XSecFile = <a class="code hl_variable" href="classMCMCProcessor.html#a4c1330a025c0b91e382bdc29c960424a">CovConfig</a>[<a class="code hl_enumvalue" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20ba7386f5611ea4d01b85b9bb92a5ca335f">kXSecPar</a>];</div>
<div class="line"><span class="lineno"> 2497</span> </div>
<div class="line"><span class="lineno"> 2498</span>  <span class="keyword">auto</span> systematics = XSecFile[<span class="stringliteral">&quot;Systematics&quot;</span>];</div>
<div class="line"><span class="lineno"> 2499</span>  <span class="keywordtype">int</span> i = 0;</div>
<div class="line"><span class="lineno"> 2500</span>  <span class="keywordflow">for</span> (<span class="keyword">auto</span> it = systematics.begin(); it != systematics.end(); ++it, ++i)</div>
<div class="line"><span class="lineno"> 2501</span>  {</div>
<div class="line"><span class="lineno"> 2502</span>    <span class="keyword">auto</span> <span class="keyword">const</span> &amp;param = *it;</div>
<div class="line"><span class="lineno"> 2503</span> </div>
<div class="line"><span class="lineno"> 2504</span>    <span class="comment">// Push back the name</span></div>
<div class="line"><span class="lineno"> 2505</span>    std::string TempString = (param[<span class="stringliteral">&quot;Systematic&quot;</span>][<span class="stringliteral">&quot;Names&quot;</span>][<span class="stringliteral">&quot;FancyName&quot;</span>].as&lt;std::string&gt;());</div>
<div class="line"><span class="lineno"> 2506</span> </div>
<div class="line"><span class="lineno"> 2507</span>    <span class="comment">//KS:Reject particular parameter names, noticed that sometimes string comparison doesn&#39;t work becasue of some weird casting of TObjString into std::string. This is rare and sooner or later we move away from TObjString so this is fine</span></div>
<div class="line"><span class="lineno"> 2508</span>    <span class="keywordtype">bool</span> rejected = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 2509</span>    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ik = 0; ik &lt; <a class="code hl_variable" href="classMCMCProcessor.html#a7425f7802e50bcb5ff4b38e20157c423">ExcludedNames</a>.size(); ++ik)</div>
<div class="line"><span class="lineno"> 2510</span>    {</div>
<div class="line"><span class="lineno"> 2511</span>      <span class="keywordflow">if</span> (TempString.rfind(<a class="code hl_variable" href="classMCMCProcessor.html#a7425f7802e50bcb5ff4b38e20157c423">ExcludedNames</a>.at(ik), 0) == 0)</div>
<div class="line"><span class="lineno"> 2512</span>      {</div>
<div class="line"><span class="lineno"> 2513</span>        <span class="keyword">const</span> <span class="keywordtype">int</span> Tracker = <a class="code hl_variable" href="classMCMCProcessor.html#aeab63979ff36256072c046a15d981875">ParamTypeStartPos</a>[<a class="code hl_enumvalue" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20ba7386f5611ea4d01b85b9bb92a5ca335f">kXSecPar</a>] + i;</div>
<div class="line"><span class="lineno"> 2514</span>        <a class="code hl_variable" href="classMCMCProcessor.html#ad043b6b2c885f47ab9967831bc8d0f5a">BranchNames</a>[Tracker] = <span class="stringliteral">&quot;delete&quot;</span>;</div>
<div class="line"><span class="lineno"> 2515</span>        <a class="code hl_variable" href="classMCMCProcessor.html#a4200e7cbe1c8f811d3640ebfd648ca85">nParam</a>[<a class="code hl_enumvalue" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20ba7386f5611ea4d01b85b9bb92a5ca335f">kXSecPar</a>]--;</div>
<div class="line"><span class="lineno"> 2516</span>        rejected = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 2517</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2518</span>      }</div>
<div class="line"><span class="lineno"> 2519</span>    }</div>
<div class="line"><span class="lineno"> 2520</span>    <span class="keywordflow">if</span>(rejected) <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 2521</span>    <a class="code hl_variable" href="classMCMCProcessor.html#adecc55689f7d37b9412f8886fe3480dc">ParamNames</a>[<a class="code hl_enumvalue" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20ba7386f5611ea4d01b85b9bb92a5ca335f">kXSecPar</a>].push_back(TempString);</div>
<div class="line"><span class="lineno"> 2522</span>    <span class="keywordflow">if</span>(<a class="code hl_variable" href="classMCMCProcessor.html#adecc55689f7d37b9412f8886fe3480dc">ParamNames</a>[<a class="code hl_enumvalue" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20ba7386f5611ea4d01b85b9bb92a5ca335f">kXSecPar</a>][i].BeginsWith(<span class="stringliteral">&quot;b_&quot;</span>))</div>
<div class="line"><span class="lineno"> 2523</span>    {</div>
<div class="line"><span class="lineno"> 2524</span>      <a class="code hl_variable" href="classMCMCProcessor.html#a2c06d64020e9246e720cc131a9f4986d">IsXsec</a>.push_back(<span class="keyword">false</span>);</div>
<div class="line"><span class="lineno"> 2525</span>      <a class="code hl_variable" href="classMCMCProcessor.html#acfc681553c5fbba89e133dfda605db3c">nFlux</a>++;</div>
<div class="line"><span class="lineno"> 2526</span>    } </div>
<div class="line"><span class="lineno"> 2527</span>    <span class="keywordflow">else</span> <a class="code hl_variable" href="classMCMCProcessor.html#a2c06d64020e9246e720cc131a9f4986d">IsXsec</a>.push_back(<span class="keyword">true</span>);  </div>
<div class="line"><span class="lineno"> 2528</span>    </div>
<div class="line"><span class="lineno"> 2529</span>    <a class="code hl_variable" href="classMCMCProcessor.html#a3a6614826ae320e462211e38e96d9d02">ParamCentral</a>[<a class="code hl_enumvalue" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20ba7386f5611ea4d01b85b9bb92a5ca335f">kXSecPar</a>].push_back( param[<span class="stringliteral">&quot;Systematic&quot;</span>][<span class="stringliteral">&quot;ParameterValues&quot;</span>][<span class="stringliteral">&quot;PreFitValue&quot;</span>].as&lt;double&gt;() );</div>
<div class="line"><span class="lineno"> 2530</span>    <a class="code hl_variable" href="classMCMCProcessor.html#a4c4c6aa4827a2fe54ce37defbb3d0475">ParamNom</a>[<a class="code hl_enumvalue" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20ba7386f5611ea4d01b85b9bb92a5ca335f">kXSecPar</a>].push_back( param[<span class="stringliteral">&quot;Systematic&quot;</span>][<span class="stringliteral">&quot;ParameterValues&quot;</span>][<span class="stringliteral">&quot;Generated&quot;</span>].as&lt;double&gt;() );</div>
<div class="line"><span class="lineno"> 2531</span>    <a class="code hl_variable" href="classMCMCProcessor.html#a3a97e3cb4be3ceb9eb721eac51d82d60">ParamErrors</a>[<a class="code hl_enumvalue" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20ba7386f5611ea4d01b85b9bb92a5ca335f">kXSecPar</a>].push_back( param[<span class="stringliteral">&quot;Systematic&quot;</span>][<span class="stringliteral">&quot;Error&quot;</span>].as&lt;double&gt;() );</div>
<div class="line"><span class="lineno"> 2532</span> </div>
<div class="line"><span class="lineno"> 2533</span>    <span class="keywordtype">bool</span> flat = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 2534</span>    <span class="keywordflow">if</span> (param[<span class="stringliteral">&quot;Systematic&quot;</span>][<span class="stringliteral">&quot;FlatPrior&quot;</span>]) { flat = param[<span class="stringliteral">&quot;Systematic&quot;</span>][<span class="stringliteral">&quot;FlatPrior&quot;</span>].as&lt;<span class="keywordtype">bool</span>&gt;(); }</div>
<div class="line"><span class="lineno"> 2535</span>    <a class="code hl_variable" href="classMCMCProcessor.html#a4be1eedb743e4ea410009a4fa45720f7">ParamFlat</a>[<a class="code hl_enumvalue" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20ba7386f5611ea4d01b85b9bb92a5ca335f">kXSecPar</a>].push_back( flat );</div>
<div class="line"><span class="lineno"> 2536</span>  }</div>
<div class="line"><span class="lineno"> 2537</span>}</div>
<div class="ttc" id="aclassMCMCProcessor_html_a7425f7802e50bcb5ff4b38e20157c423"><div class="ttname"><a href="classMCMCProcessor.html#a7425f7802e50bcb5ff4b38e20157c423">MCMCProcessor::ExcludedNames</a></div><div class="ttdeci">std::vector&lt; std::string &gt; ExcludedNames</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8h_source.html#l00357">MCMCProcessor.h:357</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a9a29c1cb64589ac136f7f927cafa18aa" name="a9a29c1cb64589ac136f7f927cafa18aa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9a29c1cb64589ac136f7f927cafa18aa">&#9670;&#160;</a></span>RemoveParameters()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void MCMCProcessor::RemoveParameters </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Remove parameter specified in config. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8cpp_source.html#l02661">2661</a> of file <a class="el" href="MCMCProcessor_8cpp_source.html">MCMCProcessor.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2661</span>                                     {</div>
<div class="line"><span class="lineno"> 2662</span><span class="comment">// ***************</span></div>
<div class="line"><span class="lineno"> 2663</span>  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_variable" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>; i++)</div>
<div class="line"><span class="lineno"> 2664</span>  {</div>
<div class="line"><span class="lineno"> 2665</span>    <span class="keywordflow">if</span>(<a class="code hl_variable" href="classMCMCProcessor.html#ad043b6b2c885f47ab9967831bc8d0f5a">BranchNames</a>[i] == <span class="stringliteral">&quot;delete&quot;</span>)</div>
<div class="line"><span class="lineno"> 2666</span>    {</div>
<div class="line"><span class="lineno"> 2667</span>      <a class="code hl_variable" href="classMCMCProcessor.html#ad043b6b2c885f47ab9967831bc8d0f5a">BranchNames</a>.erase(<a class="code hl_variable" href="classMCMCProcessor.html#ad043b6b2c885f47ab9967831bc8d0f5a">BranchNames</a>.begin() + i);</div>
<div class="line"><span class="lineno"> 2668</span>      <a class="code hl_variable" href="classMCMCProcessor.html#aaa903949bde8f1a69800c71fe1eb538e">ParamType</a>.erase(<a class="code hl_variable" href="classMCMCProcessor.html#aaa903949bde8f1a69800c71fe1eb538e">ParamType</a>.begin() + i);</div>
<div class="line"><span class="lineno"> 2669</span>      <a class="code hl_variable" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>--;</div>
<div class="line"><span class="lineno"> 2670</span>      i = 0;</div>
<div class="line"><span class="lineno"> 2671</span>    }</div>
<div class="line"><span class="lineno"> 2672</span>  }</div>
<div class="line"><span class="lineno"> 2673</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a36441ec3d5b0e24e48040282ffcda3eb" name="a36441ec3d5b0e24e48040282ffcda3eb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a36441ec3d5b0e24e48040282ffcda3eb">&#9670;&#160;</a></span>ResetHistograms()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void MCMCProcessor::ResetHistograms </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reset 2D posteriors, in case we would like to calculate in again with different BurnInCut. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8cpp_source.html#l02730">2730</a> of file <a class="el" href="MCMCProcessor_8cpp_source.html">MCMCProcessor.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2730</span>                                    {</div>
<div class="line"><span class="lineno"> 2731</span><span class="comment">// **************************************************</span></div>
<div class="line"><span class="lineno"> 2732</span><span class="preprocessor">  #ifdef MULTITHREAD</span></div>
<div class="line"><span class="lineno"> 2733</span><span class="preprocessor">  #pragma omp parallel for</span></div>
<div class="line"><span class="lineno"> 2734</span><span class="preprocessor">  #endif</span></div>
<div class="line"><span class="lineno"> 2735</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_variable" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>; ++i) </div>
<div class="line"><span class="lineno"> 2736</span>  {</div>
<div class="line"><span class="lineno"> 2737</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt;= i; ++j)</div>
<div class="line"><span class="lineno"> 2738</span>    {</div>
<div class="line"><span class="lineno"> 2739</span>      <span class="comment">// TH2D to hold the Correlation </span></div>
<div class="line"><span class="lineno"> 2740</span>      <a class="code hl_variable" href="classMCMCProcessor.html#a0ddcfa4ba1e4dcdea366d88decc64391">hpost2D</a>[i][j]-&gt;Reset(<span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><span class="lineno"> 2741</span>      <a class="code hl_variable" href="classMCMCProcessor.html#a0ddcfa4ba1e4dcdea366d88decc64391">hpost2D</a>[i][j]-&gt;Fill(0.0, 0.0, 0.0);</div>
<div class="line"><span class="lineno"> 2742</span>    }</div>
<div class="line"><span class="lineno"> 2743</span>  }</div>
<div class="line"><span class="lineno"> 2744</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ad3b1cfab21c7063bc29d1cf5dcca888c" name="ad3b1cfab21c7063bc29d1cf5dcca888c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad3b1cfab21c7063bc29d1cf5dcca888c">&#9670;&#160;</a></span>ReweightPrior()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void MCMCProcessor::ReweightPrior </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; std::string &gt; &amp;&#160;</td>
          <td class="paramname"><em>Names</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>NewCentral</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>NewError</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reweight Prior by giving new central value and new error. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ParName</td><td>Parameter names for which we do reweighting </td></tr>
    <tr><td class="paramname">NewCentral</td><td>New central value for which we reweight </td></tr>
    <tr><td class="paramname">NewError</td><td>New error used for calculating weight </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8cpp_source.html#l03028">3028</a> of file <a class="el" href="MCMCProcessor_8cpp_source.html">MCMCProcessor.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3030</span>                                                                     {</div>
<div class="line"><span class="lineno"> 3031</span><span class="comment">// **************************</span></div>
<div class="line"><span class="lineno"> 3032</span>  <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Reweighting Prior&quot;</span>);</div>
<div class="line"><span class="lineno"> 3033</span> </div>
<div class="line"><span class="lineno"> 3034</span>  <span class="keywordflow">if</span>( (Names.size() != NewCentral.size()) || (NewCentral.size() != NewError.size()))</div>
<div class="line"><span class="lineno"> 3035</span>  {</div>
<div class="line"><span class="lineno"> 3036</span>    <a class="code hl_define" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Size of passed vectors doesn&#39;t match in ReweightPrior&quot;</span>);</div>
<div class="line"><span class="lineno"> 3037</span>    <span class="keywordflow">throw</span> <a class="code hl_class" href="classMaCh3Exception.html">MaCh3Exception</a>(__FILE__ , __LINE__ );</div>
<div class="line"><span class="lineno"> 3038</span>  }</div>
<div class="line"><span class="lineno"> 3039</span>  std::vector&lt;int&gt; Param;</div>
<div class="line"><span class="lineno"> 3040</span>  std::vector&lt;double&gt; OldCentral;</div>
<div class="line"><span class="lineno"> 3041</span>  std::vector&lt;double&gt; OldError;</div>
<div class="line"><span class="lineno"> 3042</span>  std::vector&lt;bool&gt; FlatPrior;</div>
<div class="line"><span class="lineno"> 3043</span> </div>
<div class="line"><span class="lineno"> 3044</span>  <span class="comment">//KS: First we need to find parameter number based on name</span></div>
<div class="line"><span class="lineno"> 3045</span>  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> k = 0; k &lt; Names.size(); ++k)</div>
<div class="line"><span class="lineno"> 3046</span>  {</div>
<div class="line"><span class="lineno"> 3047</span>    <span class="comment">//KS: First we need to find parameter number based on name</span></div>
<div class="line"><span class="lineno"> 3048</span>    <span class="keywordtype">int</span> ParamNo = <a class="code hl_function" href="classMCMCProcessor.html#a5ab91183fbbf23fff759fefc9954a1a5">GetParamIndexFromName</a>(Names[k]);</div>
<div class="line"><span class="lineno"> 3049</span>    <span class="keywordflow">if</span>(ParamNo == <a class="code hl_define" href="MCMCProcessor_8h.html#a82a6d79039474bc403b627437a7b97ec">_UNDEF_</a>)</div>
<div class="line"><span class="lineno"> 3050</span>    {</div>
<div class="line"><span class="lineno"> 3051</span>      <a class="code hl_define" href="MaCh3Logger_8h.html#ad5b2eb6377721e3ac95def22c2386bb1">MACH3LOG_WARN</a>(<span class="stringliteral">&quot;Couldn&#39;t find param {}. Can&#39;t reweight Prior&quot;</span>, Names[k]);</div>
<div class="line"><span class="lineno"> 3052</span>      <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 3053</span>    }</div>
<div class="line"><span class="lineno"> 3054</span> </div>
<div class="line"><span class="lineno"> 3055</span>    TString Title = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><span class="lineno"> 3056</span>    <span class="keywordtype">double</span> Prior = 1.0;</div>
<div class="line"><span class="lineno"> 3057</span>    <span class="keywordtype">double</span> PriorError = 1.0;</div>
<div class="line"><span class="lineno"> 3058</span>    <a class="code hl_function" href="classMCMCProcessor.html#a28dfe42f1bf6fd3a145287be1e63fb0b">GetNthParameter</a>(ParamNo, Prior, PriorError, Title);</div>
<div class="line"><span class="lineno"> 3059</span> </div>
<div class="line"><span class="lineno"> 3060</span>    Param.push_back(ParamNo);</div>
<div class="line"><span class="lineno"> 3061</span>    OldCentral.push_back(Prior);</div>
<div class="line"><span class="lineno"> 3062</span>    OldError.push_back(PriorError);</div>
<div class="line"><span class="lineno"> 3063</span> </div>
<div class="line"><span class="lineno"> 3064</span>    <a class="code hl_enumeration" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20b">ParameterEnum</a> ParType = <a class="code hl_variable" href="classMCMCProcessor.html#aaa903949bde8f1a69800c71fe1eb538e">ParamType</a>[ParamNo];</div>
<div class="line"><span class="lineno"> 3065</span>    <span class="keywordtype">int</span> ParamTemp = ParamNo - <a class="code hl_variable" href="classMCMCProcessor.html#aeab63979ff36256072c046a15d981875">ParamTypeStartPos</a>[ParType];</div>
<div class="line"><span class="lineno"> 3066</span> </div>
<div class="line"><span class="lineno"> 3067</span>    FlatPrior.push_back(<a class="code hl_variable" href="classMCMCProcessor.html#a4be1eedb743e4ea410009a4fa45720f7">ParamFlat</a>[ParType][ParamTemp]);</div>
<div class="line"><span class="lineno"> 3068</span>  }</div>
<div class="line"><span class="lineno"> 3069</span>  std::vector&lt;double&gt; ParameterPos(Names.size());</div>
<div class="line"><span class="lineno"> 3070</span> </div>
<div class="line"><span class="lineno"> 3071</span>  std::string InputFile = <a class="code hl_variable" href="classMCMCProcessor.html#a6d212d77a818304a8674a7b9b18d43b8">MCMCFile</a>+<span class="stringliteral">&quot;.root&quot;</span>;</div>
<div class="line"><span class="lineno"> 3072</span>  std::string OutputFilename = <a class="code hl_variable" href="classMCMCProcessor.html#a6d212d77a818304a8674a7b9b18d43b8">MCMCFile</a> + <span class="stringliteral">&quot;_reweighted.root&quot;</span>;</div>
<div class="line"><span class="lineno"> 3073</span> </div>
<div class="line"><span class="lineno"> 3074</span>  <span class="comment">//KS: Simply create copy of file and add there new branch</span></div>
<div class="line"><span class="lineno"> 3075</span>  <span class="keywordtype">int</span> ret = system((<span class="stringliteral">&quot;cp &quot;</span> + InputFile + <span class="stringliteral">&quot; &quot;</span> + OutputFilename).c_str());</div>
<div class="line"><span class="lineno"> 3076</span>  <span class="keywordflow">if</span> (ret != 0)</div>
<div class="line"><span class="lineno"> 3077</span>    <a class="code hl_define" href="MaCh3Logger_8h.html#ad5b2eb6377721e3ac95def22c2386bb1">MACH3LOG_WARN</a>(<span class="stringliteral">&quot;Error: system call to copy file failed with code {}&quot;</span>, ret);</div>
<div class="line"><span class="lineno"> 3078</span> </div>
<div class="line"><span class="lineno"> 3079</span>  TFile *OutputChain = <span class="keyword">new</span> TFile(OutputFilename.c_str(), <span class="stringliteral">&quot;UPDATE&quot;</span>);</div>
<div class="line"><span class="lineno"> 3080</span>  OutputChain-&gt;cd();</div>
<div class="line"><span class="lineno"> 3081</span>  TTree *post = OutputChain-&gt;Get&lt;TTree&gt;(<span class="stringliteral">&quot;posteriors&quot;</span>);</div>
<div class="line"><span class="lineno"> 3082</span> </div>
<div class="line"><span class="lineno"> 3083</span>  <span class="keywordtype">double</span> Weight = 1.;</div>
<div class="line"><span class="lineno"> 3084</span> </div>
<div class="line"><span class="lineno"> 3085</span>  post-&gt;SetBranchStatus(<span class="stringliteral">&quot;*&quot;</span>,<span class="keyword">false</span>);</div>
<div class="line"><span class="lineno"> 3086</span>  <span class="comment">// Set the branch addresses for params</span></div>
<div class="line"><span class="lineno"> 3087</span>  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j = 0; j &lt; Names.size(); ++j) {</div>
<div class="line"><span class="lineno"> 3088</span>    post-&gt;SetBranchStatus(<a class="code hl_variable" href="classMCMCProcessor.html#ad043b6b2c885f47ab9967831bc8d0f5a">BranchNames</a>[Param[j]].Data(), <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno"> 3089</span>    post-&gt;SetBranchAddress(<a class="code hl_variable" href="classMCMCProcessor.html#ad043b6b2c885f47ab9967831bc8d0f5a">BranchNames</a>[Param[j]].Data(), &amp;ParameterPos[j]);</div>
<div class="line"><span class="lineno"> 3090</span>  }</div>
<div class="line"><span class="lineno"> 3091</span>  TBranch *bpt = post-&gt;Branch(<span class="stringliteral">&quot;Weight&quot;</span>, &amp;Weight, <span class="stringliteral">&quot;Weight/D&quot;</span>);</div>
<div class="line"><span class="lineno"> 3092</span>  post-&gt;SetBranchStatus(<span class="stringliteral">&quot;Weight&quot;</span>, <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno"> 3093</span> </div>
<div class="line"><span class="lineno"> 3094</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_variable" href="classMCMCProcessor.html#af3a19b885e9c34e1674aea8cfbe14e1c">nEntries</a>; ++i)</div>
<div class="line"><span class="lineno"> 3095</span>  {</div>
<div class="line"><span class="lineno"> 3096</span>    post-&gt;GetEntry(i);</div>
<div class="line"><span class="lineno"> 3097</span>    Weight = 1.;</div>
<div class="line"><span class="lineno"> 3098</span> </div>
<div class="line"><span class="lineno"> 3099</span>    <span class="comment">//KS: Calculate reweight weight. Weights are multiplicative so we can do several reweights at once. FIXME Big limitation is that code only works for uncorrelated parameters :(</span></div>
<div class="line"><span class="lineno"> 3100</span>    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j = 0; j &lt; Names.size(); ++j)</div>
<div class="line"><span class="lineno"> 3101</span>    {</div>
<div class="line"><span class="lineno"> 3102</span>      <span class="keywordtype">double</span> new_chi = (ParameterPos[j] - NewCentral[j])/NewError[j];</div>
<div class="line"><span class="lineno"> 3103</span>      <span class="keywordtype">double</span> new_prior = std::exp(-0.5 * new_chi * new_chi);</div>
<div class="line"><span class="lineno"> 3104</span> </div>
<div class="line"><span class="lineno"> 3105</span>      <span class="keywordtype">double</span> old_chi = -1;</div>
<div class="line"><span class="lineno"> 3106</span>      <span class="keywordtype">double</span> old_prior = -1;</div>
<div class="line"><span class="lineno"> 3107</span>      <span class="keywordflow">if</span>(FlatPrior[j])</div>
<div class="line"><span class="lineno"> 3108</span>      {</div>
<div class="line"><span class="lineno"> 3109</span>        old_prior = 1.0;</div>
<div class="line"><span class="lineno"> 3110</span>      }</div>
<div class="line"><span class="lineno"> 3111</span>      <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 3112</span>      {</div>
<div class="line"><span class="lineno"> 3113</span>        old_chi = (ParameterPos[j] - OldCentral[j])/OldError[j];</div>
<div class="line"><span class="lineno"> 3114</span>        old_prior = std::exp(-0.5 * old_chi * old_chi);</div>
<div class="line"><span class="lineno"> 3115</span>      }</div>
<div class="line"><span class="lineno"> 3116</span>      Weight *= new_prior/old_prior;</div>
<div class="line"><span class="lineno"> 3117</span>    }</div>
<div class="line"><span class="lineno"> 3118</span>    bpt-&gt;Fill();</div>
<div class="line"><span class="lineno"> 3119</span>  }</div>
<div class="line"><span class="lineno"> 3120</span>  post-&gt;SetBranchStatus(<span class="stringliteral">&quot;*&quot;</span>,<span class="keyword">true</span>);</div>
<div class="line"><span class="lineno"> 3121</span>  OutputChain-&gt;cd();</div>
<div class="line"><span class="lineno"> 3122</span>  post-&gt;Write(<span class="stringliteral">&quot;posteriors&quot;</span>, TObject::kOverwrite);</div>
<div class="line"><span class="lineno"> 3123</span>  OutputChain-&gt;Close();</div>
<div class="line"><span class="lineno"> 3124</span>  <span class="keyword">delete</span> OutputChain;</div>
<div class="line"><span class="lineno"> 3125</span> </div>
<div class="line"><span class="lineno"> 3126</span>  <a class="code hl_variable" href="classMCMCProcessor.html#a62035b99df4617ab334cd1abd6ed0346">OutputFile</a>-&gt;cd();</div>
<div class="line"><span class="lineno"> 3127</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="aeff2174617268c1e55333529459bffb6" name="aeff2174617268c1e55333529459bffb6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeff2174617268c1e55333529459bffb6">&#9670;&#160;</a></span>ScanInput()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void MCMCProcessor::ScanInput </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Scan Input etc. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8cpp_source.html#l02124">2124</a> of file <a class="el" href="MCMCProcessor_8cpp_source.html">MCMCProcessor.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2124</span>                              {</div>
<div class="line"><span class="lineno"> 2125</span><span class="comment">// **************************</span></div>
<div class="line"><span class="lineno"> 2126</span>  <span class="comment">// KS: This can reduce time necessary for caching even by half</span></div>
<div class="line"><span class="lineno"> 2127</span><span class="preprocessor">  #ifdef MULTITHREAD</span></div>
<div class="line"><span class="lineno"> 2128</span>  <span class="comment">//ROOT::EnableImplicitMT();</span></div>
<div class="line"><span class="lineno"> 2129</span><span class="preprocessor">  #endif</span></div>
<div class="line"><span class="lineno"> 2130</span> </div>
<div class="line"><span class="lineno"> 2131</span>  <span class="comment">// Open the Chain</span></div>
<div class="line"><span class="lineno"> 2132</span>  <a class="code hl_variable" href="classMCMCProcessor.html#a6be3bbebd4a79fe9814a3da09b3bb820">Chain</a> = <span class="keyword">new</span> TChain(<span class="stringliteral">&quot;posteriors&quot;</span>,<span class="stringliteral">&quot;posteriors&quot;</span>);</div>
<div class="line"><span class="lineno"> 2133</span>  <a class="code hl_variable" href="classMCMCProcessor.html#a6be3bbebd4a79fe9814a3da09b3bb820">Chain</a>-&gt;Add(<a class="code hl_variable" href="classMCMCProcessor.html#a6d212d77a818304a8674a7b9b18d43b8">MCMCFile</a>.c_str());</div>
<div class="line"><span class="lineno"> 2134</span> </div>
<div class="line"><span class="lineno"> 2135</span>  <a class="code hl_variable" href="classMCMCProcessor.html#af3a19b885e9c34e1674aea8cfbe14e1c">nEntries</a> = int(<a class="code hl_variable" href="classMCMCProcessor.html#a6be3bbebd4a79fe9814a3da09b3bb820">Chain</a>-&gt;GetEntries());</div>
<div class="line"><span class="lineno"> 2136</span>  </div>
<div class="line"><span class="lineno"> 2137</span>  <span class="comment">//Only is suboptimality we might want to change it, therefore set it high enough so it doesn&#39;t affect other functionality</span></div>
<div class="line"><span class="lineno"> 2138</span>  <a class="code hl_variable" href="classMCMCProcessor.html#a840c686f15f419c0156df01c4ed62931">UpperCut</a> = <a class="code hl_variable" href="classMCMCProcessor.html#af3a19b885e9c34e1674aea8cfbe14e1c">nEntries</a>+1;</div>
<div class="line"><span class="lineno"> 2139</span> </div>
<div class="line"><span class="lineno"> 2140</span>  <span class="comment">// Get the list of branches</span></div>
<div class="line"><span class="lineno"> 2141</span> </div>
<div class="line"><span class="lineno"> 2142</span>  TObjArray* brlis = <a class="code hl_variable" href="classMCMCProcessor.html#a6be3bbebd4a79fe9814a3da09b3bb820">Chain</a>-&gt;GetListOfBranches();</div>
<div class="line"><span class="lineno"> 2143</span> </div>
<div class="line"><span class="lineno"> 2144</span>  <span class="comment">// Get the number of branches</span></div>
<div class="line"><span class="lineno"> 2145</span>  <a class="code hl_variable" href="classMCMCProcessor.html#af6ba5d9aec5350fafebbf81309e813cb">nBranches</a> = brlis-&gt;GetEntries();</div>
<div class="line"><span class="lineno"> 2146</span> </div>
<div class="line"><span class="lineno"> 2147</span>  <a class="code hl_variable" href="classMCMCProcessor.html#ad043b6b2c885f47ab9967831bc8d0f5a">BranchNames</a>.reserve(<a class="code hl_variable" href="classMCMCProcessor.html#af6ba5d9aec5350fafebbf81309e813cb">nBranches</a>);</div>
<div class="line"><span class="lineno"> 2148</span>  <a class="code hl_variable" href="classMCMCProcessor.html#a95fa49737432818bc830a44898d0d850">IamVaried</a>.reserve(<a class="code hl_variable" href="classMCMCProcessor.html#af6ba5d9aec5350fafebbf81309e813cb">nBranches</a>);</div>
<div class="line"><span class="lineno"> 2149</span>  <a class="code hl_variable" href="classMCMCProcessor.html#aaa903949bde8f1a69800c71fe1eb538e">ParamType</a>.reserve(<a class="code hl_variable" href="classMCMCProcessor.html#af6ba5d9aec5350fafebbf81309e813cb">nBranches</a>);</div>
<div class="line"><span class="lineno"> 2150</span> </div>
<div class="line"><span class="lineno"> 2151</span>  <span class="comment">// Set all the branches to off</span></div>
<div class="line"><span class="lineno"> 2152</span>  <a class="code hl_variable" href="classMCMCProcessor.html#a6be3bbebd4a79fe9814a3da09b3bb820">Chain</a>-&gt;SetBranchStatus(<span class="stringliteral">&quot;*&quot;</span>, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno"> 2153</span> </div>
<div class="line"><span class="lineno"> 2154</span>  <span class="comment">// Loop over the number of branches</span></div>
<div class="line"><span class="lineno"> 2155</span>  <span class="comment">// Find the name and how many of each systematic we have</span></div>
<div class="line"><span class="lineno"> 2156</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_variable" href="classMCMCProcessor.html#af6ba5d9aec5350fafebbf81309e813cb">nBranches</a>; i++)</div>
<div class="line"><span class="lineno"> 2157</span>  {</div>
<div class="line"><span class="lineno"> 2158</span>    <span class="comment">// Get the TBranch and its name</span></div>
<div class="line"><span class="lineno"> 2159</span>    TBranch* br = <span class="keyword">static_cast&lt;</span>TBranch*<span class="keyword">&gt;</span>(brlis-&gt;At(i));</div>
<div class="line"><span class="lineno"> 2160</span>    <span class="keywordflow">if</span>(!br){</div>
<div class="line"><span class="lineno"> 2161</span>      <a class="code hl_define" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Invalid branch at position {}&quot;</span>, i);</div>
<div class="line"><span class="lineno"> 2162</span>      <span class="keywordflow">throw</span> <a class="code hl_class" href="classMaCh3Exception.html">MaCh3Exception</a>(__FILE__,__LINE__);</div>
<div class="line"><span class="lineno"> 2163</span>    }</div>
<div class="line"><span class="lineno"> 2164</span>    TString bname = br-&gt;GetName();</div>
<div class="line"><span class="lineno"> 2165</span> </div>
<div class="line"><span class="lineno"> 2166</span>    <span class="comment">//KS: Exclude parameter types</span></div>
<div class="line"><span class="lineno"> 2167</span>    <span class="keywordtype">bool</span> rejected = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 2168</span>    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ik = 0; ik &lt; <a class="code hl_variable" href="classMCMCProcessor.html#aada4aadea10661586b46c1013a9d018f">ExcludedTypes</a>.size(); ++ik )</div>
<div class="line"><span class="lineno"> 2169</span>    {</div>
<div class="line"><span class="lineno"> 2170</span>      <span class="keywordflow">if</span>(bname.BeginsWith(<a class="code hl_variable" href="classMCMCProcessor.html#aada4aadea10661586b46c1013a9d018f">ExcludedTypes</a>[ik]))</div>
<div class="line"><span class="lineno"> 2171</span>      {</div>
<div class="line"><span class="lineno"> 2172</span>        rejected = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 2173</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2174</span>      }</div>
<div class="line"><span class="lineno"> 2175</span>    }</div>
<div class="line"><span class="lineno"> 2176</span>    <span class="keywordflow">if</span>(rejected) <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 2177</span> </div>
<div class="line"><span class="lineno"> 2178</span>    <span class="comment">// Turn on the branches which we want for parameters</span></div>
<div class="line"><span class="lineno"> 2179</span>    <a class="code hl_variable" href="classMCMCProcessor.html#a6be3bbebd4a79fe9814a3da09b3bb820">Chain</a>-&gt;SetBranchStatus(bname.Data(), <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno"> 2180</span> </div>
<div class="line"><span class="lineno"> 2181</span>    <span class="comment">// If we&#39;re on beam systematics</span></div>
<div class="line"><span class="lineno"> 2182</span>    <span class="keywordflow">if</span>(bname.BeginsWith(<span class="stringliteral">&quot;xsec_&quot;</span>)) </div>
<div class="line"><span class="lineno"> 2183</span>    {</div>
<div class="line"><span class="lineno"> 2184</span>      <a class="code hl_variable" href="classMCMCProcessor.html#ad043b6b2c885f47ab9967831bc8d0f5a">BranchNames</a>.push_back(bname);</div>
<div class="line"><span class="lineno"> 2185</span>      <a class="code hl_variable" href="classMCMCProcessor.html#aaa903949bde8f1a69800c71fe1eb538e">ParamType</a>.push_back(<a class="code hl_enumvalue" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20ba7386f5611ea4d01b85b9bb92a5ca335f">kXSecPar</a>);</div>
<div class="line"><span class="lineno"> 2186</span>      <a class="code hl_variable" href="classMCMCProcessor.html#a4200e7cbe1c8f811d3640ebfd648ca85">nParam</a>[<a class="code hl_enumvalue" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20ba7386f5611ea4d01b85b9bb92a5ca335f">kXSecPar</a>]++;</div>
<div class="line"><span class="lineno"> 2187</span>    }</div>
<div class="line"><span class="lineno"> 2188</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (bname.BeginsWith(<span class="stringliteral">&quot;ndd_&quot;</span>))</div>
<div class="line"><span class="lineno"> 2189</span>    {</div>
<div class="line"><span class="lineno"> 2190</span>      <a class="code hl_variable" href="classMCMCProcessor.html#ad043b6b2c885f47ab9967831bc8d0f5a">BranchNames</a>.push_back(bname);</div>
<div class="line"><span class="lineno"> 2191</span>      <a class="code hl_variable" href="classMCMCProcessor.html#aaa903949bde8f1a69800c71fe1eb538e">ParamType</a>.push_back(<a class="code hl_enumvalue" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20ba4ac215e1a6cd9e776ec0a230f62a0bb4">kNDPar</a>);</div>
<div class="line"><span class="lineno"> 2192</span>      <a class="code hl_variable" href="classMCMCProcessor.html#a4200e7cbe1c8f811d3640ebfd648ca85">nParam</a>[<a class="code hl_enumvalue" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20ba4ac215e1a6cd9e776ec0a230f62a0bb4">kNDPar</a>]++;</div>
<div class="line"><span class="lineno"> 2193</span>    }</div>
<div class="line"><span class="lineno"> 2194</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (bname.BeginsWith(<span class="stringliteral">&quot;skd_joint_&quot;</span>))</div>
<div class="line"><span class="lineno"> 2195</span>    {</div>
<div class="line"><span class="lineno"> 2196</span>      <a class="code hl_variable" href="classMCMCProcessor.html#ad043b6b2c885f47ab9967831bc8d0f5a">BranchNames</a>.push_back(bname);</div>
<div class="line"><span class="lineno"> 2197</span>      <a class="code hl_variable" href="classMCMCProcessor.html#aaa903949bde8f1a69800c71fe1eb538e">ParamType</a>.push_back(<a class="code hl_enumvalue" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20bad7032c60390bd4bb843950e9a7afcdae">kFDDetPar</a>);</div>
<div class="line"><span class="lineno"> 2198</span>      <a class="code hl_variable" href="classMCMCProcessor.html#a4200e7cbe1c8f811d3640ebfd648ca85">nParam</a>[<a class="code hl_enumvalue" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20bad7032c60390bd4bb843950e9a7afcdae">kFDDetPar</a>]++;</div>
<div class="line"><span class="lineno"> 2199</span>    }</div>
<div class="line"><span class="lineno"> 2200</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (bname.BeginsWith(<span class="stringliteral">&quot;sin2th_&quot;</span>)  ||</div>
<div class="line"><span class="lineno"> 2201</span>             bname.BeginsWith(<span class="stringliteral">&quot;delm2_&quot;</span>)   ||</div>
<div class="line"><span class="lineno"> 2202</span>             bname.BeginsWith(<span class="stringliteral">&quot;delta_&quot;</span>)   ||</div>
<div class="line"><span class="lineno"> 2203</span>             bname.BeginsWith(<span class="stringliteral">&quot;baseline&quot;</span>) ||</div>
<div class="line"><span class="lineno"> 2204</span>             bname.BeginsWith(<span class="stringliteral">&quot;density&quot;</span>)   )</div>
<div class="line"><span class="lineno"> 2205</span>    {</div>
<div class="line"><span class="lineno"> 2206</span>      <a class="code hl_variable" href="classMCMCProcessor.html#ad043b6b2c885f47ab9967831bc8d0f5a">BranchNames</a>.push_back(bname);</div>
<div class="line"><span class="lineno"> 2207</span>      <a class="code hl_variable" href="classMCMCProcessor.html#aaa903949bde8f1a69800c71fe1eb538e">ParamType</a>.push_back(<a class="code hl_enumvalue" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20ba03865cac80b3eb8f5ef46421eb8dab06">kOSCPar</a>);</div>
<div class="line"><span class="lineno"> 2208</span>      <a class="code hl_variable" href="classMCMCProcessor.html#a4200e7cbe1c8f811d3640ebfd648ca85">nParam</a>[<a class="code hl_enumvalue" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20ba03865cac80b3eb8f5ef46421eb8dab06">kOSCPar</a>]++;</div>
<div class="line"><span class="lineno"> 2209</span>    }</div>
<div class="line"><span class="lineno"> 2210</span> </div>
<div class="line"><span class="lineno"> 2211</span>    <span class="comment">//KS: as a bonus get LogL systematic</span></div>
<div class="line"><span class="lineno"> 2212</span>    <span class="keywordflow">if</span> (bname.BeginsWith(<span class="stringliteral">&quot;LogL_sample_&quot;</span>)) {</div>
<div class="line"><span class="lineno"> 2213</span>      <a class="code hl_variable" href="classMCMCProcessor.html#a3660e404a6631cfa913a815481730a9b">SampleName_v</a>.push_back(bname);</div>
<div class="line"><span class="lineno"> 2214</span>      <a class="code hl_variable" href="classMCMCProcessor.html#a419d3669dbb54a55a635e35691134cc1">nSamples</a>++;</div>
<div class="line"><span class="lineno"> 2215</span>    }</div>
<div class="line"><span class="lineno"> 2216</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (bname.BeginsWith(<span class="stringliteral">&quot;LogL_systematic_&quot;</span>)) {</div>
<div class="line"><span class="lineno"> 2217</span>      <a class="code hl_variable" href="classMCMCProcessor.html#acb1871575fdd3ae156aed4bf7c7a0a73">SystName_v</a>.push_back(bname);</div>
<div class="line"><span class="lineno"> 2218</span>      <a class="code hl_variable" href="classMCMCProcessor.html#adf518be96278f1d3901404cfbe767b67">nSysts</a>++;</div>
<div class="line"><span class="lineno"> 2219</span>    }</div>
<div class="line"><span class="lineno"> 2220</span>  }</div>
<div class="line"><span class="lineno"> 2221</span>  <a class="code hl_variable" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a> = int(<a class="code hl_variable" href="classMCMCProcessor.html#ad043b6b2c885f47ab9967831bc8d0f5a">BranchNames</a>.size());</div>
<div class="line"><span class="lineno"> 2222</span>  <span class="comment">// Read the input Covariances</span></div>
<div class="line"><span class="lineno"> 2223</span>  <a class="code hl_function" href="classMCMCProcessor.html#afef48d4fccf7551dc1845f8f6c08864f">ReadInputCov</a>();</div>
<div class="line"><span class="lineno"> 2224</span>  </div>
<div class="line"><span class="lineno"> 2225</span>  <span class="comment">// Check order of parameter types</span></div>
<div class="line"><span class="lineno"> 2226</span>  <a class="code hl_function" href="classMCMCProcessor.html#a015cf0d6925d026e5bd9d82aa31083b6">ScanParameterOrder</a>();</div>
<div class="line"><span class="lineno"> 2227</span>  <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;************************************************&quot;</span>);</div>
<div class="line"><span class="lineno"> 2228</span>  <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Scanning output branches...&quot;</span>);</div>
<div class="line"><span class="lineno"> 2229</span>  <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;# useful entries in tree: \033[1;32m {} \033[0m &quot;</span>, <a class="code hl_variable" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>);</div>
<div class="line"><span class="lineno"> 2230</span>  <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;# XSec params:  \033[1;32m {} starting at {} \033[0m &quot;</span>, <a class="code hl_variable" href="classMCMCProcessor.html#a4200e7cbe1c8f811d3640ebfd648ca85">nParam</a>[<a class="code hl_enumvalue" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20ba7386f5611ea4d01b85b9bb92a5ca335f">kXSecPar</a>] - <a class="code hl_variable" href="classMCMCProcessor.html#acfc681553c5fbba89e133dfda605db3c">nFlux</a>, <a class="code hl_variable" href="classMCMCProcessor.html#aeab63979ff36256072c046a15d981875">ParamTypeStartPos</a>[<a class="code hl_enumvalue" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20ba7386f5611ea4d01b85b9bb92a5ca335f">kXSecPar</a>]);</div>
<div class="line"><span class="lineno"> 2231</span>  <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;# Flux params:   {}&quot;</span>, <a class="code hl_variable" href="classMCMCProcessor.html#acfc681553c5fbba89e133dfda605db3c">nFlux</a>);</div>
<div class="line"><span class="lineno"> 2232</span>  <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;# ND params:    \033[1;32m {} starting at {} \033[0m &quot;</span>, <a class="code hl_variable" href="classMCMCProcessor.html#a4200e7cbe1c8f811d3640ebfd648ca85">nParam</a>[<a class="code hl_enumvalue" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20ba4ac215e1a6cd9e776ec0a230f62a0bb4">kNDPar</a>], <a class="code hl_variable" href="classMCMCProcessor.html#aeab63979ff36256072c046a15d981875">ParamTypeStartPos</a>[<a class="code hl_enumvalue" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20ba4ac215e1a6cd9e776ec0a230f62a0bb4">kNDPar</a>]);</div>
<div class="line"><span class="lineno"> 2233</span>  <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;# FD params:    \033[1;32m {} starting at {} \033[0m &quot;</span>, <a class="code hl_variable" href="classMCMCProcessor.html#a4200e7cbe1c8f811d3640ebfd648ca85">nParam</a>[<a class="code hl_enumvalue" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20bad7032c60390bd4bb843950e9a7afcdae">kFDDetPar</a>], <a class="code hl_variable" href="classMCMCProcessor.html#aeab63979ff36256072c046a15d981875">ParamTypeStartPos</a>[<a class="code hl_enumvalue" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20bad7032c60390bd4bb843950e9a7afcdae">kFDDetPar</a>]);</div>
<div class="line"><span class="lineno"> 2234</span>  <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;# Osc params:   \033[1;32m {} starting at {} \033[0m &quot;</span>, <a class="code hl_variable" href="classMCMCProcessor.html#a4200e7cbe1c8f811d3640ebfd648ca85">nParam</a>[<a class="code hl_enumvalue" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20ba03865cac80b3eb8f5ef46421eb8dab06">kOSCPar</a>], <a class="code hl_variable" href="classMCMCProcessor.html#aeab63979ff36256072c046a15d981875">ParamTypeStartPos</a>[<a class="code hl_enumvalue" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20ba03865cac80b3eb8f5ef46421eb8dab06">kOSCPar</a>]);</div>
<div class="line"><span class="lineno"> 2235</span>  <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;************************************************&quot;</span>);</div>
<div class="line"><span class="lineno"> 2236</span> </div>
<div class="line"><span class="lineno"> 2237</span>  <a class="code hl_variable" href="classMCMCProcessor.html#aae0016a4e1d105d5d65243438c622a97">nSteps</a> = <a class="code hl_variable" href="classMCMCProcessor.html#a6be3bbebd4a79fe9814a3da09b3bb820">Chain</a>-&gt;GetMaximum(<span class="stringliteral">&quot;step&quot;</span>);</div>
<div class="line"><span class="lineno"> 2238</span>  <span class="comment">// Set the step cut to be 20%</span></div>
<div class="line"><span class="lineno"> 2239</span>  <span class="keywordtype">int</span> cut = <a class="code hl_variable" href="classMCMCProcessor.html#aae0016a4e1d105d5d65243438c622a97">nSteps</a>/5;</div>
<div class="line"><span class="lineno"> 2240</span>  <a class="code hl_function" href="classMCMCProcessor.html#ad610d8e835031872b428e759ef4045f1">SetStepCut</a>(cut);</div>
<div class="line"><span class="lineno"> 2241</span>}</div>
<div class="ttc" id="aclassMCMCProcessor_html_a015cf0d6925d026e5bd9d82aa31083b6"><div class="ttname"><a href="classMCMCProcessor.html#a015cf0d6925d026e5bd9d82aa31083b6">MCMCProcessor::ScanParameterOrder</a></div><div class="ttdeci">void ScanParameterOrder()</div><div class="ttdoc">Scan order of params from a different groups.</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8cpp_source.html#l02301">MCMCProcessor.cpp:2301</a></div></div>
<div class="ttc" id="aclassMCMCProcessor_html_aada4aadea10661586b46c1013a9d018f"><div class="ttname"><a href="classMCMCProcessor.html#aada4aadea10661586b46c1013a9d018f">MCMCProcessor::ExcludedTypes</a></div><div class="ttdeci">std::vector&lt; std::string &gt; ExcludedTypes</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8h_source.html#l00356">MCMCProcessor.h:356</a></div></div>
<div class="ttc" id="aclassMCMCProcessor_html_ad610d8e835031872b428e759ef4045f1"><div class="ttname"><a href="classMCMCProcessor.html#ad610d8e835031872b428e759ef4045f1">MCMCProcessor::SetStepCut</a></div><div class="ttdeci">void SetStepCut(const std::string &amp;Cuts)</div><div class="ttdoc">Set the step cutting by string.</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8cpp_source.html#l02677">MCMCProcessor.cpp:2677</a></div></div>
<div class="ttc" id="aclassMCMCProcessor_html_af6ba5d9aec5350fafebbf81309e813cb"><div class="ttname"><a href="classMCMCProcessor.html#af6ba5d9aec5350fafebbf81309e813cb">MCMCProcessor::nBranches</a></div><div class="ttdeci">int nBranches</div><div class="ttdoc">Number of branches in a TTree.</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8h_source.html#l00342">MCMCProcessor.h:342</a></div></div>
<div class="ttc" id="aclassMCMCProcessor_html_afef48d4fccf7551dc1845f8f6c08864f"><div class="ttname"><a href="classMCMCProcessor.html#afef48d4fccf7551dc1845f8f6c08864f">MCMCProcessor::ReadInputCov</a></div><div class="ttdeci">void ReadInputCov()</div><div class="ttdoc">CW: Read the input Covariance matrix entries. Get stuff like parameter input errors,...</div><div class="ttdef"><b>Definition:</b> <a href="MCMCProcessor_8cpp_source.html#l02384">MCMCProcessor.cpp:2384</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a015cf0d6925d026e5bd9d82aa31083b6" name="a015cf0d6925d026e5bd9d82aa31083b6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a015cf0d6925d026e5bd9d82aa31083b6">&#9670;&#160;</a></span>ScanParameterOrder()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void MCMCProcessor::ScanParameterOrder </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Scan order of params from a different groups. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8cpp_source.html#l02301">2301</a> of file <a class="el" href="MCMCProcessor_8cpp_source.html">MCMCProcessor.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2301</span>                                       {</div>
<div class="line"><span class="lineno"> 2302</span><span class="comment">// *****************************</span></div>
<div class="line"><span class="lineno"> 2303</span>  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_enumvalue" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20babd8035289bbe1770c6cb4d4d3e9d1b5a">kNParameterEnum</a>; i++)</div>
<div class="line"><span class="lineno"> 2304</span>  {</div>
<div class="line"><span class="lineno"> 2305</span>    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j = 0; j &lt; <a class="code hl_variable" href="classMCMCProcessor.html#aaa903949bde8f1a69800c71fe1eb538e">ParamType</a>.size(); j++)</div>
<div class="line"><span class="lineno"> 2306</span>    {</div>
<div class="line"><span class="lineno"> 2307</span>      <span class="keywordflow">if</span>(<a class="code hl_variable" href="classMCMCProcessor.html#aaa903949bde8f1a69800c71fe1eb538e">ParamType</a>[j] == <a class="code hl_enumeration" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20b">ParameterEnum</a>(i)) </div>
<div class="line"><span class="lineno"> 2308</span>      {</div>
<div class="line"><span class="lineno"> 2309</span>        <span class="comment">//KS: When we find that i-th parameter types start at j, save and move to the next parameter.</span></div>
<div class="line"><span class="lineno"> 2310</span>        <a class="code hl_variable" href="classMCMCProcessor.html#aeab63979ff36256072c046a15d981875">ParamTypeStartPos</a>[i] = j;</div>
<div class="line"><span class="lineno"> 2311</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2312</span>      }</div>
<div class="line"><span class="lineno"> 2313</span>    }</div>
<div class="line"><span class="lineno"> 2314</span>  }</div>
<div class="line"><span class="lineno"> 2315</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a09a6fa6cefcb20c00bee22c1dc5718c5" name="a09a6fa6cefcb20c00bee22c1dc5718c5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a09a6fa6cefcb20c00bee22c1dc5718c5">&#9670;&#160;</a></span>SetExcludedNames()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void MCMCProcessor::SetExcludedNames </td>
          <td>(</td>
          <td class="paramtype">std::vector&lt; std::string &gt;&#160;</td>
          <td class="paramname"><em>Name</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00244">244</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  244</span>{<a class="code hl_variable" href="classMCMCProcessor.html#a7425f7802e50bcb5ff4b38e20157c423">ExcludedNames</a> = Name; };</div>
</div><!-- fragment -->
</div>
</div>
<a id="a4364a8ab084906c8925c9db9dc110485" name="a4364a8ab084906c8925c9db9dc110485"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4364a8ab084906c8925c9db9dc110485">&#9670;&#160;</a></span>SetExcludedTypes()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void MCMCProcessor::SetExcludedTypes </td>
          <td>(</td>
          <td class="paramtype">std::vector&lt; std::string &gt;&#160;</td>
          <td class="paramname"><em>Name</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Setter related what parameters we want to exclude from analysis, for example if cross-section parameters look like xsec_, then passing "xsec_" will. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">Batches</td><td>Vector with parameters type names we want to exclude </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00243">243</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  243</span>{<a class="code hl_variable" href="classMCMCProcessor.html#aada4aadea10661586b46c1013a9d018f">ExcludedTypes</a> = Name; };</div>
</div><!-- fragment -->
</div>
</div>
<a id="a7f61cf0a51670f24f16dd7d77b7f5ae4" name="a7f61cf0a51670f24f16dd7d77b7f5ae4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7f61cf0a51670f24f16dd7d77b7f5ae4">&#9670;&#160;</a></span>SetFancyNames()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void MCMCProcessor::SetFancyNames </td>
          <td>(</td>
          <td class="paramtype">const bool&#160;</td>
          <td class="paramname"><em>PlotOrNot</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00232">232</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  232</span>{<a class="code hl_variable" href="classMCMCProcessor.html#ad25fe818c94163b0c4a8fcdfd387c148">FancyPlotNames</a> = PlotOrNot; };</div>
</div><!-- fragment -->
</div>
</div>
<a id="a5b13f1879f84d13b7d139432a9b993c6" name="a5b13f1879f84d13b7d139432a9b993c6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5b13f1879f84d13b7d139432a9b993c6">&#9670;&#160;</a></span>SetnBatches()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void MCMCProcessor::SetnBatches </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>Batches</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Set value of Nbatches used for batched mean, this need to be done earlier as batches are made when reading tree. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">Batches</td><td>Number of batches, default is 20 </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00248">248</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  248</span>{<a class="code hl_variable" href="classMCMCProcessor.html#a02c5a3f849cf217705816c650c678d19">nBatches</a> = Batches; };</div>
</div><!-- fragment -->
</div>
</div>
<a id="a173d37d528ff201e66db8f92c156e3bb" name="a173d37d528ff201e66db8f92c156e3bb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a173d37d528ff201e66db8f92c156e3bb">&#9670;&#160;</a></span>SetnLags()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void MCMCProcessor::SetnLags </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>nLags</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00249">249</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  249</span>{<a class="code hl_variable" href="classMCMCProcessor.html#a6156bba72e1f076e66f0356e48506a36">AutoCorrLag</a> = nLags; };</div>
</div><!-- fragment -->
</div>
</div>
<a id="a2f4bf14c95b830c457a73be5399403ad" name="a2f4bf14c95b830c457a73be5399403ad"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2f4bf14c95b830c457a73be5399403ad">&#9670;&#160;</a></span>SetOutputSuffix()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void MCMCProcessor::SetOutputSuffix </td>
          <td>(</td>
          <td class="paramtype">const std::string&#160;</td>
          <td class="paramname"><em>Suffix</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Sett output suffix, this way jobs using the same file will have different names. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00252">252</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  252</span>{<a class="code hl_variable" href="classMCMCProcessor.html#aa34b50ce33fb2cb7d9e9ef2d9f2f67c1">OutputSuffix</a> = Suffix; };</div>
</div><!-- fragment -->
</div>
</div>
<a id="aed120fafdfe97615f4c2a30aedde03dd" name="aed120fafdfe97615f4c2a30aedde03dd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aed120fafdfe97615f4c2a30aedde03dd">&#9670;&#160;</a></span>SetPlotBinValue()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void MCMCProcessor::SetPlotBinValue </td>
          <td>(</td>
          <td class="paramtype">const bool&#160;</td>
          <td class="paramname"><em>PlotOrNot</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00231">231</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  231</span>{<a class="code hl_variable" href="classMCMCProcessor.html#aa7611f55ac3c0ea70607761d037fbd91">plotBinValue</a> = PlotOrNot; };</div>
</div><!-- fragment -->
</div>
</div>
<a id="adbe0ec06ce30447cb1c03a961364b929" name="adbe0ec06ce30447cb1c03a961364b929"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adbe0ec06ce30447cb1c03a961364b929">&#9670;&#160;</a></span>SetPlotErrorForFlatPrior()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void MCMCProcessor::SetPlotErrorForFlatPrior </td>
          <td>(</td>
          <td class="paramtype">const bool&#160;</td>
          <td class="paramname"><em>PlotOrNot</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Set whether you want to plot error for parameters which have flat prior. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00230">230</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  230</span>{<a class="code hl_variable" href="classMCMCProcessor.html#ad24411a2556504c440ff0af045e8e7aa">PlotFlatPrior</a> = PlotOrNot; };</div>
</div><!-- fragment -->
</div>
</div>
<a id="a6ea549289949ac19d2fc768d82c8f1c9" name="a6ea549289949ac19d2fc768d82c8f1c9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6ea549289949ac19d2fc768d82c8f1c9">&#9670;&#160;</a></span>SetPlotRelativeToPrior()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void MCMCProcessor::SetPlotRelativeToPrior </td>
          <td>(</td>
          <td class="paramtype">const bool&#160;</td>
          <td class="paramname"><em>PlotOrNot</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>You can set relative to prior or relative to generated. It is advised to use relate to prior. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">PlotOrNot</td><td>bool controlling plotRelativeToPrior argument </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00227">227</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  227</span>{<a class="code hl_variable" href="classMCMCProcessor.html#afbac2a114c15ca7db4abe71dd549504c">plotRelativeToPrior</a> = PlotOrNot; };</div>
</div><!-- fragment -->
</div>
</div>
<a id="ab605f4d7bf4e2b24b4c0b1c5853b479f" name="ab605f4d7bf4e2b24b4c0b1c5853b479f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab605f4d7bf4e2b24b4c0b1c5853b479f">&#9670;&#160;</a></span>SetPost2DPlotThreshold()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void MCMCProcessor::SetPost2DPlotThreshold </td>
          <td>(</td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>Threshold</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Code will only plot 2D posteriors if Correlation are larger than defined threshold. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">Threshold</td><td>This threshold is compared with correlation value </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00237">237</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  237</span>{<a class="code hl_variable" href="classMCMCProcessor.html#a25e4685b6299181021b02ac0e0b74681">Post2DPlotThreshold</a> = Threshold; };</div>
</div><!-- fragment -->
</div>
</div>
<a id="a641da7f5e018d48d480638fbad6406a4" name="a641da7f5e018d48d480638fbad6406a4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a641da7f5e018d48d480638fbad6406a4">&#9670;&#160;</a></span>SetPosterior1DCut()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void MCMCProcessor::SetPosterior1DCut </td>
          <td>(</td>
          <td class="paramtype">const std::string&#160;</td>
          <td class="paramname"><em>Cut</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Allow to set addtional cuts based on ROOT TBrowser cut, for to only affect one mass ordering. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00254">254</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  254</span>{<a class="code hl_variable" href="classMCMCProcessor.html#a85917e25c4f5b5b966c50cccd9ddd6a0">Posterior1DCut</a> = Cut; };</div>
</div><!-- fragment -->
</div>
</div>
<a id="a9db87211d9f066011daed18af7f4631e" name="a9db87211d9f066011daed18af7f4631e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9db87211d9f066011daed18af7f4631e">&#9670;&#160;</a></span>SetPrintToPDF()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void MCMCProcessor::SetPrintToPDF </td>
          <td>(</td>
          <td class="paramtype">const bool&#160;</td>
          <td class="paramname"><em>PlotOrNot</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00228">228</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  228</span>{<a class="code hl_variable" href="classMCMCProcessor.html#ad73755714ae3d6dc951158d5513c6eee">printToPDF</a> = PlotOrNot; };</div>
</div><!-- fragment -->
</div>
</div>
<a id="a4bec41cdc9af977a51b269e2a07fe961" name="a4bec41cdc9af977a51b269e2a07fe961"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4bec41cdc9af977a51b269e2a07fe961">&#9670;&#160;</a></span>SetSmoothing()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void MCMCProcessor::SetSmoothing </td>
          <td>(</td>
          <td class="paramtype">const bool&#160;</td>
          <td class="paramname"><em>PlotOrNot</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Set whether want to use smoothing for histograms using ROOT algorithm. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00234">234</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  234</span>{<a class="code hl_variable" href="classMCMCProcessor.html#a682c1c47626542f5820d633ba2bc010c">ApplySmoothing</a> = PlotOrNot; };</div>
</div><!-- fragment -->
</div>
</div>
<a id="a16f653dcb6358f2a8e393e3946a7e6d2" name="a16f653dcb6358f2a8e393e3946a7e6d2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a16f653dcb6358f2a8e393e3946a7e6d2">&#9670;&#160;</a></span>SetStepCut() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void MCMCProcessor::SetStepCut </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>Cuts</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set the step cutting by int. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">Cuts</td><td>integer telling cut value </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8cpp_source.html#l02685">2685</a> of file <a class="el" href="MCMCProcessor_8cpp_source.html">MCMCProcessor.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2685</span>                                             {</div>
<div class="line"><span class="lineno"> 2686</span><span class="comment">// ***************</span></div>
<div class="line"><span class="lineno"> 2687</span>  std::stringstream TempStream;</div>
<div class="line"><span class="lineno"> 2688</span>  TempStream &lt;&lt; <span class="stringliteral">&quot;step &gt; &quot;</span> &lt;&lt; Cuts;</div>
<div class="line"><span class="lineno"> 2689</span>  <a class="code hl_variable" href="classMCMCProcessor.html#a576f0eb874afaf7e31ff5c86b9e5b8f9">StepCut</a> = TempStream.str();</div>
<div class="line"><span class="lineno"> 2690</span>  <a class="code hl_variable" href="classMCMCProcessor.html#a22f82dadceccbe87dd8c5b7daa8432e8">BurnInCut</a> = Cuts;</div>
<div class="line"><span class="lineno"> 2691</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ad610d8e835031872b428e759ef4045f1" name="ad610d8e835031872b428e759ef4045f1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad610d8e835031872b428e759ef4045f1">&#9670;&#160;</a></span>SetStepCut() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void MCMCProcessor::SetStepCut </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>Cuts</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set the step cutting by string. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">Cuts</td><td>string telling cut value </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8cpp_source.html#l02677">2677</a> of file <a class="el" href="MCMCProcessor_8cpp_source.html">MCMCProcessor.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2677</span>                                                    {</div>
<div class="line"><span class="lineno"> 2678</span><span class="comment">// ***************</span></div>
<div class="line"><span class="lineno"> 2679</span>  <a class="code hl_variable" href="classMCMCProcessor.html#a576f0eb874afaf7e31ff5c86b9e5b8f9">StepCut</a> = Cuts;</div>
<div class="line"><span class="lineno"> 2680</span>  <a class="code hl_variable" href="classMCMCProcessor.html#a22f82dadceccbe87dd8c5b7daa8432e8">BurnInCut</a> = std::stoi( Cuts );</div>
<div class="line"><span class="lineno"> 2681</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="aa4761be1345f1be3defe162b278a9d8e" name="aa4761be1345f1be3defe162b278a9d8e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa4761be1345f1be3defe162b278a9d8e">&#9670;&#160;</a></span>SetupOutput()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void MCMCProcessor::SetupOutput </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Prepare all objects used for output. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8cpp_source.html#l02245">2245</a> of file <a class="el" href="MCMCProcessor_8cpp_source.html">MCMCProcessor.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2245</span>                                {</div>
<div class="line"><span class="lineno"> 2246</span><span class="comment">// ****************************</span></div>
<div class="line"><span class="lineno"> 2247</span> </div>
<div class="line"><span class="lineno"> 2248</span>  <span class="comment">// Make sure we can read files located anywhere and strip the .root ending</span></div>
<div class="line"><span class="lineno"> 2249</span>  <a class="code hl_variable" href="classMCMCProcessor.html#a6d212d77a818304a8674a7b9b18d43b8">MCMCFile</a> = <a class="code hl_variable" href="classMCMCProcessor.html#a6d212d77a818304a8674a7b9b18d43b8">MCMCFile</a>.substr(0, <a class="code hl_variable" href="classMCMCProcessor.html#a6d212d77a818304a8674a7b9b18d43b8">MCMCFile</a>.find(<span class="stringliteral">&quot;.root&quot;</span>));</div>
<div class="line"><span class="lineno"> 2250</span> </div>
<div class="line"><span class="lineno"> 2251</span>  <span class="comment">// Check if the output file is ready</span></div>
<div class="line"><span class="lineno"> 2252</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="classMCMCProcessor.html#a62035b99df4617ab334cd1abd6ed0346">OutputFile</a> == <span class="keyword">nullptr</span>) <a class="code hl_function" href="classMCMCProcessor.html#aa5a7761e97cf2e24c7d877a5374b7333">MakeOutputFile</a>();</div>
<div class="line"><span class="lineno"> 2253</span>  </div>
<div class="line"><span class="lineno"> 2254</span>  <a class="code hl_variable" href="classMCMCProcessor.html#ab5aec3dc293919701d31e6ae705601dd">CanvasName</a> = <a class="code hl_variable" href="classMCMCProcessor.html#a6d212d77a818304a8674a7b9b18d43b8">MCMCFile</a> + <a class="code hl_variable" href="classMCMCProcessor.html#aa34b50ce33fb2cb7d9e9ef2d9f2f67c1">OutputSuffix</a> + <span class="stringliteral">&quot;.pdf[&quot;</span>;</div>
<div class="line"><span class="lineno"> 2255</span>  <span class="keywordflow">if</span>(<a class="code hl_variable" href="classMCMCProcessor.html#ad73755714ae3d6dc951158d5513c6eee">printToPDF</a>) <a class="code hl_variable" href="classMCMCProcessor.html#a82e6cfef1ba6fcfc8ac8f61acb5bf931">Posterior</a>-&gt;Print(<a class="code hl_variable" href="classMCMCProcessor.html#ab5aec3dc293919701d31e6ae705601dd">CanvasName</a>);</div>
<div class="line"><span class="lineno"> 2256</span> </div>
<div class="line"><span class="lineno"> 2257</span>  <span class="comment">// Once the pdf file is open no longer need to bracket</span></div>
<div class="line"><span class="lineno"> 2258</span>  <a class="code hl_variable" href="classMCMCProcessor.html#ab5aec3dc293919701d31e6ae705601dd">CanvasName</a>.ReplaceAll(<span class="stringliteral">&quot;[&quot;</span>,<span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><span class="lineno"> 2259</span> </div>
<div class="line"><span class="lineno"> 2260</span>  <span class="comment">// We fit with this Gaussian</span></div>
<div class="line"><span class="lineno"> 2261</span>  <a class="code hl_variable" href="classMCMCProcessor.html#a92c1d9b0ebdf90951221cdaf2ac4cc2c">Gauss</a> = <span class="keyword">new</span> TF1(<span class="stringliteral">&quot;gauss&quot;</span>,<span class="stringliteral">&quot;[0]/sqrt(2.0*3.14159)/[2]*TMath::Exp(-0.5*pow(x-[1],2)/[2]/[2])&quot;</span>, -5, 5);</div>
<div class="line"><span class="lineno"> 2262</span> </div>
<div class="line"><span class="lineno"> 2263</span>  <span class="comment">// Declare the TVectors</span></div>
<div class="line"><span class="lineno"> 2264</span>  <a class="code hl_variable" href="classMCMCProcessor.html#af9a40632e2d7f1266d69a74d5b5f2244">Covariance</a> = <span class="keyword">new</span> TMatrixDSym(<a class="code hl_variable" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>);</div>
<div class="line"><span class="lineno"> 2265</span>  <a class="code hl_variable" href="classMCMCProcessor.html#a03f28431158777cdd81d058b6632a92f">Correlation</a> = <span class="keyword">new</span> TMatrixDSym(<a class="code hl_variable" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>);</div>
<div class="line"><span class="lineno"> 2266</span>  <a class="code hl_variable" href="classMCMCProcessor.html#aad661c6d53f9f891e18ff8ccdbd08479">Central_Value</a> = <span class="keyword">new</span> TVectorD(<a class="code hl_variable" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>);</div>
<div class="line"><span class="lineno"> 2267</span>  <a class="code hl_variable" href="classMCMCProcessor.html#acaf7f239136dfa3506d095b612323d0a">Means</a> = <span class="keyword">new</span> TVectorD(<a class="code hl_variable" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>);</div>
<div class="line"><span class="lineno"> 2268</span>  <a class="code hl_variable" href="classMCMCProcessor.html#a5174aaa900edf16ddc6e841ea4adae83">Errors</a> = <span class="keyword">new</span> TVectorD(<a class="code hl_variable" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>);</div>
<div class="line"><span class="lineno"> 2269</span>  <a class="code hl_variable" href="classMCMCProcessor.html#a600fc8c39af2750df91fb7a0ff85ac74">Means_Gauss</a> = <span class="keyword">new</span> TVectorD(<a class="code hl_variable" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>);</div>
<div class="line"><span class="lineno"> 2270</span>  <a class="code hl_variable" href="classMCMCProcessor.html#aa78b7ed1bb9966f84f4eaf8cedf5e688">Errors_Gauss</a> = <span class="keyword">new</span> TVectorD(<a class="code hl_variable" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>);</div>
<div class="line"><span class="lineno"> 2271</span>  <a class="code hl_variable" href="classMCMCProcessor.html#a32657dc39a7fc0d04804f6195a3d8c3e">Means_HPD</a>    = <span class="keyword">new</span> TVectorD(<a class="code hl_variable" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>);</div>
<div class="line"><span class="lineno"> 2272</span>  <a class="code hl_variable" href="classMCMCProcessor.html#abb5c6ad85c89227bbb9bc5de2eb71272">Errors_HPD</a>   = <span class="keyword">new</span> TVectorD(<a class="code hl_variable" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>);</div>
<div class="line"><span class="lineno"> 2273</span>  <a class="code hl_variable" href="classMCMCProcessor.html#af96664fa8cc51c49ad1385da07a343b8">Errors_HPD_Positive</a> = <span class="keyword">new</span> TVectorD(<a class="code hl_variable" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>);</div>
<div class="line"><span class="lineno"> 2274</span>  <a class="code hl_variable" href="classMCMCProcessor.html#a7b85df39f22390dac24f4d66a89518e5">Errors_HPD_Negative</a> = <span class="keyword">new</span> TVectorD(<a class="code hl_variable" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>);</div>
<div class="line"><span class="lineno"> 2275</span> </div>
<div class="line"><span class="lineno"> 2276</span>  <span class="comment">// Initialise to something silly</span></div>
<div class="line"><span class="lineno"> 2277</span><span class="preprocessor">  #ifdef MULTITHREAD</span></div>
<div class="line"><span class="lineno"> 2278</span><span class="preprocessor">  #pragma omp parallel for</span></div>
<div class="line"><span class="lineno"> 2279</span><span class="preprocessor">  #endif</span></div>
<div class="line"><span class="lineno"> 2280</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_variable" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>; ++i)</div>
<div class="line"><span class="lineno"> 2281</span>  {</div>
<div class="line"><span class="lineno"> 2282</span>    (*Central_Value)(i) = <a class="code hl_define" href="MCMCProcessor_8h.html#a82a6d79039474bc403b627437a7b97ec">_UNDEF_</a>;</div>
<div class="line"><span class="lineno"> 2283</span>    (*Means)(i) = <a class="code hl_define" href="MCMCProcessor_8h.html#a82a6d79039474bc403b627437a7b97ec">_UNDEF_</a>;</div>
<div class="line"><span class="lineno"> 2284</span>    (*Errors)(i) = <a class="code hl_define" href="MCMCProcessor_8h.html#a82a6d79039474bc403b627437a7b97ec">_UNDEF_</a>;</div>
<div class="line"><span class="lineno"> 2285</span>    (*Means_Gauss)(i) = <a class="code hl_define" href="MCMCProcessor_8h.html#a82a6d79039474bc403b627437a7b97ec">_UNDEF_</a>;</div>
<div class="line"><span class="lineno"> 2286</span>    (*Errors_Gauss)(i) = <a class="code hl_define" href="MCMCProcessor_8h.html#a82a6d79039474bc403b627437a7b97ec">_UNDEF_</a>;</div>
<div class="line"><span class="lineno"> 2287</span>    (*Means_HPD)(i) = <a class="code hl_define" href="MCMCProcessor_8h.html#a82a6d79039474bc403b627437a7b97ec">_UNDEF_</a>;</div>
<div class="line"><span class="lineno"> 2288</span>    (*Errors_HPD)(i) = <a class="code hl_define" href="MCMCProcessor_8h.html#a82a6d79039474bc403b627437a7b97ec">_UNDEF_</a>;</div>
<div class="line"><span class="lineno"> 2289</span>    (*Errors_HPD_Positive)(i) = <a class="code hl_define" href="MCMCProcessor_8h.html#a82a6d79039474bc403b627437a7b97ec">_UNDEF_</a>;</div>
<div class="line"><span class="lineno"> 2290</span>    (*Errors_HPD_Negative)(i) = <a class="code hl_define" href="MCMCProcessor_8h.html#a82a6d79039474bc403b627437a7b97ec">_UNDEF_</a>;</div>
<div class="line"><span class="lineno"> 2291</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a class="code hl_variable" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>; ++j) {</div>
<div class="line"><span class="lineno"> 2292</span>      (*Covariance)(i, j) = <a class="code hl_define" href="MCMCProcessor_8h.html#a82a6d79039474bc403b627437a7b97ec">_UNDEF_</a>;</div>
<div class="line"><span class="lineno"> 2293</span>      (*Correlation)(i, j) = <a class="code hl_define" href="MCMCProcessor_8h.html#a82a6d79039474bc403b627437a7b97ec">_UNDEF_</a>;</div>
<div class="line"><span class="lineno"> 2294</span>    }</div>
<div class="line"><span class="lineno"> 2295</span>  }</div>
<div class="line"><span class="lineno"> 2296</span>  <a class="code hl_variable" href="classMCMCProcessor.html#a795f661ed1ba8b8ae54c41fde5fb9496">hpost</a>.resize(<a class="code hl_variable" href="classMCMCProcessor.html#aa30545fedb0af2ad9619d6accf42a10d">nDraw</a>);</div>
<div class="line"><span class="lineno"> 2297</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ab90c5ec77c57103dfaa72648c330a390" name="ab90c5ec77c57103dfaa72648c330a390"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab90c5ec77c57103dfaa72648c330a390">&#9670;&#160;</a></span>SetUseFFTAutoCorrelation()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void MCMCProcessor::SetUseFFTAutoCorrelation </td>
          <td>(</td>
          <td class="paramtype">const bool&#160;</td>
          <td class="paramname"><em>useFFT</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Toggle using the FFT-based autocorrelation calculator. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00239">239</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  239</span>{<a class="code hl_variable" href="classMCMCProcessor.html#a562261269f0f4ec4a209b2fca64ff443">useFFTAutoCorrelation</a> = useFFT; };</div>
</div><!-- fragment -->
</div>
</div>
<a id="a623957be60ec7c48145e80d0014ef971" name="a623957be60ec7c48145e80d0014ef971"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a623957be60ec7c48145e80d0014ef971">&#9670;&#160;</a></span>ThinMCMC()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void MCMCProcessor::ThinMCMC </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>ThinningCut</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Thin MCMC Chain, to save space and maintain low autocorrelations. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ThinningCut</td><td>every which entry you want to thin </td></tr>
    <tr><td class="paramname">Average</td><td>If true will perform MCMC averaging instead of thinning </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00166">166</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  166</span>{ <a class="code hl_function" href="StatisticalUtils_8h.html#aa6fd944e00fcda133cfef10782f08de0">ThinningMCMC</a>(<a class="code hl_variable" href="classMCMCProcessor.html#a6d212d77a818304a8674a7b9b18d43b8">MCMCFile</a>+<span class="stringliteral">&quot;.root&quot;</span>, ThinningCut); };</div>
<div class="ttc" id="aStatisticalUtils_8h_html_aa6fd944e00fcda133cfef10782f08de0"><div class="ttname"><a href="StatisticalUtils_8h.html#aa6fd944e00fcda133cfef10782f08de0">ThinningMCMC</a></div><div class="ttdeci">void ThinningMCMC(const std::string &amp;FilePath, const int ThinningCut)</div><div class="ttdoc">Thin MCMC Chain, to save space and maintain low autocorrelations.</div><div class="ttdef"><b>Definition:</b> <a href="StatisticalUtils_8h_source.html#l00542">StatisticalUtils.h:542</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="a523a223a4754c133121796f4591c7be3" name="a523a223a4754c133121796f4591c7be3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a523a223a4754c133121796f4591c7be3">&#9670;&#160;</a></span>AccProbBatchedAverages</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double* MCMCProcessor::AccProbBatchedAverages</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Holds all accProb in batches. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00496">496</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>

</div>
</div>
<a id="a88cab29770fd6098a674a0ab3628a251" name="a88cab29770fd6098a674a0ab3628a251"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a88cab29770fd6098a674a0ab3628a251">&#9670;&#160;</a></span>AccProbValues</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double* MCMCProcessor::AccProbValues</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Holds all accProb. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00494">494</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>

</div>
</div>
<a id="a682c1c47626542f5820d633ba2bc010c" name="a682c1c47626542f5820d633ba2bc010c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a682c1c47626542f5820d633ba2bc010c">&#9670;&#160;</a></span>ApplySmoothing</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool MCMCProcessor::ApplySmoothing</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Apply smoothing for 2D histos using root algorithm. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00410">410</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>

</div>
</div>
<a id="a6156bba72e1f076e66f0356e48506a36" name="a6156bba72e1f076e66f0356e48506a36"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6156bba72e1f076e66f0356e48506a36">&#9670;&#160;</a></span>AutoCorrLag</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int MCMCProcessor::AutoCorrLag</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>LagL used in AutoCorrelation. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00481">481</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>

</div>
</div>
<a id="ab3f590b501162fc2ee5b78ce75689771" name="ab3f590b501162fc2ee5b78ce75689771"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab3f590b501162fc2ee5b78ce75689771">&#9670;&#160;</a></span>BatchedAverages</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double** MCMCProcessor::BatchedAverages</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Values of batched average for every param and batch. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00486">486</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>

</div>
</div>
<a id="ad043b6b2c885f47ab9967831bc8d0f5a" name="ad043b6b2c885f47ab9967831bc8d0f5a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad043b6b2c885f47ab9967831bc8d0f5a">&#9670;&#160;</a></span>BranchNames</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;TString&gt; MCMCProcessor::BranchNames</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00355">355</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>

</div>
</div>
<a id="a22f82dadceccbe87dd8c5b7daa8432e8" name="a22f82dadceccbe87dd8c5b7daa8432e8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a22f82dadceccbe87dd8c5b7daa8432e8">&#9670;&#160;</a></span>BurnInCut</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int MCMCProcessor::BurnInCut</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Value of burn in cut. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00340">340</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>

</div>
</div>
<a id="aea84f0315695aa05ec41fcf965b1b031" name="aea84f0315695aa05ec41fcf965b1b031"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aea84f0315695aa05ec41fcf965b1b031">&#9670;&#160;</a></span>CacheMCMC</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool MCMCProcessor::CacheMCMC</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>MCMC Chain has been cached. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00473">473</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>

</div>
</div>
<a id="ab5aec3dc293919701d31e6ae705601dd" name="ab5aec3dc293919701d31e6ae705601dd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab5aec3dc293919701d31e6ae705601dd">&#9670;&#160;</a></span>CanvasName</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">TString MCMCProcessor::CanvasName</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Name of canvas which help to save to the sample pdf. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00391">391</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>

</div>
</div>
<a id="aad661c6d53f9f891e18ff8ccdbd08479" name="aad661c6d53f9f891e18ff8ccdbd08479"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aad661c6d53f9f891e18ff8ccdbd08479">&#9670;&#160;</a></span>Central_Value</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">TVectorD* MCMCProcessor::Central_Value</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Vector with central value for each parameter. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00430">430</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>

</div>
</div>
<a id="a6be3bbebd4a79fe9814a3da09b3bb820" name="a6be3bbebd4a79fe9814a3da09b3bb820"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6be3bbebd4a79fe9814a3da09b3bb820">&#9670;&#160;</a></span>Chain</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">TChain* MCMCProcessor::Chain</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Main chain storing all steps etc. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00332">332</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>

</div>
</div>
<a id="a03f28431158777cdd81d058b6632a92f" name="a03f28431158777cdd81d058b6632a92f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a03f28431158777cdd81d058b6632a92f">&#9670;&#160;</a></span>Correlation</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">TMatrixDSym* MCMCProcessor::Correlation</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Posterior Correlation Matrix. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00451">451</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>

</div>
</div>
<a id="af9a40632e2d7f1266d69a74d5b5f2244" name="af9a40632e2d7f1266d69a74d5b5f2244"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af9a40632e2d7f1266d69a74d5b5f2244">&#9670;&#160;</a></span>Covariance</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">TMatrixDSym* MCMCProcessor::Covariance</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Posterior Covariance Matrix. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00449">449</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>

</div>
</div>
<a id="a4c1330a025c0b91e382bdc29c960424a" name="a4c1330a025c0b91e382bdc29c960424a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4c1330a025c0b91e382bdc29c960424a">&#9670;&#160;</a></span>CovConfig</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;YAML::Node&gt; MCMCProcessor::CovConfig</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Covariance matrix config. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00329">329</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>

</div>
</div>
<a id="a7c6afb0ed75207fd02c28e408f0592d4" name="a7c6afb0ed75207fd02c28e408f0592d4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7c6afb0ed75207fd02c28e408f0592d4">&#9670;&#160;</a></span>CovPos</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;std::vector&lt;std::string&gt; &gt; MCMCProcessor::CovPos</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Covariance matrix name position. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00327">327</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>

</div>
</div>
<a id="adf449e50cf358f737fe4a2b65d9668e9" name="adf449e50cf358f737fe4a2b65d9668e9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adf449e50cf358f737fe4a2b65d9668e9">&#9670;&#160;</a></span>doDiagMCMC</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool MCMCProcessor::doDiagMCMC</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Doing MCMC Diagnostic. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00475">475</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>

</div>
</div>
<a id="a4abe633b264acd9b0459c7b8ccd8b9df" name="a4abe633b264acd9b0459c7b8ccd8b9df"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4abe633b264acd9b0459c7b8ccd8b9df">&#9670;&#160;</a></span>DrawRange</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double MCMCProcessor::DrawRange</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Drawrange for SetMaximum. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00470">470</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>

</div>
</div>
<a id="a5174aaa900edf16ddc6e841ea4adae83" name="a5174aaa900edf16ddc6e841ea4adae83"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5174aaa900edf16ddc6e841ea4adae83">&#9670;&#160;</a></span>Errors</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">TVectorD* MCMCProcessor::Errors</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Vector with errors values using RMS. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00434">434</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>

</div>
</div>
<a id="aa78b7ed1bb9966f84f4eaf8cedf5e688" name="aa78b7ed1bb9966f84f4eaf8cedf5e688"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa78b7ed1bb9966f84f4eaf8cedf5e688">&#9670;&#160;</a></span>Errors_Gauss</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">TVectorD* MCMCProcessor::Errors_Gauss</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Vector with error values using Gaussian fit. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00438">438</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>

</div>
</div>
<a id="abb5c6ad85c89227bbb9bc5de2eb71272" name="abb5c6ad85c89227bbb9bc5de2eb71272"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abb5c6ad85c89227bbb9bc5de2eb71272">&#9670;&#160;</a></span>Errors_HPD</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">TVectorD* MCMCProcessor::Errors_HPD</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Vector with error values using Highest Posterior Density. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00442">442</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>

</div>
</div>
<a id="a7b85df39f22390dac24f4d66a89518e5" name="a7b85df39f22390dac24f4d66a89518e5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7b85df39f22390dac24f4d66a89518e5">&#9670;&#160;</a></span>Errors_HPD_Negative</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">TVectorD* MCMCProcessor::Errors_HPD_Negative</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Vector with negative error (left hand side) values using Highest Posterior Density. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00446">446</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>

</div>
</div>
<a id="af96664fa8cc51c49ad1385da07a343b8" name="af96664fa8cc51c49ad1385da07a343b8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af96664fa8cc51c49ad1385da07a343b8">&#9670;&#160;</a></span>Errors_HPD_Positive</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">TVectorD* MCMCProcessor::Errors_HPD_Positive</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Vector with positive error (right hand side) values using Highest Posterior Density. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00444">444</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>

</div>
</div>
<a id="a7425f7802e50bcb5ff4b38e20157c423" name="a7425f7802e50bcb5ff4b38e20157c423"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7425f7802e50bcb5ff4b38e20157c423">&#9670;&#160;</a></span>ExcludedNames</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;std::string&gt; MCMCProcessor::ExcludedNames</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00357">357</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>

</div>
</div>
<a id="aada4aadea10661586b46c1013a9d018f" name="aada4aadea10661586b46c1013a9d018f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aada4aadea10661586b46c1013a9d018f">&#9670;&#160;</a></span>ExcludedTypes</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;std::string&gt; MCMCProcessor::ExcludedTypes</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00356">356</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>

</div>
</div>
<a id="ad25fe818c94163b0c4a8fcdfd387c148" name="ad25fe818c94163b0c4a8fcdfd387c148"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad25fe818c94163b0c4a8fcdfd387c148">&#9670;&#160;</a></span>FancyPlotNames</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool MCMCProcessor::FancyPlotNames</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Whether we want fancy plot names or not. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00406">406</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>

</div>
</div>
<a id="a92c1d9b0ebdf90951221cdaf2ac4cc2c" name="a92c1d9b0ebdf90951221cdaf2ac4cc2c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a92c1d9b0ebdf90951221cdaf2ac4cc2c">&#9670;&#160;</a></span>Gauss</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">TF1* MCMCProcessor::Gauss</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Gaussian fitter. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00420">420</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>

</div>
</div>
<a id="a795f661ed1ba8b8ae54c41fde5fb9496" name="a795f661ed1ba8b8ae54c41fde5fb9496"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a795f661ed1ba8b8ae54c41fde5fb9496">&#9670;&#160;</a></span>hpost</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;TH1D*&gt; MCMCProcessor::hpost</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Holds 1D Posterior Distributions. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00454">454</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>

</div>
</div>
<a id="a0ddcfa4ba1e4dcdea366d88decc64391" name="a0ddcfa4ba1e4dcdea366d88decc64391"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0ddcfa4ba1e4dcdea366d88decc64391">&#9670;&#160;</a></span>hpost2D</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">TH2D*** MCMCProcessor::hpost2D</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Holds 2D Posterior Distributions. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00456">456</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>

</div>
</div>
<a id="a556988f03b24e3af33e9a29b23d2b1e2" name="a556988f03b24e3af33e9a29b23d2b1e2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a556988f03b24e3af33e9a29b23d2b1e2">&#9670;&#160;</a></span>hviolin</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">TH2D* MCMCProcessor::hviolin</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Holds violin plot for all dials. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00458">458</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>

</div>
</div>
<a id="a25d79f451d5d584c3e7ef0e1423e5e8e" name="a25d79f451d5d584c3e7ef0e1423e5e8e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a25d79f451d5d584c3e7ef0e1423e5e8e">&#9670;&#160;</a></span>hviolin_prior</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">TH2D* MCMCProcessor::hviolin_prior</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Holds prior violin plot for all dials,. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00460">460</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>

</div>
</div>
<a id="a95fa49737432818bc830a44898d0d850" name="a95fa49737432818bc830a44898d0d850"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a95fa49737432818bc830a44898d0d850">&#9670;&#160;</a></span>IamVaried</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;bool&gt; MCMCProcessor::IamVaried</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Is the ith parameter varied. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00360">360</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>

</div>
</div>
<a id="a2c06d64020e9246e720cc131a9f4986d" name="a2c06d64020e9246e720cc131a9f4986d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2c06d64020e9246e720cc131a9f4986d">&#9670;&#160;</a></span>IsXsec</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;bool&gt; MCMCProcessor::IsXsec</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>In XsecMatrix we have both xsec and flux parameters, this is just for some plotting options </p><dl class="section warning"><dt>Warning</dt><dd>will become deprecated </dd></dl>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00378">378</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>

</div>
</div>
<a id="aecc35d4ea7d2c7e020e50388ba0ffb64" name="aecc35d4ea7d2c7e020e50388ba0ffb64"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aecc35d4ea7d2c7e020e50388ba0ffb64">&#9670;&#160;</a></span>MadePostfit</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool MCMCProcessor::MadePostfit</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Sanity check if Postfit is already done to not make several times. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00402">402</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>

</div>
</div>
<a id="a6d212d77a818304a8674a7b9b18d43b8" name="a6d212d77a818304a8674a7b9b18d43b8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6d212d77a818304a8674a7b9b18d43b8">&#9670;&#160;</a></span>MCMCFile</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::string MCMCProcessor::MCMCFile</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Name of MCMC file. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00323">323</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>

</div>
</div>
<a id="acaf7f239136dfa3506d095b612323d0a" name="acaf7f239136dfa3506d095b612323d0a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acaf7f239136dfa3506d095b612323d0a">&#9670;&#160;</a></span>Means</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">TVectorD* MCMCProcessor::Means</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Vector with mean values using Arithmetic Mean. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00432">432</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>

</div>
</div>
<a id="a600fc8c39af2750df91fb7a0ff85ac74" name="a600fc8c39af2750df91fb7a0ff85ac74"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a600fc8c39af2750df91fb7a0ff85ac74">&#9670;&#160;</a></span>Means_Gauss</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">TVectorD* MCMCProcessor::Means_Gauss</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Vector with mean values using Gaussian fit. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00436">436</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>

</div>
</div>
<a id="a32657dc39a7fc0d04804f6195a3d8c3e" name="a32657dc39a7fc0d04804f6195a3d8c3e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a32657dc39a7fc0d04804f6195a3d8c3e">&#9670;&#160;</a></span>Means_HPD</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">TVectorD* MCMCProcessor::Means_HPD</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Vector with mean values using Highest Posterior Density. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00440">440</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>

</div>
</div>
<a id="a02c5a3f849cf217705816c650c678d19" name="a02c5a3f849cf217705816c650c678d19"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a02c5a3f849cf217705816c650c678d19">&#9670;&#160;</a></span>nBatches</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int MCMCProcessor::nBatches</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Number of batches for Batched Mean. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00479">479</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>

</div>
</div>
<a id="a6b74f8195bcbca0979f9e9fe43468bae" name="a6b74f8195bcbca0979f9e9fe43468bae"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6b74f8195bcbca0979f9e9fe43468bae">&#9670;&#160;</a></span>nBins</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int MCMCProcessor::nBins</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Number of bins. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00468">468</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>

</div>
</div>
<a id="af6ba5d9aec5350fafebbf81309e813cb" name="af6ba5d9aec5350fafebbf81309e813cb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af6ba5d9aec5350fafebbf81309e813cb">&#9670;&#160;</a></span>nBranches</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int MCMCProcessor::nBranches</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Number of branches in a TTree. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00342">342</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>

</div>
</div>
<a id="aa30545fedb0af2ad9619d6accf42a10d" name="aa30545fedb0af2ad9619d6accf42a10d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa30545fedb0af2ad9619d6accf42a10d">&#9670;&#160;</a></span>nDraw</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int MCMCProcessor::nDraw</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Number of all parameters used in the analysis. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00352">352</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>

</div>
</div>
<a id="ae76b02ce85737d30c778698ba127933b" name="ae76b02ce85737d30c778698ba127933b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae76b02ce85737d30c778698ba127933b">&#9670;&#160;</a></span>NDSamplesBins</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; int &gt; MCMCProcessor::NDSamplesBins</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00416">416</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>

</div>
</div>
<a id="a27c8a25155baab660fc9658861c433ab" name="a27c8a25155baab660fc9658861c433ab"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a27c8a25155baab660fc9658861c433ab">&#9670;&#160;</a></span>NDSamplesNames</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; std::string &gt; MCMCProcessor::NDSamplesNames</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00417">417</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>

</div>
</div>
<a id="af3a19b885e9c34e1674aea8cfbe14e1c" name="af3a19b885e9c34e1674aea8cfbe14e1c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af3a19b885e9c34e1674aea8cfbe14e1c">&#9670;&#160;</a></span>nEntries</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int MCMCProcessor::nEntries</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>KS: For merged chains number of entries will be different from nSteps. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00344">344</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>

</div>
</div>
<a id="acfc681553c5fbba89e133dfda605db3c" name="acfc681553c5fbba89e133dfda605db3c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acfc681553c5fbba89e133dfda605db3c">&#9670;&#160;</a></span>nFlux</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int MCMCProcessor::nFlux</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>This keep number of Flux params in xsec matrix </p><dl class="section warning"><dt>Warning</dt><dd>will become deprecated </dd></dl>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00381">381</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>

</div>
</div>
<a id="a4200e7cbe1c8f811d3640ebfd648ca85" name="a4200e7cbe1c8f811d3640ebfd648ca85"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4200e7cbe1c8f811d3640ebfd648ca85">&#9670;&#160;</a></span>nParam</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;int&gt; MCMCProcessor::nParam</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Number of parameters per type. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00369">369</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>

</div>
</div>
<a id="a419d3669dbb54a55a635e35691134cc1" name="a419d3669dbb54a55a635e35691134cc1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a419d3669dbb54a55a635e35691134cc1">&#9670;&#160;</a></span>nSamples</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int MCMCProcessor::nSamples</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Number of sample PDF objects. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00348">348</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>

</div>
</div>
<a id="aae0016a4e1d105d5d65243438c622a97" name="aae0016a4e1d105d5d65243438c622a97"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aae0016a4e1d105d5d65243438c622a97">&#9670;&#160;</a></span>nSteps</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int MCMCProcessor::nSteps</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>KS: For merged chains number of entries will be different from nSteps. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00346">346</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>

</div>
</div>
<a id="adf518be96278f1d3901404cfbe767b67" name="adf518be96278f1d3901404cfbe767b67"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adf518be96278f1d3901404cfbe767b67">&#9670;&#160;</a></span>nSysts</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int MCMCProcessor::nSysts</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Number of covariance objects. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00350">350</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>

</div>
</div>
<a id="a62035b99df4617ab334cd1abd6ed0346" name="a62035b99df4617ab334cd1abd6ed0346"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a62035b99df4617ab334cd1abd6ed0346">&#9670;&#160;</a></span>OutputFile</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">TFile* MCMCProcessor::OutputFile</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The output file. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00423">423</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>

</div>
</div>
<a id="a3d17c1720b91d6d0361da0b5dabfbbff" name="a3d17c1720b91d6d0361da0b5dabfbbff"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3d17c1720b91d6d0361da0b5dabfbbff">&#9670;&#160;</a></span>OutputName</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::string MCMCProcessor::OutputName</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Name of output files. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00389">389</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>

</div>
</div>
<a id="aa34b50ce33fb2cb7d9e9ef2d9f2f67c1" name="aa34b50ce33fb2cb7d9e9ef2d9f2f67c1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa34b50ce33fb2cb7d9e9ef2d9f2f67c1">&#9670;&#160;</a></span>OutputSuffix</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::string MCMCProcessor::OutputSuffix</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Output file suffix useful when running over same file with different settings. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00325">325</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>

</div>
</div>
<a id="a3a6614826ae320e462211e38e96d9d02" name="a3a6614826ae320e462211e38e96d9d02"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3a6614826ae320e462211e38e96d9d02">&#9670;&#160;</a></span>ParamCentral</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;std::vector&lt;double&gt; &gt; MCMCProcessor::ParamCentral</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Parameters central values which we are going to analyse. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00364">364</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>

</div>
</div>
<a id="a3a97e3cb4be3ceb9eb721eac51d82d60" name="a3a97e3cb4be3ceb9eb721eac51d82d60"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3a97e3cb4be3ceb9eb721eac51d82d60">&#9670;&#160;</a></span>ParamErrors</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;std::vector&lt;double&gt; &gt; MCMCProcessor::ParamErrors</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00366">366</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>

</div>
</div>
<a id="a4be1eedb743e4ea410009a4fa45720f7" name="a4be1eedb743e4ea410009a4fa45720f7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4be1eedb743e4ea410009a4fa45720f7">&#9670;&#160;</a></span>ParamFlat</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;std::vector&lt;bool&gt; &gt; MCMCProcessor::ParamFlat</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00367">367</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>

</div>
</div>
<a id="adecc55689f7d37b9412f8886fe3480dc" name="adecc55689f7d37b9412f8886fe3480dc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adecc55689f7d37b9412f8886fe3480dc">&#9670;&#160;</a></span>ParamNames</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;std::vector&lt;TString&gt; &gt; MCMCProcessor::ParamNames</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Name of parameters which we are going to analyse. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00362">362</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>

</div>
</div>
<a id="a4c4c6aa4827a2fe54ce37defbb3d0475" name="a4c4c6aa4827a2fe54ce37defbb3d0475"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4c4c6aa4827a2fe54ce37defbb3d0475">&#9670;&#160;</a></span>ParamNom</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;std::vector&lt;double&gt; &gt; MCMCProcessor::ParamNom</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00365">365</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>

</div>
</div>
<a id="a7db98c7cf390b050f1acb927b4f55cab" name="a7db98c7cf390b050f1acb927b4f55cab"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7db98c7cf390b050f1acb927b4f55cab">&#9670;&#160;</a></span>ParamSums</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double* MCMCProcessor::ParamSums</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Total parameter sum for each param. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00484">484</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>

</div>
</div>
<a id="aaa903949bde8f1a69800c71fe1eb538e" name="aaa903949bde8f1a69800c71fe1eb538e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaa903949bde8f1a69800c71fe1eb538e">&#9670;&#160;</a></span>ParamType</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;<a class="el" href="MCMCProcessor_8h.html#acd2848273413543fe14936252942c20b">ParameterEnum</a>&gt; MCMCProcessor::ParamType</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Make an enum for which class this parameter belongs to so we don't have to keep string comparing. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00371">371</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>

</div>
</div>
<a id="aeab63979ff36256072c046a15d981875" name="aeab63979ff36256072c046a15d981875"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeab63979ff36256072c046a15d981875">&#9670;&#160;</a></span>ParamTypeStartPos</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;int&gt; MCMCProcessor::ParamTypeStartPos</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>KS: in MCMC output there is order of parameters so for example first goes xsec then nd det etc. Idea is that this parameter will keep track of it so code is flexible </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00374">374</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>

</div>
</div>
<a id="a087dca88a306acdc28afea7213e3623c" name="a087dca88a306acdc28afea7213e3623c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a087dca88a306acdc28afea7213e3623c">&#9670;&#160;</a></span>ParStep</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double** MCMCProcessor::ParStep</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Array holding values for all parameters. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00463">463</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>

</div>
</div>
<a id="aa7611f55ac3c0ea70607761d037fbd91" name="aa7611f55ac3c0ea70607761d037fbd91"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa7611f55ac3c0ea70607761d037fbd91">&#9670;&#160;</a></span>plotBinValue</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool MCMCProcessor::plotBinValue</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>If true it will print value on each bin of covariance matrix. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00408">408</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>

</div>
</div>
<a id="ad24411a2556504c440ff0af045e8e7aa" name="ad24411a2556504c440ff0af045e8e7aa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad24411a2556504c440ff0af045e8e7aa">&#9670;&#160;</a></span>PlotFlatPrior</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool MCMCProcessor::PlotFlatPrior</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Whether we plot flat prior or not, we usually provide error even for flat prior params. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00394">394</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>

</div>
</div>
<a id="af1392c6cff68e9f0a27e2c9a4e52cf4c" name="af1392c6cff68e9f0a27e2c9a4e52cf4c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af1392c6cff68e9f0a27e2c9a4e52cf4c">&#9670;&#160;</a></span>PlotJarlskog</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool MCMCProcessor::PlotJarlskog</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Will plot Jarlskog Invariant using information in the chain. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00396">396</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>

</div>
</div>
<a id="afbac2a114c15ca7db4abe71dd549504c" name="afbac2a114c15ca7db4abe71dd549504c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afbac2a114c15ca7db4abe71dd549504c">&#9670;&#160;</a></span>plotRelativeToPrior</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool MCMCProcessor::plotRelativeToPrior</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Whether we plot relative to prior or nominal, in most cases is prior. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00400">400</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>

</div>
</div>
<a id="a25e4685b6299181021b02ac0e0b74681" name="a25e4685b6299181021b02ac0e0b74681"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a25e4685b6299181021b02ac0e0b74681">&#9670;&#160;</a></span>Post2DPlotThreshold</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double MCMCProcessor::Post2DPlotThreshold</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>KS: Set Threshold when to plot 2D posterior as by default we get a LOT of plots. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00412">412</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>

</div>
</div>
<a id="a82e6cfef1ba6fcfc8ac8f61acb5bf931" name="a82e6cfef1ba6fcfc8ac8f61acb5bf931"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a82e6cfef1ba6fcfc8ac8f61acb5bf931">&#9670;&#160;</a></span>Posterior</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">TCanvas* MCMCProcessor::Posterior</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Fancy canvas used for our beautiful plots. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00426">426</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>

</div>
</div>
<a id="a85917e25c4f5b5b966c50cccd9ddd6a0" name="a85917e25c4f5b5b966c50cccd9ddd6a0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a85917e25c4f5b5b966c50cccd9ddd6a0">&#9670;&#160;</a></span>Posterior1DCut</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::string MCMCProcessor::Posterior1DCut</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Cut used when making 1D Posterior distribution. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00336">336</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>

</div>
</div>
<a id="ad73755714ae3d6dc951158d5513c6eee" name="ad73755714ae3d6dc951158d5513c6eee"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad73755714ae3d6dc951158d5513c6eee">&#9670;&#160;</a></span>printToPDF</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool MCMCProcessor::printToPDF</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Will plot all plot to PDF not only to root file. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00404">404</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>

</div>
</div>
<a id="a3660e404a6631cfa913a815481730a9b" name="a3660e404a6631cfa913a815481730a9b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3660e404a6631cfa913a815481730a9b">&#9670;&#160;</a></span>SampleName_v</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;TString&gt; MCMCProcessor::SampleName_v</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Vector of each systematic. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00384">384</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>

</div>
</div>
<a id="a28e89498420221149ec97c353c430bf8" name="a28e89498420221149ec97c353c430bf8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a28e89498420221149ec97c353c430bf8">&#9670;&#160;</a></span>SampleValues</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double** MCMCProcessor::SampleValues</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Holds the sample values. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00489">489</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>

</div>
</div>
<a id="a576f0eb874afaf7e31ff5c86b9e5b8f9" name="a576f0eb874afaf7e31ff5c86b9e5b8f9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a576f0eb874afaf7e31ff5c86b9e5b8f9">&#9670;&#160;</a></span>StepCut</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::string MCMCProcessor::StepCut</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>BurnIn Cuts. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00334">334</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>

</div>
</div>
<a id="a07549f3b67ca5409218d80c679f6e69e" name="a07549f3b67ca5409218d80c679f6e69e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a07549f3b67ca5409218d80c679f6e69e">&#9670;&#160;</a></span>StepNumber</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int* MCMCProcessor::StepNumber</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Step number for step, important if chains were merged. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00465">465</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>

</div>
</div>
<a id="acb1871575fdd3ae156aed4bf7c7a0a73" name="acb1871575fdd3ae156aed4bf7c7a0a73"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acb1871575fdd3ae156aed4bf7c7a0a73">&#9670;&#160;</a></span>SystName_v</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;TString&gt; MCMCProcessor::SystName_v</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Vector of each sample PDF object. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00386">386</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>

</div>
</div>
<a id="a4eb2748c81b0aef9bd7e14785559e301" name="a4eb2748c81b0aef9bd7e14785559e301"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4eb2748c81b0aef9bd7e14785559e301">&#9670;&#160;</a></span>SystValues</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double** MCMCProcessor::SystValues</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Holds the systs values. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00491">491</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>

</div>
</div>
<a id="a840c686f15f419c0156df01c4ed62931" name="a840c686f15f419c0156df01c4ed62931"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a840c686f15f419c0156df01c4ed62931">&#9670;&#160;</a></span>UpperCut</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int MCMCProcessor::UpperCut</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>KS: Used only for SubOptimality. </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00338">338</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>

</div>
</div>
<a id="a562261269f0f4ec4a209b2fca64ff443" name="a562261269f0f4ec4a209b2fca64ff443"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a562261269f0f4ec4a209b2fca64ff443">&#9670;&#160;</a></span>useFFTAutoCorrelation</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool MCMCProcessor::useFFTAutoCorrelation</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>MJR: Use FFT-based autocorrelation algorithm (save time &amp; resources)? </p>

<p class="definition">Definition at line <a class="el" href="MCMCProcessor_8h_source.html#l00414">414</a> of file <a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>mcmc/<a class="el" href="MCMCProcessor_8h_source.html">MCMCProcessor.h</a></li>
<li>mcmc/<a class="el" href="MCMCProcessor_8cpp_source.html">MCMCProcessor.cpp</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.6
</small></address>
</body>
</html>
